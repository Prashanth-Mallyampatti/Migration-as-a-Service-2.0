INFO:root: 16:52:28.976380 Printing the yaml input file
INFO:root: 16:52:28.976497 {'C1': [{'VM': [{'disk': '10G', 'internet_access': True, 'mem': 2, 'name': 'VM1', 'vcpu': 4}, {'disk': '10G', 'internet_access': False, 'mem': 4, 'name': 'VM2', 'vcpu': 2}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'VM': [{'disk': '10G', 'internet_access': True, 'mem': 2, 'name': 'VM4', 'vcpu': 4}], 'subnet_addr': '1.1.1.0/24'}, {'VM': [{'disk': '10G', 'internet_access': True, 'mem': 3, 'name': 'VM3', 'vcpu': 2}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 16:52:28.976587 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 16:52:28.976635 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 16:52:28.976675 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create Tenant Namespace] ******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.1.1', u'name': u't1', u'pns_ip': u'192.168.1.1/24', u'tenant_if': u't1if', u'tenant_ip': u'192.168.1.2/24', u'pns_if': u't1pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t1"], "delta": "0:00:00.051055", "end": "2019-12-05 16:52:30.383068", "item": {"default_route_ip": "192.168.1.1", "name": "t1", "pns_if": "t1pns_if", "pns_ip": "192.168.1.1/24", "tenant_if": "t1if", "tenant_ip": "192.168.1.2/24"}, "rc": 0, "start": "2019-12-05 16:52:30.332013", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Subnet Namespace] ******************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_ns_name': u't1', u'tenant_sub_if': u't1s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.1.2', u'tenant_route_ip': u'192.168.1.2', u'dsport': 4789, u'dev': u't1s1if', u'subnet_route': u'10.1.1.0/24', u'remote_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t1ns1"], "delta": "0:00:00.054900", "end": "2019-12-05 16:52:30.713779", "item": {"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, "rc": 0, "start": "2019-12-05 16:52:30.658879", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.1.1', u'name': u't1', u'pns_ip': u'192.168.1.1/24', u'tenant_if': u't1if', u'tenant_ip': u'192.168.1.2/24', u'pns_if': u't1pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1if\" ; if [ $? -ne 0 ] ; then ip link add \"t1if\" type veth peer name \"t1pns_if\" ; fi\n", "delta": "0:00:00.011267", "end": "2019-12-05 16:52:31.029614", "item": {"default_route_ip": "192.168.1.1", "name": "t1", "pns_if": "t1pns_if", "pns_ip": "192.168.1.1/24", "tenant_if": "t1if", "tenant_ip": "192.168.1.2/24"}, "rc": 0, "start": "2019-12-05 16:52:31.018347", "stderr": "Device \"t1if\" does not exist.", "stderr_lines": ["Device \"t1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.1.1', u'name': u't1', u'pns_ip': u'192.168.1.1/24', u'tenant_if': u't1if', u'tenant_ip': u'192.168.1.2/24', u'pns_if': u't1pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip link show \"t1pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t1pns_if\" netns pns ; fi\nip netns exec \"t1\" ip link show \"t1if\" ; if [ $? -ne 0 ] ; then ip link set \"t1if\" netns \"t1\" ; fi\nip netns exec pns ip link set dev \"t1pns_if\" up\nip netns exec \"t1\" ip link set dev \"t1if\" up\n", "delta": "0:00:00.209792", "end": "2019-12-05 16:52:31.534822", "item": {"default_route_ip": "192.168.1.1", "name": "t1", "pns_if": "t1pns_if", "pns_ip": "192.168.1.1/24", "tenant_if": "t1if", "tenant_ip": "192.168.1.2/24"}, "rc": 0, "start": "2019-12-05 16:52:31.325030", "stderr": "Device \"t1pns_if\" does not exist.\nDevice \"t1if\" does not exist.", "stderr_lines": ["Device \"t1pns_if\" does not exist.", "Device \"t1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.1.1', u'name': u't1', u'pns_ip': u'192.168.1.1/24', u'tenant_if': u't1if', u'tenant_ip': u'192.168.1.2/24', u'pns_if': u't1pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip addr show \"t1pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.1.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip addr add \"192.168.1.1/24\" dev \"t1pns_if\" ; fi\nip netns exec \"t1\" ip addr show \"t1if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.1.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t1\" ip addr add \"192.168.1.2/24\" dev \"t1if\" ; fi\n", "delta": "0:00:00.160078", "end": "2019-12-05 16:52:31.946818", "item": {"default_route_ip": "192.168.1.1", "name": "t1", "pns_if": "t1pns_if", "pns_ip": "192.168.1.1/24", "tenant_if": "t1if", "tenant_ip": "192.168.1.2/24"}, "rc": 0, "start": "2019-12-05 16:52:31.786740", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t1ns1if\" type veth peer name \"t1s1if\" ; fi\n", "delta": "0:00:00.012294", "end": "2019-12-05 16:52:32.222447", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "rc": 0, "start": "2019-12-05 16:52:32.210153", "stderr": "Device \"t1ns1if\" does not exist.", "stderr_lines": ["Device \"t1ns1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1\" ip link show \"t1ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t1ns1if\" netns \"t1\" ; fi\nip netns exec \"t1ns1\" ip link show \"t1s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t1s1if\" netns \"t1ns1\" ; fi\n", "delta": "0:00:00.127908", "end": "2019-12-05 16:52:32.607207", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "rc": 0, "start": "2019-12-05 16:52:32.479299", "stderr": "Device \"t1ns1if\" does not exist.\nDevice \"t1s1if\" does not exist.", "stderr_lines": ["Device \"t1ns1if\" does not exist.", "Device \"t1s1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1\" ip link set dev \"t1ns1if\" up\nip netns exec \"t1ns1\" ip link set dev \"t1s1if\" up\n", "delta": "0:00:00.070493", "end": "2019-12-05 16:52:32.938782", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "rc": 0, "start": "2019-12-05 16:52:32.868289", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip addr show \"t1s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.1.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" ip addr add \"10.1.1.2/24\" dev \"t1s1if\" ; fi\n\nip netns exec \"t1\" ip addr show \"t1ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.1.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t1\" ip addr add \"10.1.1.1/24\" dev \"t1ns1if\" ; fi\n", "delta": "0:00:00.171846", "end": "2019-12-05 16:52:33.382943", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "rc": 0, "start": "2019-12-05 16:52:33.211097", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.1.1', u'name': u't1', u'pns_ip': u'192.168.1.1/24', u'tenant_if': u't1if', u'tenant_ip': u'192.168.1.2/24', u'pns_if': u't1pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1\" ip route show default | grep -w '[d]efault via 192.168.1.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t1\" ip route add default via \"192.168.1.1\" ; fi\n", "delta": "0:00:00.066323", "end": "2019-12-05 16:52:33.738773", "item": {"default_route_ip": "192.168.1.1", "name": "t1", "pns_if": "t1pns_if", "pns_ip": "192.168.1.1/24", "tenant_if": "t1if", "tenant_ip": "192.168.1.2/24"}, "rc": 0, "start": "2019-12-05 16:52:33.672450", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_ns_name': u't1', u'tenant_sub_if': u't1s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.1.2', u'tenant_route_ip': u'192.168.1.2', u'dsport': 4789, u'dev': u't1s1if', u'subnet_route': u'10.1.1.0/24', u'remote_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip route show default | grep -w '[d]efault via 10.1.1.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" ip route add default via \"10.1.1.1\" ; fi\n", "delta": "0:00:00.068395", "end": "2019-12-05 16:52:34.062647", "item": {"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, "rc": 0, "start": "2019-12-05 16:52:33.994252", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside namespace] ***********************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_ns_name': u't1', u'tenant_sub_if': u't1s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.1.2', u'tenant_route_ip': u'192.168.1.2', u'dsport': 4789, u'dev': u't1s1if', u'subnet_route': u'10.1.1.0/24', u'remote_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" brctl show | grep -w '^t1br1'; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" brctl addbr \"t1br1\" ; fi\nip netns exec \"t1ns1\" ip link set dev \"t1br1\" up\n", "delta": "0:00:00.122736", "end": "2019-12-05 16:52:34.466749", "item": {"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, "rc": 0, "start": "2019-12-05 16:52:34.344013", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip link show \"t1s1_dnsbrif\" ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" ip link add \"t1s1_dnsbrif\" type veth peer name \"t1s1_dnsif\" ; fi\nip netns exec \"t1ns1\" ip link set dev \"t1s1_dnsbrif\" up\nip netns exec \"t1ns1\" ip link set dev \"t1s1_dnsif\" up\n", "delta": "0:00:00.135660", "end": "2019-12-05 16:52:34.879036", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 16:52:34.743376", "stderr": "Device \"t1s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t1s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" brctl show \"t1br1\" | grep -w 't1s1_dnsbrif' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" brctl addif \"t1br1\" \"t1s1_dnsbrif\" ; fi\n", "delta": "0:00:00.070617", "end": "2019-12-05 16:52:35.214806", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 16:52:35.144189", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t1VM1if1\" type veth peer name \"t1br1if1\" ; fi\nip link set dev \"t1br1if1\" up\nip link set dev \"t1VM1if1\" up\n", "delta": "0:00:00.015518", "end": "2019-12-05 16:52:35.516995", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}], "rc": 0, "start": "2019-12-05 16:52:35.501477", "stderr": "Device \"t1br1if1\" does not exist.", "stderr_lines": ["Device \"t1br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1br1if2\" ; if [ $? -ne 0 ] ; then ip link add \"t1VM2if1\" type veth peer name \"t1br1if2\" ; fi\nip link set dev \"t1br1if2\" up\nip link set dev \"t1VM2if1\" up\n", "delta": "0:00:00.017468", "end": "2019-12-05 16:52:35.755725", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "rc": 0, "start": "2019-12-05 16:52:35.738257", "stderr": "Device \"t1br1if2\" does not exist.", "stderr_lines": ["Device \"t1br1if2\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t1br1if1\" netns \"t1ns1\" ; fi\nip netns exec \"t1ns1\" brctl show \"t1br1\" | grep -w 't1br1if1' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" brctl addif \"t1br1\" \"t1br1if1\" ; fi\n", "delta": "0:00:00.093665", "end": "2019-12-05 16:52:36.134626", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}], "rc": 0, "start": "2019-12-05 16:52:36.040961", "stderr": "", "stderr_lines": [], "stdout": "20: t1br1if1@t1VM1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 02:1f:74:7d:53:c1 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["20: t1br1if1@t1VM1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 02:1f:74:7d:53:c1 brd ff:ff:ff:ff:ff:ff"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1br1if2\" ; if [ $? -eq 0 ] ; then ip link set \"t1br1if2\" netns \"t1ns1\" ; fi\nip netns exec \"t1ns1\" brctl show \"t1br1\" | grep -w 't1br1if2' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" brctl addif \"t1br1\" \"t1br1if2\" ; fi\n", "delta": "0:00:00.092416", "end": "2019-12-05 16:52:36.426574", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "rc": 0, "start": "2019-12-05 16:52:36.334158", "stderr": "", "stderr_lines": [], "stdout": "22: t1br1if2@t1VM2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether c6:35:3c:ea:41:10 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["22: t1br1if2@t1VM2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether c6:35:3c:ea:41:10 brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip link set \"t1br1if1\" up\nip netns exec \"t1ns1\" ip link set dev \"t1br1\" up\n", "delta": "0:00:00.074070", "end": "2019-12-05 16:52:36.778802", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}], "rc": 0, "start": "2019-12-05 16:52:36.704732", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip link set \"t1br1if2\" up\nip netns exec \"t1ns1\" ip link set dev \"t1br1\" up\n", "delta": "0:00:00.069570", "end": "2019-12-05 16:52:37.079148", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "rc": 0, "start": "2019-12-05 16:52:37.009578", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip addr show \"t1s1_dnsif\" | awk 'FNR==3{ print $2 }' | grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" ip addr add \"1.1.1.1/24\" dev \"t1s1_dnsif\" ; fi\n", "delta": "0:00:00.093861", "end": "2019-12-05 16:52:37.470915", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 16:52:37.377054", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ps aux | grep -w '[d]nsmasq --interface t1s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" dnsmasq --interface \"t1s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.065813", "end": "2019-12-05 16:52:37.824358", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 16:52:37.758545", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}]}, {u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip link show \"vxlan_t1s1\" ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" ip link add \"vxlan_t1s1\" type vxlan id \"42\" local \"10.1.1.2\" remote \"10.2.1.2\" dstport \"4789\" dev \"t1s1if\"; ip netns exec \"t1ns1\" ip link set dev \"vxlan_t1s1\" up ; fi\n", "delta": "0:00:00.138536", "end": "2019-12-05 16:52:38.246767", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}]}, {"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}], "rc": 0, "start": "2019-12-05 16:52:38.108231", "stderr": "Device \"vxlan_t1s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t1s1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}]}, {u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" brctl show \"t1br1\" | grep -w 'vxlan_t1s1' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" brctl addif \"t1br1\" \"vxlan_t1s1\" ; fi\n", "delta": "0:00:00.072275", "end": "2019-12-05 16:52:38.595147", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}]}, {"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}], "rc": 0, "start": "2019-12-05 16:52:38.522872", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Create Tenant Namespace] ******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.129.1', u'name': u't1', u'pns_ip': u'192.168.129.1/24', u'tenant_if': u't1if', u'tenant_ip': u'192.168.129.2/24', u'pns_if': u't1pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t1"], "delta": "0:00:00.053235", "end": "2019-12-05 16:52:40.577425", "item": {"default_route_ip": "192.168.129.1", "name": "t1", "pns_if": "t1pns_if", "pns_ip": "192.168.129.1/24", "tenant_if": "t1if", "tenant_ip": "192.168.129.2/24"}, "rc": 0, "start": "2019-12-05 16:52:40.524190", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Subnet Namespace] ******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_ns_name': u't1', u'tenant_sub_if': u't1s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.1.2', u'tenant_route_ip': u'192.168.129.2', u'dsport': 4789, u'dev': u't1s1if', u'subnet_route': u'10.2.1.0/24', u'remote_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t1ns1"], "delta": "0:00:00.054638", "end": "2019-12-05 16:52:41.045925", "item": {"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, "rc": 0, "start": "2019-12-05 16:52:40.991287", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_ns_name': u't1', u'tenant_sub_if': u't1s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t1ns2"], "delta": "0:00:00.056921", "end": "2019-12-05 16:52:41.429606", "item": {"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-05 16:52:41.372685", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.129.1', u'name': u't1', u'pns_ip': u'192.168.129.1/24', u'tenant_if': u't1if', u'tenant_ip': u'192.168.129.2/24', u'pns_if': u't1pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1if\" ; if [ $? -ne 0 ] ; then ip link add \"t1if\" type veth peer name \"t1pns_if\" ; fi\n", "delta": "0:00:00.011517", "end": "2019-12-05 16:52:41.828724", "item": {"default_route_ip": "192.168.129.1", "name": "t1", "pns_if": "t1pns_if", "pns_ip": "192.168.129.1/24", "tenant_if": "t1if", "tenant_ip": "192.168.129.2/24"}, "rc": 0, "start": "2019-12-05 16:52:41.817207", "stderr": "Device \"t1if\" does not exist.", "stderr_lines": ["Device \"t1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.129.1', u'name': u't1', u'pns_ip': u'192.168.129.1/24', u'tenant_if': u't1if', u'tenant_ip': u'192.168.129.2/24', u'pns_if': u't1pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip link show \"t1pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t1pns_if\" netns pns ; fi\nip netns exec \"t1\" ip link show \"t1if\" ; if [ $? -ne 0 ] ; then ip link set \"t1if\" netns \"t1\" ; fi\nip netns exec pns ip link set dev \"t1pns_if\" up\nip netns exec \"t1\" ip link set dev \"t1if\" up\n", "delta": "0:00:00.212929", "end": "2019-12-05 16:52:42.447771", "item": {"default_route_ip": "192.168.129.1", "name": "t1", "pns_if": "t1pns_if", "pns_ip": "192.168.129.1/24", "tenant_if": "t1if", "tenant_ip": "192.168.129.2/24"}, "rc": 0, "start": "2019-12-05 16:52:42.234842", "stderr": "Device \"t1pns_if\" does not exist.\nDevice \"t1if\" does not exist.", "stderr_lines": ["Device \"t1pns_if\" does not exist.", "Device \"t1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.129.1', u'name': u't1', u'pns_ip': u'192.168.129.1/24', u'tenant_if': u't1if', u'tenant_ip': u'192.168.129.2/24', u'pns_if': u't1pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip addr show \"t1pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.129.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip addr add \"192.168.129.1/24\" dev \"t1pns_if\" ; fi\nip netns exec \"t1\" ip addr show \"t1if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.129.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t1\" ip addr add \"192.168.129.2/24\" dev \"t1if\" ; fi\n", "delta": "0:00:00.146538", "end": "2019-12-05 16:52:42.983821", "item": {"default_route_ip": "192.168.129.1", "name": "t1", "pns_if": "t1pns_if", "pns_ip": "192.168.129.1/24", "tenant_if": "t1if", "tenant_ip": "192.168.129.2/24"}, "rc": 0, "start": "2019-12-05 16:52:42.837283", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t1ns1if\" type veth peer name \"t1s1if\" ; fi\n", "delta": "0:00:00.012089", "end": "2019-12-05 16:52:43.383506", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "rc": 0, "start": "2019-12-05 16:52:43.371417", "stderr": "Device \"t1ns1if\" does not exist.", "stderr_lines": ["Device \"t1ns1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1ns2if\" ; if [ $? -ne 0 ] ; then ip link add \"t1ns2if\" type veth peer name \"t1s2if\" ; fi\n", "delta": "0:00:00.010793", "end": "2019-12-05 16:52:43.736145", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "rc": 0, "start": "2019-12-05 16:52:43.725352", "stderr": "Device \"t1ns2if\" does not exist.", "stderr_lines": ["Device \"t1ns2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1\" ip link show \"t1ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t1ns1if\" netns \"t1\" ; fi\nip netns exec \"t1ns1\" ip link show \"t1s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t1s1if\" netns \"t1ns1\" ; fi\n", "delta": "0:00:00.127214", "end": "2019-12-05 16:52:44.249017", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "rc": 0, "start": "2019-12-05 16:52:44.121803", "stderr": "Device \"t1ns1if\" does not exist.\nDevice \"t1s1if\" does not exist.", "stderr_lines": ["Device \"t1ns1if\" does not exist.", "Device \"t1s1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1\" ip link show \"t1ns2if\" ; if [ $? -ne 0 ] ; then ip link set \"t1ns2if\" netns \"t1\" ; fi\nip netns exec \"t1ns2\" ip link show \"t1s2if\" ; if [ $? -ne 0 ] ; then ip link set \"t1s2if\" netns \"t1ns2\" ; fi\n", "delta": "0:00:00.120158", "end": "2019-12-05 16:52:44.696447", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "rc": 0, "start": "2019-12-05 16:52:44.576289", "stderr": "Device \"t1ns2if\" does not exist.\nDevice \"t1s2if\" does not exist.", "stderr_lines": ["Device \"t1ns2if\" does not exist.", "Device \"t1s2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1\" ip link set dev \"t1ns1if\" up\nip netns exec \"t1ns1\" ip link set dev \"t1s1if\" up\n", "delta": "0:00:00.070055", "end": "2019-12-05 16:52:45.155939", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "rc": 0, "start": "2019-12-05 16:52:45.085884", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1\" ip link set dev \"t1ns2if\" up\nip netns exec \"t1ns2\" ip link set dev \"t1s2if\" up\n", "delta": "0:00:00.095822", "end": "2019-12-05 16:52:45.567866", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "rc": 0, "start": "2019-12-05 16:52:45.472044", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip addr show \"t1s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.1.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" ip addr add \"10.2.1.2/24\" dev \"t1s1if\" ; fi\n\nip netns exec \"t1\" ip addr show \"t1ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.1.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t1\" ip addr add \"10.2.1.1/24\" dev \"t1ns1if\" ; fi\n", "delta": "0:00:00.145705", "end": "2019-12-05 16:52:46.119788", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "rc": 0, "start": "2019-12-05 16:52:45.974083", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns2\" ip addr show \"t1s2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.2.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns2\" ip addr add \"10.2.2.2/24\" dev \"t1s2if\" ; fi\n\nip netns exec \"t1\" ip addr show \"t1ns2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.2.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t1\" ip addr add \"10.2.2.1/24\" dev \"t1ns2if\" ; fi\n", "delta": "0:00:00.145026", "end": "2019-12-05 16:52:46.591750", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "rc": 0, "start": "2019-12-05 16:52:46.446724", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.129.1', u'name': u't1', u'pns_ip': u'192.168.129.1/24', u'tenant_if': u't1if', u'tenant_ip': u'192.168.129.2/24', u'pns_if': u't1pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1\" ip route show default | grep -w '[d]efault via 192.168.129.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t1\" ip route add default via \"192.168.129.1\" ; fi\n", "delta": "0:00:00.070608", "end": "2019-12-05 16:52:47.039871", "item": {"default_route_ip": "192.168.129.1", "name": "t1", "pns_if": "t1pns_if", "pns_ip": "192.168.129.1/24", "tenant_if": "t1if", "tenant_ip": "192.168.129.2/24"}, "rc": 0, "start": "2019-12-05 16:52:46.969263", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_ns_name': u't1', u'tenant_sub_if': u't1s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.1.2', u'tenant_route_ip': u'192.168.129.2', u'dsport': 4789, u'dev': u't1s1if', u'subnet_route': u'10.2.1.0/24', u'remote_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip route show default | grep -w '[d]efault via 10.2.1.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" ip route add default via \"10.2.1.1\" ; fi\n", "delta": "0:00:00.083083", "end": "2019-12-05 16:52:47.491846", "item": {"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, "rc": 0, "start": "2019-12-05 16:52:47.408763", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_ns_name': u't1', u'tenant_sub_if': u't1s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns2\" ip route show default | grep -w '[d]efault via 10.2.2.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns2\" ip route add default via \"10.2.2.1\" ; fi\n", "delta": "0:00:00.076089", "end": "2019-12-05 16:52:47.887866", "item": {"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-05 16:52:47.811777", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside namespace] ***********************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_ns_name': u't1', u'tenant_sub_if': u't1s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.1.2', u'tenant_route_ip': u'192.168.129.2', u'dsport': 4789, u'dev': u't1s1if', u'subnet_route': u'10.2.1.0/24', u'remote_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" brctl show | grep -w '^t1br1'; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" brctl addbr \"t1br1\" ; fi\nip netns exec \"t1ns1\" ip link set dev \"t1br1\" up\n", "delta": "0:00:00.132460", "end": "2019-12-05 16:52:48.424024", "item": {"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, "rc": 0, "start": "2019-12-05 16:52:48.291564", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_ns_name': u't1', u'tenant_sub_if': u't1s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns2\" brctl show | grep -w '^t1br2'; if [ $? -ne 0 ] ; then ip netns exec \"t1ns2\" brctl addbr \"t1br2\" ; fi\nip netns exec \"t1ns2\" ip link set dev \"t1br2\" up\n", "delta": "0:00:00.106371", "end": "2019-12-05 16:52:48.851990", "item": {"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-05 16:52:48.745619", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip link show \"t1s1_dnsbrif\" ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" ip link add \"t1s1_dnsbrif\" type veth peer name \"t1s1_dnsif\" ; fi\nip netns exec \"t1ns1\" ip link set dev \"t1s1_dnsbrif\" up\nip netns exec \"t1ns1\" ip link set dev \"t1s1_dnsif\" up\n", "delta": "0:00:00.146256", "end": "2019-12-05 16:52:49.407773", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 16:52:49.261517", "stderr": "Device \"t1s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t1s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns2\" ip link show \"t1s2_dnsbrif\" ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns2\" ip link add \"t1s2_dnsbrif\" type veth peer name \"t1s2_dnsif\" ; fi\nip netns exec \"t1ns2\" ip link set dev \"t1s2_dnsbrif\" up\nip netns exec \"t1ns2\" ip link set dev \"t1s2_dnsif\" up\n", "delta": "0:00:00.160957", "end": "2019-12-05 16:52:49.908066", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 16:52:49.747109", "stderr": "Device \"t1s2_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t1s2_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" brctl show \"t1br1\" | grep -w 't1s1_dnsbrif' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" brctl addif \"t1br1\" \"t1s1_dnsbrif\" ; fi\n", "delta": "0:00:00.072215", "end": "2019-12-05 16:52:50.383919", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 16:52:50.311704", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns2\" brctl show \"t1br2\" | grep -w 't1s2_dnsbrif' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns2\" brctl addif \"t1br2\" \"t1s2_dnsbrif\" ; fi\n", "delta": "0:00:00.084488", "end": "2019-12-05 16:52:50.807969", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 16:52:50.723481", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t1VM4if1\" type veth peer name \"t1br1if1\" ; fi\nip link set dev \"t1br1if1\" up\nip link set dev \"t1VM4if1\" up\n", "delta": "0:00:00.011787", "end": "2019-12-05 16:52:51.239011", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "rc": 0, "start": "2019-12-05 16:52:51.227224", "stderr": "Device \"t1br1if1\" does not exist.", "stderr_lines": ["Device \"t1br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1br2if1\" ; if [ $? -ne 0 ] ; then ip link add \"t1VM3if1\" type veth peer name \"t1br2if1\" ; fi\nip link set dev \"t1br2if1\" up\nip link set dev \"t1VM3if1\" up\n", "delta": "0:00:00.019463", "end": "2019-12-05 16:52:51.598168", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "rc": 0, "start": "2019-12-05 16:52:51.578705", "stderr": "Device \"t1br2if1\" does not exist.", "stderr_lines": ["Device \"t1br2if1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t1br1if1\" netns \"t1ns1\" ; fi\nip netns exec \"t1ns1\" brctl show \"t1br1\" | grep -w 't1br1if1' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" brctl addif \"t1br1\" \"t1br1if1\" ; fi\n", "delta": "0:00:00.101128", "end": "2019-12-05 16:52:52.143850", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "rc": 0, "start": "2019-12-05 16:52:52.042722", "stderr": "", "stderr_lines": [], "stdout": "21: t1br1if1@t1VM4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 8e:df:3c:6c:9c:ce brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["21: t1br1if1@t1VM4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 8e:df:3c:6c:9c:ce brd ff:ff:ff:ff:ff:ff"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1br2if1\" ; if [ $? -eq 0 ] ; then ip link set \"t1br2if1\" netns \"t1ns2\" ; fi\nip netns exec \"t1ns2\" brctl show \"t1br2\" | grep -w 't1br2if1' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns2\" brctl addif \"t1br2\" \"t1br2if1\" ; fi\n", "delta": "0:00:00.106679", "end": "2019-12-05 16:52:52.603747", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "rc": 0, "start": "2019-12-05 16:52:52.497068", "stderr": "", "stderr_lines": [], "stdout": "23: t1br2if1@t1VM3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether de:61:b3:44:d7:6f brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["23: t1br2if1@t1VM3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether de:61:b3:44:d7:6f brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip link set \"t1br1if1\" up\nip netns exec \"t1ns1\" ip link set dev \"t1br1\" up\n", "delta": "0:00:00.067901", "end": "2019-12-05 16:52:53.084007", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "rc": 0, "start": "2019-12-05 16:52:53.016106", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns2\" ip link set \"t1br2if1\" up\nip netns exec \"t1ns2\" ip link set dev \"t1br2\" up\n", "delta": "0:00:00.086392", "end": "2019-12-05 16:52:53.507795", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "rc": 0, "start": "2019-12-05 16:52:53.421403", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip addr show \"t1s1_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" ip addr add \"1.1.1.1/24\" dev \"t1s1_dnsif\" ; fi\n", "delta": "0:00:00.085219", "end": "2019-12-05 16:52:54.051728", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 16:52:53.966509", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns2\" ip addr show \"t1s2_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^2.2.2.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns2\" ip addr add \"2.2.2.1/24\" dev \"t1s2_dnsif\" ; fi\n", "delta": "0:00:00.087095", "end": "2019-12-05 16:52:54.487904", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 16:52:54.400809", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ps aux | grep -w '[d]nsmasq --interface t1s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" dnsmasq --interface \"t1s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.077224", "end": "2019-12-05 16:52:54.965730", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 16:52:54.888506", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns2\" ps aux | grep -w '[d]nsmasq --interface t1s2_dnsif -z --dhcp-range=2.2.2.5,2.2.2.254' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns2\" dnsmasq --interface \"t1s2_dnsif\" -z --dhcp-range=2.2.2.5,'2.2.2.254' ; fi\n", "delta": "0:00:00.064254", "end": "2019-12-05 16:52:55.368258", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 16:52:55.304004", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}]}, {u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip link show \"vxlan_t1s1\" ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" ip link add \"vxlan_t1s1\" type vxlan id \"42\" local \"10.2.1.2\" remote \"10.1.1.2\" dstport \"4789\" dev \"t1s1if\" ; ip netns exec \"t1ns1\" ip link set dev \"vxlan_t1s1\" up ; fi\n", "delta": "0:00:00.156083", "end": "2019-12-05 16:52:55.939914", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}]}, {"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}], "rc": 0, "start": "2019-12-05 16:52:55.783831", "stderr": "Device \"vxlan_t1s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t1s1\" does not exist."], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}]}, {u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" brctl show \"t1br1\" | grep -w 'vxlan_t1s1' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" brctl addif \"t1br1\" \"vxlan_t1s1\" ; fi\n", "delta": "0:00:00.073551", "end": "2019-12-05 16:52:56.399753", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}]}, {"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}], "rc": 0, "start": "2019-12-05 16:52:56.326202", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}]}, {u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip route show \"10.1.1.0/24\" via \"192.168.1.2\" | grep -w '^10.1.1.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip route add \"10.1.1.0/24\" via \"192.168.1.2\" ; fi\n", "delta": "0:00:00.075346", "end": "2019-12-05 16:52:57.590891", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}]}, {"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}], "rc": 0, "start": "2019-12-05 16:52:57.515545", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": "ip netns exec pns ip addr show p1 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.042656", "end": "2019-12-05 16:52:57.907329", "rc": 0, "start": "2019-12-05 16:52:57.864673", "stderr": "", "stderr_lines": [], "stdout": "192.168.100.238", "stdout_lines": ["192.168.100.238"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}]}, {u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.1.1.0/24\" via \"192.168.100.238\" | grep -w '^10.1.1.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.1.1.0/24\" via \"192.168.100.238\" ; fi\nip route show \"10.2.1.0/24\" via 99.99.99.2 | grep -w '^10.2.1.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.2.1.0/24\" via 99.99.99.2 ; fi\n", "delta": "0:00:00.009340", "end": "2019-12-05 16:52:58.230448", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}]}, {"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}], "rc": 0, "start": "2019-12-05 16:52:58.221108", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}]}, {u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip route show \"10.2.1.0/24\" via \"192.168.129.2\" | grep -w '^10.2.1.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip route add \"10.2.1.0/24\" via \"192.168.129.2\" ; fi\n", "delta": "0:00:00.079606", "end": "2019-12-05 16:52:59.475889", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}]}, {"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}], "rc": 0, "start": "2019-12-05 16:52:59.396283", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": "ip netns exec pns ip addr show p1 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.039904", "end": "2019-12-05 16:52:59.892100", "rc": 0, "start": "2019-12-05 16:52:59.852196", "stderr": "", "stderr_lines": [], "stdout": "192.168.100.50", "stdout_lines": ["192.168.100.50"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}]}, {u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.2.1.0/24\" via \"192.168.100.50\" | grep -w '^10.2.1.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.2.1.0/24\" via \"192.168.100.50\" ; fi\nip route show \"10.1.1.0/24\" via 99.99.99.1 | grep -w '^10.1.1.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.1.1.0/24\" via 99.99.99.1 ; fi\n", "delta": "0:00:00.008177", "end": "2019-12-05 16:53:00.326710", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vms": [{"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}]}, {"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}], "rc": 0, "start": "2019-12-05 16:53:00.318533", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vms": [{"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create VM templates (C1)] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t1/VM_templates/t1_VM1.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575564781.02-253102262605216/source", "state": "file", "uid": 0}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t1/VM_templates/t1_VM2.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575564781.6-28717099839816/source", "state": "file", "uid": 0}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create VM templates (C2)] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t1/VM_templates/t1_VM4.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575564782.48-133612664587968/source", "state": "file", "uid": 0}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t1/VM_templates/t1_VM3.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575564783.05-86552572139749/source", "state": "file", "uid": 0}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Copy VM image] ****************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "d86d5962370fcd0c3d05943fc209d9e05fdac89f", "dest": "/var/lib/libvirt/images/t1_VM1.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}], "md5sum": "b977a19124b65f2d544ddc62e407114d", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/.ansible/tmp/ansible-tmp-1575564784.07-25587481027340/source", "state": "file", "uid": 0}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "d86d5962370fcd0c3d05943fc209d9e05fdac89f", "dest": "/var/lib/libvirt/images/t1_VM2.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "md5sum": "b977a19124b65f2d544ddc62e407114d", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/.ansible/tmp/ansible-tmp-1575564881.04-76678975040675/source", "state": "file", "uid": 0}

TASK [Get list of running VMs] ******************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": ["virsh", "list", "--name"], "delta": "0:00:00.044711", "end": "2019-12-05 16:56:00.315116", "rc": 0, "start": "2019-12-05 16:56:00.270405", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Define VM] ********************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t1_VM1", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t1_VM2", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}

TASK [Create VM] ********************************************************************************************************************************************
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}]}
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}]}

TASK [Start VM] *********************************************************************************************************************************************
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}]}
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}]}

TASK [Attach VM interface] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 2, u'name': u't1_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t1_VM1\" | grep -w 't1VM1if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t1_VM1\" direct \"t1VM1if1\" --live --persistent ; fi\n", "delta": "0:00:02.724745", "end": "2019-12-05 16:56:20.237364", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM1", "vcpu": 4, "vmif": "t1VM1if1"}], "rc": 0, "start": "2019-12-05 16:56:17.512619", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.1.2', u'remote_route': u'10.2.1.0/24', u'subnet_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}, {u'mem': 4, u'name': u't1_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br1if2', u'vmif': u't1VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t1_VM2\" | grep -w 't1VM2if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t1_VM2\" direct \"t1VM2if1\" --live --persistent ; fi\n", "delta": "0:00:00.228499", "end": "2019-12-05 16:56:20.624453", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if2", "disk": "10G", "mem": 4, "name": "t1_VM2", "vcpu": 2, "vmif": "t1VM2if1"}], "rc": 0, "start": "2019-12-05 16:56:20.395954", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=6    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Copy VM image] ****************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "f8b2ffa2bf201c84196c582f2dec0d33a1eb4b42", "dest": "/var/lib/libvirt/images/t1_VM4.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "md5sum": "e6d5d524b68797ddd748ba1475985d34", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/mainVM.qcow2", "state": "file", "uid": 0}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "f8b2ffa2bf201c84196c582f2dec0d33a1eb4b42", "dest": "/var/lib/libvirt/images/t1_VM3.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "md5sum": "e6d5d524b68797ddd748ba1475985d34", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/mainVM.qcow2", "state": "file", "uid": 0}

TASK [Get list of running VMs] ******************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": ["virsh", "list", "--name"], "delta": "0:00:00.045389", "end": "2019-12-05 17:00:02.639065", "rc": 0, "start": "2019-12-05 17:00:02.593676", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Define VM] ********************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t1_VM4", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t1_VM3", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}

TASK [Create VM] ********************************************************************************************************************************************
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}]}
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}]}

TASK [Start VM] *********************************************************************************************************************************************
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}]}
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}]}

TASK [Attach VM interface] **********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_sub_if': u't1s1if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.1.2', u'dsport': 4789, u'dev': u't1s1if', u'tenant_route_ip': u'192.168.129.2', u'remote_route': u'10.1.1.0/24', u'subnet_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}, {u'mem': 2, u'name': u't1_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't1br1if1', u'vmif': u't1VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t1_VM4\" | grep -w 't1VM4if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t1_VM4\" direct \"t1VM4if1\" --live --persistent ; fi\n", "delta": "0:00:00.286867", "end": "2019-12-05 17:00:07.764798", "item": [{"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}, {"brif": "t1br1if1", "disk": "10G", "mem": 2, "name": "t1_VM4", "vcpu": 4, "vmif": "t1VM4if1"}], "rc": 0, "start": "2019-12-05 17:00:07.477931", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_sub_if': u't1s2if', u'tenant_ns_name': u't1'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't1_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't1br2if1', u'vmif': u't1VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t1_VM3\" | grep -w 't1VM3if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t1_VM3\" direct \"t1VM3if1\" --live --persistent ; fi\n", "delta": "0:00:00.220787", "end": "2019-12-05 17:00:08.257936", "item": [{"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t1br2if1", "disk": "10G", "mem": 3, "name": "t1_VM3", "vcpu": 2, "vmif": "t1VM3if1"}], "rc": 0, "start": "2019-12-05 17:00:08.037149", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=6    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 17:15:37.407959 Printing the yaml input file
INFO:root: 17:15:37.408143 {'C1': [{'VM': [{'disk': '10G', 'internet_access': True, 'mem': 2, 'name': 'VM1', 'vcpu': 4}, {'disk': '10G', 'internet_access': False, 'mem': 4, 'name': 'VM2', 'vcpu': 2}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'VM': [{'disk': '10G', 'internet_access': True, 'mem': 2, 'name': 'VM4', 'vcpu': 4}], 'subnet_addr': '1.1.1.0/24'}, {'VM': [{'disk': '10G', 'internet_access': True, 'mem': 3, 'name': 'VM3', 'vcpu': 2}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 17:15:37.408262 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 17:15:37.408313 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 17:15:37.408353 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create Tenant Namespace] ******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t2"], "delta": "0:00:00.071459", "end": "2019-12-05 17:15:38.653906", "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}, "rc": 0, "start": "2019-12-05 17:15:38.582447", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Subnet Namespace] ******************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'tenant_route_ip': u'192.168.2.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.1.11.0/24', u'remote_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t2ns1"], "delta": "0:00:00.075022", "end": "2019-12-05 17:15:39.000074", "item": {"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, "rc": 0, "start": "2019-12-05 17:15:38.925052", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2if\" ; if [ $? -ne 0 ] ; then ip link add \"t2if\" type veth peer name \"t2pns_if\" ; fi\n", "delta": "0:00:00.011057", "end": "2019-12-05 17:15:39.275579", "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}, "rc": 0, "start": "2019-12-05 17:15:39.264522", "stderr": "Device \"t2if\" does not exist.", "stderr_lines": ["Device \"t2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip link show \"t2pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t2pns_if\" netns pns ; fi\nip netns exec \"t2\" ip link show \"t2if\" ; if [ $? -ne 0 ] ; then ip link set \"t2if\" netns \"t2\" ; fi\nip netns exec pns ip link set dev \"t2pns_if\" up\nip netns exec \"t2\" ip link set dev \"t2if\" up\n", "delta": "0:00:00.224108", "end": "2019-12-05 17:15:39.754978", "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}, "rc": 0, "start": "2019-12-05 17:15:39.530870", "stderr": "Device \"t2pns_if\" does not exist.\nDevice \"t2if\" does not exist.", "stderr_lines": ["Device \"t2pns_if\" does not exist.", "Device \"t2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip addr show \"t2pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.2.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip addr add \"192.168.2.1/24\" dev \"t2pns_if\" ; fi\nip netns exec \"t2\" ip addr show \"t2if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.2.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t2\" ip addr add \"192.168.2.2/24\" dev \"t2if\" ; fi\n", "delta": "0:00:00.127886", "end": "2019-12-05 17:15:40.175075", "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}, "rc": 0, "start": "2019-12-05 17:15:40.047189", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t2ns1if\" type veth peer name \"t2s1if\" ; fi\n", "delta": "0:00:00.011833", "end": "2019-12-05 17:15:40.488049", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "rc": 0, "start": "2019-12-05 17:15:40.476216", "stderr": "Device \"t2ns1if\" does not exist.", "stderr_lines": ["Device \"t2ns1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2\" ip link show \"t2ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t2ns1if\" netns \"t2\" ; fi\nip netns exec \"t2ns1\" ip link show \"t2s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t2s1if\" netns \"t2ns1\" ; fi\n", "delta": "0:00:00.115039", "end": "2019-12-05 17:15:40.902249", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "rc": 0, "start": "2019-12-05 17:15:40.787210", "stderr": "Device \"t2ns1if\" does not exist.\nDevice \"t2s1if\" does not exist.", "stderr_lines": ["Device \"t2ns1if\" does not exist.", "Device \"t2s1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2\" ip link set dev \"t2ns1if\" up\nip netns exec \"t2ns1\" ip link set dev \"t2s1if\" up\n", "delta": "0:00:00.089484", "end": "2019-12-05 17:15:41.290760", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "rc": 0, "start": "2019-12-05 17:15:41.201276", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ip addr show \"t2s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.11.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" ip addr add \"10.1.11.2/24\" dev \"t2s1if\" ; fi\n\nip netns exec \"t2\" ip addr show \"t2ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.11.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t2\" ip addr add \"10.1.11.1/24\" dev \"t2ns1if\" ; fi\n", "delta": "0:00:00.145753", "end": "2019-12-05 17:15:41.766972", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "rc": 0, "start": "2019-12-05 17:15:41.621219", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2\" ip route show default | grep -w '[d]efault via 192.168.2.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t2\" ip route add default via \"192.168.2.1\" ; fi\n", "delta": "0:00:00.091528", "end": "2019-12-05 17:15:42.110964", "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}, "rc": 0, "start": "2019-12-05 17:15:42.019436", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'tenant_route_ip': u'192.168.2.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.1.11.0/24', u'remote_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ip route show default | grep -w '[d]efault via 10.1.11.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" ip route add default via \"10.1.11.1\" ; fi\n", "delta": "0:00:00.085723", "end": "2019-12-05 17:15:42.482997", "item": {"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, "rc": 0, "start": "2019-12-05 17:15:42.397274", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside namespace] ***********************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'tenant_route_ip': u'192.168.2.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.1.11.0/24', u'remote_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" brctl show | grep -w '^t2br1'; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" brctl addbr \"t2br1\" ; fi\nip netns exec \"t2ns1\" ip link set dev \"t2br1\" up\n", "delta": "0:00:00.102136", "end": "2019-12-05 17:15:42.894917", "item": {"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, "rc": 0, "start": "2019-12-05 17:15:42.792781", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ip link show \"t2s1_dnsbrif\" ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" ip link add \"t2s1_dnsbrif\" type veth peer name \"t2s1_dnsif\" ; fi\nip netns exec \"t2ns1\" ip link set dev \"t2s1_dnsbrif\" up\nip netns exec \"t2ns1\" ip link set dev \"t2s1_dnsif\" up\n", "delta": "0:00:00.150082", "end": "2019-12-05 17:15:43.346811", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:15:43.196729", "stderr": "Device \"t2s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t2s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" brctl show \"t2br1\" | grep -w 't2s1_dnsbrif' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" brctl addif \"t2br1\" \"t2s1_dnsbrif\" ; fi\n", "delta": "0:00:00.062648", "end": "2019-12-05 17:15:43.706815", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:15:43.644167", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t2VM1if1\" type veth peer name \"t2br1if1\" ; fi\nip link set dev \"t2br1if1\" up\nip link set dev \"t2VM1if1\" up\n", "delta": "0:00:00.019546", "end": "2019-12-05 17:15:44.014769", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}], "rc": 0, "start": "2019-12-05 17:15:43.995223", "stderr": "Device \"t2br1if1\" does not exist.", "stderr_lines": ["Device \"t2br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2br1if2\" ; if [ $? -ne 0 ] ; then ip link add \"t2VM2if1\" type veth peer name \"t2br1if2\" ; fi\nip link set dev \"t2br1if2\" up\nip link set dev \"t2VM2if1\" up\n", "delta": "0:00:00.020903", "end": "2019-12-05 17:15:44.263421", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "rc": 0, "start": "2019-12-05 17:15:44.242518", "stderr": "Device \"t2br1if2\" does not exist.", "stderr_lines": ["Device \"t2br1if2\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t2br1if1\" netns \"t2ns1\" ; fi\nip netns exec \"t2ns1\" brctl show \"t2br1\" | grep -w 't2br1if1' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" brctl addif \"t2br1\" \"t2br1if1\" ; fi\n", "delta": "0:00:00.115427", "end": "2019-12-05 17:15:44.714709", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}], "rc": 0, "start": "2019-12-05 17:15:44.599282", "stderr": "", "stderr_lines": [], "stdout": "30: t2br1if1@t2VM1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 4a:fe:c4:f0:f5:27 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["30: t2br1if1@t2VM1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 4a:fe:c4:f0:f5:27 brd ff:ff:ff:ff:ff:ff"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2br1if2\" ; if [ $? -eq 0 ] ; then ip link set \"t2br1if2\" netns \"t2ns1\" ; fi\nip netns exec \"t2ns1\" brctl show \"t2br1\" | grep -w 't2br1if2' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" brctl addif \"t2br1\" \"t2br1if2\" ; fi\n", "delta": "0:00:00.104674", "end": "2019-12-05 17:15:45.042751", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "rc": 0, "start": "2019-12-05 17:15:44.938077", "stderr": "", "stderr_lines": [], "stdout": "32: t2br1if2@t2VM2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 32:82:b4:a7:c2:91 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["32: t2br1if2@t2VM2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 32:82:b4:a7:c2:91 brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ip link set \"t2br1if1\" up\nip netns exec \"t2ns1\" ip link set dev \"t2br1\" up\n", "delta": "0:00:00.085754", "end": "2019-12-05 17:15:45.414746", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}], "rc": 0, "start": "2019-12-05 17:15:45.328992", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ip link set \"t2br1if2\" up\nip netns exec \"t2ns1\" ip link set dev \"t2br1\" up\n", "delta": "0:00:00.075299", "end": "2019-12-05 17:15:45.710994", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "rc": 0, "start": "2019-12-05 17:15:45.635695", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ip addr show \"t2s1_dnsif\" | awk 'FNR==3{ print $2 }' | grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" ip addr add \"1.1.1.1/24\" dev \"t2s1_dnsif\" ; fi\n", "delta": "0:00:00.089645", "end": "2019-12-05 17:15:46.099104", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:15:46.009459", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ps aux | grep -w '[d]nsmasq --interface t2s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" dnsmasq --interface \"t2s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.081337", "end": "2019-12-05 17:15:46.461336", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:15:46.379999", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}]}, {u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ip link show \"vxlan_t2s1\" ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" ip link add \"vxlan_t2s1\" type vxlan id \"42\" local \"10.1.11.2\" remote \"10.2.11.2\" dstport \"4789\" dev \"t2s1if\"; ip netns exec \"t2ns1\" ip link set dev \"vxlan_t2s1\" up ; fi\n", "delta": "0:00:00.119411", "end": "2019-12-05 17:15:46.862879", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-05 17:15:46.743468", "stderr": "Device \"vxlan_t2s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t2s1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}]}, {u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" brctl show \"t2br1\" | grep -w 'vxlan_t2s1' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" brctl addif \"t2br1\" \"vxlan_t2s1\" ; fi\n", "delta": "0:00:00.066936", "end": "2019-12-05 17:15:47.222808", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-05 17:15:47.155872", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Create Tenant Namespace] ******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t2"], "delta": "0:00:00.050154", "end": "2019-12-05 17:15:49.193203", "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}, "rc": 0, "start": "2019-12-05 17:15:49.143049", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Subnet Namespace] ******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'tenant_route_ip': u'192.168.130.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.2.11.0/24', u'remote_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t2ns1"], "delta": "0:00:00.071059", "end": "2019-12-05 17:15:49.705887", "item": {"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, "rc": 0, "start": "2019-12-05 17:15:49.634828", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t2ns2"], "delta": "0:00:00.057296", "end": "2019-12-05 17:15:50.105873", "item": {"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-05 17:15:50.048577", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2if\" ; if [ $? -ne 0 ] ; then ip link add \"t2if\" type veth peer name \"t2pns_if\" ; fi\n", "delta": "0:00:00.017620", "end": "2019-12-05 17:15:50.537060", "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}, "rc": 0, "start": "2019-12-05 17:15:50.519440", "stderr": "Device \"t2if\" does not exist.", "stderr_lines": ["Device \"t2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip link show \"t2pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t2pns_if\" netns pns ; fi\nip netns exec \"t2\" ip link show \"t2if\" ; if [ $? -ne 0 ] ; then ip link set \"t2if\" netns \"t2\" ; fi\nip netns exec pns ip link set dev \"t2pns_if\" up\nip netns exec \"t2\" ip link set dev \"t2if\" up\n", "delta": "0:00:00.199723", "end": "2019-12-05 17:15:51.159854", "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}, "rc": 0, "start": "2019-12-05 17:15:50.960131", "stderr": "Device \"t2pns_if\" does not exist.\nDevice \"t2if\" does not exist.", "stderr_lines": ["Device \"t2pns_if\" does not exist.", "Device \"t2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip addr show \"t2pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.130.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip addr add \"192.168.130.1/24\" dev \"t2pns_if\" ; fi\nip netns exec \"t2\" ip addr show \"t2if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.130.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t2\" ip addr add \"192.168.130.2/24\" dev \"t2if\" ; fi\n", "delta": "0:00:00.155334", "end": "2019-12-05 17:15:51.695933", "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}, "rc": 0, "start": "2019-12-05 17:15:51.540599", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t2ns1if\" type veth peer name \"t2s1if\" ; fi\n", "delta": "0:00:00.014958", "end": "2019-12-05 17:15:52.116888", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "rc": 0, "start": "2019-12-05 17:15:52.101930", "stderr": "Device \"t2ns1if\" does not exist.", "stderr_lines": ["Device \"t2ns1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2ns2if\" ; if [ $? -ne 0 ] ; then ip link add \"t2ns2if\" type veth peer name \"t2s2if\" ; fi\n", "delta": "0:00:00.013302", "end": "2019-12-05 17:15:52.471128", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "rc": 0, "start": "2019-12-05 17:15:52.457826", "stderr": "Device \"t2ns2if\" does not exist.", "stderr_lines": ["Device \"t2ns2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2\" ip link show \"t2ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t2ns1if\" netns \"t2\" ; fi\nip netns exec \"t2ns1\" ip link show \"t2s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t2s1if\" netns \"t2ns1\" ; fi\n", "delta": "0:00:00.127401", "end": "2019-12-05 17:15:53.048844", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "rc": 0, "start": "2019-12-05 17:15:52.921443", "stderr": "Device \"t2ns1if\" does not exist.\nDevice \"t2s1if\" does not exist.", "stderr_lines": ["Device \"t2ns1if\" does not exist.", "Device \"t2s1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2\" ip link show \"t2ns2if\" ; if [ $? -ne 0 ] ; then ip link set \"t2ns2if\" netns \"t2\" ; fi\nip netns exec \"t2ns2\" ip link show \"t2s2if\" ; if [ $? -ne 0 ] ; then ip link set \"t2s2if\" netns \"t2ns2\" ; fi\n", "delta": "0:00:00.136772", "end": "2019-12-05 17:15:53.541802", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "rc": 0, "start": "2019-12-05 17:15:53.405030", "stderr": "Device \"t2ns2if\" does not exist.\nDevice \"t2s2if\" does not exist.", "stderr_lines": ["Device \"t2ns2if\" does not exist.", "Device \"t2s2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2\" ip link set dev \"t2ns1if\" up\nip netns exec \"t2ns1\" ip link set dev \"t2s1if\" up\n", "delta": "0:00:00.084697", "end": "2019-12-05 17:15:54.043976", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "rc": 0, "start": "2019-12-05 17:15:53.959279", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2\" ip link set dev \"t2ns2if\" up\nip netns exec \"t2ns2\" ip link set dev \"t2s2if\" up\n", "delta": "0:00:00.088035", "end": "2019-12-05 17:15:54.488024", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "rc": 0, "start": "2019-12-05 17:15:54.399989", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ip addr show \"t2s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.11.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" ip addr add \"10.2.11.2/24\" dev \"t2s1if\" ; fi\n\nip netns exec \"t2\" ip addr show \"t2ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.11.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t2\" ip addr add \"10.2.11.1/24\" dev \"t2ns1if\" ; fi\n", "delta": "0:00:00.165311", "end": "2019-12-05 17:15:55.067882", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "rc": 0, "start": "2019-12-05 17:15:54.902571", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns2\" ip addr show \"t2s2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.12.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns2\" ip addr add \"10.2.12.2/24\" dev \"t2s2if\" ; fi\n\nip netns exec \"t2\" ip addr show \"t2ns2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.12.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t2\" ip addr add \"10.2.12.1/24\" dev \"t2ns2if\" ; fi\n", "delta": "0:00:00.154316", "end": "2019-12-05 17:15:55.571871", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "rc": 0, "start": "2019-12-05 17:15:55.417555", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2\" ip route show default | grep -w '[d]efault via 192.168.130.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t2\" ip route add default via \"192.168.130.1\" ; fi\n", "delta": "0:00:00.089821", "end": "2019-12-05 17:15:56.072044", "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}, "rc": 0, "start": "2019-12-05 17:15:55.982223", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'tenant_route_ip': u'192.168.130.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.2.11.0/24', u'remote_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ip route show default | grep -w '[d]efault via 10.2.11.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" ip route add default via \"10.2.11.1\" ; fi\n", "delta": "0:00:00.069790", "end": "2019-12-05 17:15:56.567959", "item": {"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, "rc": 0, "start": "2019-12-05 17:15:56.498169", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns2\" ip route show default | grep -w '[d]efault via 10.2.12.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns2\" ip route add default via \"10.2.12.1\" ; fi\n", "delta": "0:00:00.079619", "end": "2019-12-05 17:15:56.980012", "item": {"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-05 17:15:56.900393", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside namespace] ***********************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'tenant_route_ip': u'192.168.130.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.2.11.0/24', u'remote_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" brctl show | grep -w '^t2br1'; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" brctl addbr \"t2br1\" ; fi\nip netns exec \"t2ns1\" ip link set dev \"t2br1\" up\n", "delta": "0:00:00.131579", "end": "2019-12-05 17:15:57.527927", "item": {"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, "rc": 0, "start": "2019-12-05 17:15:57.396348", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns2\" brctl show | grep -w '^t2br2'; if [ $? -ne 0 ] ; then ip netns exec \"t2ns2\" brctl addbr \"t2br2\" ; fi\nip netns exec \"t2ns2\" ip link set dev \"t2br2\" up\n", "delta": "0:00:00.123383", "end": "2019-12-05 17:15:57.968030", "item": {"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-05 17:15:57.844647", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ip link show \"t2s1_dnsbrif\" ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" ip link add \"t2s1_dnsbrif\" type veth peer name \"t2s1_dnsif\" ; fi\nip netns exec \"t2ns1\" ip link set dev \"t2s1_dnsbrif\" up\nip netns exec \"t2ns1\" ip link set dev \"t2s1_dnsif\" up\n", "delta": "0:00:00.174173", "end": "2019-12-05 17:15:58.584156", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:15:58.409983", "stderr": "Device \"t2s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t2s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns2\" ip link show \"t2s2_dnsbrif\" ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns2\" ip link add \"t2s2_dnsbrif\" type veth peer name \"t2s2_dnsif\" ; fi\nip netns exec \"t2ns2\" ip link set dev \"t2s2_dnsbrif\" up\nip netns exec \"t2ns2\" ip link set dev \"t2s2_dnsif\" up\n", "delta": "0:00:00.191474", "end": "2019-12-05 17:15:59.124180", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:15:58.932706", "stderr": "Device \"t2s2_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t2s2_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" brctl show \"t2br1\" | grep -w 't2s1_dnsbrif' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" brctl addif \"t2br1\" \"t2s1_dnsbrif\" ; fi\n", "delta": "0:00:00.084382", "end": "2019-12-05 17:15:59.631885", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:15:59.547503", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns2\" brctl show \"t2br2\" | grep -w 't2s2_dnsbrif' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns2\" brctl addif \"t2br2\" \"t2s2_dnsbrif\" ; fi\n", "delta": "0:00:00.069796", "end": "2019-12-05 17:16:00.039853", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:15:59.970057", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t2VM4if1\" type veth peer name \"t2br1if1\" ; fi\nip link set dev \"t2br1if1\" up\nip link set dev \"t2VM4if1\" up\n", "delta": "0:00:00.017644", "end": "2019-12-05 17:16:00.469681", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "rc": 0, "start": "2019-12-05 17:16:00.452037", "stderr": "Device \"t2br1if1\" does not exist.", "stderr_lines": ["Device \"t2br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2br2if1\" ; if [ $? -ne 0 ] ; then ip link add \"t2VM3if1\" type veth peer name \"t2br2if1\" ; fi\nip link set dev \"t2br2if1\" up\nip link set dev \"t2VM3if1\" up\n", "delta": "0:00:00.019640", "end": "2019-12-05 17:16:00.854567", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "rc": 0, "start": "2019-12-05 17:16:00.834927", "stderr": "Device \"t2br2if1\" does not exist.", "stderr_lines": ["Device \"t2br2if1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t2br1if1\" netns \"t2ns1\" ; fi\nip netns exec \"t2ns1\" brctl show \"t2br1\" | grep -w 't2br1if1' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" brctl addif \"t2br1\" \"t2br1if1\" ; fi\n", "delta": "0:00:00.116741", "end": "2019-12-05 17:16:01.415972", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "rc": 0, "start": "2019-12-05 17:16:01.299231", "stderr": "", "stderr_lines": [], "stdout": "33: t2br1if1@t2VM4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 42:61:0b:cb:76:f7 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["33: t2br1if1@t2VM4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 42:61:0b:cb:76:f7 brd ff:ff:ff:ff:ff:ff"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2br2if1\" ; if [ $? -eq 0 ] ; then ip link set \"t2br2if1\" netns \"t2ns2\" ; fi\nip netns exec \"t2ns2\" brctl show \"t2br2\" | grep -w 't2br2if1' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns2\" brctl addif \"t2br2\" \"t2br2if1\" ; fi\n", "delta": "0:00:00.114667", "end": "2019-12-05 17:16:01.911929", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "rc": 0, "start": "2019-12-05 17:16:01.797262", "stderr": "", "stderr_lines": [], "stdout": "35: t2br2if1@t2VM3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether e6:d4:83:fd:6a:25 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["35: t2br2if1@t2VM3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether e6:d4:83:fd:6a:25 brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ip link set \"t2br1if1\" up\nip netns exec \"t2ns1\" ip link set dev \"t2br1\" up\n", "delta": "0:00:00.064326", "end": "2019-12-05 17:16:02.403901", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "rc": 0, "start": "2019-12-05 17:16:02.339575", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns2\" ip link set \"t2br2if1\" up\nip netns exec \"t2ns2\" ip link set dev \"t2br2\" up\n", "delta": "0:00:00.077662", "end": "2019-12-05 17:16:02.848136", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "rc": 0, "start": "2019-12-05 17:16:02.770474", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ip addr show \"t2s1_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" ip addr add \"1.1.1.1/24\" dev \"t2s1_dnsif\" ; fi\n", "delta": "0:00:00.095424", "end": "2019-12-05 17:16:03.359987", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:16:03.264563", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns2\" ip addr show \"t2s2_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^2.2.2.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns2\" ip addr add \"2.2.2.1/24\" dev \"t2s2_dnsif\" ; fi\n", "delta": "0:00:00.077233", "end": "2019-12-05 17:16:03.763977", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:16:03.686744", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ps aux | grep -w '[d]nsmasq --interface t2s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" dnsmasq --interface \"t2s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.092508", "end": "2019-12-05 17:16:04.273485", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:16:04.180977", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns2\" ps aux | grep -w '[d]nsmasq --interface t2s2_dnsif -z --dhcp-range=2.2.2.5,2.2.2.254' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns2\" dnsmasq --interface \"t2s2_dnsif\" -z --dhcp-range=2.2.2.5,'2.2.2.254' ; fi\n", "delta": "0:00:00.085682", "end": "2019-12-05 17:16:04.708679", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:16:04.622997", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}]}, {u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ip link show \"vxlan_t2s1\" ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" ip link add \"vxlan_t2s1\" type vxlan id \"42\" local \"10.2.11.2\" remote \"10.1.11.2\" dstport \"4789\" dev \"t2s1if\" ; ip netns exec \"t2ns1\" ip link set dev \"vxlan_t2s1\" up ; fi\n", "delta": "0:00:00.163672", "end": "2019-12-05 17:16:05.276074", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-05 17:16:05.112402", "stderr": "Device \"vxlan_t2s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t2s1\" does not exist."], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}]}, {u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" brctl show \"t2br1\" | grep -w 'vxlan_t2s1' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" brctl addif \"t2br1\" \"vxlan_t2s1\" ; fi\n", "delta": "0:00:00.070858", "end": "2019-12-05 17:16:05.779892", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-05 17:16:05.709034", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}]}, {u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip route show \"10.1.11.0/24\" via \"192.168.2.2\" | grep -w '^10.1.11.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip route add \"10.1.11.0/24\" via \"192.168.2.2\" ; fi\n", "delta": "0:00:00.070466", "end": "2019-12-05 17:16:06.926888", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-05 17:16:06.856422", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": "ip netns exec pns ip addr show p1 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.039464", "end": "2019-12-05 17:16:07.263163", "rc": 0, "start": "2019-12-05 17:16:07.223699", "stderr": "", "stderr_lines": [], "stdout": "192.168.100.238", "stdout_lines": ["192.168.100.238"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}]}, {u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.1.11.0/24\" via \"192.168.100.238\" | grep -w '^10.1.11.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.1.11.0/24\" via \"192.168.100.238\" ; fi\nip route show \"10.2.11.0/24\" via 99.99.99.2 | grep -w '^10.2.11.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.2.11.0/24\" via 99.99.99.2 ; fi\n", "delta": "0:00:00.008951", "end": "2019-12-05 17:16:07.571889", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-05 17:16:07.562938", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}]}, {u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip route show \"10.2.11.0/24\" via \"192.168.130.2\" | grep -w '^10.2.11.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip route add \"10.2.11.0/24\" via \"192.168.130.2\" ; fi\n", "delta": "0:00:00.075684", "end": "2019-12-05 17:16:08.847896", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-05 17:16:08.772212", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": "ip netns exec pns ip addr show p1 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.045408", "end": "2019-12-05 17:16:09.292388", "rc": 0, "start": "2019-12-05 17:16:09.246980", "stderr": "", "stderr_lines": [], "stdout": "192.168.100.50", "stdout_lines": ["192.168.100.50"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}]}, {u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.2.11.0/24\" via \"192.168.100.50\" | grep -w '^10.2.11.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.2.11.0/24\" via \"192.168.100.50\" ; fi\nip route show \"10.1.11.0/24\" via 99.99.99.1 | grep -w '^10.1.11.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.1.11.0/24\" via 99.99.99.1 ; fi\n", "delta": "0:00:00.008209", "end": "2019-12-05 17:16:09.712659", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-05 17:16:09.704450", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create VM templates (C1)] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t2/VM_templates/t2_VM1.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575566170.44-124610988213122/source", "state": "file", "uid": 0}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t2/VM_templates/t2_VM2.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575566171.08-215228952907218/source", "state": "file", "uid": 0}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create VM templates (C2)] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t2/VM_templates/t2_VM4.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575566172.05-258680757173992/source", "state": "file", "uid": 0}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t2/VM_templates/t2_VM3.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575566172.62-137627926586896/source", "state": "file", "uid": 0}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Copy VM image] ****************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "d86d5962370fcd0c3d05943fc209d9e05fdac89f", "dest": "/var/lib/libvirt/images/t2_VM1.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}], "md5sum": "b977a19124b65f2d544ddc62e407114d", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/.ansible/tmp/ansible-tmp-1575566173.63-243798079082995/source", "state": "file", "uid": 0}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "d86d5962370fcd0c3d05943fc209d9e05fdac89f", "dest": "/var/lib/libvirt/images/t2_VM2.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "md5sum": "b977a19124b65f2d544ddc62e407114d", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/.ansible/tmp/ansible-tmp-1575566298.24-184710592608301/source", "state": "file", "uid": 0}

TASK [Get list of running VMs] ******************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": ["virsh", "list", "--name"], "delta": "0:00:00.064717", "end": "2019-12-05 17:20:08.178749", "rc": 0, "start": "2019-12-05 17:20:08.114032", "stderr": "", "stderr_lines": [], "stdout": "t1_VM1\nt1_VM2", "stdout_lines": ["t1_VM1", "t1_VM2"]}

TASK [Define VM] ********************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t2_VM1", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t2_VM2", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}

TASK [Create VM] ********************************************************************************************************************************************
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}]}
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}]}

TASK [Start VM] *********************************************************************************************************************************************
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}]}
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}]}

TASK [Attach VM interface] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 2, u'name': u't2_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t2_VM1\" | grep -w 't2VM1if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t2_VM1\" direct \"t2VM1if1\" --live --persistent ; fi\n", "delta": "0:00:00.257719", "end": "2019-12-05 17:20:11.930165", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM1", "vcpu": 4, "vmif": "t2VM1if1"}], "rc": 0, "start": "2019-12-05 17:20:11.672446", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'mem': 4, u'name': u't2_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br1if2', u'vmif': u't2VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t2_VM2\" | grep -w 't2VM2if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t2_VM2\" direct \"t2VM2if1\" --live --persistent ; fi\n", "delta": "0:00:00.217950", "end": "2019-12-05 17:20:12.301350", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if2", "disk": "10G", "mem": 4, "name": "t2_VM2", "vcpu": 2, "vmif": "t2VM2if1"}], "rc": 0, "start": "2019-12-05 17:20:12.083400", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=6    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Copy VM image] ****************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "f8b2ffa2bf201c84196c582f2dec0d33a1eb4b42", "dest": "/var/lib/libvirt/images/t2_VM4.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "md5sum": "e6d5d524b68797ddd748ba1475985d34", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/mainVM.qcow2", "state": "file", "uid": 0}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "f8b2ffa2bf201c84196c582f2dec0d33a1eb4b42", "dest": "/var/lib/libvirt/images/t2_VM3.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "md5sum": "e6d5d524b68797ddd748ba1475985d34", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/mainVM.qcow2", "state": "file", "uid": 0}

TASK [Get list of running VMs] ******************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": ["virsh", "list", "--name"], "delta": "0:00:00.032875", "end": "2019-12-05 17:23:28.289247", "rc": 0, "start": "2019-12-05 17:23:28.256372", "stderr": "", "stderr_lines": [], "stdout": "t1_VM4\nt1_VM3", "stdout_lines": ["t1_VM4", "t1_VM3"]}

TASK [Define VM] ********************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t2_VM4", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t2_VM3", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}

TASK [Create VM] ********************************************************************************************************************************************
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}]}
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}]}

TASK [Start VM] *********************************************************************************************************************************************
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}]}
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}]}

TASK [Attach VM interface] **********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'mem': 2, u'name': u't2_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't2br1if1', u'vmif': u't2VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t2_VM4\" | grep -w 't2VM4if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t2_VM4\" direct \"t2VM4if1\" --live --persistent ; fi\n", "delta": "0:00:00.344117", "end": "2019-12-05 17:23:55.581719", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "disk": "10G", "mem": 2, "name": "t2_VM4", "vcpu": 4, "vmif": "t2VM4if1"}], "rc": 0, "start": "2019-12-05 17:23:55.237602", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't2_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't2br2if1', u'vmif': u't2VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t2_VM3\" | grep -w 't2VM3if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t2_VM3\" direct \"t2VM3if1\" --live --persistent ; fi\n", "delta": "0:00:00.263837", "end": "2019-12-05 17:23:56.123687", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2br2if1", "disk": "10G", "mem": 3, "name": "t2_VM3", "vcpu": 2, "vmif": "t2VM3if1"}], "rc": 0, "start": "2019-12-05 17:23:55.859850", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=6    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 17:41:30.427467 Printing the yaml input file
INFO:root: 17:41:30.427672 {'C1': [{'VM': [{'disk': '10G', 'internet_access': True, 'mem': 2, 'name': 'VM1', 'vcpu': 4}, {'disk': '10G', 'internet_access': False, 'mem': 4, 'name': 'VM2', 'vcpu': 2}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'VM': [{'disk': '10G', 'internet_access': True, 'mem': 2, 'name': 'VM4', 'vcpu': 4}], 'subnet_addr': '1.1.1.0/24'}, {'VM': [{'disk': '10G', 'internet_access': True, 'mem': 3, 'name': 'VM3', 'vcpu': 2}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 17:41:30.427795 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 17:41:30.427847 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 17:41:30.427889 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create Tenant Namespace] ******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.3.1', u'name': u't3', u'pns_ip': u'192.168.3.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.3.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t3"], "delta": "0:00:00.054646", "end": "2019-12-05 17:41:31.772004", "item": {"default_route_ip": "192.168.3.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.3.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.3.2/24"}, "rc": 0, "start": "2019-12-05 17:41:31.717358", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Subnet Namespace] ******************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'tenant_route_ip': u'192.168.3.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.1.21.0/24', u'remote_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t3ns1"], "delta": "0:00:00.054785", "end": "2019-12-05 17:41:32.135264", "item": {"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, "rc": 0, "start": "2019-12-05 17:41:32.080479", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.3.1', u'name': u't3', u'pns_ip': u'192.168.3.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.3.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3if\" ; if [ $? -ne 0 ] ; then ip link add \"t3if\" type veth peer name \"t3pns_if\" ; fi\n", "delta": "0:00:00.030122", "end": "2019-12-05 17:41:32.453733", "item": {"default_route_ip": "192.168.3.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.3.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.3.2/24"}, "rc": 0, "start": "2019-12-05 17:41:32.423611", "stderr": "Device \"t3if\" does not exist.", "stderr_lines": ["Device \"t3if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.3.1', u'name': u't3', u'pns_ip': u'192.168.3.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.3.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip link show \"t3pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t3pns_if\" netns pns ; fi\nip netns exec \"t3\" ip link show \"t3if\" ; if [ $? -ne 0 ] ; then ip link set \"t3if\" netns \"t3\" ; fi\nip netns exec pns ip link set dev \"t3pns_if\" up\nip netns exec \"t3\" ip link set dev \"t3if\" up\n", "delta": "0:00:00.196122", "end": "2019-12-05 17:41:32.954811", "item": {"default_route_ip": "192.168.3.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.3.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.3.2/24"}, "rc": 0, "start": "2019-12-05 17:41:32.758689", "stderr": "Device \"t3pns_if\" does not exist.\nDevice \"t3if\" does not exist.", "stderr_lines": ["Device \"t3pns_if\" does not exist.", "Device \"t3if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.3.1', u'name': u't3', u'pns_ip': u'192.168.3.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.3.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip addr show \"t3pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.3.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip addr add \"192.168.3.1/24\" dev \"t3pns_if\" ; fi\nip netns exec \"t3\" ip addr show \"t3if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.3.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t3\" ip addr add \"192.168.3.2/24\" dev \"t3if\" ; fi\n", "delta": "0:00:00.150752", "end": "2019-12-05 17:41:33.390937", "item": {"default_route_ip": "192.168.3.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.3.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.3.2/24"}, "rc": 0, "start": "2019-12-05 17:41:33.240185", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t3ns1if\" type veth peer name \"t3s1if\" ; fi\n", "delta": "0:00:00.012830", "end": "2019-12-05 17:41:33.702284", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "rc": 0, "start": "2019-12-05 17:41:33.689454", "stderr": "Device \"t3ns1if\" does not exist.", "stderr_lines": ["Device \"t3ns1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3\" ip link show \"t3ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t3ns1if\" netns \"t3\" ; fi\nip netns exec \"t3ns1\" ip link show \"t3s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t3s1if\" netns \"t3ns1\" ; fi\n", "delta": "0:00:00.150075", "end": "2019-12-05 17:41:34.177311", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "rc": 0, "start": "2019-12-05 17:41:34.027236", "stderr": "Device \"t3ns1if\" does not exist.\nDevice \"t3s1if\" does not exist.", "stderr_lines": ["Device \"t3ns1if\" does not exist.", "Device \"t3s1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3\" ip link set dev \"t3ns1if\" up\nip netns exec \"t3ns1\" ip link set dev \"t3s1if\" up\n", "delta": "0:00:00.089862", "end": "2019-12-05 17:41:34.582841", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "rc": 0, "start": "2019-12-05 17:41:34.492979", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ip addr show \"t3s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.21.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" ip addr add \"10.1.21.2/24\" dev \"t3s1if\" ; fi\n\nip netns exec \"t3\" ip addr show \"t3ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.21.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t3\" ip addr add \"10.1.21.1/24\" dev \"t3ns1if\" ; fi\n", "delta": "0:00:00.153756", "end": "2019-12-05 17:41:35.018767", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "rc": 0, "start": "2019-12-05 17:41:34.865011", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.3.1', u'name': u't3', u'pns_ip': u'192.168.3.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.3.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3\" ip route show default | grep -w '[d]efault via 192.168.3.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t3\" ip route add default via \"192.168.3.1\" ; fi\n", "delta": "0:00:00.075875", "end": "2019-12-05 17:41:35.382692", "item": {"default_route_ip": "192.168.3.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.3.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.3.2/24"}, "rc": 0, "start": "2019-12-05 17:41:35.306817", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'tenant_route_ip': u'192.168.3.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.1.21.0/24', u'remote_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ip route show default | grep -w '[d]efault via 10.1.21.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" ip route add default via \"10.1.21.1\" ; fi\n", "delta": "0:00:00.078910", "end": "2019-12-05 17:41:35.762810", "item": {"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, "rc": 0, "start": "2019-12-05 17:41:35.683900", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside namespace] ***********************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'tenant_route_ip': u'192.168.3.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.1.21.0/24', u'remote_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" brctl show | grep -w '^t3br1'; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" brctl addbr \"t3br1\" ; fi\nip netns exec \"t3ns1\" ip link set dev \"t3br1\" up\n", "delta": "0:00:00.128120", "end": "2019-12-05 17:41:36.194999", "item": {"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, "rc": 0, "start": "2019-12-05 17:41:36.066879", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ip link show \"t3s1_dnsbrif\" ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" ip link add \"t3s1_dnsbrif\" type veth peer name \"t3s1_dnsif\" ; fi\nip netns exec \"t3ns1\" ip link set dev \"t3s1_dnsbrif\" up\nip netns exec \"t3ns1\" ip link set dev \"t3s1_dnsif\" up\n", "delta": "0:00:00.175766", "end": "2019-12-05 17:41:36.706871", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:41:36.531105", "stderr": "Device \"t3s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t3s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" brctl show \"t3br1\" | grep -w 't3s1_dnsbrif' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" brctl addif \"t3br1\" \"t3s1_dnsbrif\" ; fi\n", "delta": "0:00:00.095165", "end": "2019-12-05 17:41:37.150965", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:41:37.055800", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t3VM1if1\" type veth peer name \"t3br1if1\" ; fi\nip link set dev \"t3br1if1\" up\nip link set dev \"t3VM1if1\" up\n", "delta": "0:00:00.017043", "end": "2019-12-05 17:41:37.471499", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}], "rc": 0, "start": "2019-12-05 17:41:37.454456", "stderr": "Device \"t3br1if1\" does not exist.", "stderr_lines": ["Device \"t3br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3br1if2\" ; if [ $? -ne 0 ] ; then ip link add \"t3VM2if1\" type veth peer name \"t3br1if2\" ; fi\nip link set dev \"t3br1if2\" up\nip link set dev \"t3VM2if1\" up\n", "delta": "0:00:00.019561", "end": "2019-12-05 17:41:37.738211", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "rc": 0, "start": "2019-12-05 17:41:37.718650", "stderr": "Device \"t3br1if2\" does not exist.", "stderr_lines": ["Device \"t3br1if2\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t3br1if1\" netns \"t3ns1\" ; fi\nip netns exec \"t3ns1\" brctl show \"t3br1\" | grep -w 't3br1if1' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" brctl addif \"t3br1\" \"t3br1if1\" ; fi\n", "delta": "0:00:00.087637", "end": "2019-12-05 17:41:38.114787", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}], "rc": 0, "start": "2019-12-05 17:41:38.027150", "stderr": "", "stderr_lines": [], "stdout": "40: t3br1if1@t3VM1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether f2:b2:55:93:e6:ac brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["40: t3br1if1@t3VM1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether f2:b2:55:93:e6:ac brd ff:ff:ff:ff:ff:ff"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3br1if2\" ; if [ $? -eq 0 ] ; then ip link set \"t3br1if2\" netns \"t3ns1\" ; fi\nip netns exec \"t3ns1\" brctl show \"t3br1\" | grep -w 't3br1if2' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" brctl addif \"t3br1\" \"t3br1if2\" ; fi\n", "delta": "0:00:00.105753", "end": "2019-12-05 17:41:38.426777", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "rc": 0, "start": "2019-12-05 17:41:38.321024", "stderr": "", "stderr_lines": [], "stdout": "42: t3br1if2@t3VM2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether b2:aa:b5:c4:fd:ac brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["42: t3br1if2@t3VM2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether b2:aa:b5:c4:fd:ac brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ip link set \"t3br1if1\" up\nip netns exec \"t3ns1\" ip link set dev \"t3br1\" up\n", "delta": "0:00:00.097220", "end": "2019-12-05 17:41:38.806865", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}], "rc": 0, "start": "2019-12-05 17:41:38.709645", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ip link set \"t3br1if2\" up\nip netns exec \"t3ns1\" ip link set dev \"t3br1\" up\n", "delta": "0:00:00.074481", "end": "2019-12-05 17:41:39.086761", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "rc": 0, "start": "2019-12-05 17:41:39.012280", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ip addr show \"t3s1_dnsif\" | awk 'FNR==3{ print $2 }' | grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" ip addr add \"1.1.1.1/24\" dev \"t3s1_dnsif\" ; fi\n", "delta": "0:00:00.067702", "end": "2019-12-05 17:41:39.434754", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:41:39.367052", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ps aux | grep -w '[d]nsmasq --interface t3s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" dnsmasq --interface \"t3s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.075000", "end": "2019-12-05 17:41:39.819689", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:41:39.744689", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}]}, {u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ip link show \"vxlan_t3s1\" ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" ip link add \"vxlan_t3s1\" type vxlan id \"42\" local \"10.1.21.2\" remote \"10.2.21.2\" dstport \"4789\" dev \"t3s1if\"; ip netns exec \"t3ns1\" ip link set dev \"vxlan_t3s1\" up ; fi\n", "delta": "0:00:00.123983", "end": "2019-12-05 17:41:40.250999", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-05 17:41:40.127016", "stderr": "Device \"vxlan_t3s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t3s1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}]}, {u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" brctl show \"t3br1\" | grep -w 'vxlan_t3s1' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" brctl addif \"t3br1\" \"vxlan_t3s1\" ; fi\n", "delta": "0:00:00.075302", "end": "2019-12-05 17:41:40.642739", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-05 17:41:40.567437", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Create Tenant Namespace] ******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.131.1', u'name': u't3', u'pns_ip': u'192.168.131.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.131.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t3"], "delta": "0:00:00.053373", "end": "2019-12-05 17:41:42.596279", "item": {"default_route_ip": "192.168.131.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.131.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.131.2/24"}, "rc": 0, "start": "2019-12-05 17:41:42.542906", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Subnet Namespace] ******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'tenant_route_ip': u'192.168.131.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.2.21.0/24', u'remote_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t3ns1"], "delta": "0:00:00.052076", "end": "2019-12-05 17:41:43.071152", "item": {"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, "rc": 0, "start": "2019-12-05 17:41:43.019076", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t3ns2"], "delta": "0:00:00.058041", "end": "2019-12-05 17:41:43.456338", "item": {"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-05 17:41:43.398297", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.131.1', u'name': u't3', u'pns_ip': u'192.168.131.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.131.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3if\" ; if [ $? -ne 0 ] ; then ip link add \"t3if\" type veth peer name \"t3pns_if\" ; fi\n", "delta": "0:00:00.012282", "end": "2019-12-05 17:41:43.862269", "item": {"default_route_ip": "192.168.131.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.131.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.131.2/24"}, "rc": 0, "start": "2019-12-05 17:41:43.849987", "stderr": "Device \"t3if\" does not exist.", "stderr_lines": ["Device \"t3if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.131.1', u'name': u't3', u'pns_ip': u'192.168.131.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.131.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip link show \"t3pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t3pns_if\" netns pns ; fi\nip netns exec \"t3\" ip link show \"t3if\" ; if [ $? -ne 0 ] ; then ip link set \"t3if\" netns \"t3\" ; fi\nip netns exec pns ip link set dev \"t3pns_if\" up\nip netns exec \"t3\" ip link set dev \"t3if\" up\n", "delta": "0:00:00.188746", "end": "2019-12-05 17:41:44.442711", "item": {"default_route_ip": "192.168.131.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.131.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.131.2/24"}, "rc": 0, "start": "2019-12-05 17:41:44.253965", "stderr": "Device \"t3pns_if\" does not exist.\nDevice \"t3if\" does not exist.", "stderr_lines": ["Device \"t3pns_if\" does not exist.", "Device \"t3if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.131.1', u'name': u't3', u'pns_ip': u'192.168.131.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.131.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip addr show \"t3pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.131.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip addr add \"192.168.131.1/24\" dev \"t3pns_if\" ; fi\nip netns exec \"t3\" ip addr show \"t3if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.131.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t3\" ip addr add \"192.168.131.2/24\" dev \"t3if\" ; fi\n", "delta": "0:00:00.148871", "end": "2019-12-05 17:41:44.986574", "item": {"default_route_ip": "192.168.131.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.131.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.131.2/24"}, "rc": 0, "start": "2019-12-05 17:41:44.837703", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t3ns1if\" type veth peer name \"t3s1if\" ; fi\n", "delta": "0:00:00.010130", "end": "2019-12-05 17:41:45.407265", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "rc": 0, "start": "2019-12-05 17:41:45.397135", "stderr": "Device \"t3ns1if\" does not exist.", "stderr_lines": ["Device \"t3ns1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3ns2if\" ; if [ $? -ne 0 ] ; then ip link add \"t3ns2if\" type veth peer name \"t3s2if\" ; fi\n", "delta": "0:00:00.013384", "end": "2019-12-05 17:41:45.757638", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "rc": 0, "start": "2019-12-05 17:41:45.744254", "stderr": "Device \"t3ns2if\" does not exist.", "stderr_lines": ["Device \"t3ns2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3\" ip link show \"t3ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t3ns1if\" netns \"t3\" ; fi\nip netns exec \"t3ns1\" ip link show \"t3s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t3s1if\" netns \"t3ns1\" ; fi\n", "delta": "0:00:00.136305", "end": "2019-12-05 17:41:46.295563", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "rc": 0, "start": "2019-12-05 17:41:46.159258", "stderr": "Device \"t3ns1if\" does not exist.\nDevice \"t3s1if\" does not exist.", "stderr_lines": ["Device \"t3ns1if\" does not exist.", "Device \"t3s1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3\" ip link show \"t3ns2if\" ; if [ $? -ne 0 ] ; then ip link set \"t3ns2if\" netns \"t3\" ; fi\nip netns exec \"t3ns2\" ip link show \"t3s2if\" ; if [ $? -ne 0 ] ; then ip link set \"t3s2if\" netns \"t3ns2\" ; fi\n", "delta": "0:00:00.117301", "end": "2019-12-05 17:41:46.751304", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "rc": 0, "start": "2019-12-05 17:41:46.634003", "stderr": "Device \"t3ns2if\" does not exist.\nDevice \"t3s2if\" does not exist.", "stderr_lines": ["Device \"t3ns2if\" does not exist.", "Device \"t3s2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3\" ip link set dev \"t3ns1if\" up\nip netns exec \"t3ns1\" ip link set dev \"t3s1if\" up\n", "delta": "0:00:00.074493", "end": "2019-12-05 17:41:47.222615", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "rc": 0, "start": "2019-12-05 17:41:47.148122", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3\" ip link set dev \"t3ns2if\" up\nip netns exec \"t3ns2\" ip link set dev \"t3s2if\" up\n", "delta": "0:00:00.080591", "end": "2019-12-05 17:41:47.626757", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "rc": 0, "start": "2019-12-05 17:41:47.546166", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ip addr show \"t3s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.21.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" ip addr add \"10.2.21.2/24\" dev \"t3s1if\" ; fi\n\nip netns exec \"t3\" ip addr show \"t3ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.21.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t3\" ip addr add \"10.2.21.1/24\" dev \"t3ns1if\" ; fi\n", "delta": "0:00:00.153567", "end": "2019-12-05 17:41:48.182554", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "rc": 0, "start": "2019-12-05 17:41:48.028987", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns2\" ip addr show \"t3s2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.22.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns2\" ip addr add \"10.2.22.2/24\" dev \"t3s2if\" ; fi\n\nip netns exec \"t3\" ip addr show \"t3ns2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.22.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t3\" ip addr add \"10.2.22.1/24\" dev \"t3ns2if\" ; fi\n", "delta": "0:00:00.154504", "end": "2019-12-05 17:41:48.678542", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "rc": 0, "start": "2019-12-05 17:41:48.524038", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.131.1', u'name': u't3', u'pns_ip': u'192.168.131.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.131.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3\" ip route show default | grep -w '[d]efault via 192.168.131.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t3\" ip route add default via \"192.168.131.1\" ; fi\n", "delta": "0:00:00.089396", "end": "2019-12-05 17:41:49.158689", "item": {"default_route_ip": "192.168.131.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.131.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.131.2/24"}, "rc": 0, "start": "2019-12-05 17:41:49.069293", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'tenant_route_ip': u'192.168.131.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.2.21.0/24', u'remote_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ip route show default | grep -w '[d]efault via 10.2.21.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" ip route add default via \"10.2.21.1\" ; fi\n", "delta": "0:00:00.089433", "end": "2019-12-05 17:41:49.650653", "item": {"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, "rc": 0, "start": "2019-12-05 17:41:49.561220", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns2\" ip route show default | grep -w '[d]efault via 10.2.22.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns2\" ip route add default via \"10.2.22.1\" ; fi\n", "delta": "0:00:00.075553", "end": "2019-12-05 17:41:50.042587", "item": {"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-05 17:41:49.967034", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside namespace] ***********************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'tenant_route_ip': u'192.168.131.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.2.21.0/24', u'remote_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" brctl show | grep -w '^t3br1'; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" brctl addbr \"t3br1\" ; fi\nip netns exec \"t3ns1\" ip link set dev \"t3br1\" up\n", "delta": "0:00:00.122231", "end": "2019-12-05 17:41:50.558866", "item": {"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, "rc": 0, "start": "2019-12-05 17:41:50.436635", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns2\" brctl show | grep -w '^t3br2'; if [ $? -ne 0 ] ; then ip netns exec \"t3ns2\" brctl addbr \"t3br2\" ; fi\nip netns exec \"t3ns2\" ip link set dev \"t3br2\" up\n", "delta": "0:00:00.117057", "end": "2019-12-05 17:41:51.010796", "item": {"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-05 17:41:50.893739", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ip link show \"t3s1_dnsbrif\" ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" ip link add \"t3s1_dnsbrif\" type veth peer name \"t3s1_dnsif\" ; fi\nip netns exec \"t3ns1\" ip link set dev \"t3s1_dnsbrif\" up\nip netns exec \"t3ns1\" ip link set dev \"t3s1_dnsif\" up\n", "delta": "0:00:00.159928", "end": "2019-12-05 17:41:51.590777", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:41:51.430849", "stderr": "Device \"t3s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t3s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns2\" ip link show \"t3s2_dnsbrif\" ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns2\" ip link add \"t3s2_dnsbrif\" type veth peer name \"t3s2_dnsif\" ; fi\nip netns exec \"t3ns2\" ip link set dev \"t3s2_dnsbrif\" up\nip netns exec \"t3ns2\" ip link set dev \"t3s2_dnsif\" up\n", "delta": "0:00:00.143656", "end": "2019-12-05 17:41:52.090641", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:41:51.946985", "stderr": "Device \"t3s2_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t3s2_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" brctl show \"t3br1\" | grep -w 't3s1_dnsbrif' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" brctl addif \"t3br1\" \"t3s1_dnsbrif\" ; fi\n", "delta": "0:00:00.074217", "end": "2019-12-05 17:41:52.582636", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:41:52.508419", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns2\" brctl show \"t3br2\" | grep -w 't3s2_dnsbrif' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns2\" brctl addif \"t3br2\" \"t3s2_dnsbrif\" ; fi\n", "delta": "0:00:00.076901", "end": "2019-12-05 17:41:52.994678", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:41:52.917777", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t3VM4if1\" type veth peer name \"t3br1if1\" ; fi\nip link set dev \"t3br1if1\" up\nip link set dev \"t3VM4if1\" up\n", "delta": "0:00:00.019570", "end": "2019-12-05 17:41:53.412448", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "rc": 0, "start": "2019-12-05 17:41:53.392878", "stderr": "Device \"t3br1if1\" does not exist.", "stderr_lines": ["Device \"t3br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3br2if1\" ; if [ $? -ne 0 ] ; then ip link add \"t3VM3if1\" type veth peer name \"t3br2if1\" ; fi\nip link set dev \"t3br2if1\" up\nip link set dev \"t3VM3if1\" up\n", "delta": "0:00:00.016784", "end": "2019-12-05 17:41:53.781342", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "rc": 0, "start": "2019-12-05 17:41:53.764558", "stderr": "Device \"t3br2if1\" does not exist.", "stderr_lines": ["Device \"t3br2if1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t3br1if1\" netns \"t3ns1\" ; fi\nip netns exec \"t3ns1\" brctl show \"t3br1\" | grep -w 't3br1if1' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" brctl addif \"t3br1\" \"t3br1if1\" ; fi\n", "delta": "0:00:00.098089", "end": "2019-12-05 17:41:54.290550", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "rc": 0, "start": "2019-12-05 17:41:54.192461", "stderr": "", "stderr_lines": [], "stdout": "21: t3br1if1@t3VM4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether e6:85:69:3b:f6:56 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["21: t3br1if1@t3VM4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether e6:85:69:3b:f6:56 brd ff:ff:ff:ff:ff:ff"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3br2if1\" ; if [ $? -eq 0 ] ; then ip link set \"t3br2if1\" netns \"t3ns2\" ; fi\nip netns exec \"t3ns2\" brctl show \"t3br2\" | grep -w 't3br2if1' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns2\" brctl addif \"t3br2\" \"t3br2if1\" ; fi\n", "delta": "0:00:00.127413", "end": "2019-12-05 17:41:54.758599", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "rc": 0, "start": "2019-12-05 17:41:54.631186", "stderr": "", "stderr_lines": [], "stdout": "23: t3br2if1@t3VM3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether b6:8a:de:26:32:d0 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["23: t3br2if1@t3VM3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether b6:8a:de:26:32:d0 brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ip link set \"t3br1if1\" up\nip netns exec \"t3ns1\" ip link set dev \"t3br1\" up\n", "delta": "0:00:00.079153", "end": "2019-12-05 17:41:55.242499", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "rc": 0, "start": "2019-12-05 17:41:55.163346", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns2\" ip link set \"t3br2if1\" up\nip netns exec \"t3ns2\" ip link set dev \"t3br2\" up\n", "delta": "0:00:00.077507", "end": "2019-12-05 17:41:55.670684", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "rc": 0, "start": "2019-12-05 17:41:55.593177", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ip addr show \"t3s1_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" ip addr add \"1.1.1.1/24\" dev \"t3s1_dnsif\" ; fi\n", "delta": "0:00:00.093415", "end": "2019-12-05 17:41:56.166837", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:41:56.073422", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns2\" ip addr show \"t3s2_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^2.2.2.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns2\" ip addr add \"2.2.2.1/24\" dev \"t3s2_dnsif\" ; fi\n", "delta": "0:00:00.084178", "end": "2019-12-05 17:41:56.582644", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:41:56.498466", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ps aux | grep -w '[d]nsmasq --interface t3s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" dnsmasq --interface \"t3s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.066644", "end": "2019-12-05 17:41:57.067427", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:41:57.000783", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns2\" ps aux | grep -w '[d]nsmasq --interface t3s2_dnsif -z --dhcp-range=2.2.2.5,2.2.2.254' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns2\" dnsmasq --interface \"t3s2_dnsif\" -z --dhcp-range=2.2.2.5,'2.2.2.254' ; fi\n", "delta": "0:00:00.065520", "end": "2019-12-05 17:41:57.474935", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 17:41:57.409415", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}]}, {u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" ip link show \"vxlan_t3s1\" ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" ip link add \"vxlan_t3s1\" type vxlan id \"42\" local \"10.2.21.2\" remote \"10.1.21.2\" dstport \"4789\" dev \"t3s1if\" ; ip netns exec \"t3ns1\" ip link set dev \"vxlan_t3s1\" up ; fi\n", "delta": "0:00:00.146139", "end": "2019-12-05 17:41:58.042745", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-05 17:41:57.896606", "stderr": "Device \"vxlan_t3s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t3s1\" does not exist."], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}]}, {u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t3ns1\" brctl show \"t3br1\" | grep -w 'vxlan_t3s1' ; if [ $? -ne 0 ] ; then ip netns exec \"t3ns1\" brctl addif \"t3br1\" \"vxlan_t3s1\" ; fi\n", "delta": "0:00:00.065319", "end": "2019-12-05 17:41:58.558635", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-05 17:41:58.493316", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}]}, {u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip route show \"10.1.21.0/24\" via \"192.168.3.2\" | grep -w '^10.1.21.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip route add \"10.1.21.0/24\" via \"192.168.3.2\" ; fi\n", "delta": "0:00:00.082048", "end": "2019-12-05 17:41:59.763012", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-05 17:41:59.680964", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": "ip netns exec pns ip addr show p1 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.056851", "end": "2019-12-05 17:42:00.155350", "rc": 0, "start": "2019-12-05 17:42:00.098499", "stderr": "", "stderr_lines": [], "stdout": "192.168.100.238", "stdout_lines": ["192.168.100.238"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}]}, {u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.1.21.0/24\" via \"192.168.100.238\" | grep -w '^10.1.21.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.1.21.0/24\" via \"192.168.100.238\" ; fi\nip route show \"10.2.21.0/24\" via 99.99.99.2 | grep -w '^10.2.21.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.2.21.0/24\" via 99.99.99.2 ; fi\n", "delta": "0:00:00.009399", "end": "2019-12-05 17:42:00.494305", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-05 17:42:00.484906", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}]}, {u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip route show \"10.2.21.0/24\" via \"192.168.131.2\" | grep -w '^10.2.21.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip route add \"10.2.21.0/24\" via \"192.168.131.2\" ; fi\n", "delta": "0:00:00.081054", "end": "2019-12-05 17:42:01.770768", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-05 17:42:01.689714", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": "ip netns exec pns ip addr show p1 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.038497", "end": "2019-12-05 17:42:02.187034", "rc": 0, "start": "2019-12-05 17:42:02.148537", "stderr": "", "stderr_lines": [], "stdout": "192.168.100.50", "stdout_lines": ["192.168.100.50"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}]}, {u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.2.21.0/24\" via \"192.168.100.50\" | grep -w '^10.2.21.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.2.21.0/24\" via \"192.168.100.50\" ; fi\nip route show \"10.1.21.0/24\" via 99.99.99.1 | grep -w '^10.1.21.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.1.21.0/24\" via 99.99.99.1 ; fi\n", "delta": "0:00:00.007545", "end": "2019-12-05 17:42:02.628517", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-05 17:42:02.620972", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create VM templates (C1)] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t3/VM_templates/t3_VM1.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575567723.32-18671277048900/source", "state": "file", "uid": 0}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t3/VM_templates/t3_VM2.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575567723.89-29087759195845/source", "state": "file", "uid": 0}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create VM templates (C2)] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t3/VM_templates/t3_VM4.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575567724.75-16027943077229/source", "state": "file", "uid": 0}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t3/VM_templates/t3_VM3.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575567725.34-169576201768076/source", "state": "file", "uid": 0}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Copy VM image] ****************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "d86d5962370fcd0c3d05943fc209d9e05fdac89f", "dest": "/var/lib/libvirt/images/t3_VM1.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}], "md5sum": "b977a19124b65f2d544ddc62e407114d", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/.ansible/tmp/ansible-tmp-1575567726.31-163507629561229/source", "state": "file", "uid": 0}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "d86d5962370fcd0c3d05943fc209d9e05fdac89f", "dest": "/var/lib/libvirt/images/t3_VM2.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "md5sum": "b977a19124b65f2d544ddc62e407114d", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/.ansible/tmp/ansible-tmp-1575567846.63-27465767823121/source", "state": "file", "uid": 0}

TASK [Get list of running VMs] ******************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": ["virsh", "list", "--name"], "delta": "0:00:00.051494", "end": "2019-12-05 17:45:39.206797", "rc": 0, "start": "2019-12-05 17:45:39.155303", "stderr": "", "stderr_lines": [], "stdout": "t1_VM1\nt1_VM2\nt2_VM1\nt2_VM2", "stdout_lines": ["t1_VM1", "t1_VM2", "t2_VM1", "t2_VM2"]}

TASK [Define VM] ********************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t3_VM1", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t3_VM2", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}

TASK [Create VM] ********************************************************************************************************************************************
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}]}
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}]}

TASK [Start VM] *********************************************************************************************************************************************
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}]}
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}]}

TASK [Attach VM interface] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 2, u'name': u't3_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t3_VM1\" | grep -w 't3VM1if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t3_VM1\" direct \"t3VM1if1\" --live --persistent ; fi\n", "delta": "0:00:11.350724", "end": "2019-12-05 17:46:07.270594", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM1", "vcpu": 4, "vmif": "t3VM1if1"}], "rc": 0, "start": "2019-12-05 17:45:55.919870", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'mem': 4, u'name': u't3_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br1if2', u'vmif': u't3VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t3_VM2\" | grep -w 't3VM2if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t3_VM2\" direct \"t3VM2if1\" --live --persistent ; fi\n", "delta": "0:00:00.267654", "end": "2019-12-05 17:46:07.718503", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if2", "disk": "10G", "mem": 4, "name": "t3_VM2", "vcpu": 2, "vmif": "t3VM2if1"}], "rc": 0, "start": "2019-12-05 17:46:07.450849", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=6    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Copy VM image] ****************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "f8b2ffa2bf201c84196c582f2dec0d33a1eb4b42", "dest": "/var/lib/libvirt/images/t3_VM4.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "md5sum": "e6d5d524b68797ddd748ba1475985d34", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/mainVM.qcow2", "state": "file", "uid": 0}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "f8b2ffa2bf201c84196c582f2dec0d33a1eb4b42", "dest": "/var/lib/libvirt/images/t3_VM3.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "md5sum": "e6d5d524b68797ddd748ba1475985d34", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/mainVM.qcow2", "state": "file", "uid": 0}

TASK [Get list of running VMs] ******************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": ["virsh", "list", "--name"], "delta": "0:00:00.040869", "end": "2019-12-05 17:49:22.935581", "rc": 0, "start": "2019-12-05 17:49:22.894712", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Define VM] ********************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t3_VM4", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t3_VM3", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}

TASK [Create VM] ********************************************************************************************************************************************
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}]}
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}]}

TASK [Start VM] *********************************************************************************************************************************************
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}]}
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}]}

TASK [Attach VM interface] **********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'mem': 2, u'name': u't3_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't3br1if1', u'vmif': u't3VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t3_VM4\" | grep -w 't3VM4if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t3_VM4\" direct \"t3VM4if1\" --live --persistent ; fi\n", "delta": "0:00:00.291285", "end": "2019-12-05 17:50:01.380545", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "disk": "10G", "mem": 2, "name": "t3_VM4", "vcpu": 4, "vmif": "t3VM4if1"}], "rc": 0, "start": "2019-12-05 17:50:01.089260", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't3_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't3br2if1', u'vmif': u't3VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t3_VM3\" | grep -w 't3VM3if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t3_VM3\" direct \"t3VM3if1\" --live --persistent ; fi\n", "delta": "0:00:00.239707", "end": "2019-12-05 17:50:01.886426", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3br2if1", "disk": "10G", "mem": 3, "name": "t3_VM3", "vcpu": 2, "vmif": "t3VM3if1"}], "rc": 0, "start": "2019-12-05 17:50:01.646719", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=6    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 17:55:59.257571 The subnet 1.1.1.0/24 is present in Cloud 1
INFO:root: 17:55:59.257722 The subnet 1.1.1.0/24 is present in Cloud 2
INFO:root: 17:55:59.257764 The subnet 2.2.2.0/24 is present in Cloud 2
INFO:root: 17:55:59.257795 The VM VM2 is present in Cloud 1
INFO:root: 17:55:59.257822 The VM VM4 is present in Cloud 2
INFO:root: 17:55:59.257847 The VM VM3 is present in Cloud 2
INFO:root: 17:55:59.257897 The subnet 1.1.1.0/24 is present in destination cloud
INFO:root: 17:55:59.257930 The subnet 1.1.1.0/24 is present in destination cloud
ERROR:root: 17:55:59.257959 The subnet 2.2.2.0/24 is not present in the destination cloud
INFO:root: 17:55:59.544453 source cloud is C1
INFO:root: 17:55:59.546057 source cloud is C2
INFO:paramiko.transport:Connected (version 2.0, client OpenSSH_7.6p1)
INFO:paramiko.transport:Authentication (publickey) successful!
INFO:root: 17:56:00.535439 source cloud is C2
INFO:paramiko.transport:Connected (version 2.0, client OpenSSH_7.6p1)
INFO:paramiko.transport:Authentication (publickey) successful!
INFO:root: 17:59:28.455009 The subnet 1.1.1.0/24 is present in Cloud 1
INFO:root: 17:59:28.455297 The subnet 1.1.1.0/24 is present in Cloud 2
INFO:root: 17:59:28.455349 The subnet 2.2.2.0/24 is present in Cloud 2
INFO:root: 17:59:28.455380 The VM VM2 is present in Cloud 1
INFO:root: 17:59:28.455410 The VM VM4 is present in Cloud 2
INFO:root: 17:59:28.455436 The VM VM3 is present in Cloud 2
INFO:root: 17:59:28.455497 The subnet 1.1.1.0/24 is present in destination cloud
INFO:root: 17:59:28.455530 The subnet 1.1.1.0/24 is present in destination cloud
ERROR:root: 17:59:28.455572 The subnet 2.2.2.0/24 is not present in the destination cloud
INFO:root: 17:59:28.747428 source cloud is C1
INFO:root: 17:59:28.749090 source cloud is C2
INFO:paramiko.transport:Connected (version 2.0, client OpenSSH_7.6p1)
INFO:paramiko.transport:Authentication (publickey) successful!
INFO:root: 17:59:29.638719 source cloud is C2
INFO:paramiko.transport:Connected (version 2.0, client OpenSSH_7.6p1)
INFO:paramiko.transport:Authentication (publickey) successful!
INFO:root: 18:02:28.958021 The subnet 1.1.1.0/24 is present in Cloud 1
INFO:root: 18:02:28.958292 The subnet 1.1.1.0/24 is present in Cloud 2
INFO:root: 18:02:28.958339 The subnet 2.2.2.0/24 is present in Cloud 2
INFO:root: 18:02:28.958371 The VM VM2 is present in Cloud 1
INFO:root: 18:02:28.958399 The VM VM4 is present in Cloud 2
INFO:root: 18:02:28.958425 The VM VM3 is present in Cloud 2
INFO:root: 18:02:28.958485 The subnet 1.1.1.0/24 is present in destination cloud
INFO:root: 18:02:28.958538 The subnet 1.1.1.0/24 is present in destination cloud
ERROR:root: 18:02:28.958578 The subnet 2.2.2.0/24 is not present in the destination cloud
INFO:root: 18:02:29.240660 source cloud is C1
INFO:root: 18:02:29.242815 source cloud is C2
INFO:paramiko.transport:Connected (version 2.0, client OpenSSH_7.6p1)
INFO:paramiko.transport:Authentication (publickey) successful!
INFO:root: 18:02:30.120996 source cloud is C2
INFO:paramiko.transport:Connected (version 2.0, client OpenSSH_7.6p1)
INFO:paramiko.transport:Authentication (publickey) successful!
INFO:root: 18:05:25.322006 The subnet 1.1.1.0/24 is present in Cloud 1
INFO:root: 18:05:25.322200 The subnet 1.1.1.0/24 is present in Cloud 2
INFO:root: 18:05:25.322251 The subnet 2.2.2.0/24 is present in Cloud 2
INFO:root: 18:05:25.322287 The VM VM2 is present in Cloud 1
INFO:root: 18:05:25.322319 The VM VM4 is present in Cloud 2
INFO:root: 18:05:25.322348 The VM VM3 is present in Cloud 2
INFO:root: 18:05:25.322406 The subnet 1.1.1.0/24 is present in destination cloud
INFO:root: 18:05:25.322633 The subnet 1.1.1.0/24 is present in destination cloud
ERROR:root: 18:05:25.322806 The subnet 2.2.2.0/24 is not present in the destination cloud
INFO:root: 18:05:25.568508 source cloud is C1
INFO:root: 18:05:25.570214 source cloud is C2
INFO:paramiko.transport:Connected (version 2.0, client OpenSSH_7.6p1)
INFO:paramiko.transport:Authentication (publickey) successful!
INFO:root: 18:05:26.410319 source cloud is C2
INFO:paramiko.transport:Connected (version 2.0, client OpenSSH_7.6p1)
INFO:paramiko.transport:Authentication (publickey) successful!
INFO:root: 18:18:35.529811 Printing the yaml input file
INFO:root: 18:18:35.530022 {'C1': [{'VM': [{'disk': '10G', 'internet_access': True, 'mem': 2, 'name': 'VM1', 'vcpu': 4}, {'disk': '10G', 'internet_access': False, 'mem': 4, 'name': 'VM2', 'vcpu': 2}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'VM': [{'disk': '10G', 'internet_access': True, 'mem': 2, 'name': 'VM4', 'vcpu': 4}], 'subnet_addr': '1.1.1.0/24'}, {'VM': [{'disk': '10G', 'internet_access': True, 'mem': 3, 'name': 'VM3', 'vcpu': 2}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 18:18:35.530177 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 18:18:35.530248 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 18:18:35.530301 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create Tenant Namespace] ******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t4"], "delta": "0:00:00.072899", "end": "2019-12-05 18:18:38.368897", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-05 18:18:38.295998", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Subnet Namespace] ******************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'tenant_route_ip': u'192.168.4.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.1.31.0/24', u'remote_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t4ns1"], "delta": "0:00:00.051535", "end": "2019-12-05 18:18:38.768997", "item": {"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-05 18:18:38.717462", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4if\" ; if [ $? -ne 0 ] ; then ip link add \"t4if\" type veth peer name \"t4pns_if\" ; fi\n", "delta": "0:00:00.017577", "end": "2019-12-05 18:18:39.080973", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-05 18:18:39.063396", "stderr": "Device \"t4if\" does not exist.", "stderr_lines": ["Device \"t4if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip link show \"t4pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t4pns_if\" netns pns ; fi\nip netns exec \"t4\" ip link show \"t4if\" ; if [ $? -ne 0 ] ; then ip link set \"t4if\" netns \"t4\" ; fi\nip netns exec pns ip link set dev \"t4pns_if\" up\nip netns exec \"t4\" ip link set dev \"t4if\" up\n", "delta": "0:00:00.221584", "end": "2019-12-05 18:18:39.598719", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-05 18:18:39.377135", "stderr": "Device \"t4pns_if\" does not exist.\nDevice \"t4if\" does not exist.", "stderr_lines": ["Device \"t4pns_if\" does not exist.", "Device \"t4if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip addr show \"t4pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.4.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip addr add \"192.168.4.1/24\" dev \"t4pns_if\" ; fi\nip netns exec \"t4\" ip addr show \"t4if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.4.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t4\" ip addr add \"192.168.4.2/24\" dev \"t4if\" ; fi\n", "delta": "0:00:00.216178", "end": "2019-12-05 18:18:40.138788", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-05 18:18:39.922610", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t4ns1if\" type veth peer name \"t4s1if\" ; fi\n", "delta": "0:00:00.012253", "end": "2019-12-05 18:18:40.487543", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "rc": 0, "start": "2019-12-05 18:18:40.475290", "stderr": "Device \"t4ns1if\" does not exist.", "stderr_lines": ["Device \"t4ns1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4\" ip link show \"t4ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t4ns1if\" netns \"t4\" ; fi\nip netns exec \"t4ns1\" ip link show \"t4s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t4s1if\" netns \"t4ns1\" ; fi\n", "delta": "0:00:00.111304", "end": "2019-12-05 18:18:40.923808", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "rc": 0, "start": "2019-12-05 18:18:40.812504", "stderr": "Device \"t4ns1if\" does not exist.\nDevice \"t4s1if\" does not exist.", "stderr_lines": ["Device \"t4ns1if\" does not exist.", "Device \"t4s1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4\" ip link set dev \"t4ns1if\" up\nip netns exec \"t4ns1\" ip link set dev \"t4s1if\" up\n", "delta": "0:00:00.089001", "end": "2019-12-05 18:18:41.331054", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "rc": 0, "start": "2019-12-05 18:18:41.242053", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ip addr show \"t4s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.31.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" ip addr add \"10.1.31.2/24\" dev \"t4s1if\" ; fi\n\nip netns exec \"t4\" ip addr show \"t4ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.31.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t4\" ip addr add \"10.1.31.1/24\" dev \"t4ns1if\" ; fi\n", "delta": "0:00:00.159950", "end": "2019-12-05 18:18:41.815509", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "rc": 0, "start": "2019-12-05 18:18:41.655559", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4\" ip route show default | grep -w '[d]efault via 192.168.4.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t4\" ip route add default via \"192.168.4.1\" ; fi\n", "delta": "0:00:00.096501", "end": "2019-12-05 18:18:42.194804", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-05 18:18:42.098303", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'tenant_route_ip': u'192.168.4.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.1.31.0/24', u'remote_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ip route show default | grep -w '[d]efault via 10.1.31.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" ip route add default via \"10.1.31.1\" ; fi\n", "delta": "0:00:00.082247", "end": "2019-12-05 18:18:42.570808", "item": {"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-05 18:18:42.488561", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside namespace] ***********************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'tenant_route_ip': u'192.168.4.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.1.31.0/24', u'remote_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" brctl show | grep -w '^t4br1'; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" brctl addbr \"t4br1\" ; fi\nip netns exec \"t4ns1\" ip link set dev \"t4br1\" up\n", "delta": "0:00:00.109166", "end": "2019-12-05 18:18:42.990774", "item": {"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-05 18:18:42.881608", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ip link show \"t4s1_dnsbrif\" ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" ip link add \"t4s1_dnsbrif\" type veth peer name \"t4s1_dnsif\" ; fi\nip netns exec \"t4ns1\" ip link set dev \"t4s1_dnsbrif\" up\nip netns exec \"t4ns1\" ip link set dev \"t4s1_dnsif\" up\n", "delta": "0:00:00.145615", "end": "2019-12-05 18:18:43.426708", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 18:18:43.281093", "stderr": "Device \"t4s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t4s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" brctl show \"t4br1\" | grep -w 't4s1_dnsbrif' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" brctl addif \"t4br1\" \"t4s1_dnsbrif\" ; fi\n", "delta": "0:00:00.078758", "end": "2019-12-05 18:18:43.782821", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 18:18:43.704063", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t4VM1if1\" type veth peer name \"t4br1if1\" ; fi\nip link set dev \"t4br1if1\" up\nip link set dev \"t4VM1if1\" up\n", "delta": "0:00:00.018879", "end": "2019-12-05 18:18:44.105877", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}], "rc": 0, "start": "2019-12-05 18:18:44.086998", "stderr": "Device \"t4br1if1\" does not exist.", "stderr_lines": ["Device \"t4br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4br1if2\" ; if [ $? -ne 0 ] ; then ip link add \"t4VM2if1\" type veth peer name \"t4br1if2\" ; fi\nip link set dev \"t4br1if2\" up\nip link set dev \"t4VM2if1\" up\n", "delta": "0:00:00.017924", "end": "2019-12-05 18:18:44.343536", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "rc": 0, "start": "2019-12-05 18:18:44.325612", "stderr": "Device \"t4br1if2\" does not exist.", "stderr_lines": ["Device \"t4br1if2\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t4br1if1\" netns \"t4ns1\" ; fi\nip netns exec \"t4ns1\" brctl show \"t4br1\" | grep -w 't4br1if1' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" brctl addif \"t4br1\" \"t4br1if1\" ; fi\n", "delta": "0:00:00.123241", "end": "2019-12-05 18:18:44.742660", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}], "rc": 0, "start": "2019-12-05 18:18:44.619419", "stderr": "", "stderr_lines": [], "stdout": "50: t4br1if1@t4VM1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether c2:57:77:45:86:a4 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["50: t4br1if1@t4VM1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether c2:57:77:45:86:a4 brd ff:ff:ff:ff:ff:ff"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4br1if2\" ; if [ $? -eq 0 ] ; then ip link set \"t4br1if2\" netns \"t4ns1\" ; fi\nip netns exec \"t4ns1\" brctl show \"t4br1\" | grep -w 't4br1if2' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" brctl addif \"t4br1\" \"t4br1if2\" ; fi\n", "delta": "0:00:00.114390", "end": "2019-12-05 18:18:45.098819", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "rc": 0, "start": "2019-12-05 18:18:44.984429", "stderr": "", "stderr_lines": [], "stdout": "52: t4br1if2@t4VM2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 12:bc:a3:c5:25:89 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["52: t4br1if2@t4VM2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 12:bc:a3:c5:25:89 brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ip link set \"t4br1if1\" up\nip netns exec \"t4ns1\" ip link set dev \"t4br1\" up\n", "delta": "0:00:00.069872", "end": "2019-12-05 18:18:45.478894", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}], "rc": 0, "start": "2019-12-05 18:18:45.409022", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ip link set \"t4br1if2\" up\nip netns exec \"t4ns1\" ip link set dev \"t4br1\" up\n", "delta": "0:00:00.072582", "end": "2019-12-05 18:18:45.810871", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "rc": 0, "start": "2019-12-05 18:18:45.738289", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ip addr show \"t4s1_dnsif\" | awk 'FNR==3{ print $2 }' | grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" ip addr add \"1.1.1.1/24\" dev \"t4s1_dnsif\" ; fi\n", "delta": "0:00:00.085996", "end": "2019-12-05 18:18:46.190872", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 18:18:46.104876", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ps aux | grep -w '[d]nsmasq --interface t4s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" dnsmasq --interface \"t4s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.078680", "end": "2019-12-05 18:18:46.556583", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 18:18:46.477903", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}]}, {u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ip link show \"vxlan_t4s1\" ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" ip link add \"vxlan_t4s1\" type vxlan id \"42\" local \"10.1.31.2\" remote \"10.2.31.2\" dstport \"4789\" dev \"t4s1if\"; ip netns exec \"t4ns1\" ip link set dev \"vxlan_t4s1\" up ; fi\n", "delta": "0:00:00.122633", "end": "2019-12-05 18:18:46.963108", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-05 18:18:46.840475", "stderr": "Device \"vxlan_t4s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t4s1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}]}, {u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" brctl show \"t4br1\" | grep -w 'vxlan_t4s1' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" brctl addif \"t4br1\" \"vxlan_t4s1\" ; fi\n", "delta": "0:00:00.075658", "end": "2019-12-05 18:18:47.326795", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-05 18:18:47.251137", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Create Tenant Namespace] ******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.132.1', u'name': u't4', u'pns_ip': u'192.168.132.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.132.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t4"], "delta": "0:00:00.054018", "end": "2019-12-05 18:18:49.407577", "item": {"default_route_ip": "192.168.132.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.132.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.132.2/24"}, "rc": 0, "start": "2019-12-05 18:18:49.353559", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Subnet Namespace] ******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'tenant_route_ip': u'192.168.132.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.2.31.0/24', u'remote_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t4ns1"], "delta": "0:00:00.057421", "end": "2019-12-05 18:18:49.901451", "item": {"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-05 18:18:49.844030", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": ["ip", "netns", "add", "t4ns2"], "delta": "0:00:00.052363", "end": "2019-12-05 18:18:50.300659", "item": {"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-05 18:18:50.248296", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.132.1', u'name': u't4', u'pns_ip': u'192.168.132.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.132.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4if\" ; if [ $? -ne 0 ] ; then ip link add \"t4if\" type veth peer name \"t4pns_if\" ; fi\n", "delta": "0:00:00.017034", "end": "2019-12-05 18:18:50.732293", "item": {"default_route_ip": "192.168.132.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.132.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.132.2/24"}, "rc": 0, "start": "2019-12-05 18:18:50.715259", "stderr": "Device \"t4if\" does not exist.", "stderr_lines": ["Device \"t4if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.132.1', u'name': u't4', u'pns_ip': u'192.168.132.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.132.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip link show \"t4pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t4pns_if\" netns pns ; fi\nip netns exec \"t4\" ip link show \"t4if\" ; if [ $? -ne 0 ] ; then ip link set \"t4if\" netns \"t4\" ; fi\nip netns exec pns ip link set dev \"t4pns_if\" up\nip netns exec \"t4\" ip link set dev \"t4if\" up\n", "delta": "0:00:00.234124", "end": "2019-12-05 18:18:51.382629", "item": {"default_route_ip": "192.168.132.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.132.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.132.2/24"}, "rc": 0, "start": "2019-12-05 18:18:51.148505", "stderr": "Device \"t4pns_if\" does not exist.\nDevice \"t4if\" does not exist.", "stderr_lines": ["Device \"t4pns_if\" does not exist.", "Device \"t4if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.132.1', u'name': u't4', u'pns_ip': u'192.168.132.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.132.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip addr show \"t4pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.132.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip addr add \"192.168.132.1/24\" dev \"t4pns_if\" ; fi\nip netns exec \"t4\" ip addr show \"t4if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.132.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t4\" ip addr add \"192.168.132.2/24\" dev \"t4if\" ; fi\n", "delta": "0:00:00.169999", "end": "2019-12-05 18:18:51.982649", "item": {"default_route_ip": "192.168.132.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.132.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.132.2/24"}, "rc": 0, "start": "2019-12-05 18:18:51.812650", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t4ns1if\" type veth peer name \"t4s1if\" ; fi\n", "delta": "0:00:00.018085", "end": "2019-12-05 18:18:52.438129", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "rc": 0, "start": "2019-12-05 18:18:52.420044", "stderr": "Device \"t4ns1if\" does not exist.", "stderr_lines": ["Device \"t4ns1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4ns2if\" ; if [ $? -ne 0 ] ; then ip link add \"t4ns2if\" type veth peer name \"t4s2if\" ; fi\n", "delta": "0:00:00.013732", "end": "2019-12-05 18:18:52.814552", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "rc": 0, "start": "2019-12-05 18:18:52.800820", "stderr": "Device \"t4ns2if\" does not exist.", "stderr_lines": ["Device \"t4ns2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4\" ip link show \"t4ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t4ns1if\" netns \"t4\" ; fi\nip netns exec \"t4ns1\" ip link show \"t4s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t4s1if\" netns \"t4ns1\" ; fi\n", "delta": "0:00:00.152674", "end": "2019-12-05 18:18:53.408004", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "rc": 0, "start": "2019-12-05 18:18:53.255330", "stderr": "Device \"t4ns1if\" does not exist.\nDevice \"t4s1if\" does not exist.", "stderr_lines": ["Device \"t4ns1if\" does not exist.", "Device \"t4s1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4\" ip link show \"t4ns2if\" ; if [ $? -ne 0 ] ; then ip link set \"t4ns2if\" netns \"t4\" ; fi\nip netns exec \"t4ns2\" ip link show \"t4s2if\" ; if [ $? -ne 0 ] ; then ip link set \"t4s2if\" netns \"t4ns2\" ; fi\n", "delta": "0:00:00.160590", "end": "2019-12-05 18:18:53.924785", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "rc": 0, "start": "2019-12-05 18:18:53.764195", "stderr": "Device \"t4ns2if\" does not exist.\nDevice \"t4s2if\" does not exist.", "stderr_lines": ["Device \"t4ns2if\" does not exist.", "Device \"t4s2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4\" ip link set dev \"t4ns1if\" up\nip netns exec \"t4ns1\" ip link set dev \"t4s1if\" up\n", "delta": "0:00:00.078913", "end": "2019-12-05 18:18:54.418706", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "rc": 0, "start": "2019-12-05 18:18:54.339793", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4\" ip link set dev \"t4ns2if\" up\nip netns exec \"t4ns2\" ip link set dev \"t4s2if\" up\n", "delta": "0:00:00.082185", "end": "2019-12-05 18:18:54.850736", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "rc": 0, "start": "2019-12-05 18:18:54.768551", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ip addr show \"t4s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.31.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" ip addr add \"10.2.31.2/24\" dev \"t4s1if\" ; fi\n\nip netns exec \"t4\" ip addr show \"t4ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.31.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t4\" ip addr add \"10.2.31.1/24\" dev \"t4ns1if\" ; fi\n", "delta": "0:00:00.154181", "end": "2019-12-05 18:18:55.470618", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "rc": 0, "start": "2019-12-05 18:18:55.316437", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns2\" ip addr show \"t4s2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.32.2/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns2\" ip addr add \"10.2.32.2/24\" dev \"t4s2if\" ; fi\n\nip netns exec \"t4\" ip addr show \"t4ns2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.32.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t4\" ip addr add \"10.2.32.1/24\" dev \"t4ns2if\" ; fi\n", "delta": "0:00:00.168515", "end": "2019-12-05 18:18:56.014650", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "rc": 0, "start": "2019-12-05 18:18:55.846135", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.132.1', u'name': u't4', u'pns_ip': u'192.168.132.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.132.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4\" ip route show default | grep -w '[d]efault via 192.168.132.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t4\" ip route add default via \"192.168.132.1\" ; fi\n", "delta": "0:00:00.086602", "end": "2019-12-05 18:18:56.526704", "item": {"default_route_ip": "192.168.132.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.132.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.132.2/24"}, "rc": 0, "start": "2019-12-05 18:18:56.440102", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'tenant_route_ip': u'192.168.132.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.2.31.0/24', u'remote_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ip route show default | grep -w '[d]efault via 10.2.31.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" ip route add default via \"10.2.31.1\" ; fi\n", "delta": "0:00:00.084545", "end": "2019-12-05 18:18:57.006568", "item": {"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-05 18:18:56.922023", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns2\" ip route show default | grep -w '[d]efault via 10.2.32.1' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns2\" ip route add default via \"10.2.32.1\" ; fi\n", "delta": "0:00:00.088234", "end": "2019-12-05 18:18:57.410687", "item": {"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-05 18:18:57.322453", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside namespace] ***********************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'tenant_route_ip': u'192.168.132.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.2.31.0/24', u'remote_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" brctl show | grep -w '^t4br1'; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" brctl addbr \"t4br1\" ; fi\nip netns exec \"t4ns1\" ip link set dev \"t4br1\" up\n", "delta": "0:00:00.113286", "end": "2019-12-05 18:18:57.918789", "item": {"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-05 18:18:57.805503", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns2\" brctl show | grep -w '^t4br2'; if [ $? -ne 0 ] ; then ip netns exec \"t4ns2\" brctl addbr \"t4br2\" ; fi\nip netns exec \"t4ns2\" ip link set dev \"t4br2\" up\n", "delta": "0:00:00.130800", "end": "2019-12-05 18:18:58.394750", "item": {"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-05 18:18:58.263950", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ip link show \"t4s1_dnsbrif\" ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" ip link add \"t4s1_dnsbrif\" type veth peer name \"t4s1_dnsif\" ; fi\nip netns exec \"t4ns1\" ip link set dev \"t4s1_dnsbrif\" up\nip netns exec \"t4ns1\" ip link set dev \"t4s1_dnsif\" up\n", "delta": "0:00:00.148247", "end": "2019-12-05 18:18:58.974601", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 18:18:58.826354", "stderr": "Device \"t4s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t4s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns2\" ip link show \"t4s2_dnsbrif\" ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns2\" ip link add \"t4s2_dnsbrif\" type veth peer name \"t4s2_dnsif\" ; fi\nip netns exec \"t4ns2\" ip link set dev \"t4s2_dnsbrif\" up\nip netns exec \"t4ns2\" ip link set dev \"t4s2_dnsif\" up\n", "delta": "0:00:00.171961", "end": "2019-12-05 18:18:59.510568", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 18:18:59.338607", "stderr": "Device \"t4s2_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t4s2_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" brctl show \"t4br1\" | grep -w 't4s1_dnsbrif' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" brctl addif \"t4br1\" \"t4s1_dnsbrif\" ; fi\n", "delta": "0:00:00.073365", "end": "2019-12-05 18:19:00.010774", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 18:18:59.937409", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns2\" brctl show \"t4br2\" | grep -w 't4s2_dnsbrif' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns2\" brctl addif \"t4br2\" \"t4s2_dnsbrif\" ; fi\n", "delta": "0:00:00.082015", "end": "2019-12-05 18:19:00.442736", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 18:19:00.360721", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t4VM4if1\" type veth peer name \"t4br1if1\" ; fi\nip link set dev \"t4br1if1\" up\nip link set dev \"t4VM4if1\" up\n", "delta": "0:00:00.019414", "end": "2019-12-05 18:19:00.898824", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "rc": 0, "start": "2019-12-05 18:19:00.879410", "stderr": "Device \"t4br1if1\" does not exist.", "stderr_lines": ["Device \"t4br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4br2if1\" ; if [ $? -ne 0 ] ; then ip link add \"t4VM3if1\" type veth peer name \"t4br2if1\" ; fi\nip link set dev \"t4br2if1\" up\nip link set dev \"t4VM3if1\" up\n", "delta": "0:00:00.023691", "end": "2019-12-05 18:19:01.301255", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "rc": 0, "start": "2019-12-05 18:19:01.277564", "stderr": "Device \"t4br2if1\" does not exist.", "stderr_lines": ["Device \"t4br2if1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t4br1if1\" netns \"t4ns1\" ; fi\nip netns exec \"t4ns1\" brctl show \"t4br1\" | grep -w 't4br1if1' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" brctl addif \"t4br1\" \"t4br1if1\" ; fi\n", "delta": "0:00:00.106069", "end": "2019-12-05 18:19:01.870627", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "rc": 0, "start": "2019-12-05 18:19:01.764558", "stderr": "", "stderr_lines": [], "stdout": "36: t4br1if1@t4VM4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 36:2d:2c:d2:01:dd brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["36: t4br1if1@t4VM4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 36:2d:2c:d2:01:dd brd ff:ff:ff:ff:ff:ff"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4br2if1\" ; if [ $? -eq 0 ] ; then ip link set \"t4br2if1\" netns \"t4ns2\" ; fi\nip netns exec \"t4ns2\" brctl show \"t4br2\" | grep -w 't4br2if1' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns2\" brctl addif \"t4br2\" \"t4br2if1\" ; fi\n", "delta": "0:00:00.112482", "end": "2019-12-05 18:19:02.386545", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "rc": 0, "start": "2019-12-05 18:19:02.274063", "stderr": "", "stderr_lines": [], "stdout": "38: t4br2if1@t4VM3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 3e:c5:fe:58:58:77 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["38: t4br2if1@t4VM3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 3e:c5:fe:58:58:77 brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ip link set \"t4br1if1\" up\nip netns exec \"t4ns1\" ip link set dev \"t4br1\" up\n", "delta": "0:00:00.075885", "end": "2019-12-05 18:19:02.942888", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "rc": 0, "start": "2019-12-05 18:19:02.867003", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns2\" ip link set \"t4br2if1\" up\nip netns exec \"t4ns2\" ip link set dev \"t4br2\" up\n", "delta": "0:00:00.099108", "end": "2019-12-05 18:19:03.434852", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "rc": 0, "start": "2019-12-05 18:19:03.335744", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ip addr show \"t4s1_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" ip addr add \"1.1.1.1/24\" dev \"t4s1_dnsif\" ; fi\n", "delta": "0:00:00.083564", "end": "2019-12-05 18:19:03.958633", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 18:19:03.875069", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns2\" ip addr show \"t4s2_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^2.2.2.1/24' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns2\" ip addr add \"2.2.2.1/24\" dev \"t4s2_dnsif\" ; fi\n", "delta": "0:00:00.084633", "end": "2019-12-05 18:19:04.434716", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 18:19:04.350083", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ps aux | grep -w '[d]nsmasq --interface t4s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" dnsmasq --interface \"t4s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.078775", "end": "2019-12-05 18:19:04.977838", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 18:19:04.899063", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns2\" ps aux | grep -w '[d]nsmasq --interface t4s2_dnsif -z --dhcp-range=2.2.2.5,2.2.2.254' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns2\" dnsmasq --interface \"t4s2_dnsif\" -z --dhcp-range=2.2.2.5,'2.2.2.254' ; fi\n", "delta": "0:00:00.087257", "end": "2019-12-05 18:19:05.429425", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-05 18:19:05.342168", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}]}, {u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" ip link show \"vxlan_t4s1\" ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" ip link add \"vxlan_t4s1\" type vxlan id \"42\" local \"10.2.31.2\" remote \"10.1.31.2\" dstport \"4789\" dev \"t4s1if\" ; ip netns exec \"t4ns1\" ip link set dev \"vxlan_t4s1\" up ; fi\n", "delta": "0:00:00.135180", "end": "2019-12-05 18:19:05.998582", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-05 18:19:05.863402", "stderr": "Device \"vxlan_t4s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t4s1\" does not exist."], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}]}, {u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t4ns1\" brctl show \"t4br1\" | grep -w 'vxlan_t4s1' ; if [ $? -ne 0 ] ; then ip netns exec \"t4ns1\" brctl addif \"t4br1\" \"vxlan_t4s1\" ; fi\n", "delta": "0:00:00.070818", "end": "2019-12-05 18:19:06.534679", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-05 18:19:06.463861", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}]}, {u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip route show \"10.1.31.0/24\" via \"192.168.4.2\" | grep -w '^10.1.31.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip route add \"10.1.31.0/24\" via \"192.168.4.2\" ; fi\n", "delta": "0:00:00.071754", "end": "2019-12-05 18:19:07.819023", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-05 18:19:07.747269", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": "ip netns exec pns ip addr show p1 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.037738", "end": "2019-12-05 18:19:08.167979", "rc": 0, "start": "2019-12-05 18:19:08.130241", "stderr": "", "stderr_lines": [], "stdout": "192.168.100.238", "stdout_lines": ["192.168.100.238"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}]}, {u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.1.31.0/24\" via \"192.168.100.238\" | grep -w '^10.1.31.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.1.31.0/24\" via \"192.168.100.238\" ; fi\nip route show \"10.2.31.0/24\" via 99.99.99.2 | grep -w '^10.2.31.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.2.31.0/24\" via 99.99.99.2 ; fi\n", "delta": "0:00:00.011368", "end": "2019-12-05 18:19:08.518990", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-05 18:19:08.507622", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}]}, {u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip route show \"10.2.31.0/24\" via \"192.168.132.2\" | grep -w '^10.2.31.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns ip route add \"10.2.31.0/24\" via \"192.168.132.2\" ; fi\n", "delta": "0:00:00.089258", "end": "2019-12-05 18:19:09.842600", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-05 18:19:09.753342", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": "ip netns exec pns ip addr show p1 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.045323", "end": "2019-12-05 18:19:10.311095", "rc": 0, "start": "2019-12-05 18:19:10.265772", "stderr": "", "stderr_lines": [], "stdout": "192.168.100.50", "stdout_lines": ["192.168.100.50"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}]}, {u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.2.31.0/24\" via \"192.168.100.50\" | grep -w '^10.2.31.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.2.31.0/24\" via \"192.168.100.50\" ; fi\nip route show \"10.1.31.0/24\" via 99.99.99.1 | grep -w '^10.1.31.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.1.31.0/24\" via 99.99.99.1 ; fi\n", "delta": "0:00:00.008700", "end": "2019-12-05 18:19:10.770576", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-05 18:19:10.761876", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create VM templates (C1)] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t4/VM_templates/t4_VM1.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575569951.55-215733294927321/source", "state": "file", "uid": 0}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t4/VM_templates/t4_VM2.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575569952.18-239154246081808/source", "state": "file", "uid": 0}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create VM templates (C2)] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t4/VM_templates/t4_VM4.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575569953.11-235947317910820/source", "state": "file", "uid": 0}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "350ba870bd31b7f6ee517845c14237910b5af0bf", "dest": "/root/Migration-as-a-Service/etc/t4/VM_templates/t4_VM3.xml.j2", "gid": 0, "group": "root", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "md5sum": "fbfc2eb0c2569531f25eea92c26d3bee", "mode": "0644", "owner": "root", "size": 4091, "src": "/root/.ansible/tmp/ansible-tmp-1575569953.76-165842901350807/source", "state": "file", "uid": 0}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Copy VM image] ****************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "d86d5962370fcd0c3d05943fc209d9e05fdac89f", "dest": "/var/lib/libvirt/images/t4_VM1.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}], "md5sum": "b977a19124b65f2d544ddc62e407114d", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/.ansible/tmp/ansible-tmp-1575569954.87-79440827733752/source", "state": "file", "uid": 0}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "d86d5962370fcd0c3d05943fc209d9e05fdac89f", "dest": "/var/lib/libvirt/images/t4_VM2.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "md5sum": "b977a19124b65f2d544ddc62e407114d", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/.ansible/tmp/ansible-tmp-1575570049.63-54031831886859/source", "state": "file", "uid": 0}

TASK [Get list of running VMs] ******************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": ["virsh", "list", "--name"], "delta": "0:00:00.023419", "end": "2019-12-05 18:22:21.810506", "rc": 0, "start": "2019-12-05 18:22:21.787087", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Define VM] ********************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t4_VM1", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t4_VM2", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}

TASK [Create VM] ********************************************************************************************************************************************
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}]}
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}]}

TASK [Start VM] *********************************************************************************************************************************************
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}]}
ok: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}]}

TASK [Attach VM interface] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 2, u'name': u't4_VM1', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM1if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t4_VM1\" | grep -w 't4VM1if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t4_VM1\" direct \"t4VM1if1\" --live --persistent ; fi\n", "delta": "0:00:08.404489", "end": "2019-12-05 18:22:40.581117", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM1", "vcpu": 4, "vmif": "t4VM1if1"}], "rc": 0, "start": "2019-12-05 18:22:32.176628", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'mem': 4, u'name': u't4_VM2', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br1if2', u'vmif': u't4VM2if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t4_VM2\" | grep -w 't4VM2if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t4_VM2\" direct \"t4VM2if1\" --live --persistent ; fi\n", "delta": "0:00:00.232971", "end": "2019-12-05 18:22:41.035798", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "disk": "10G", "mem": 4, "name": "t4_VM2", "vcpu": 2, "vmif": "t4VM2if1"}], "rc": 0, "start": "2019-12-05 18:22:40.802827", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=6    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Copy VM image] ****************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "f8b2ffa2bf201c84196c582f2dec0d33a1eb4b42", "dest": "/var/lib/libvirt/images/t4_VM4.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "md5sum": "e6d5d524b68797ddd748ba1475985d34", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/mainVM.qcow2", "state": "file", "uid": 0}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "f8b2ffa2bf201c84196c582f2dec0d33a1eb4b42", "dest": "/var/lib/libvirt/images/t4_VM3.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "md5sum": "e6d5d524b68797ddd748ba1475985d34", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/mainVM.qcow2", "state": "file", "uid": 0}

TASK [Get list of running VMs] ******************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": ["virsh", "list", "--name"], "delta": "0:00:00.021341", "end": "2019-12-05 18:25:42.144702", "rc": 0, "start": "2019-12-05 18:25:42.123361", "stderr": "", "stderr_lines": [], "stdout": "t3_VM2", "stdout_lines": ["t3_VM2"]}

TASK [Define VM] ********************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t4_VM4", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t4_VM3", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "warnings": ["'xml' is given - ignoring 'name'"]}

TASK [Create VM] ********************************************************************************************************************************************
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}]}
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}]}

TASK [Start VM] *********************************************************************************************************************************************
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}]}
ok: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}]}

TASK [Attach VM interface] **********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'mem': 2, u'name': u't4_VM4', u'vcpu': 4, u'disk': u'10G', u'brif': u't4br1if1', u'vmif': u't4VM4if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t4_VM4\" | grep -w 't4VM4if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t4_VM4\" direct \"t4VM4if1\" --live --persistent ; fi\n", "delta": "0:00:00.260630", "end": "2019-12-05 18:26:17.739989", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "disk": "10G", "mem": 2, "name": "t4_VM4", "vcpu": 4, "vmif": "t4VM4if1"}], "rc": 0, "start": "2019-12-05 18:26:17.479359", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'mem': 3, u'name': u't4_VM3', u'vcpu': 2, u'disk': u'10G', u'brif': u't4br2if1', u'vmif': u't4VM3if1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t4_VM3\" | grep -w 't4VM3if1' ; if [ $? -ne 0 ] ; then virsh attach-interface \"t4_VM3\" direct \"t4VM3if1\" --live --persistent ; fi\n", "delta": "0:00:00.273898", "end": "2019-12-05 18:26:18.286647", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4br2if1", "disk": "10G", "mem": 3, "name": "t4_VM3", "vcpu": 2, "vmif": "t4VM3if1"}], "rc": 0, "start": "2019-12-05 18:26:18.012749", "stderr": "", "stderr_lines": [], "stdout": "Interface attached successfully", "stdout_lines": ["Interface attached successfully"]}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=6    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 18:31:58.994550 The subnet 1.1.1.0/24 is present in Cloud 1
INFO:root: 18:31:58.994884 The subnet 1.1.1.0/24 is present in Cloud 2
INFO:root: 18:31:58.994975 The subnet 2.2.2.0/24 is present in Cloud 2
INFO:root: 18:31:58.995039 The VM VM2 is present in Cloud 1
INFO:root: 18:31:58.995105 The VM VM4 is present in Cloud 2
INFO:root: 18:31:58.995164 The VM VM3 is present in Cloud 2
INFO:root: 18:31:58.995276 The subnet 1.1.1.0/24 is present in destination cloud
INFO:root: 18:31:58.995367 The subnet 1.1.1.0/24 is present in destination cloud
ERROR:root: 18:31:58.995454 The subnet 2.2.2.0/24 is not present in the destination cloud
INFO:root: 18:34:25.802362 The subnet 1.1.1.0/24 is present in Cloud 1
INFO:root: 18:34:25.802569 The subnet 1.1.1.0/24 is present in Cloud 2
INFO:root: 18:34:25.802614 The subnet 2.2.2.0/24 is present in Cloud 2
INFO:root: 18:34:25.802645 The VM VM2 is present in Cloud 1
INFO:root: 18:34:25.802673 The VM VM4 is present in Cloud 2
INFO:root: 18:34:25.802699 The VM VM3 is present in Cloud 2
INFO:root: 18:34:25.802758 The subnet 1.1.1.0/24 is present in destination cloud
INFO:root: 18:34:25.802797 The subnet 1.1.1.0/24 is present in destination cloud
ERROR:root: 18:34:25.803129 The subnet 2.2.2.0/24 is not present in the destination cloud
INFO:root: 18:34:26.110628 source cloud is C1
INFO:root: 18:34:26.112392 source cloud is C2
INFO:paramiko.transport:Connected (version 2.0, client OpenSSH_7.6p1)
INFO:paramiko.transport:Authentication (publickey) successful!
INFO:root: 18:34:27.103695 source cloud is C2
INFO:paramiko.transport:Connected (version 2.0, client OpenSSH_7.6p1)
INFO:paramiko.transport:Authentication (publickey) successful!
INFO:root: 21:08:52.787491 Printing the yaml input file
INFO:root: 21:08:52.787887 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 21:08:52.788003 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 21:08:52.788056 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 21:08:52.788227 Provided subnet in C2: 2.2.2.0/24 is valid
INFO:root: 21:25:06.248138 Printing the yaml input file
INFO:root: 21:25:06.248712 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 21:25:06.248914 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 21:25:06.248975 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 21:25:06.249020 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file
INFO:root: 21:25:38.606612 Printing the yaml input file
INFO:root: 21:25:38.606732 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 21:25:38.606824 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 21:25:38.606871 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 21:25:38.606911 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
fatal: [localhost]: FAILED! => {"changed": false, "msg": "Failed to import the required Python library (Docker SDK for Python: docker (Python >= 2.7) or docker-py (Python 2.6)) on t11_vm8's Python /usr/bin/python3. Please read module documentation and install in the appropriate location. If the required library is installed, but Ansible is using the wrong Python interpreter, please consult the documentation on ansible_python_interpreter, for example via `pip install docker` or `pip install docker-py` (Python 2.6). The error was: No module named 'docker'"}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   

INFO:root: 21:26:58.846391 Printing the yaml input file
INFO:root: 21:26:58.846508 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 21:26:58.846604 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 21:26:58.846656 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 21:26:58.846700 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
fatal: [localhost]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'itemn' is undefined\n\nThe error appears to be in '/root/Migration-as-a-Service-2.0/src/southbound/ansible/create_infra_C1.yml': line 31, column 5, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n  - name: Create Subnet Containers\n    ^ here\n"}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=2    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   

INFO:root: 21:27:34.163793 Printing the yaml input file
INFO:root: 21:27:34.163949 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 21:27:34.164067 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 21:27:34.164119 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 21:27:34.164162 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
ok: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}, "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 22:20:40.271494 Printing the yaml input file
INFO:root: 22:20:40.271923 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 22:20:40.272037 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 22:20:40.272090 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 22:20:40.272132 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

PLAY RECAP **************************************************************************************************************************************************

INFO:root: 22:22:38.147720 Printing the yaml input file
INFO:root: 22:22:38.147871 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 22:22:38.147988 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 22:22:38.148042 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 22:22:38.148086 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

PLAY RECAP **************************************************************************************************************************************************

INFO:root: 22:24:57.169733 Printing the yaml input file
INFO:root: 22:24:57.169879 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 22:24:57.169992 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 22:24:57.170042 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 22:24:57.170083 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
ok: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
ok: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}, "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

PLAY RECAP **************************************************************************************************************************************************

INFO:root: 22:34:39.706125 Printing the yaml input file
INFO:root: 22:34:39.706629 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 22:34:39.706751 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 22:34:39.706805 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 22:34:39.706848 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
ok: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
ok: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}, "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

PLAY RECAP **************************************************************************************************************************************************

INFO:root: 22:41:24.656870 Printing the yaml input file
INFO:root: 22:41:24.657376 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 22:41:24.657520 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 22:41:24.657575 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 22:41:24.657618 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
ok: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
ok: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}, "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

PLAY RECAP **************************************************************************************************************************************************

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
An exception occurred during task execution. To see the full traceback, use -vvv. The error was: APIError: 500 Server Error: Internal Server Error ("Cannot locate specified Dockerfile: Dockerfile")
fatal: [99.99.99.2]: FAILED! => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "msg": "An unexpected docker error occurred: 500 Server Error: Internal Server Error (\"Cannot locate specified Dockerfile: Dockerfile\")"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   

INFO:root: 22:56:22.949991 Printing the yaml input file
INFO:root: 22:56:22.950213 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 22:56:22.950364 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 22:56:22.950462 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 22:56:22.950536 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
ok: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
ok: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}, "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
failed: [localhost] (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'pid': u'24507', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip link show \"t6pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t6pns_if\" netns pns ; fi\nip netns exec \"t6\" ip link show \"t6if\" ; if [ $? -ne 0 ] ; then ip link set \"t6if\" netns \"t6\" ; fi\nip netns exec pns ip link set dev \"t6pns_if\" up\nip netns exec \"t6\" ip link set dev \"t6if\" up\n", "delta": "0:00:00.108493", "end": "2019-12-05 22:56:26.692047", "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pid": "24507", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}, "msg": "non-zero return code", "rc": 1, "start": "2019-12-05 22:56:26.583554", "stderr": "Device \"t6pns_if\" does not exist.\nCannot find device \"t6pns_if\"\nCannot open network namespace \"t6\": No such file or directory\nError: argument \"t6\" is wrong: Invalid \"netns\" value\n\nCannot find device \"t6pns_if\"\nCannot open network namespace \"t6\": No such file or directory", "stderr_lines": ["Device \"t6pns_if\" does not exist.", "Cannot find device \"t6pns_if\"", "Cannot open network namespace \"t6\": No such file or directory", "Error: argument \"t6\" is wrong: Invalid \"netns\" value", "", "Cannot find device \"t6pns_if\"", "Cannot open network namespace \"t6\": No such file or directory"], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   

INFO:root: 22:58:36.051530 Printing the yaml input file
INFO:root: 22:58:36.051668 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 22:58:36.051768 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 22:58:36.051819 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 22:58:36.051887 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
ok: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
ok: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}, "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
failed: [localhost] (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'pid': u'24507', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns ip link show \"t6pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t6pns_if\" netns pns ; fi\nip netns exec \"t6\" ip link show \"t6if\" ; if [ $? -ne 0 ] ; then ip link set \"t6if\" netns \"t6\" ; fi\nip netns exec pns ip link set dev \"t6pns_if\" up\nip netns exec \"t6\" ip link set dev \"t6if\" up\n", "delta": "0:00:00.099650", "end": "2019-12-05 22:58:39.759436", "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pid": "24507", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}, "msg": "non-zero return code", "rc": 1, "start": "2019-12-05 22:58:39.659786", "stderr": "Device \"t6pns_if\" does not exist.\nCannot find device \"t6pns_if\"\nCannot open network namespace \"t6\": No such file or directory\nError: argument \"t6\" is wrong: Invalid \"netns\" value\n\nCannot find device \"t6pns_if\"\nCannot open network namespace \"t6\": No such file or directory", "stderr_lines": ["Device \"t6pns_if\" does not exist.", "Cannot find device \"t6pns_if\"", "Cannot open network namespace \"t6\": No such file or directory", "Error: argument \"t6\" is wrong: Invalid \"netns\" value", "", "Cannot find device \"t6pns_if\"", "Cannot open network namespace \"t6\": No such file or directory"], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   

INFO:root: 23:10:06.094594 Printing the yaml input file
INFO:root: 23:10:06.094744 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 23:10:06.094856 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 23:10:06.094907 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 23:10:06.094949 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
ok: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
ok: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}, "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
INFO:root: 23:13:49.889006 Printing the yaml input file
INFO:root: 23:13:49.889308 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 23:13:49.889457 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 23:13:49.889574 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 23:13:49.889656 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
ok: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:01.624999278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/merged", "UpperDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/diff", "WorkDir": "/var/lib/docker/overlay2/65d1a5dfa28021cb2856b6da2a0737cb124a25c8e59e6d94c5a83a2d4e3d0c40/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hostname", "HostsPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/hosts", "Id": "4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/408477bc9ce35ea9220e124c34a4b8b060e9573f2444fbc36e75cb45430dde7f/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "32aefe6f1e4f32108a3a13cd259e245620684a77998b32df6d68175893aa9fd1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "3984b754ebed773168a58cb69bfd80af2a01be9966107cc9b6dc0c573b64bbac", "SandboxKey": "/var/run/docker/netns/3984b754ebed", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4a5aad75fef0324c8a6a4c0e85e0ef576c652cbdf51ca07f5e7647c1cd38f7ea/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24507, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:02.498594417Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
ok: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T21:27:36.50295659Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/merged", "UpperDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/diff", "WorkDir": "/var/lib/docker/overlay2/36f406d85ccbfbb8ed7a0fced78ad3e09aaaa3130cd7f8540f9cb7f8d1885f64/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hostname", "HostsPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/hosts", "Id": "06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/de89960d81b03dd760adf948a87cfa3b929fb408aed8bec8406fb8e8926b476b/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d0cbfcc0486e72a332f13b115da5e92f60f3a181e12d56840a9d52a9b527bcd9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "ef6aa5f61d186f7d98c840086c03684bb0fcc2715c2773acef1e6bae110fd93c", "SandboxKey": "/var/run/docker/netns/ef6aa5f61d18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/06bb17719ca5c563eed29959ea4d87938cf2fd9fe1d7a86fd8cc78ce8f3588ba/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25932, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T21:27:37.139251607Z", "Status": "running"}}, "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
INFO:root: 23:14:35.419902 Printing the yaml input file
INFO:root: 23:14:35.420022 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 23:14:35.420114 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 23:14:35.420167 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 23:14:35.420209 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.7.1', u'name': u't7', u'pns_ip': u'192.168.7.1/24', u'tenant_if': u't7if', u'tenant_ip': u'192.168.7.2/24', u'pns_if': u't7pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:14:37.372115878Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/58751cbd427265a2c7e9ae571493b48574da747890a3b37c316414dfe82f8a5a-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/58751cbd427265a2c7e9ae571493b48574da747890a3b37c316414dfe82f8a5a/merged", "UpperDir": "/var/lib/docker/overlay2/58751cbd427265a2c7e9ae571493b48574da747890a3b37c316414dfe82f8a5a/diff", "WorkDir": "/var/lib/docker/overlay2/58751cbd427265a2c7e9ae571493b48574da747890a3b37c316414dfe82f8a5a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/dd9d34b7cf4c7477f5108e4aa6483880eec0e165aef80a7164e90e45ed905f50/hostname", "HostsPath": "/var/lib/docker/containers/dd9d34b7cf4c7477f5108e4aa6483880eec0e165aef80a7164e90e45ed905f50/hosts", "Id": "dd9d34b7cf4c7477f5108e4aa6483880eec0e165aef80a7164e90e45ed905f50", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/dd9d34b7cf4c7477f5108e4aa6483880eec0e165aef80a7164e90e45ed905f50/dd9d34b7cf4c7477f5108e4aa6483880eec0e165aef80a7164e90e45ed905f50-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "96bee19ee7e5e62f8b9ad2d8eddc330979435e46ceacb9fc57f2d92fe7f694cd", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/96bee19ee7e5e62f8b9ad2d8eddc330979435e46ceacb9fc57f2d92fe7f694cd/_data", "Type": "volume"}], "Name": "/t7", "NetworkSettings": {"Bridge": "", "EndpointID": "3627d0c9ee895411551d7037a2304a4a0a24c075f08fd425d1c8331b6754cb9f", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "3627d0c9ee895411551d7037a2304a4a0a24c075f08fd425d1c8331b6754cb9f", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "59c31248c0b4d28189547ebf9fdd1baee88c1f6d32dbde2dd518334dec4d8748", "SandboxKey": "/var/run/docker/netns/59c31248c0b4", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/dd9d34b7cf4c7477f5108e4aa6483880eec0e165aef80a7164e90e45ed905f50/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4116, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T23:14:38.192628966Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:14:37.372115878Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/58751cbd427265a2c7e9ae571493b48574da747890a3b37c316414dfe82f8a5a-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/58751cbd427265a2c7e9ae571493b48574da747890a3b37c316414dfe82f8a5a/merged", "UpperDir": "/var/lib/docker/overlay2/58751cbd427265a2c7e9ae571493b48574da747890a3b37c316414dfe82f8a5a/diff", "WorkDir": "/var/lib/docker/overlay2/58751cbd427265a2c7e9ae571493b48574da747890a3b37c316414dfe82f8a5a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/dd9d34b7cf4c7477f5108e4aa6483880eec0e165aef80a7164e90e45ed905f50/hostname", "HostsPath": "/var/lib/docker/containers/dd9d34b7cf4c7477f5108e4aa6483880eec0e165aef80a7164e90e45ed905f50/hosts", "Id": "dd9d34b7cf4c7477f5108e4aa6483880eec0e165aef80a7164e90e45ed905f50", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/dd9d34b7cf4c7477f5108e4aa6483880eec0e165aef80a7164e90e45ed905f50/dd9d34b7cf4c7477f5108e4aa6483880eec0e165aef80a7164e90e45ed905f50-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "96bee19ee7e5e62f8b9ad2d8eddc330979435e46ceacb9fc57f2d92fe7f694cd", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/96bee19ee7e5e62f8b9ad2d8eddc330979435e46ceacb9fc57f2d92fe7f694cd/_data", "Type": "volume"}], "Name": "/t7", "NetworkSettings": {"Bridge": "", "EndpointID": "3627d0c9ee895411551d7037a2304a4a0a24c075f08fd425d1c8331b6754cb9f", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "3627d0c9ee895411551d7037a2304a4a0a24c075f08fd425d1c8331b6754cb9f", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "59c31248c0b4d28189547ebf9fdd1baee88c1f6d32dbde2dd518334dec4d8748", "SandboxKey": "/var/run/docker/netns/59c31248c0b4", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/dd9d34b7cf4c7477f5108e4aa6483880eec0e165aef80a7164e90e45ed905f50/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4116, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T23:14:38.192628966Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.7.1", "name": "t7", "pns_if": "t7pns_if", "pns_ip": "192.168.7.1/24", "tenant_if": "t7if", "tenant_ip": "192.168.7.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.61.1/24', u'ns_name': u't7', u'ns_if': u't7if', u'if': u'p1'}], u'default_route_ip': u'10.1.61.1', u'bridge_name': u't7br1', u'dns': [{u'dnsif': u't7s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't7s1_dnsbrif'}], u'ns_name': u't7ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.61.2/24', u'tenant_ns_ip': u'10.1.61.1/24', u'tenant_ns_if': u't7ns1if', u'tenant_ns_name': u't7', u'tenant_sub_if': u't7s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't7br1if1', u'vmif': u't7C1if1', u'name': u't7_C1'}, {u'brif': u't7br1if2', u'vmif': u't7C2if1', u'name': u't7_C2'}], u'vxlan': [{u'local_ip': u'10.1.61.2', u'tenant_route_ip': u'192.168.7.2', u'dsport': 4789, u'dev': u't7s1if', u'subnet_route': u'10.1.61.0/24', u'remote_route': u'10.2.61.0/24', u'v_name': u'vxlan_t7s1', u'id': 42, u'remote_ip': u'10.2.61.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t7ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:14:38.742119464Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/bd3de325fa9426289a6c1f381bf08691ba2e60cde378fa49cce0cbd4ee262e98-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/bd3de325fa9426289a6c1f381bf08691ba2e60cde378fa49cce0cbd4ee262e98/merged", "UpperDir": "/var/lib/docker/overlay2/bd3de325fa9426289a6c1f381bf08691ba2e60cde378fa49cce0cbd4ee262e98/diff", "WorkDir": "/var/lib/docker/overlay2/bd3de325fa9426289a6c1f381bf08691ba2e60cde378fa49cce0cbd4ee262e98/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c185f496139eeb10c8575a998f016c3302efbd09d8962f6b564d9c50030c8586/hostname", "HostsPath": "/var/lib/docker/containers/c185f496139eeb10c8575a998f016c3302efbd09d8962f6b564d9c50030c8586/hosts", "Id": "c185f496139eeb10c8575a998f016c3302efbd09d8962f6b564d9c50030c8586", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/c185f496139eeb10c8575a998f016c3302efbd09d8962f6b564d9c50030c8586/c185f496139eeb10c8575a998f016c3302efbd09d8962f6b564d9c50030c8586-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "39924643eb2daefc5a3a20cbb55a5efa0fb4cc831b5ea8bba547e1c6e1f09238", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/39924643eb2daefc5a3a20cbb55a5efa0fb4cc831b5ea8bba547e1c6e1f09238/_data", "Type": "volume"}], "Name": "/t7ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "a6440535575ac3e1f50985e8ba7ba327984ec462095eff509e41fb8920b96424", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:06", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "a6440535575ac3e1f50985e8ba7ba327984ec462095eff509e41fb8920b96424", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:06", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "f18f821fa5424fed35e5e45e191ceb6956b9f82091c2883eef62b39bc52576c2", "SandboxKey": "/var/run/docker/netns/f18f821fa542", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c185f496139eeb10c8575a998f016c3302efbd09d8962f6b564d9c50030c8586/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4676, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T23:14:39.781705403Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t7ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:14:38.742119464Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/bd3de325fa9426289a6c1f381bf08691ba2e60cde378fa49cce0cbd4ee262e98-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/bd3de325fa9426289a6c1f381bf08691ba2e60cde378fa49cce0cbd4ee262e98/merged", "UpperDir": "/var/lib/docker/overlay2/bd3de325fa9426289a6c1f381bf08691ba2e60cde378fa49cce0cbd4ee262e98/diff", "WorkDir": "/var/lib/docker/overlay2/bd3de325fa9426289a6c1f381bf08691ba2e60cde378fa49cce0cbd4ee262e98/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c185f496139eeb10c8575a998f016c3302efbd09d8962f6b564d9c50030c8586/hostname", "HostsPath": "/var/lib/docker/containers/c185f496139eeb10c8575a998f016c3302efbd09d8962f6b564d9c50030c8586/hosts", "Id": "c185f496139eeb10c8575a998f016c3302efbd09d8962f6b564d9c50030c8586", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/c185f496139eeb10c8575a998f016c3302efbd09d8962f6b564d9c50030c8586/c185f496139eeb10c8575a998f016c3302efbd09d8962f6b564d9c50030c8586-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "39924643eb2daefc5a3a20cbb55a5efa0fb4cc831b5ea8bba547e1c6e1f09238", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/39924643eb2daefc5a3a20cbb55a5efa0fb4cc831b5ea8bba547e1c6e1f09238/_data", "Type": "volume"}], "Name": "/t7ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "a6440535575ac3e1f50985e8ba7ba327984ec462095eff509e41fb8920b96424", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:06", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "a6440535575ac3e1f50985e8ba7ba327984ec462095eff509e41fb8920b96424", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:06", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "f18f821fa5424fed35e5e45e191ceb6956b9f82091c2883eef62b39bc52576c2", "SandboxKey": "/var/run/docker/netns/f18f821fa542", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c185f496139eeb10c8575a998f016c3302efbd09d8962f6b564d9c50030c8586/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4676, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T23:14:39.781705403Z", "Status": "running"}}, "item": {"bridge_name": "t7br1", "default_route_ip": "10.1.61.1", "dns": [{"brif": "t7s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t7s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t7ns1", "route": [{"if": "p1", "ip": "10.1.61.1/24", "ns_if": "t7if", "ns_name": "t7"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t7ns1if", "tenant_ns_ip": "10.1.61.1/24", "tenant_ns_name": "t7", "tenant_sub_if": "t7s1if", "tenant_sub_ip": "10.1.61.2/24"}], "vms": [{"brif": "t7br1if1", "name": "t7_C1", "vmif": "t7C1if1"}, {"brif": "t7br1if2", "name": "t7_C2", "vmif": "t7C2if1"}], "vxlan": [{"dev": "t7s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.61.2", "remote_ip": "10.2.61.2", "remote_route": "10.2.61.0/24", "subnet_route": "10.1.61.0/24", "tenant_route_ip": "192.168.7.2", "v_name": "vxlan_t7s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
INFO:root: 23:50:13.252115 Printing the yaml input file
INFO:root: 23:50:13.253061 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 23:50:13.253287 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 23:50:13.253370 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 23:50:13.253436 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.8.1', u'name': u't8', u'pns_ip': u'192.168.8.1/24', u'tenant_if': u't8if', u'tenant_ip': u'192.168.8.2/24', u'pns_if': u't8pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:50:15.964574188Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/57fdcbdc1c84e7ca0a9f3c3866a4f9f5f5311dc44258f56851907e8960186e4d-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/57fdcbdc1c84e7ca0a9f3c3866a4f9f5f5311dc44258f56851907e8960186e4d/merged", "UpperDir": "/var/lib/docker/overlay2/57fdcbdc1c84e7ca0a9f3c3866a4f9f5f5311dc44258f56851907e8960186e4d/diff", "WorkDir": "/var/lib/docker/overlay2/57fdcbdc1c84e7ca0a9f3c3866a4f9f5f5311dc44258f56851907e8960186e4d/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/62614bce2659158d408ccac598c3c9fb0d5738e72c58ab4c9304d1859491ef8b/hostname", "HostsPath": "/var/lib/docker/containers/62614bce2659158d408ccac598c3c9fb0d5738e72c58ab4c9304d1859491ef8b/hosts", "Id": "62614bce2659158d408ccac598c3c9fb0d5738e72c58ab4c9304d1859491ef8b", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/62614bce2659158d408ccac598c3c9fb0d5738e72c58ab4c9304d1859491ef8b/62614bce2659158d408ccac598c3c9fb0d5738e72c58ab4c9304d1859491ef8b-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "973183ca6c4bb4fb724ca1be4901b59a3b7b0480d28e0c6b9fb0524f8770b23e", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/973183ca6c4bb4fb724ca1be4901b59a3b7b0480d28e0c6b9fb0524f8770b23e/_data", "Type": "volume"}], "Name": "/t8", "NetworkSettings": {"Bridge": "", "EndpointID": "05dc4bddd96c667b4b91aae828a75dd1e3c13287c4fc2421021600ed29552c2a", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:07", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "05dc4bddd96c667b4b91aae828a75dd1e3c13287c4fc2421021600ed29552c2a", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:07", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "2596c4c686973387844f83192dfa28c54410cd33a1363e97713753de8989c46e", "SandboxKey": "/var/run/docker/netns/2596c4c68697", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/62614bce2659158d408ccac598c3c9fb0d5738e72c58ab4c9304d1859491ef8b/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 29363, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T23:50:16.910881607Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:50:15.964574188Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/57fdcbdc1c84e7ca0a9f3c3866a4f9f5f5311dc44258f56851907e8960186e4d-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/57fdcbdc1c84e7ca0a9f3c3866a4f9f5f5311dc44258f56851907e8960186e4d/merged", "UpperDir": "/var/lib/docker/overlay2/57fdcbdc1c84e7ca0a9f3c3866a4f9f5f5311dc44258f56851907e8960186e4d/diff", "WorkDir": "/var/lib/docker/overlay2/57fdcbdc1c84e7ca0a9f3c3866a4f9f5f5311dc44258f56851907e8960186e4d/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/62614bce2659158d408ccac598c3c9fb0d5738e72c58ab4c9304d1859491ef8b/hostname", "HostsPath": "/var/lib/docker/containers/62614bce2659158d408ccac598c3c9fb0d5738e72c58ab4c9304d1859491ef8b/hosts", "Id": "62614bce2659158d408ccac598c3c9fb0d5738e72c58ab4c9304d1859491ef8b", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/62614bce2659158d408ccac598c3c9fb0d5738e72c58ab4c9304d1859491ef8b/62614bce2659158d408ccac598c3c9fb0d5738e72c58ab4c9304d1859491ef8b-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "973183ca6c4bb4fb724ca1be4901b59a3b7b0480d28e0c6b9fb0524f8770b23e", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/973183ca6c4bb4fb724ca1be4901b59a3b7b0480d28e0c6b9fb0524f8770b23e/_data", "Type": "volume"}], "Name": "/t8", "NetworkSettings": {"Bridge": "", "EndpointID": "05dc4bddd96c667b4b91aae828a75dd1e3c13287c4fc2421021600ed29552c2a", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:07", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "05dc4bddd96c667b4b91aae828a75dd1e3c13287c4fc2421021600ed29552c2a", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:07", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "2596c4c686973387844f83192dfa28c54410cd33a1363e97713753de8989c46e", "SandboxKey": "/var/run/docker/netns/2596c4c68697", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/62614bce2659158d408ccac598c3c9fb0d5738e72c58ab4c9304d1859491ef8b/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 29363, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T23:50:16.910881607Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.8.1", "name": "t8", "pns_if": "t8pns_if", "pns_ip": "192.168.8.1/24", "tenant_if": "t8if", "tenant_ip": "192.168.8.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.71.1/24', u'ns_name': u't8', u'ns_if': u't8if', u'if': u'p1'}], u'default_route_ip': u'10.1.71.1', u'bridge_name': u't8br1', u'dns': [{u'dnsif': u't8s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't8s1_dnsbrif'}], u'ns_name': u't8ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.71.2/24', u'tenant_ns_ip': u'10.1.71.1/24', u'tenant_ns_if': u't8ns1if', u'tenant_ns_name': u't8', u'tenant_sub_if': u't8s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't8br1if1', u'vmif': u't8C1if1', u'name': u't8_C1'}, {u'brif': u't8br1if2', u'vmif': u't8C2if1', u'name': u't8_C2'}], u'vxlan': [{u'local_ip': u'10.1.71.2', u'tenant_route_ip': u'192.168.8.2', u'dsport': 4789, u'dev': u't8s1if', u'subnet_route': u'10.1.71.0/24', u'remote_route': u'10.2.71.0/24', u'v_name': u'vxlan_t8s1', u'id': 42, u'remote_ip': u'10.2.71.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t8ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:50:17.598788985Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/56a1f682db2619213ac5e7524fac3c6f44ea0e05e8aa668f24c1b42c52bf3f7b-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/56a1f682db2619213ac5e7524fac3c6f44ea0e05e8aa668f24c1b42c52bf3f7b/merged", "UpperDir": "/var/lib/docker/overlay2/56a1f682db2619213ac5e7524fac3c6f44ea0e05e8aa668f24c1b42c52bf3f7b/diff", "WorkDir": "/var/lib/docker/overlay2/56a1f682db2619213ac5e7524fac3c6f44ea0e05e8aa668f24c1b42c52bf3f7b/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/b3e7578005e6719a64122a612a49ecdde7d2106371599df05469a33c4ab08b7c/hostname", "HostsPath": "/var/lib/docker/containers/b3e7578005e6719a64122a612a49ecdde7d2106371599df05469a33c4ab08b7c/hosts", "Id": "b3e7578005e6719a64122a612a49ecdde7d2106371599df05469a33c4ab08b7c", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/b3e7578005e6719a64122a612a49ecdde7d2106371599df05469a33c4ab08b7c/b3e7578005e6719a64122a612a49ecdde7d2106371599df05469a33c4ab08b7c-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "7db9f10e79fa3ab38d65482430e02816004e689c25a46267d0ae5501cb3a02c9", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/7db9f10e79fa3ab38d65482430e02816004e689c25a46267d0ae5501cb3a02c9/_data", "Type": "volume"}], "Name": "/t8ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "7653378eb84e84110e0e9ec87b5ff3beba5e6d10b86edf53b4fe3a5a53d7a1fb", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:08", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "7653378eb84e84110e0e9ec87b5ff3beba5e6d10b86edf53b4fe3a5a53d7a1fb", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:08", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "b3121ae3fdfcf42db427d8fffc6c36a7ca79a9e98ac3e933ecdece9598f5260a", "SandboxKey": "/var/run/docker/netns/b3121ae3fdfc", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/b3e7578005e6719a64122a612a49ecdde7d2106371599df05469a33c4ab08b7c/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 30079, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T23:50:19.245750191Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t8ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:50:17.598788985Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/56a1f682db2619213ac5e7524fac3c6f44ea0e05e8aa668f24c1b42c52bf3f7b-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/56a1f682db2619213ac5e7524fac3c6f44ea0e05e8aa668f24c1b42c52bf3f7b/merged", "UpperDir": "/var/lib/docker/overlay2/56a1f682db2619213ac5e7524fac3c6f44ea0e05e8aa668f24c1b42c52bf3f7b/diff", "WorkDir": "/var/lib/docker/overlay2/56a1f682db2619213ac5e7524fac3c6f44ea0e05e8aa668f24c1b42c52bf3f7b/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/b3e7578005e6719a64122a612a49ecdde7d2106371599df05469a33c4ab08b7c/hostname", "HostsPath": "/var/lib/docker/containers/b3e7578005e6719a64122a612a49ecdde7d2106371599df05469a33c4ab08b7c/hosts", "Id": "b3e7578005e6719a64122a612a49ecdde7d2106371599df05469a33c4ab08b7c", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/b3e7578005e6719a64122a612a49ecdde7d2106371599df05469a33c4ab08b7c/b3e7578005e6719a64122a612a49ecdde7d2106371599df05469a33c4ab08b7c-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "7db9f10e79fa3ab38d65482430e02816004e689c25a46267d0ae5501cb3a02c9", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/7db9f10e79fa3ab38d65482430e02816004e689c25a46267d0ae5501cb3a02c9/_data", "Type": "volume"}], "Name": "/t8ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "7653378eb84e84110e0e9ec87b5ff3beba5e6d10b86edf53b4fe3a5a53d7a1fb", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:08", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "7653378eb84e84110e0e9ec87b5ff3beba5e6d10b86edf53b4fe3a5a53d7a1fb", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:08", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "b3121ae3fdfcf42db427d8fffc6c36a7ca79a9e98ac3e933ecdece9598f5260a", "SandboxKey": "/var/run/docker/netns/b3121ae3fdfc", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/b3e7578005e6719a64122a612a49ecdde7d2106371599df05469a33c4ab08b7c/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 30079, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T23:50:19.245750191Z", "Status": "running"}}, "item": {"bridge_name": "t8br1", "default_route_ip": "10.1.71.1", "dns": [{"brif": "t8s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t8s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t8ns1", "route": [{"if": "p1", "ip": "10.1.71.1/24", "ns_if": "t8if", "ns_name": "t8"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t8ns1if", "tenant_ns_ip": "10.1.71.1/24", "tenant_ns_name": "t8", "tenant_sub_if": "t8s1if", "tenant_sub_ip": "10.1.71.2/24"}], "vms": [{"brif": "t8br1if1", "name": "t8_C1", "vmif": "t8C1if1"}, {"brif": "t8br1if2", "name": "t8_C2", "vmif": "t8C2if1"}], "vxlan": [{"dev": "t8s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.71.2", "remote_ip": "10.2.71.2", "remote_route": "10.2.71.0/24", "subnet_route": "10.1.71.0/24", "tenant_route_ip": "192.168.8.2", "v_name": "vxlan_t8s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
changed: [99.99.99.2] => {"actions": ["Built image centos7:latest from /root"], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": true, "image": {"Architecture": "amd64", "Author": "Prashanth_M", "Comment": "", "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "", "Image": "sha256:1f99394e5306029eb52d0ad19f7413ebe454419c65cc26a5fe5303c055904ca7", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Container": "8c1067e6e84436c79308fc858072fe6f352a977f29a8158a8e5f6640a23e9c57", "ContainerConfig": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/bin/sh", "-c", "#(nop) ", "CMD [\"/usr/sbin/init\"]"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "8c1067e6e844", "Image": "sha256:1f99394e5306029eb52d0ad19f7413ebe454419c65cc26a5fe5303c055904ca7", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:56:31.020952437Z", "DockerVersion": "19.03.5", "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/merged", "UpperDir": "/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff", "WorkDir": "/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/work"}, "Name": "overlay2"}, "Id": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "Metadata": {"LastTagTime": "2019-12-05T23:56:33.637766331Z"}, "Os": "linux", "Parent": "sha256:1f99394e5306029eb52d0ad19f7413ebe454419c65cc26a5fe5303c055904ca7", "RepoDigests": [], "RepoTags": ["centos7:latest"], "RootFS": {"Layers": ["sha256:77b174a6a187b610e4699546bd973a8d1e77663796e3724318a2a4b24cb07ea0", "sha256:3a4989aad8c4143a6e097072760d6803e72e8f1e2f7ae99308507d378ca25ad3", "sha256:e1fba407a1dba75f7ee02bc318876b4fc8cf2855f60966d9ee3b99519f230708", "sha256:bf97829bc0ae0e1ac3f289bd26ea607a286f8bcfc42709d51c540e0f7eccd9a6"], "Type": "layers"}, "Size": 362755526, "VirtualSize": 362755526}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.136.1', u'name': u't8', u'pns_ip': u'192.168.136.1/24', u'tenant_if': u't8if', u'tenant_ip': u'192.168.136.2/24', u'pns_if': u't8pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:56:35.461192999Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/069c699a14f63c09865b0b9fe7313de891c6d02cf78cbbed6eba3cdf68e5eb92-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/069c699a14f63c09865b0b9fe7313de891c6d02cf78cbbed6eba3cdf68e5eb92/merged", "UpperDir": "/var/lib/docker/overlay2/069c699a14f63c09865b0b9fe7313de891c6d02cf78cbbed6eba3cdf68e5eb92/diff", "WorkDir": "/var/lib/docker/overlay2/069c699a14f63c09865b0b9fe7313de891c6d02cf78cbbed6eba3cdf68e5eb92/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c1fcbe27b4254425793ab886009f8a8b0b597d195bbb947e657fe8ccdb70b21f/hostname", "HostsPath": "/var/lib/docker/containers/c1fcbe27b4254425793ab886009f8a8b0b597d195bbb947e657fe8ccdb70b21f/hosts", "Id": "c1fcbe27b4254425793ab886009f8a8b0b597d195bbb947e657fe8ccdb70b21f", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/c1fcbe27b4254425793ab886009f8a8b0b597d195bbb947e657fe8ccdb70b21f/c1fcbe27b4254425793ab886009f8a8b0b597d195bbb947e657fe8ccdb70b21f-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "2f21afdad816e41ddd26c636077882c46d19b0a470a0312cd2c6e01dc5456c80", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/2f21afdad816e41ddd26c636077882c46d19b0a470a0312cd2c6e01dc5456c80/_data", "Type": "volume"}], "Name": "/t8", "NetworkSettings": {"Bridge": "", "EndpointID": "4f77ee92f6efec7d6d5e33518c472b67c48f593728a12e7ecc393c7f9eb02de6", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "4f77ee92f6efec7d6d5e33518c472b67c48f593728a12e7ecc393c7f9eb02de6", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "8a591232d06b683068e57dede794e411bf064aff192241f87bb861712ee0a291"}}, "Ports": {}, "SandboxID": "2a533d25b891daffc793662af3f5ab69ec68e3a4405d9ab4049ac60f2eca42ee", "SandboxKey": "/var/run/docker/netns/2a533d25b891", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c1fcbe27b4254425793ab886009f8a8b0b597d195bbb947e657fe8ccdb70b21f/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 28220, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T23:56:37.125354783Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:56:35.461192999Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/069c699a14f63c09865b0b9fe7313de891c6d02cf78cbbed6eba3cdf68e5eb92-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/069c699a14f63c09865b0b9fe7313de891c6d02cf78cbbed6eba3cdf68e5eb92/merged", "UpperDir": "/var/lib/docker/overlay2/069c699a14f63c09865b0b9fe7313de891c6d02cf78cbbed6eba3cdf68e5eb92/diff", "WorkDir": "/var/lib/docker/overlay2/069c699a14f63c09865b0b9fe7313de891c6d02cf78cbbed6eba3cdf68e5eb92/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c1fcbe27b4254425793ab886009f8a8b0b597d195bbb947e657fe8ccdb70b21f/hostname", "HostsPath": "/var/lib/docker/containers/c1fcbe27b4254425793ab886009f8a8b0b597d195bbb947e657fe8ccdb70b21f/hosts", "Id": "c1fcbe27b4254425793ab886009f8a8b0b597d195bbb947e657fe8ccdb70b21f", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/c1fcbe27b4254425793ab886009f8a8b0b597d195bbb947e657fe8ccdb70b21f/c1fcbe27b4254425793ab886009f8a8b0b597d195bbb947e657fe8ccdb70b21f-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "2f21afdad816e41ddd26c636077882c46d19b0a470a0312cd2c6e01dc5456c80", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/2f21afdad816e41ddd26c636077882c46d19b0a470a0312cd2c6e01dc5456c80/_data", "Type": "volume"}], "Name": "/t8", "NetworkSettings": {"Bridge": "", "EndpointID": "4f77ee92f6efec7d6d5e33518c472b67c48f593728a12e7ecc393c7f9eb02de6", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "4f77ee92f6efec7d6d5e33518c472b67c48f593728a12e7ecc393c7f9eb02de6", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "8a591232d06b683068e57dede794e411bf064aff192241f87bb861712ee0a291"}}, "Ports": {}, "SandboxID": "2a533d25b891daffc793662af3f5ab69ec68e3a4405d9ab4049ac60f2eca42ee", "SandboxKey": "/var/run/docker/netns/2a533d25b891", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c1fcbe27b4254425793ab886009f8a8b0b597d195bbb947e657fe8ccdb70b21f/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 28220, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T23:56:37.125354783Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.136.1", "name": "t8", "pns_if": "t8pns_if", "pns_ip": "192.168.136.1/24", "tenant_if": "t8if", "tenant_ip": "192.168.136.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.71.1/24', u'ns_name': u't8', u'ns_if': u't8if', u'if': u'p1'}], u'default_route_ip': u'10.2.71.1', u'bridge_name': u't8br1', u'dns': [{u'dnsif': u't8s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't8s1_dnsbrif'}], u'ns_name': u't8ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.71.2/24', u'tenant_ns_ip': u'10.2.71.1/24', u'tenant_ns_if': u't8ns1if', u'tenant_ns_name': u't8', u'tenant_sub_if': u't8s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't8br1if1', u'vmif': u't8C3if1', u'name': u't8_C3'}], u'vxlan': [{u'local_ip': u'10.2.71.2', u'tenant_route_ip': u'192.168.136.2', u'dsport': 4789, u'dev': u't8s1if', u'subnet_route': u'10.2.71.0/24', u'remote_route': u'10.1.71.0/24', u'v_name': u'vxlan_t8s1', u'id': 42, u'remote_ip': u'10.1.71.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t8ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:56:39.032286689Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/85757ed9b03355a86bd78fbee358f55cf5c5588481eb2f506e59ad8fbe4d809b-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/85757ed9b03355a86bd78fbee358f55cf5c5588481eb2f506e59ad8fbe4d809b/merged", "UpperDir": "/var/lib/docker/overlay2/85757ed9b03355a86bd78fbee358f55cf5c5588481eb2f506e59ad8fbe4d809b/diff", "WorkDir": "/var/lib/docker/overlay2/85757ed9b03355a86bd78fbee358f55cf5c5588481eb2f506e59ad8fbe4d809b/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/d7ff10a461e91453b6e6b5e76b7729da2b4090fbb6cc2d1ebfc33bc9849eba41/hostname", "HostsPath": "/var/lib/docker/containers/d7ff10a461e91453b6e6b5e76b7729da2b4090fbb6cc2d1ebfc33bc9849eba41/hosts", "Id": "d7ff10a461e91453b6e6b5e76b7729da2b4090fbb6cc2d1ebfc33bc9849eba41", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/d7ff10a461e91453b6e6b5e76b7729da2b4090fbb6cc2d1ebfc33bc9849eba41/d7ff10a461e91453b6e6b5e76b7729da2b4090fbb6cc2d1ebfc33bc9849eba41-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "dbc92f7d3808f18a3f5f8dbf0ce943fbd7ca1d374228eb0881af0ece530d3d42", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/dbc92f7d3808f18a3f5f8dbf0ce943fbd7ca1d374228eb0881af0ece530d3d42/_data", "Type": "volume"}], "Name": "/t8ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "8f2920736ca999a2770e26cb8994ea63318dff3b4fd020bcdd72112b1e46ce60", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "8f2920736ca999a2770e26cb8994ea63318dff3b4fd020bcdd72112b1e46ce60", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "8a591232d06b683068e57dede794e411bf064aff192241f87bb861712ee0a291"}}, "Ports": {}, "SandboxID": "6275b08aa09581b01ac56c7b4fff31434899e6f8172d0eb5cf146f4d0ca34bc2", "SandboxKey": "/var/run/docker/netns/6275b08aa095", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/d7ff10a461e91453b6e6b5e76b7729da2b4090fbb6cc2d1ebfc33bc9849eba41/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 28908, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T23:56:42.115645198Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t8ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:56:39.032286689Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/85757ed9b03355a86bd78fbee358f55cf5c5588481eb2f506e59ad8fbe4d809b-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/85757ed9b03355a86bd78fbee358f55cf5c5588481eb2f506e59ad8fbe4d809b/merged", "UpperDir": "/var/lib/docker/overlay2/85757ed9b03355a86bd78fbee358f55cf5c5588481eb2f506e59ad8fbe4d809b/diff", "WorkDir": "/var/lib/docker/overlay2/85757ed9b03355a86bd78fbee358f55cf5c5588481eb2f506e59ad8fbe4d809b/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/d7ff10a461e91453b6e6b5e76b7729da2b4090fbb6cc2d1ebfc33bc9849eba41/hostname", "HostsPath": "/var/lib/docker/containers/d7ff10a461e91453b6e6b5e76b7729da2b4090fbb6cc2d1ebfc33bc9849eba41/hosts", "Id": "d7ff10a461e91453b6e6b5e76b7729da2b4090fbb6cc2d1ebfc33bc9849eba41", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/d7ff10a461e91453b6e6b5e76b7729da2b4090fbb6cc2d1ebfc33bc9849eba41/d7ff10a461e91453b6e6b5e76b7729da2b4090fbb6cc2d1ebfc33bc9849eba41-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "dbc92f7d3808f18a3f5f8dbf0ce943fbd7ca1d374228eb0881af0ece530d3d42", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/dbc92f7d3808f18a3f5f8dbf0ce943fbd7ca1d374228eb0881af0ece530d3d42/_data", "Type": "volume"}], "Name": "/t8ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "8f2920736ca999a2770e26cb8994ea63318dff3b4fd020bcdd72112b1e46ce60", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "8f2920736ca999a2770e26cb8994ea63318dff3b4fd020bcdd72112b1e46ce60", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "8a591232d06b683068e57dede794e411bf064aff192241f87bb861712ee0a291"}}, "Ports": {}, "SandboxID": "6275b08aa09581b01ac56c7b4fff31434899e6f8172d0eb5cf146f4d0ca34bc2", "SandboxKey": "/var/run/docker/netns/6275b08aa095", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/d7ff10a461e91453b6e6b5e76b7729da2b4090fbb6cc2d1ebfc33bc9849eba41/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 28908, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T23:56:42.115645198Z", "Status": "running"}}, "item": {"bridge_name": "t8br1", "default_route_ip": "10.2.71.1", "dns": [{"brif": "t8s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t8s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t8ns1", "route": [{"if": "p1", "ip": "10.2.71.1/24", "ns_if": "t8if", "ns_name": "t8"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t8ns1if", "tenant_ns_ip": "10.2.71.1/24", "tenant_ns_name": "t8", "tenant_sub_if": "t8s1if", "tenant_sub_ip": "10.2.71.2/24"}], "vms": [{"brif": "t8br1if1", "name": "t8_C3", "vmif": "t8C3if1"}], "vxlan": [{"dev": "t8s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.71.2", "remote_ip": "10.1.71.2", "remote_route": "10.1.71.0/24", "subnet_route": "10.2.71.0/24", "tenant_route_ip": "192.168.136.2", "v_name": "vxlan_t8s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.72.1/24', u'ns_name': u't8', u'ns_if': u't8if', u'if': u'p1'}], u'default_route_ip': u'10.2.72.1', u'bridge_name': u't8br2', u'dns': [{u'dnsif': u't8s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't8s2_dnsbrif'}], u'ns_name': u't8ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.72.2/24', u'tenant_ns_ip': u'10.2.72.1/24', u'tenant_ns_if': u't8ns2if', u'tenant_ns_name': u't8', u'tenant_sub_if': u't8s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't8br2if1', u'vmif': u't8C4if1', u'name': u't8_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t8ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:56:43.217418124Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/ad23014a6fd06f239c55525b65d4a07739d15348e708506316cea53a36aa4b84-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/ad23014a6fd06f239c55525b65d4a07739d15348e708506316cea53a36aa4b84/merged", "UpperDir": "/var/lib/docker/overlay2/ad23014a6fd06f239c55525b65d4a07739d15348e708506316cea53a36aa4b84/diff", "WorkDir": "/var/lib/docker/overlay2/ad23014a6fd06f239c55525b65d4a07739d15348e708506316cea53a36aa4b84/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/05eced86dbfdc8fe4c725f1404407ef993a12d69be4a108abbc1c5165042f279/hostname", "HostsPath": "/var/lib/docker/containers/05eced86dbfdc8fe4c725f1404407ef993a12d69be4a108abbc1c5165042f279/hosts", "Id": "05eced86dbfdc8fe4c725f1404407ef993a12d69be4a108abbc1c5165042f279", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/05eced86dbfdc8fe4c725f1404407ef993a12d69be4a108abbc1c5165042f279/05eced86dbfdc8fe4c725f1404407ef993a12d69be4a108abbc1c5165042f279-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "46bd0a52b304b2ce3f528feb26fcb5f306d85cc74c7394dc1f0e4313d59e83d7", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/46bd0a52b304b2ce3f528feb26fcb5f306d85cc74c7394dc1f0e4313d59e83d7/_data", "Type": "volume"}], "Name": "/t8ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "1a760a000cd6112b5bedba41b5cfe03ed4483c4d68c22aaeb7fc1a39ea9692ef", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "1a760a000cd6112b5bedba41b5cfe03ed4483c4d68c22aaeb7fc1a39ea9692ef", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "8a591232d06b683068e57dede794e411bf064aff192241f87bb861712ee0a291"}}, "Ports": {}, "SandboxID": "37c6c6d7ecdd7a22eaad055b245944bfda48197dc8e659182c7a8e46df2c044c", "SandboxKey": "/var/run/docker/netns/37c6c6d7ecdd", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/05eced86dbfdc8fe4c725f1404407ef993a12d69be4a108abbc1c5165042f279/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 29981, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T23:56:44.078408826Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t8ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-05T23:56:43.217418124Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/ad23014a6fd06f239c55525b65d4a07739d15348e708506316cea53a36aa4b84-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/ad23014a6fd06f239c55525b65d4a07739d15348e708506316cea53a36aa4b84/merged", "UpperDir": "/var/lib/docker/overlay2/ad23014a6fd06f239c55525b65d4a07739d15348e708506316cea53a36aa4b84/diff", "WorkDir": "/var/lib/docker/overlay2/ad23014a6fd06f239c55525b65d4a07739d15348e708506316cea53a36aa4b84/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/05eced86dbfdc8fe4c725f1404407ef993a12d69be4a108abbc1c5165042f279/hostname", "HostsPath": "/var/lib/docker/containers/05eced86dbfdc8fe4c725f1404407ef993a12d69be4a108abbc1c5165042f279/hosts", "Id": "05eced86dbfdc8fe4c725f1404407ef993a12d69be4a108abbc1c5165042f279", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/05eced86dbfdc8fe4c725f1404407ef993a12d69be4a108abbc1c5165042f279/05eced86dbfdc8fe4c725f1404407ef993a12d69be4a108abbc1c5165042f279-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "46bd0a52b304b2ce3f528feb26fcb5f306d85cc74c7394dc1f0e4313d59e83d7", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/46bd0a52b304b2ce3f528feb26fcb5f306d85cc74c7394dc1f0e4313d59e83d7/_data", "Type": "volume"}], "Name": "/t8ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "1a760a000cd6112b5bedba41b5cfe03ed4483c4d68c22aaeb7fc1a39ea9692ef", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "1a760a000cd6112b5bedba41b5cfe03ed4483c4d68c22aaeb7fc1a39ea9692ef", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "8a591232d06b683068e57dede794e411bf064aff192241f87bb861712ee0a291"}}, "Ports": {}, "SandboxID": "37c6c6d7ecdd7a22eaad055b245944bfda48197dc8e659182c7a8e46df2c044c", "SandboxKey": "/var/run/docker/netns/37c6c6d7ecdd", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/05eced86dbfdc8fe4c725f1404407ef993a12d69be4a108abbc1c5165042f279/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 29981, "Restarting": false, "Running": true, "StartedAt": "2019-12-05T23:56:44.078408826Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t8br2", "default_route_ip": "10.2.72.1", "dns": [{"brif": "t8s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t8s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t8ns2", "route": [{"if": "p1", "ip": "10.2.72.1/24", "ns_if": "t8if", "ns_name": "t8"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t8ns2if", "tenant_ns_ip": "10.2.72.1/24", "tenant_ns_name": "t8", "tenant_sub_if": "t8s2if", "tenant_sub_ip": "10.2.72.2/24"}], "vms": [{"brif": "t8br2if1", "name": "t8_C4", "vmif": "t8C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 02:38:35.379057 Printing the yaml input file
INFO:root: 02:38:35.379282 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 02:38:35.379417 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 02:38:35.379471 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 02:38:35.379514 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.9.1', u'name': u't9', u'pns_ip': u'192.168.9.1/24', u'tenant_if': u't9if', u'tenant_ip': u'192.168.9.2/24', u'pns_if': u't9pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T02:38:37.424593804Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/e7cb4e94dcf89d0e6da05c2aa21310b4b6bb39a840b9e2c8cc04ff33d28186f1-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/e7cb4e94dcf89d0e6da05c2aa21310b4b6bb39a840b9e2c8cc04ff33d28186f1/merged", "UpperDir": "/var/lib/docker/overlay2/e7cb4e94dcf89d0e6da05c2aa21310b4b6bb39a840b9e2c8cc04ff33d28186f1/diff", "WorkDir": "/var/lib/docker/overlay2/e7cb4e94dcf89d0e6da05c2aa21310b4b6bb39a840b9e2c8cc04ff33d28186f1/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/1acea560c7feab3f17d5e02eb95f9bab2ed772ee5a80ab53be6e0d28aecb6c50/hostname", "HostsPath": "/var/lib/docker/containers/1acea560c7feab3f17d5e02eb95f9bab2ed772ee5a80ab53be6e0d28aecb6c50/hosts", "Id": "1acea560c7feab3f17d5e02eb95f9bab2ed772ee5a80ab53be6e0d28aecb6c50", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/1acea560c7feab3f17d5e02eb95f9bab2ed772ee5a80ab53be6e0d28aecb6c50/1acea560c7feab3f17d5e02eb95f9bab2ed772ee5a80ab53be6e0d28aecb6c50-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "b1b01f149220157577e6351dad3bab01af42208e6ee5793ef45482e825808223", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/b1b01f149220157577e6351dad3bab01af42208e6ee5793ef45482e825808223/_data", "Type": "volume"}], "Name": "/t9", "NetworkSettings": {"Bridge": "", "EndpointID": "b8a44b86965adc7194cedcb5f04a081f82b974c0e2dfea73dfeee6f9b906e65d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:09", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "b8a44b86965adc7194cedcb5f04a081f82b974c0e2dfea73dfeee6f9b906e65d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:09", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "d9926c573882bbf86ee4294aceb8f63ce223a1f2c86ea071b6f838b34fde76c7", "SandboxKey": "/var/run/docker/netns/d9926c573882", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/1acea560c7feab3f17d5e02eb95f9bab2ed772ee5a80ab53be6e0d28aecb6c50/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 979, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T02:38:38.20577793Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T02:38:37.424593804Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/e7cb4e94dcf89d0e6da05c2aa21310b4b6bb39a840b9e2c8cc04ff33d28186f1-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/e7cb4e94dcf89d0e6da05c2aa21310b4b6bb39a840b9e2c8cc04ff33d28186f1/merged", "UpperDir": "/var/lib/docker/overlay2/e7cb4e94dcf89d0e6da05c2aa21310b4b6bb39a840b9e2c8cc04ff33d28186f1/diff", "WorkDir": "/var/lib/docker/overlay2/e7cb4e94dcf89d0e6da05c2aa21310b4b6bb39a840b9e2c8cc04ff33d28186f1/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/1acea560c7feab3f17d5e02eb95f9bab2ed772ee5a80ab53be6e0d28aecb6c50/hostname", "HostsPath": "/var/lib/docker/containers/1acea560c7feab3f17d5e02eb95f9bab2ed772ee5a80ab53be6e0d28aecb6c50/hosts", "Id": "1acea560c7feab3f17d5e02eb95f9bab2ed772ee5a80ab53be6e0d28aecb6c50", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/1acea560c7feab3f17d5e02eb95f9bab2ed772ee5a80ab53be6e0d28aecb6c50/1acea560c7feab3f17d5e02eb95f9bab2ed772ee5a80ab53be6e0d28aecb6c50-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "b1b01f149220157577e6351dad3bab01af42208e6ee5793ef45482e825808223", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/b1b01f149220157577e6351dad3bab01af42208e6ee5793ef45482e825808223/_data", "Type": "volume"}], "Name": "/t9", "NetworkSettings": {"Bridge": "", "EndpointID": "b8a44b86965adc7194cedcb5f04a081f82b974c0e2dfea73dfeee6f9b906e65d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:09", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "b8a44b86965adc7194cedcb5f04a081f82b974c0e2dfea73dfeee6f9b906e65d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:09", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "d9926c573882bbf86ee4294aceb8f63ce223a1f2c86ea071b6f838b34fde76c7", "SandboxKey": "/var/run/docker/netns/d9926c573882", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/1acea560c7feab3f17d5e02eb95f9bab2ed772ee5a80ab53be6e0d28aecb6c50/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 979, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T02:38:38.20577793Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.9.1", "name": "t9", "pns_if": "t9pns_if", "pns_ip": "192.168.9.1/24", "tenant_if": "t9if", "tenant_ip": "192.168.9.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.81.1/24', u'ns_name': u't9', u'ns_if': u't9if', u'if': u'p1'}], u'default_route_ip': u'10.1.81.1', u'bridge_name': u't9br1', u'dns': [{u'dnsif': u't9s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't9s1_dnsbrif'}], u'ns_name': u't9ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.81.2/24', u'tenant_ns_ip': u'10.1.81.1/24', u'tenant_ns_if': u't9ns1if', u'tenant_ns_name': u't9', u'tenant_sub_if': u't9s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't9br1if1', u'vmif': u't9C1if1', u'name': u't9_C1'}, {u'brif': u't9br1if2', u'vmif': u't9C2if1', u'name': u't9_C2'}], u'vxlan': [{u'local_ip': u'10.1.81.2', u'tenant_route_ip': u'192.168.9.2', u'dsport': 4789, u'dev': u't9s1if', u'subnet_route': u'10.1.81.0/24', u'remote_route': u'10.2.81.0/24', u'v_name': u'vxlan_t9s1', u'id': 42, u'remote_ip': u'10.2.81.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t9ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T02:38:38.804173069Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/fd1a179a5a1bde8c95b01893e6321c06920656816e8bf3fd8f43419858464849-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/fd1a179a5a1bde8c95b01893e6321c06920656816e8bf3fd8f43419858464849/merged", "UpperDir": "/var/lib/docker/overlay2/fd1a179a5a1bde8c95b01893e6321c06920656816e8bf3fd8f43419858464849/diff", "WorkDir": "/var/lib/docker/overlay2/fd1a179a5a1bde8c95b01893e6321c06920656816e8bf3fd8f43419858464849/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c297a321ff1930dedc2c5a8bf9a8ebcf26be773ea45699dc3de18d18eafd297f/hostname", "HostsPath": "/var/lib/docker/containers/c297a321ff1930dedc2c5a8bf9a8ebcf26be773ea45699dc3de18d18eafd297f/hosts", "Id": "c297a321ff1930dedc2c5a8bf9a8ebcf26be773ea45699dc3de18d18eafd297f", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/c297a321ff1930dedc2c5a8bf9a8ebcf26be773ea45699dc3de18d18eafd297f/c297a321ff1930dedc2c5a8bf9a8ebcf26be773ea45699dc3de18d18eafd297f-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "516eb83c58d423d88be9e3fad4f99de8a06ce227aee12dc525662f3150852634", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/516eb83c58d423d88be9e3fad4f99de8a06ce227aee12dc525662f3150852634/_data", "Type": "volume"}], "Name": "/t9ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "5d0ef30ae18c92ffe66ec02083e45bcf49b24defb88a0ed4dad404c0b373c8db", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.10", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0a", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "5d0ef30ae18c92ffe66ec02083e45bcf49b24defb88a0ed4dad404c0b373c8db", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.10", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0a", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "f609ed4e08a038165e548a9200bbcaf12881c2f1d81688b892646e53ebf3c44c", "SandboxKey": "/var/run/docker/netns/f609ed4e08a0", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c297a321ff1930dedc2c5a8bf9a8ebcf26be773ea45699dc3de18d18eafd297f/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 2301, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T02:38:40.085284412Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t9ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T02:38:38.804173069Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/fd1a179a5a1bde8c95b01893e6321c06920656816e8bf3fd8f43419858464849-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/fd1a179a5a1bde8c95b01893e6321c06920656816e8bf3fd8f43419858464849/merged", "UpperDir": "/var/lib/docker/overlay2/fd1a179a5a1bde8c95b01893e6321c06920656816e8bf3fd8f43419858464849/diff", "WorkDir": "/var/lib/docker/overlay2/fd1a179a5a1bde8c95b01893e6321c06920656816e8bf3fd8f43419858464849/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c297a321ff1930dedc2c5a8bf9a8ebcf26be773ea45699dc3de18d18eafd297f/hostname", "HostsPath": "/var/lib/docker/containers/c297a321ff1930dedc2c5a8bf9a8ebcf26be773ea45699dc3de18d18eafd297f/hosts", "Id": "c297a321ff1930dedc2c5a8bf9a8ebcf26be773ea45699dc3de18d18eafd297f", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/c297a321ff1930dedc2c5a8bf9a8ebcf26be773ea45699dc3de18d18eafd297f/c297a321ff1930dedc2c5a8bf9a8ebcf26be773ea45699dc3de18d18eafd297f-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "516eb83c58d423d88be9e3fad4f99de8a06ce227aee12dc525662f3150852634", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/516eb83c58d423d88be9e3fad4f99de8a06ce227aee12dc525662f3150852634/_data", "Type": "volume"}], "Name": "/t9ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "5d0ef30ae18c92ffe66ec02083e45bcf49b24defb88a0ed4dad404c0b373c8db", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.10", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0a", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "5d0ef30ae18c92ffe66ec02083e45bcf49b24defb88a0ed4dad404c0b373c8db", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.10", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0a", "NetworkID": "f0c50c477d981d810d879f3d1a19be5a50816ebca30338f3fa5eb1e09ae7acb5"}}, "Ports": {}, "SandboxID": "f609ed4e08a038165e548a9200bbcaf12881c2f1d81688b892646e53ebf3c44c", "SandboxKey": "/var/run/docker/netns/f609ed4e08a0", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c297a321ff1930dedc2c5a8bf9a8ebcf26be773ea45699dc3de18d18eafd297f/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 2301, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T02:38:40.085284412Z", "Status": "running"}}, "item": {"bridge_name": "t9br1", "default_route_ip": "10.1.81.1", "dns": [{"brif": "t9s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t9s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t9ns1", "route": [{"if": "p1", "ip": "10.1.81.1/24", "ns_if": "t9if", "ns_name": "t9"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t9ns1if", "tenant_ns_ip": "10.1.81.1/24", "tenant_ns_name": "t9", "tenant_sub_if": "t9s1if", "tenant_sub_ip": "10.1.81.2/24"}], "vms": [{"brif": "t9br1if1", "name": "t9_C1", "vmif": "t9C1if1"}, {"brif": "t9br1if2", "name": "t9_C2", "vmif": "t9C2if1"}], "vxlan": [{"dev": "t9s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.81.2", "remote_ip": "10.2.81.2", "remote_route": "10.2.81.0/24", "subnet_route": "10.1.81.0/24", "tenant_route_ip": "192.168.9.2", "v_name": "vxlan_t9s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.137.1', u'name': u't9', u'pns_ip': u'192.168.137.1/24', u'tenant_if': u't9if', u'tenant_ip': u'192.168.137.2/24', u'pns_if': u't9pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T02:38:44.03275965Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/dde2264b653f8a7312db305a1574eb110a02ed9334294e6580833f6550543dea-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/dde2264b653f8a7312db305a1574eb110a02ed9334294e6580833f6550543dea/merged", "UpperDir": "/var/lib/docker/overlay2/dde2264b653f8a7312db305a1574eb110a02ed9334294e6580833f6550543dea/diff", "WorkDir": "/var/lib/docker/overlay2/dde2264b653f8a7312db305a1574eb110a02ed9334294e6580833f6550543dea/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/1232dbef2d6b7b02a0cda2651e6cb2a0dcba51bced4578e4703e45eab0833ea3/hostname", "HostsPath": "/var/lib/docker/containers/1232dbef2d6b7b02a0cda2651e6cb2a0dcba51bced4578e4703e45eab0833ea3/hosts", "Id": "1232dbef2d6b7b02a0cda2651e6cb2a0dcba51bced4578e4703e45eab0833ea3", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/1232dbef2d6b7b02a0cda2651e6cb2a0dcba51bced4578e4703e45eab0833ea3/1232dbef2d6b7b02a0cda2651e6cb2a0dcba51bced4578e4703e45eab0833ea3-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "edf44707256d8bbc60a3a8225bd9ac441f327c790724103a80e5cf9089babcfe", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/edf44707256d8bbc60a3a8225bd9ac441f327c790724103a80e5cf9089babcfe/_data", "Type": "volume"}], "Name": "/t9", "NetworkSettings": {"Bridge": "", "EndpointID": "132171e4cf3fa30f935c3d2abe1bc5400c3022f3356a60f0f75065b46bb3251b", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "132171e4cf3fa30f935c3d2abe1bc5400c3022f3356a60f0f75065b46bb3251b", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "8a591232d06b683068e57dede794e411bf064aff192241f87bb861712ee0a291"}}, "Ports": {}, "SandboxID": "02296c876111bb06ada014b64d0fdc281f47e8d3fe470339c5d4d524ad599a48", "SandboxKey": "/var/run/docker/netns/02296c876111", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/1232dbef2d6b7b02a0cda2651e6cb2a0dcba51bced4578e4703e45eab0833ea3/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 3482, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T02:38:44.665513356Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T02:38:44.03275965Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/dde2264b653f8a7312db305a1574eb110a02ed9334294e6580833f6550543dea-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/dde2264b653f8a7312db305a1574eb110a02ed9334294e6580833f6550543dea/merged", "UpperDir": "/var/lib/docker/overlay2/dde2264b653f8a7312db305a1574eb110a02ed9334294e6580833f6550543dea/diff", "WorkDir": "/var/lib/docker/overlay2/dde2264b653f8a7312db305a1574eb110a02ed9334294e6580833f6550543dea/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/1232dbef2d6b7b02a0cda2651e6cb2a0dcba51bced4578e4703e45eab0833ea3/hostname", "HostsPath": "/var/lib/docker/containers/1232dbef2d6b7b02a0cda2651e6cb2a0dcba51bced4578e4703e45eab0833ea3/hosts", "Id": "1232dbef2d6b7b02a0cda2651e6cb2a0dcba51bced4578e4703e45eab0833ea3", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/1232dbef2d6b7b02a0cda2651e6cb2a0dcba51bced4578e4703e45eab0833ea3/1232dbef2d6b7b02a0cda2651e6cb2a0dcba51bced4578e4703e45eab0833ea3-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "edf44707256d8bbc60a3a8225bd9ac441f327c790724103a80e5cf9089babcfe", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/edf44707256d8bbc60a3a8225bd9ac441f327c790724103a80e5cf9089babcfe/_data", "Type": "volume"}], "Name": "/t9", "NetworkSettings": {"Bridge": "", "EndpointID": "132171e4cf3fa30f935c3d2abe1bc5400c3022f3356a60f0f75065b46bb3251b", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "132171e4cf3fa30f935c3d2abe1bc5400c3022f3356a60f0f75065b46bb3251b", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "8a591232d06b683068e57dede794e411bf064aff192241f87bb861712ee0a291"}}, "Ports": {}, "SandboxID": "02296c876111bb06ada014b64d0fdc281f47e8d3fe470339c5d4d524ad599a48", "SandboxKey": "/var/run/docker/netns/02296c876111", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/1232dbef2d6b7b02a0cda2651e6cb2a0dcba51bced4578e4703e45eab0833ea3/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 3482, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T02:38:44.665513356Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.137.1", "name": "t9", "pns_if": "t9pns_if", "pns_ip": "192.168.137.1/24", "tenant_if": "t9if", "tenant_ip": "192.168.137.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.81.1/24', u'ns_name': u't9', u'ns_if': u't9if', u'if': u'p1'}], u'default_route_ip': u'10.2.81.1', u'bridge_name': u't9br1', u'dns': [{u'dnsif': u't9s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't9s1_dnsbrif'}], u'ns_name': u't9ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.81.2/24', u'tenant_ns_ip': u'10.2.81.1/24', u'tenant_ns_if': u't9ns1if', u'tenant_ns_name': u't9', u'tenant_sub_if': u't9s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't9br1if1', u'vmif': u't9C3if1', u'name': u't9_C3'}], u'vxlan': [{u'local_ip': u'10.2.81.2', u'tenant_route_ip': u'192.168.137.2', u'dsport': 4789, u'dev': u't9s1if', u'subnet_route': u'10.2.81.0/24', u'remote_route': u'10.1.81.0/24', u'v_name': u'vxlan_t9s1', u'id': 42, u'remote_ip': u'10.1.81.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t9ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T02:38:45.453582003Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/43942147fb477d8923f6fb89af8bfdf1d7204f3687230f1c6256c4545d26551f-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/43942147fb477d8923f6fb89af8bfdf1d7204f3687230f1c6256c4545d26551f/merged", "UpperDir": "/var/lib/docker/overlay2/43942147fb477d8923f6fb89af8bfdf1d7204f3687230f1c6256c4545d26551f/diff", "WorkDir": "/var/lib/docker/overlay2/43942147fb477d8923f6fb89af8bfdf1d7204f3687230f1c6256c4545d26551f/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/34aee32b2a8211612ebea27c2b0ff7bc5983b4ff262e403155dd1dce70176522/hostname", "HostsPath": "/var/lib/docker/containers/34aee32b2a8211612ebea27c2b0ff7bc5983b4ff262e403155dd1dce70176522/hosts", "Id": "34aee32b2a8211612ebea27c2b0ff7bc5983b4ff262e403155dd1dce70176522", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/34aee32b2a8211612ebea27c2b0ff7bc5983b4ff262e403155dd1dce70176522/34aee32b2a8211612ebea27c2b0ff7bc5983b4ff262e403155dd1dce70176522-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "d7204ddc78cfde3dd9ad492df3448b65ce21b0c5b99087d842fc918747f278a6", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/d7204ddc78cfde3dd9ad492df3448b65ce21b0c5b99087d842fc918747f278a6/_data", "Type": "volume"}], "Name": "/t9ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "1027dde026d4b771fab0d902e55a18b8c27cae6b90c36a85f2940cf0c7fb2689", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:06", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "1027dde026d4b771fab0d902e55a18b8c27cae6b90c36a85f2940cf0c7fb2689", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:06", "NetworkID": "8a591232d06b683068e57dede794e411bf064aff192241f87bb861712ee0a291"}}, "Ports": {}, "SandboxID": "dab8cc2db00b893713705cd5ef45ef8925ff857f7848496427b9ccf1dcb6e8e1", "SandboxKey": "/var/run/docker/netns/dab8cc2db00b", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/34aee32b2a8211612ebea27c2b0ff7bc5983b4ff262e403155dd1dce70176522/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4469, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T02:38:46.531161554Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t9ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T02:38:45.453582003Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/43942147fb477d8923f6fb89af8bfdf1d7204f3687230f1c6256c4545d26551f-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/43942147fb477d8923f6fb89af8bfdf1d7204f3687230f1c6256c4545d26551f/merged", "UpperDir": "/var/lib/docker/overlay2/43942147fb477d8923f6fb89af8bfdf1d7204f3687230f1c6256c4545d26551f/diff", "WorkDir": "/var/lib/docker/overlay2/43942147fb477d8923f6fb89af8bfdf1d7204f3687230f1c6256c4545d26551f/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/34aee32b2a8211612ebea27c2b0ff7bc5983b4ff262e403155dd1dce70176522/hostname", "HostsPath": "/var/lib/docker/containers/34aee32b2a8211612ebea27c2b0ff7bc5983b4ff262e403155dd1dce70176522/hosts", "Id": "34aee32b2a8211612ebea27c2b0ff7bc5983b4ff262e403155dd1dce70176522", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/34aee32b2a8211612ebea27c2b0ff7bc5983b4ff262e403155dd1dce70176522/34aee32b2a8211612ebea27c2b0ff7bc5983b4ff262e403155dd1dce70176522-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "d7204ddc78cfde3dd9ad492df3448b65ce21b0c5b99087d842fc918747f278a6", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/d7204ddc78cfde3dd9ad492df3448b65ce21b0c5b99087d842fc918747f278a6/_data", "Type": "volume"}], "Name": "/t9ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "1027dde026d4b771fab0d902e55a18b8c27cae6b90c36a85f2940cf0c7fb2689", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:06", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "1027dde026d4b771fab0d902e55a18b8c27cae6b90c36a85f2940cf0c7fb2689", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:06", "NetworkID": "8a591232d06b683068e57dede794e411bf064aff192241f87bb861712ee0a291"}}, "Ports": {}, "SandboxID": "dab8cc2db00b893713705cd5ef45ef8925ff857f7848496427b9ccf1dcb6e8e1", "SandboxKey": "/var/run/docker/netns/dab8cc2db00b", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/34aee32b2a8211612ebea27c2b0ff7bc5983b4ff262e403155dd1dce70176522/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4469, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T02:38:46.531161554Z", "Status": "running"}}, "item": {"bridge_name": "t9br1", "default_route_ip": "10.2.81.1", "dns": [{"brif": "t9s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t9s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t9ns1", "route": [{"if": "p1", "ip": "10.2.81.1/24", "ns_if": "t9if", "ns_name": "t9"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t9ns1if", "tenant_ns_ip": "10.2.81.1/24", "tenant_ns_name": "t9", "tenant_sub_if": "t9s1if", "tenant_sub_ip": "10.2.81.2/24"}], "vms": [{"brif": "t9br1if1", "name": "t9_C3", "vmif": "t9C3if1"}], "vxlan": [{"dev": "t9s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.81.2", "remote_ip": "10.1.81.2", "remote_route": "10.1.81.0/24", "subnet_route": "10.2.81.0/24", "tenant_route_ip": "192.168.137.2", "v_name": "vxlan_t9s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.82.1/24', u'ns_name': u't9', u'ns_if': u't9if', u'if': u'p1'}], u'default_route_ip': u'10.2.82.1', u'bridge_name': u't9br2', u'dns': [{u'dnsif': u't9s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't9s2_dnsbrif'}], u'ns_name': u't9ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.82.2/24', u'tenant_ns_ip': u'10.2.82.1/24', u'tenant_ns_if': u't9ns2if', u'tenant_ns_name': u't9', u'tenant_sub_if': u't9s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't9br2if1', u'vmif': u't9C4if1', u'name': u't9_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t9ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T02:38:47.339102908Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/21f3b5cc11b1b623768948fd2470b44d6afbb56db55f7bf3c2541e8fb2e8d420-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/21f3b5cc11b1b623768948fd2470b44d6afbb56db55f7bf3c2541e8fb2e8d420/merged", "UpperDir": "/var/lib/docker/overlay2/21f3b5cc11b1b623768948fd2470b44d6afbb56db55f7bf3c2541e8fb2e8d420/diff", "WorkDir": "/var/lib/docker/overlay2/21f3b5cc11b1b623768948fd2470b44d6afbb56db55f7bf3c2541e8fb2e8d420/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/d8b6a26715099d21fec95a5245dfb1664662bda4bb7568506c85597a248b5a9a/hostname", "HostsPath": "/var/lib/docker/containers/d8b6a26715099d21fec95a5245dfb1664662bda4bb7568506c85597a248b5a9a/hosts", "Id": "d8b6a26715099d21fec95a5245dfb1664662bda4bb7568506c85597a248b5a9a", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/d8b6a26715099d21fec95a5245dfb1664662bda4bb7568506c85597a248b5a9a/d8b6a26715099d21fec95a5245dfb1664662bda4bb7568506c85597a248b5a9a-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "985758129d73987f4ec5075d1e0265f19f01ca7e61ef5c9ecd7d1ec9b563cf44", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/985758129d73987f4ec5075d1e0265f19f01ca7e61ef5c9ecd7d1ec9b563cf44/_data", "Type": "volume"}], "Name": "/t9ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "8e62d251ee44b806f6df036ae78d2e78300d59ca76fb3a74871b0390c052f37f", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:07", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "8e62d251ee44b806f6df036ae78d2e78300d59ca76fb3a74871b0390c052f37f", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:07", "NetworkID": "8a591232d06b683068e57dede794e411bf064aff192241f87bb861712ee0a291"}}, "Ports": {}, "SandboxID": "923e56247d86bc4c419b57ada9a35415165502be4047f4faaa490b744e046ce3", "SandboxKey": "/var/run/docker/netns/923e56247d86", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/d8b6a26715099d21fec95a5245dfb1664662bda4bb7568506c85597a248b5a9a/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 6731, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T02:38:48.375923855Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t9ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T02:38:47.339102908Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/21f3b5cc11b1b623768948fd2470b44d6afbb56db55f7bf3c2541e8fb2e8d420-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/21f3b5cc11b1b623768948fd2470b44d6afbb56db55f7bf3c2541e8fb2e8d420/merged", "UpperDir": "/var/lib/docker/overlay2/21f3b5cc11b1b623768948fd2470b44d6afbb56db55f7bf3c2541e8fb2e8d420/diff", "WorkDir": "/var/lib/docker/overlay2/21f3b5cc11b1b623768948fd2470b44d6afbb56db55f7bf3c2541e8fb2e8d420/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/d8b6a26715099d21fec95a5245dfb1664662bda4bb7568506c85597a248b5a9a/hostname", "HostsPath": "/var/lib/docker/containers/d8b6a26715099d21fec95a5245dfb1664662bda4bb7568506c85597a248b5a9a/hosts", "Id": "d8b6a26715099d21fec95a5245dfb1664662bda4bb7568506c85597a248b5a9a", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/d8b6a26715099d21fec95a5245dfb1664662bda4bb7568506c85597a248b5a9a/d8b6a26715099d21fec95a5245dfb1664662bda4bb7568506c85597a248b5a9a-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "985758129d73987f4ec5075d1e0265f19f01ca7e61ef5c9ecd7d1ec9b563cf44", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/985758129d73987f4ec5075d1e0265f19f01ca7e61ef5c9ecd7d1ec9b563cf44/_data", "Type": "volume"}], "Name": "/t9ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "8e62d251ee44b806f6df036ae78d2e78300d59ca76fb3a74871b0390c052f37f", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:07", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "8e62d251ee44b806f6df036ae78d2e78300d59ca76fb3a74871b0390c052f37f", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:07", "NetworkID": "8a591232d06b683068e57dede794e411bf064aff192241f87bb861712ee0a291"}}, "Ports": {}, "SandboxID": "923e56247d86bc4c419b57ada9a35415165502be4047f4faaa490b744e046ce3", "SandboxKey": "/var/run/docker/netns/923e56247d86", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/d8b6a26715099d21fec95a5245dfb1664662bda4bb7568506c85597a248b5a9a/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 6731, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T02:38:48.375923855Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t9br2", "default_route_ip": "10.2.82.1", "dns": [{"brif": "t9s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t9s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t9ns2", "route": [{"if": "p1", "ip": "10.2.82.1/24", "ns_if": "t9if", "ns_name": "t9"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t9ns2if", "tenant_ns_ip": "10.2.82.1/24", "tenant_ns_name": "t9", "tenant_sub_if": "t9s2if", "tenant_sub_ip": "10.2.82.2/24"}], "vms": [{"brif": "t9br2if1", "name": "t9_C4", "vmif": "t9C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 03:16:52.345455 Printing the yaml input file
INFO:root: 03:16:52.346301 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 03:16:52.346460 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 03:16:52.346516 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 03:16:52.346559 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:16:54.726484035Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/0d91b4f86b40353d55491ac5ec27bd60f9c5e9baa5841d7a1c6ac8da49d0f438-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/0d91b4f86b40353d55491ac5ec27bd60f9c5e9baa5841d7a1c6ac8da49d0f438/merged", "UpperDir": "/var/lib/docker/overlay2/0d91b4f86b40353d55491ac5ec27bd60f9c5e9baa5841d7a1c6ac8da49d0f438/diff", "WorkDir": "/var/lib/docker/overlay2/0d91b4f86b40353d55491ac5ec27bd60f9c5e9baa5841d7a1c6ac8da49d0f438/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/3eb4eb40ecf22ad6135eed9b37f6eb9ae21425de5589e337354cbf6359a2b691/hostname", "HostsPath": "/var/lib/docker/containers/3eb4eb40ecf22ad6135eed9b37f6eb9ae21425de5589e337354cbf6359a2b691/hosts", "Id": "3eb4eb40ecf22ad6135eed9b37f6eb9ae21425de5589e337354cbf6359a2b691", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/3eb4eb40ecf22ad6135eed9b37f6eb9ae21425de5589e337354cbf6359a2b691/3eb4eb40ecf22ad6135eed9b37f6eb9ae21425de5589e337354cbf6359a2b691-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "d038cbfb4826a4c83ed932067fca4b0844f509eeb7554306295eb1c6406d5f57", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/d038cbfb4826a4c83ed932067fca4b0844f509eeb7554306295eb1c6406d5f57/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "aafc7c5f08ed6435f2299018d7bbaafdfb6ee19449872f002565cbd191f9b1c1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "aafc7c5f08ed6435f2299018d7bbaafdfb6ee19449872f002565cbd191f9b1c1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "6aac317424a4aae4fd56aa7fc6a2505d7c5e576ed1615d8e72a35034eb489a2d", "SandboxKey": "/var/run/docker/netns/6aac317424a4", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/3eb4eb40ecf22ad6135eed9b37f6eb9ae21425de5589e337354cbf6359a2b691/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4339, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:16:55.565967311Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:16:54.726484035Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/0d91b4f86b40353d55491ac5ec27bd60f9c5e9baa5841d7a1c6ac8da49d0f438-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/0d91b4f86b40353d55491ac5ec27bd60f9c5e9baa5841d7a1c6ac8da49d0f438/merged", "UpperDir": "/var/lib/docker/overlay2/0d91b4f86b40353d55491ac5ec27bd60f9c5e9baa5841d7a1c6ac8da49d0f438/diff", "WorkDir": "/var/lib/docker/overlay2/0d91b4f86b40353d55491ac5ec27bd60f9c5e9baa5841d7a1c6ac8da49d0f438/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/3eb4eb40ecf22ad6135eed9b37f6eb9ae21425de5589e337354cbf6359a2b691/hostname", "HostsPath": "/var/lib/docker/containers/3eb4eb40ecf22ad6135eed9b37f6eb9ae21425de5589e337354cbf6359a2b691/hosts", "Id": "3eb4eb40ecf22ad6135eed9b37f6eb9ae21425de5589e337354cbf6359a2b691", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/3eb4eb40ecf22ad6135eed9b37f6eb9ae21425de5589e337354cbf6359a2b691/3eb4eb40ecf22ad6135eed9b37f6eb9ae21425de5589e337354cbf6359a2b691-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "d038cbfb4826a4c83ed932067fca4b0844f509eeb7554306295eb1c6406d5f57", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/d038cbfb4826a4c83ed932067fca4b0844f509eeb7554306295eb1c6406d5f57/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "aafc7c5f08ed6435f2299018d7bbaafdfb6ee19449872f002565cbd191f9b1c1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "aafc7c5f08ed6435f2299018d7bbaafdfb6ee19449872f002565cbd191f9b1c1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "6aac317424a4aae4fd56aa7fc6a2505d7c5e576ed1615d8e72a35034eb489a2d", "SandboxKey": "/var/run/docker/netns/6aac317424a4", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/3eb4eb40ecf22ad6135eed9b37f6eb9ae21425de5589e337354cbf6359a2b691/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4339, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:16:55.565967311Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'tenant_route_ip': u'192.168.2.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.1.11.0/24', u'remote_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:16:56.039303484Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/49b7f2c5dc14f3e5f9235e5efec10cf2e17ae46f3c078730db332920fc0d9bc4-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/49b7f2c5dc14f3e5f9235e5efec10cf2e17ae46f3c078730db332920fc0d9bc4/merged", "UpperDir": "/var/lib/docker/overlay2/49b7f2c5dc14f3e5f9235e5efec10cf2e17ae46f3c078730db332920fc0d9bc4/diff", "WorkDir": "/var/lib/docker/overlay2/49b7f2c5dc14f3e5f9235e5efec10cf2e17ae46f3c078730db332920fc0d9bc4/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/a6870cfd68f8119ef1ec4cbc14e38274d86a670d58d1024e070381c56c3b79b4/hostname", "HostsPath": "/var/lib/docker/containers/a6870cfd68f8119ef1ec4cbc14e38274d86a670d58d1024e070381c56c3b79b4/hosts", "Id": "a6870cfd68f8119ef1ec4cbc14e38274d86a670d58d1024e070381c56c3b79b4", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/a6870cfd68f8119ef1ec4cbc14e38274d86a670d58d1024e070381c56c3b79b4/a6870cfd68f8119ef1ec4cbc14e38274d86a670d58d1024e070381c56c3b79b4-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ae2e433392eea3c355dbe8a67291821e47e9e41ee95eef95f8fb838442aee2c2", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ae2e433392eea3c355dbe8a67291821e47e9e41ee95eef95f8fb838442aee2c2/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "c852117d260dcc61e19a119daa7f14881888e02872521d74fe4e8987fd1fd087", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "c852117d260dcc61e19a119daa7f14881888e02872521d74fe4e8987fd1fd087", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "a4a6133e90dd9f9dd7312a635c3267e2a5c56ab64b6e930d03e8d75d7f79be4f", "SandboxKey": "/var/run/docker/netns/a4a6133e90dd", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/a6870cfd68f8119ef1ec4cbc14e38274d86a670d58d1024e070381c56c3b79b4/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4905, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:16:56.833573755Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:16:56.039303484Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/49b7f2c5dc14f3e5f9235e5efec10cf2e17ae46f3c078730db332920fc0d9bc4-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/49b7f2c5dc14f3e5f9235e5efec10cf2e17ae46f3c078730db332920fc0d9bc4/merged", "UpperDir": "/var/lib/docker/overlay2/49b7f2c5dc14f3e5f9235e5efec10cf2e17ae46f3c078730db332920fc0d9bc4/diff", "WorkDir": "/var/lib/docker/overlay2/49b7f2c5dc14f3e5f9235e5efec10cf2e17ae46f3c078730db332920fc0d9bc4/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/a6870cfd68f8119ef1ec4cbc14e38274d86a670d58d1024e070381c56c3b79b4/hostname", "HostsPath": "/var/lib/docker/containers/a6870cfd68f8119ef1ec4cbc14e38274d86a670d58d1024e070381c56c3b79b4/hosts", "Id": "a6870cfd68f8119ef1ec4cbc14e38274d86a670d58d1024e070381c56c3b79b4", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/a6870cfd68f8119ef1ec4cbc14e38274d86a670d58d1024e070381c56c3b79b4/a6870cfd68f8119ef1ec4cbc14e38274d86a670d58d1024e070381c56c3b79b4-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ae2e433392eea3c355dbe8a67291821e47e9e41ee95eef95f8fb838442aee2c2", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ae2e433392eea3c355dbe8a67291821e47e9e41ee95eef95f8fb838442aee2c2/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "c852117d260dcc61e19a119daa7f14881888e02872521d74fe4e8987fd1fd087", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "c852117d260dcc61e19a119daa7f14881888e02872521d74fe4e8987fd1fd087", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "a4a6133e90dd9f9dd7312a635c3267e2a5c56ab64b6e930d03e8d75d7f79be4f", "SandboxKey": "/var/run/docker/netns/a4a6133e90dd", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/a6870cfd68f8119ef1ec4cbc14e38274d86a670d58d1024e070381c56c3b79b4/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4905, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:16:56.833573755Z", "Status": "running"}}, "item": {"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:17:01.262378144Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/8b7d6a6cb3b61fbaabf6f9689bdefd140affa4bae4dbc16d20aa3a48f5f58710-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/8b7d6a6cb3b61fbaabf6f9689bdefd140affa4bae4dbc16d20aa3a48f5f58710/merged", "UpperDir": "/var/lib/docker/overlay2/8b7d6a6cb3b61fbaabf6f9689bdefd140affa4bae4dbc16d20aa3a48f5f58710/diff", "WorkDir": "/var/lib/docker/overlay2/8b7d6a6cb3b61fbaabf6f9689bdefd140affa4bae4dbc16d20aa3a48f5f58710/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/f4df67e0d80fea79b307cc2b456c164feaebd9cccb8bd08f55f7d0256dc8fd37/hostname", "HostsPath": "/var/lib/docker/containers/f4df67e0d80fea79b307cc2b456c164feaebd9cccb8bd08f55f7d0256dc8fd37/hosts", "Id": "f4df67e0d80fea79b307cc2b456c164feaebd9cccb8bd08f55f7d0256dc8fd37", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/f4df67e0d80fea79b307cc2b456c164feaebd9cccb8bd08f55f7d0256dc8fd37/f4df67e0d80fea79b307cc2b456c164feaebd9cccb8bd08f55f7d0256dc8fd37-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "6f2f40f46f6f0085a7d464b2d936050a67ba65ce7a5a0d89ec3995fb7b9e5923", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/6f2f40f46f6f0085a7d464b2d936050a67ba65ce7a5a0d89ec3995fb7b9e5923/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "ec2bb12d25889c431b73fd795c6c49d4cc2986d7b6b3877cee4667edd6f2d41d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "ec2bb12d25889c431b73fd795c6c49d4cc2986d7b6b3877cee4667edd6f2d41d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "d81d1fc84c247f7877644ab388673b4dad66b9ac7eba24f305af73e89ce8ac10", "SandboxKey": "/var/run/docker/netns/d81d1fc84c24", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/f4df67e0d80fea79b307cc2b456c164feaebd9cccb8bd08f55f7d0256dc8fd37/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 3861, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:17:02.131759851Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:17:01.262378144Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/8b7d6a6cb3b61fbaabf6f9689bdefd140affa4bae4dbc16d20aa3a48f5f58710-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/8b7d6a6cb3b61fbaabf6f9689bdefd140affa4bae4dbc16d20aa3a48f5f58710/merged", "UpperDir": "/var/lib/docker/overlay2/8b7d6a6cb3b61fbaabf6f9689bdefd140affa4bae4dbc16d20aa3a48f5f58710/diff", "WorkDir": "/var/lib/docker/overlay2/8b7d6a6cb3b61fbaabf6f9689bdefd140affa4bae4dbc16d20aa3a48f5f58710/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/f4df67e0d80fea79b307cc2b456c164feaebd9cccb8bd08f55f7d0256dc8fd37/hostname", "HostsPath": "/var/lib/docker/containers/f4df67e0d80fea79b307cc2b456c164feaebd9cccb8bd08f55f7d0256dc8fd37/hosts", "Id": "f4df67e0d80fea79b307cc2b456c164feaebd9cccb8bd08f55f7d0256dc8fd37", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/f4df67e0d80fea79b307cc2b456c164feaebd9cccb8bd08f55f7d0256dc8fd37/f4df67e0d80fea79b307cc2b456c164feaebd9cccb8bd08f55f7d0256dc8fd37-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "6f2f40f46f6f0085a7d464b2d936050a67ba65ce7a5a0d89ec3995fb7b9e5923", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/6f2f40f46f6f0085a7d464b2d936050a67ba65ce7a5a0d89ec3995fb7b9e5923/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "ec2bb12d25889c431b73fd795c6c49d4cc2986d7b6b3877cee4667edd6f2d41d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "ec2bb12d25889c431b73fd795c6c49d4cc2986d7b6b3877cee4667edd6f2d41d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "d81d1fc84c247f7877644ab388673b4dad66b9ac7eba24f305af73e89ce8ac10", "SandboxKey": "/var/run/docker/netns/d81d1fc84c24", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/f4df67e0d80fea79b307cc2b456c164feaebd9cccb8bd08f55f7d0256dc8fd37/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 3861, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:17:02.131759851Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'tenant_route_ip': u'192.168.130.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.2.11.0/24', u'remote_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:17:02.735396Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/f09e31dd732d125ce215f05af583e7a083628a1215a6b95eb66b05b18f6da8d4-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/f09e31dd732d125ce215f05af583e7a083628a1215a6b95eb66b05b18f6da8d4/merged", "UpperDir": "/var/lib/docker/overlay2/f09e31dd732d125ce215f05af583e7a083628a1215a6b95eb66b05b18f6da8d4/diff", "WorkDir": "/var/lib/docker/overlay2/f09e31dd732d125ce215f05af583e7a083628a1215a6b95eb66b05b18f6da8d4/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/54b40b751aeedea745c426f75c749fbd8db8c8317f00488cd157348222a9ab8e/hostname", "HostsPath": "/var/lib/docker/containers/54b40b751aeedea745c426f75c749fbd8db8c8317f00488cd157348222a9ab8e/hosts", "Id": "54b40b751aeedea745c426f75c749fbd8db8c8317f00488cd157348222a9ab8e", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/54b40b751aeedea745c426f75c749fbd8db8c8317f00488cd157348222a9ab8e/54b40b751aeedea745c426f75c749fbd8db8c8317f00488cd157348222a9ab8e-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "bae1e949c5c502ced48fd7313514cdc243cc648e9572e7040e8e820e2e74a3e4", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/bae1e949c5c502ced48fd7313514cdc243cc648e9572e7040e8e820e2e74a3e4/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "1950c98bc1c44e991ad558f18378ab446e3b0b492c1883615de120dc64f224b6", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "1950c98bc1c44e991ad558f18378ab446e3b0b492c1883615de120dc64f224b6", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "097fdbbedff590b16e51593009a2b32bf341c3d855c2c8cfc7fac09221809849", "SandboxKey": "/var/run/docker/netns/097fdbbedff5", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/54b40b751aeedea745c426f75c749fbd8db8c8317f00488cd157348222a9ab8e/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4469, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:17:03.48388866Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:17:02.735396Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/f09e31dd732d125ce215f05af583e7a083628a1215a6b95eb66b05b18f6da8d4-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/f09e31dd732d125ce215f05af583e7a083628a1215a6b95eb66b05b18f6da8d4/merged", "UpperDir": "/var/lib/docker/overlay2/f09e31dd732d125ce215f05af583e7a083628a1215a6b95eb66b05b18f6da8d4/diff", "WorkDir": "/var/lib/docker/overlay2/f09e31dd732d125ce215f05af583e7a083628a1215a6b95eb66b05b18f6da8d4/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/54b40b751aeedea745c426f75c749fbd8db8c8317f00488cd157348222a9ab8e/hostname", "HostsPath": "/var/lib/docker/containers/54b40b751aeedea745c426f75c749fbd8db8c8317f00488cd157348222a9ab8e/hosts", "Id": "54b40b751aeedea745c426f75c749fbd8db8c8317f00488cd157348222a9ab8e", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/54b40b751aeedea745c426f75c749fbd8db8c8317f00488cd157348222a9ab8e/54b40b751aeedea745c426f75c749fbd8db8c8317f00488cd157348222a9ab8e-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "bae1e949c5c502ced48fd7313514cdc243cc648e9572e7040e8e820e2e74a3e4", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/bae1e949c5c502ced48fd7313514cdc243cc648e9572e7040e8e820e2e74a3e4/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "1950c98bc1c44e991ad558f18378ab446e3b0b492c1883615de120dc64f224b6", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "1950c98bc1c44e991ad558f18378ab446e3b0b492c1883615de120dc64f224b6", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "097fdbbedff590b16e51593009a2b32bf341c3d855c2c8cfc7fac09221809849", "SandboxKey": "/var/run/docker/netns/097fdbbedff5", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/54b40b751aeedea745c426f75c749fbd8db8c8317f00488cd157348222a9ab8e/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4469, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:17:03.48388866Z", "Status": "running"}}, "item": {"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:17:04.296748885Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/64731974dd1717bc0e0a2bc133aea30af11801502d04b09532d73c5c49b1f440-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/64731974dd1717bc0e0a2bc133aea30af11801502d04b09532d73c5c49b1f440/merged", "UpperDir": "/var/lib/docker/overlay2/64731974dd1717bc0e0a2bc133aea30af11801502d04b09532d73c5c49b1f440/diff", "WorkDir": "/var/lib/docker/overlay2/64731974dd1717bc0e0a2bc133aea30af11801502d04b09532d73c5c49b1f440/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/ac6b95dd6da6d1c3877e86ae95ad4fc467bb56b1ccffc9406cc1daf938c1ae91/hostname", "HostsPath": "/var/lib/docker/containers/ac6b95dd6da6d1c3877e86ae95ad4fc467bb56b1ccffc9406cc1daf938c1ae91/hosts", "Id": "ac6b95dd6da6d1c3877e86ae95ad4fc467bb56b1ccffc9406cc1daf938c1ae91", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/ac6b95dd6da6d1c3877e86ae95ad4fc467bb56b1ccffc9406cc1daf938c1ae91/ac6b95dd6da6d1c3877e86ae95ad4fc467bb56b1ccffc9406cc1daf938c1ae91-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "1359c87cb2045d13c14209bfc4c0f0264964b6f75feab38026e4920d9745c6f5", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/1359c87cb2045d13c14209bfc4c0f0264964b6f75feab38026e4920d9745c6f5/_data", "Type": "volume"}], "Name": "/t2ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "aba31aec8b7e514fc74d7dad7cd4a81bc3af301ccfabe1ada198e42143d9126a", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "aba31aec8b7e514fc74d7dad7cd4a81bc3af301ccfabe1ada198e42143d9126a", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "575caa3c097f5a00705d5243aaa00ed25fe6d6afeb1568fa9a7a318d85bf198b", "SandboxKey": "/var/run/docker/netns/575caa3c097f", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/ac6b95dd6da6d1c3877e86ae95ad4fc467bb56b1ccffc9406cc1daf938c1ae91/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 5694, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:17:04.89016712Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:17:04.296748885Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/64731974dd1717bc0e0a2bc133aea30af11801502d04b09532d73c5c49b1f440-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/64731974dd1717bc0e0a2bc133aea30af11801502d04b09532d73c5c49b1f440/merged", "UpperDir": "/var/lib/docker/overlay2/64731974dd1717bc0e0a2bc133aea30af11801502d04b09532d73c5c49b1f440/diff", "WorkDir": "/var/lib/docker/overlay2/64731974dd1717bc0e0a2bc133aea30af11801502d04b09532d73c5c49b1f440/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/ac6b95dd6da6d1c3877e86ae95ad4fc467bb56b1ccffc9406cc1daf938c1ae91/hostname", "HostsPath": "/var/lib/docker/containers/ac6b95dd6da6d1c3877e86ae95ad4fc467bb56b1ccffc9406cc1daf938c1ae91/hosts", "Id": "ac6b95dd6da6d1c3877e86ae95ad4fc467bb56b1ccffc9406cc1daf938c1ae91", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/ac6b95dd6da6d1c3877e86ae95ad4fc467bb56b1ccffc9406cc1daf938c1ae91/ac6b95dd6da6d1c3877e86ae95ad4fc467bb56b1ccffc9406cc1daf938c1ae91-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "1359c87cb2045d13c14209bfc4c0f0264964b6f75feab38026e4920d9745c6f5", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/1359c87cb2045d13c14209bfc4c0f0264964b6f75feab38026e4920d9745c6f5/_data", "Type": "volume"}], "Name": "/t2ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "aba31aec8b7e514fc74d7dad7cd4a81bc3af301ccfabe1ada198e42143d9126a", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "aba31aec8b7e514fc74d7dad7cd4a81bc3af301ccfabe1ada198e42143d9126a", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "575caa3c097f5a00705d5243aaa00ed25fe6d6afeb1568fa9a7a318d85bf198b", "SandboxKey": "/var/run/docker/netns/575caa3c097f", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/ac6b95dd6da6d1c3877e86ae95ad4fc467bb56b1ccffc9406cc1daf938c1ae91/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 5694, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:17:04.89016712Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 03:21:32.025222 Printing the yaml input file
INFO:root: 03:21:32.025360 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 03:21:32.025464 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 03:21:32.025525 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 03:21:32.025575 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:33.878488374Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/c5269e62d68f822df2270b856de7c89f9dc79ce8619ec25cd85453c66572723a-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/c5269e62d68f822df2270b856de7c89f9dc79ce8619ec25cd85453c66572723a/merged", "UpperDir": "/var/lib/docker/overlay2/c5269e62d68f822df2270b856de7c89f9dc79ce8619ec25cd85453c66572723a/diff", "WorkDir": "/var/lib/docker/overlay2/c5269e62d68f822df2270b856de7c89f9dc79ce8619ec25cd85453c66572723a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/989b9a724a825405033d56a583ba1edb809f39960d41a9039501190074656fbd/hostname", "HostsPath": "/var/lib/docker/containers/989b9a724a825405033d56a583ba1edb809f39960d41a9039501190074656fbd/hosts", "Id": "989b9a724a825405033d56a583ba1edb809f39960d41a9039501190074656fbd", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/989b9a724a825405033d56a583ba1edb809f39960d41a9039501190074656fbd/989b9a724a825405033d56a583ba1edb809f39960d41a9039501190074656fbd-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "55d18de02314a30e56f56be737e4d86dfafafbcb332d911455fe6a5d123cf836", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/55d18de02314a30e56f56be737e4d86dfafafbcb332d911455fe6a5d123cf836/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "a1952d5da7e24f4b0e81cc11a2940abbcacc7a3a6cee73d85e3db7a1323d52e7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "a1952d5da7e24f4b0e81cc11a2940abbcacc7a3a6cee73d85e3db7a1323d52e7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "8891bad65ccaf3dc5589f18039e22025f873ea9818b9b05d49a447899950fcd0", "SandboxKey": "/var/run/docker/netns/8891bad65cca", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/989b9a724a825405033d56a583ba1edb809f39960d41a9039501190074656fbd/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 7900, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:21:34.368746382Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:33.878488374Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/c5269e62d68f822df2270b856de7c89f9dc79ce8619ec25cd85453c66572723a-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/c5269e62d68f822df2270b856de7c89f9dc79ce8619ec25cd85453c66572723a/merged", "UpperDir": "/var/lib/docker/overlay2/c5269e62d68f822df2270b856de7c89f9dc79ce8619ec25cd85453c66572723a/diff", "WorkDir": "/var/lib/docker/overlay2/c5269e62d68f822df2270b856de7c89f9dc79ce8619ec25cd85453c66572723a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/989b9a724a825405033d56a583ba1edb809f39960d41a9039501190074656fbd/hostname", "HostsPath": "/var/lib/docker/containers/989b9a724a825405033d56a583ba1edb809f39960d41a9039501190074656fbd/hosts", "Id": "989b9a724a825405033d56a583ba1edb809f39960d41a9039501190074656fbd", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/989b9a724a825405033d56a583ba1edb809f39960d41a9039501190074656fbd/989b9a724a825405033d56a583ba1edb809f39960d41a9039501190074656fbd-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "55d18de02314a30e56f56be737e4d86dfafafbcb332d911455fe6a5d123cf836", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/55d18de02314a30e56f56be737e4d86dfafafbcb332d911455fe6a5d123cf836/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "a1952d5da7e24f4b0e81cc11a2940abbcacc7a3a6cee73d85e3db7a1323d52e7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "a1952d5da7e24f4b0e81cc11a2940abbcacc7a3a6cee73d85e3db7a1323d52e7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "8891bad65ccaf3dc5589f18039e22025f873ea9818b9b05d49a447899950fcd0", "SandboxKey": "/var/run/docker/netns/8891bad65cca", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/989b9a724a825405033d56a583ba1edb809f39960d41a9039501190074656fbd/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 7900, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:21:34.368746382Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'tenant_route_ip': u'192.168.2.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.1.11.0/24', u'remote_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:34.899574314Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/727a5ded9afe3726ddedbf21aebdb23c5cbc9800d7ca652799174d9362fcfd5c-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/727a5ded9afe3726ddedbf21aebdb23c5cbc9800d7ca652799174d9362fcfd5c/merged", "UpperDir": "/var/lib/docker/overlay2/727a5ded9afe3726ddedbf21aebdb23c5cbc9800d7ca652799174d9362fcfd5c/diff", "WorkDir": "/var/lib/docker/overlay2/727a5ded9afe3726ddedbf21aebdb23c5cbc9800d7ca652799174d9362fcfd5c/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/acea879ccedbc4414306099ceebe8ad6557a506b5146716ba0d48f2cfde893f9/hostname", "HostsPath": "/var/lib/docker/containers/acea879ccedbc4414306099ceebe8ad6557a506b5146716ba0d48f2cfde893f9/hosts", "Id": "acea879ccedbc4414306099ceebe8ad6557a506b5146716ba0d48f2cfde893f9", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/acea879ccedbc4414306099ceebe8ad6557a506b5146716ba0d48f2cfde893f9/acea879ccedbc4414306099ceebe8ad6557a506b5146716ba0d48f2cfde893f9-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "6584f9a826c69aeb4f17f5dc90327d6bb945a87a352554829dfd47b3911be64d", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/6584f9a826c69aeb4f17f5dc90327d6bb945a87a352554829dfd47b3911be64d/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "e9f0a51a453d2f849713a2a4aeca5112730fd8e8e71e4b4c53d9ebc60c9f2de7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "e9f0a51a453d2f849713a2a4aeca5112730fd8e8e71e4b4c53d9ebc60c9f2de7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "204036f385af29734dc958ca72fdf7651b6834d59c175a6e1d4ff1aa969449bb", "SandboxKey": "/var/run/docker/netns/204036f385af", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/acea879ccedbc4414306099ceebe8ad6557a506b5146716ba0d48f2cfde893f9/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8513, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:21:35.522761044Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:34.899574314Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/727a5ded9afe3726ddedbf21aebdb23c5cbc9800d7ca652799174d9362fcfd5c-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/727a5ded9afe3726ddedbf21aebdb23c5cbc9800d7ca652799174d9362fcfd5c/merged", "UpperDir": "/var/lib/docker/overlay2/727a5ded9afe3726ddedbf21aebdb23c5cbc9800d7ca652799174d9362fcfd5c/diff", "WorkDir": "/var/lib/docker/overlay2/727a5ded9afe3726ddedbf21aebdb23c5cbc9800d7ca652799174d9362fcfd5c/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/acea879ccedbc4414306099ceebe8ad6557a506b5146716ba0d48f2cfde893f9/hostname", "HostsPath": "/var/lib/docker/containers/acea879ccedbc4414306099ceebe8ad6557a506b5146716ba0d48f2cfde893f9/hosts", "Id": "acea879ccedbc4414306099ceebe8ad6557a506b5146716ba0d48f2cfde893f9", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/acea879ccedbc4414306099ceebe8ad6557a506b5146716ba0d48f2cfde893f9/acea879ccedbc4414306099ceebe8ad6557a506b5146716ba0d48f2cfde893f9-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "6584f9a826c69aeb4f17f5dc90327d6bb945a87a352554829dfd47b3911be64d", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/6584f9a826c69aeb4f17f5dc90327d6bb945a87a352554829dfd47b3911be64d/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "e9f0a51a453d2f849713a2a4aeca5112730fd8e8e71e4b4c53d9ebc60c9f2de7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "e9f0a51a453d2f849713a2a4aeca5112730fd8e8e71e4b4c53d9ebc60c9f2de7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "204036f385af29734dc958ca72fdf7651b6834d59c175a6e1d4ff1aa969449bb", "SandboxKey": "/var/run/docker/netns/204036f385af", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/acea879ccedbc4414306099ceebe8ad6557a506b5146716ba0d48f2cfde893f9/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8513, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:21:35.522761044Z", "Status": "running"}}, "item": {"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:39.090639666Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673/merged", "UpperDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673/diff", "WorkDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/hostname", "HostsPath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/hosts", "Id": "381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ed8f4c1e68aa23d38911f66d5606cc23928d0e65bc0ca656517ea28f16ad00dd", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ed8f4c1e68aa23d38911f66d5606cc23928d0e65bc0ca656517ea28f16ad00dd/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "c238c239b6c646255f3eb436cab6ef18fdabc2c6bddd2eefc69b3130be1307c0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "c238c239b6c646255f3eb436cab6ef18fdabc2c6bddd2eefc69b3130be1307c0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "24d52198272e4ec7997dbe1ef25c0bcaf4e85daa158879692335a6726a9d4194", "SandboxKey": "/var/run/docker/netns/24d52198272e", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 7782, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:21:41.118892215Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:39.090639666Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673/merged", "UpperDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673/diff", "WorkDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/hostname", "HostsPath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/hosts", "Id": "381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ed8f4c1e68aa23d38911f66d5606cc23928d0e65bc0ca656517ea28f16ad00dd", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ed8f4c1e68aa23d38911f66d5606cc23928d0e65bc0ca656517ea28f16ad00dd/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "c238c239b6c646255f3eb436cab6ef18fdabc2c6bddd2eefc69b3130be1307c0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "c238c239b6c646255f3eb436cab6ef18fdabc2c6bddd2eefc69b3130be1307c0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "24d52198272e4ec7997dbe1ef25c0bcaf4e85daa158879692335a6726a9d4194", "SandboxKey": "/var/run/docker/netns/24d52198272e", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 7782, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:21:41.118892215Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'tenant_route_ip': u'192.168.130.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.2.11.0/24', u'remote_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:41.971548875Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19/merged", "UpperDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19/diff", "WorkDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/hostname", "HostsPath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/hosts", "Id": "a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "9b1b87e5e20036f2c5ace41968a33cc153074be7b8f04844712245750183a5f2", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/9b1b87e5e20036f2c5ace41968a33cc153074be7b8f04844712245750183a5f2/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "27105f08d5e8a77d44657db3d84adc3e72ff4fc433c8bfe992a1c92ac5ed01eb", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "27105f08d5e8a77d44657db3d84adc3e72ff4fc433c8bfe992a1c92ac5ed01eb", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "3244347741f0c9bfc6affa7a027d0585d25689abba86eb9346d03a76d2306cff", "SandboxKey": "/var/run/docker/netns/3244347741f0", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8539, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:21:44.744369203Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:41.971548875Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19/merged", "UpperDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19/diff", "WorkDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/hostname", "HostsPath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/hosts", "Id": "a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "9b1b87e5e20036f2c5ace41968a33cc153074be7b8f04844712245750183a5f2", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/9b1b87e5e20036f2c5ace41968a33cc153074be7b8f04844712245750183a5f2/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "27105f08d5e8a77d44657db3d84adc3e72ff4fc433c8bfe992a1c92ac5ed01eb", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "27105f08d5e8a77d44657db3d84adc3e72ff4fc433c8bfe992a1c92ac5ed01eb", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "3244347741f0c9bfc6affa7a027d0585d25689abba86eb9346d03a76d2306cff", "SandboxKey": "/var/run/docker/netns/3244347741f0", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8539, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:21:44.744369203Z", "Status": "running"}}, "item": {"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:45.597688588Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0/merged", "UpperDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0/diff", "WorkDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/hostname", "HostsPath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/hosts", "Id": "40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "3a47f27fd2b45c7d323fc207dab7de8a731edad2065f02deeda39ee8f724081d", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/3a47f27fd2b45c7d323fc207dab7de8a731edad2065f02deeda39ee8f724081d/_data", "Type": "volume"}], "Name": "/t2ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "ba26f245bd9d318e56c705d4a22971b73cf7c7ed1aa5a0ae8def4aa0eaac0407", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "ba26f245bd9d318e56c705d4a22971b73cf7c7ed1aa5a0ae8def4aa0eaac0407", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "dee1b7cc0b183afaf53c861adeaebea47bd1e3194a8be5e2fc0e1e92847d8b66", "SandboxKey": "/var/run/docker/netns/dee1b7cc0b18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 9650, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:21:46.174622307Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:45.597688588Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0/merged", "UpperDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0/diff", "WorkDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/hostname", "HostsPath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/hosts", "Id": "40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "3a47f27fd2b45c7d323fc207dab7de8a731edad2065f02deeda39ee8f724081d", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/3a47f27fd2b45c7d323fc207dab7de8a731edad2065f02deeda39ee8f724081d/_data", "Type": "volume"}], "Name": "/t2ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "ba26f245bd9d318e56c705d4a22971b73cf7c7ed1aa5a0ae8def4aa0eaac0407", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "ba26f245bd9d318e56c705d4a22971b73cf7c7ed1aa5a0ae8def4aa0eaac0407", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "dee1b7cc0b183afaf53c861adeaebea47bd1e3194a8be5e2fc0e1e92847d8b66", "SandboxKey": "/var/run/docker/netns/dee1b7cc0b18", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 9650, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:21:46.174622307Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 03:27:06.025829 Printing the yaml input file
INFO:root: 03:27:06.025975 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 03:27:06.026075 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 03:27:06.026125 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 03:27:06.026165 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.3.1', u'name': u't3', u'pns_ip': u'192.168.3.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.3.2/24', u'pns_if': u't3pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:27:07.941583303Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/fddaa94df2c03012476d6ca05078cd05f355518a297d2b2f9a36d4579a7a2c5b-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/fddaa94df2c03012476d6ca05078cd05f355518a297d2b2f9a36d4579a7a2c5b/merged", "UpperDir": "/var/lib/docker/overlay2/fddaa94df2c03012476d6ca05078cd05f355518a297d2b2f9a36d4579a7a2c5b/diff", "WorkDir": "/var/lib/docker/overlay2/fddaa94df2c03012476d6ca05078cd05f355518a297d2b2f9a36d4579a7a2c5b/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/759069e1658f7ab7ff604ea6ee6eca86d7f72713a596deae28fd1bc40ee59ca9/hostname", "HostsPath": "/var/lib/docker/containers/759069e1658f7ab7ff604ea6ee6eca86d7f72713a596deae28fd1bc40ee59ca9/hosts", "Id": "759069e1658f7ab7ff604ea6ee6eca86d7f72713a596deae28fd1bc40ee59ca9", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/759069e1658f7ab7ff604ea6ee6eca86d7f72713a596deae28fd1bc40ee59ca9/759069e1658f7ab7ff604ea6ee6eca86d7f72713a596deae28fd1bc40ee59ca9-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "cfdf60979d49f486ec410c15bd1c33ddf25207a34f39c72c89560f81b01bb57e", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/cfdf60979d49f486ec410c15bd1c33ddf25207a34f39c72c89560f81b01bb57e/_data", "Type": "volume"}], "Name": "/t3", "NetworkSettings": {"Bridge": "", "EndpointID": "cd0b814e28094363ed22d772ebd190610c640e90faa8d39447290241643f58d8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "cd0b814e28094363ed22d772ebd190610c640e90faa8d39447290241643f58d8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "3455cc7284ce9694c5aed51b61f93f744432559f666000dc1e9fe3acab314a04", "SandboxKey": "/var/run/docker/netns/3455cc7284ce", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/759069e1658f7ab7ff604ea6ee6eca86d7f72713a596deae28fd1bc40ee59ca9/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 16488, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:27:08.448162688Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:27:07.941583303Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/fddaa94df2c03012476d6ca05078cd05f355518a297d2b2f9a36d4579a7a2c5b-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/fddaa94df2c03012476d6ca05078cd05f355518a297d2b2f9a36d4579a7a2c5b/merged", "UpperDir": "/var/lib/docker/overlay2/fddaa94df2c03012476d6ca05078cd05f355518a297d2b2f9a36d4579a7a2c5b/diff", "WorkDir": "/var/lib/docker/overlay2/fddaa94df2c03012476d6ca05078cd05f355518a297d2b2f9a36d4579a7a2c5b/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/759069e1658f7ab7ff604ea6ee6eca86d7f72713a596deae28fd1bc40ee59ca9/hostname", "HostsPath": "/var/lib/docker/containers/759069e1658f7ab7ff604ea6ee6eca86d7f72713a596deae28fd1bc40ee59ca9/hosts", "Id": "759069e1658f7ab7ff604ea6ee6eca86d7f72713a596deae28fd1bc40ee59ca9", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/759069e1658f7ab7ff604ea6ee6eca86d7f72713a596deae28fd1bc40ee59ca9/759069e1658f7ab7ff604ea6ee6eca86d7f72713a596deae28fd1bc40ee59ca9-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "cfdf60979d49f486ec410c15bd1c33ddf25207a34f39c72c89560f81b01bb57e", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/cfdf60979d49f486ec410c15bd1c33ddf25207a34f39c72c89560f81b01bb57e/_data", "Type": "volume"}], "Name": "/t3", "NetworkSettings": {"Bridge": "", "EndpointID": "cd0b814e28094363ed22d772ebd190610c640e90faa8d39447290241643f58d8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "cd0b814e28094363ed22d772ebd190610c640e90faa8d39447290241643f58d8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "3455cc7284ce9694c5aed51b61f93f744432559f666000dc1e9fe3acab314a04", "SandboxKey": "/var/run/docker/netns/3455cc7284ce", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/759069e1658f7ab7ff604ea6ee6eca86d7f72713a596deae28fd1bc40ee59ca9/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 16488, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:27:08.448162688Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.3.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.3.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.3.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'tenant_route_ip': u'192.168.3.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.1.21.0/24', u'remote_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:27:08.960313016Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/6d089caa112823d29a4174990f3bbc261f06e53b99f4928821d382d7403132fb-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/6d089caa112823d29a4174990f3bbc261f06e53b99f4928821d382d7403132fb/merged", "UpperDir": "/var/lib/docker/overlay2/6d089caa112823d29a4174990f3bbc261f06e53b99f4928821d382d7403132fb/diff", "WorkDir": "/var/lib/docker/overlay2/6d089caa112823d29a4174990f3bbc261f06e53b99f4928821d382d7403132fb/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/b3b9d0c415e1e28f0b79ecfc16a128d36db25a81e4d6dc5f18f54780f1335524/hostname", "HostsPath": "/var/lib/docker/containers/b3b9d0c415e1e28f0b79ecfc16a128d36db25a81e4d6dc5f18f54780f1335524/hosts", "Id": "b3b9d0c415e1e28f0b79ecfc16a128d36db25a81e4d6dc5f18f54780f1335524", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/b3b9d0c415e1e28f0b79ecfc16a128d36db25a81e4d6dc5f18f54780f1335524/b3b9d0c415e1e28f0b79ecfc16a128d36db25a81e4d6dc5f18f54780f1335524-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ad2a5017ab20da8377e722fbc1c6763721142baf34bfaf1ec2170ffd0e46d03b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ad2a5017ab20da8377e722fbc1c6763721142baf34bfaf1ec2170ffd0e46d03b/_data", "Type": "volume"}], "Name": "/t3ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "4237be50ef2f1a95c1cc4e3c2d70dc94de0be1217c9cd4e204fdc53bcc8f7fb4", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "4237be50ef2f1a95c1cc4e3c2d70dc94de0be1217c9cd4e204fdc53bcc8f7fb4", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "e6ce381bd2e2e4e34aa626b634dfe90ef95c7bd3bbcfc1da055e7f1cd322a69f", "SandboxKey": "/var/run/docker/netns/e6ce381bd2e2", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/b3b9d0c415e1e28f0b79ecfc16a128d36db25a81e4d6dc5f18f54780f1335524/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 17048, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:27:09.644803474Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:27:08.960313016Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/6d089caa112823d29a4174990f3bbc261f06e53b99f4928821d382d7403132fb-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/6d089caa112823d29a4174990f3bbc261f06e53b99f4928821d382d7403132fb/merged", "UpperDir": "/var/lib/docker/overlay2/6d089caa112823d29a4174990f3bbc261f06e53b99f4928821d382d7403132fb/diff", "WorkDir": "/var/lib/docker/overlay2/6d089caa112823d29a4174990f3bbc261f06e53b99f4928821d382d7403132fb/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/b3b9d0c415e1e28f0b79ecfc16a128d36db25a81e4d6dc5f18f54780f1335524/hostname", "HostsPath": "/var/lib/docker/containers/b3b9d0c415e1e28f0b79ecfc16a128d36db25a81e4d6dc5f18f54780f1335524/hosts", "Id": "b3b9d0c415e1e28f0b79ecfc16a128d36db25a81e4d6dc5f18f54780f1335524", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/b3b9d0c415e1e28f0b79ecfc16a128d36db25a81e4d6dc5f18f54780f1335524/b3b9d0c415e1e28f0b79ecfc16a128d36db25a81e4d6dc5f18f54780f1335524-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ad2a5017ab20da8377e722fbc1c6763721142baf34bfaf1ec2170ffd0e46d03b", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ad2a5017ab20da8377e722fbc1c6763721142baf34bfaf1ec2170ffd0e46d03b/_data", "Type": "volume"}], "Name": "/t3ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "4237be50ef2f1a95c1cc4e3c2d70dc94de0be1217c9cd4e204fdc53bcc8f7fb4", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "4237be50ef2f1a95c1cc4e3c2d70dc94de0be1217c9cd4e204fdc53bcc8f7fb4", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "e6ce381bd2e2e4e34aa626b634dfe90ef95c7bd3bbcfc1da055e7f1cd322a69f", "SandboxKey": "/var/run/docker/netns/e6ce381bd2e2", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/b3b9d0c415e1e28f0b79ecfc16a128d36db25a81e4d6dc5f18f54780f1335524/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 17048, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:27:09.644803474Z", "Status": "running"}}, "item": {"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vmif": "t3C2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.131.1', u'name': u't3', u'pns_ip': u'192.168.131.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.131.2/24', u'pns_if': u't3pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:27:13.213269551Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/5ecd345a2242880d367a781135f752c4e9a9184035bd7dbbf39eca2cff52e055-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/5ecd345a2242880d367a781135f752c4e9a9184035bd7dbbf39eca2cff52e055/merged", "UpperDir": "/var/lib/docker/overlay2/5ecd345a2242880d367a781135f752c4e9a9184035bd7dbbf39eca2cff52e055/diff", "WorkDir": "/var/lib/docker/overlay2/5ecd345a2242880d367a781135f752c4e9a9184035bd7dbbf39eca2cff52e055/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/e547ab0103b0be430039bcb34737468adad2c433fc8be4b1f9075cb998073d25/hostname", "HostsPath": "/var/lib/docker/containers/e547ab0103b0be430039bcb34737468adad2c433fc8be4b1f9075cb998073d25/hosts", "Id": "e547ab0103b0be430039bcb34737468adad2c433fc8be4b1f9075cb998073d25", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/e547ab0103b0be430039bcb34737468adad2c433fc8be4b1f9075cb998073d25/e547ab0103b0be430039bcb34737468adad2c433fc8be4b1f9075cb998073d25-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "04b7cd1e1f827b205e9b5e4ac94aaa45872ad5af71a1d519c64a26816f1d0a28", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/04b7cd1e1f827b205e9b5e4ac94aaa45872ad5af71a1d519c64a26816f1d0a28/_data", "Type": "volume"}], "Name": "/t3", "NetworkSettings": {"Bridge": "", "EndpointID": "1be8d6bad51ed4a918aae9b42b3abbda28e53103bf9f0c72631cd0bf1421f4b2", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "1be8d6bad51ed4a918aae9b42b3abbda28e53103bf9f0c72631cd0bf1421f4b2", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "2131a595cc5cf8deb54d5b3be830c5138f0f70c2738ca6c9c5215b4b3bdd4e21", "SandboxKey": "/var/run/docker/netns/2131a595cc5c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/e547ab0103b0be430039bcb34737468adad2c433fc8be4b1f9075cb998073d25/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 11452, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:27:14.12829889Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:27:13.213269551Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/5ecd345a2242880d367a781135f752c4e9a9184035bd7dbbf39eca2cff52e055-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/5ecd345a2242880d367a781135f752c4e9a9184035bd7dbbf39eca2cff52e055/merged", "UpperDir": "/var/lib/docker/overlay2/5ecd345a2242880d367a781135f752c4e9a9184035bd7dbbf39eca2cff52e055/diff", "WorkDir": "/var/lib/docker/overlay2/5ecd345a2242880d367a781135f752c4e9a9184035bd7dbbf39eca2cff52e055/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/e547ab0103b0be430039bcb34737468adad2c433fc8be4b1f9075cb998073d25/hostname", "HostsPath": "/var/lib/docker/containers/e547ab0103b0be430039bcb34737468adad2c433fc8be4b1f9075cb998073d25/hosts", "Id": "e547ab0103b0be430039bcb34737468adad2c433fc8be4b1f9075cb998073d25", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/e547ab0103b0be430039bcb34737468adad2c433fc8be4b1f9075cb998073d25/e547ab0103b0be430039bcb34737468adad2c433fc8be4b1f9075cb998073d25-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "04b7cd1e1f827b205e9b5e4ac94aaa45872ad5af71a1d519c64a26816f1d0a28", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/04b7cd1e1f827b205e9b5e4ac94aaa45872ad5af71a1d519c64a26816f1d0a28/_data", "Type": "volume"}], "Name": "/t3", "NetworkSettings": {"Bridge": "", "EndpointID": "1be8d6bad51ed4a918aae9b42b3abbda28e53103bf9f0c72631cd0bf1421f4b2", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "1be8d6bad51ed4a918aae9b42b3abbda28e53103bf9f0c72631cd0bf1421f4b2", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "2131a595cc5cf8deb54d5b3be830c5138f0f70c2738ca6c9c5215b4b3bdd4e21", "SandboxKey": "/var/run/docker/netns/2131a595cc5c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/e547ab0103b0be430039bcb34737468adad2c433fc8be4b1f9075cb998073d25/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 11452, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:27:14.12829889Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.131.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.131.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.131.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'tenant_route_ip': u'192.168.131.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.2.21.0/24', u'remote_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:27:14.947948684Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/8880d815f98339ee327c29ae9a63a1cc03b9b3df6767a4cb55ea30bc3e6e75d0-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/8880d815f98339ee327c29ae9a63a1cc03b9b3df6767a4cb55ea30bc3e6e75d0/merged", "UpperDir": "/var/lib/docker/overlay2/8880d815f98339ee327c29ae9a63a1cc03b9b3df6767a4cb55ea30bc3e6e75d0/diff", "WorkDir": "/var/lib/docker/overlay2/8880d815f98339ee327c29ae9a63a1cc03b9b3df6767a4cb55ea30bc3e6e75d0/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/46fc313a0b760ec35c73ba0ccb4d5417f4af443cb007011a9294d1a2cc317154/hostname", "HostsPath": "/var/lib/docker/containers/46fc313a0b760ec35c73ba0ccb4d5417f4af443cb007011a9294d1a2cc317154/hosts", "Id": "46fc313a0b760ec35c73ba0ccb4d5417f4af443cb007011a9294d1a2cc317154", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/46fc313a0b760ec35c73ba0ccb4d5417f4af443cb007011a9294d1a2cc317154/46fc313a0b760ec35c73ba0ccb4d5417f4af443cb007011a9294d1a2cc317154-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "a46ee1041bc681fb66d2ddf62a3a5e6f1371bbff0c91821f0f6704b8671b382c", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/a46ee1041bc681fb66d2ddf62a3a5e6f1371bbff0c91821f0f6704b8671b382c/_data", "Type": "volume"}], "Name": "/t3ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "017de0d418e4e69cd3eb1032642f4c6a133abf7466221ab66b256a492a1aa47c", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:06", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "017de0d418e4e69cd3eb1032642f4c6a133abf7466221ab66b256a492a1aa47c", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:06", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "2f8dba3195774950dc89194146a0a50ade2e959538b84791eb9152eea5009b12", "SandboxKey": "/var/run/docker/netns/2f8dba319577", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/46fc313a0b760ec35c73ba0ccb4d5417f4af443cb007011a9294d1a2cc317154/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12493, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:27:15.806528163Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:27:14.947948684Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/8880d815f98339ee327c29ae9a63a1cc03b9b3df6767a4cb55ea30bc3e6e75d0-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/8880d815f98339ee327c29ae9a63a1cc03b9b3df6767a4cb55ea30bc3e6e75d0/merged", "UpperDir": "/var/lib/docker/overlay2/8880d815f98339ee327c29ae9a63a1cc03b9b3df6767a4cb55ea30bc3e6e75d0/diff", "WorkDir": "/var/lib/docker/overlay2/8880d815f98339ee327c29ae9a63a1cc03b9b3df6767a4cb55ea30bc3e6e75d0/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/46fc313a0b760ec35c73ba0ccb4d5417f4af443cb007011a9294d1a2cc317154/hostname", "HostsPath": "/var/lib/docker/containers/46fc313a0b760ec35c73ba0ccb4d5417f4af443cb007011a9294d1a2cc317154/hosts", "Id": "46fc313a0b760ec35c73ba0ccb4d5417f4af443cb007011a9294d1a2cc317154", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/46fc313a0b760ec35c73ba0ccb4d5417f4af443cb007011a9294d1a2cc317154/46fc313a0b760ec35c73ba0ccb4d5417f4af443cb007011a9294d1a2cc317154-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "a46ee1041bc681fb66d2ddf62a3a5e6f1371bbff0c91821f0f6704b8671b382c", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/a46ee1041bc681fb66d2ddf62a3a5e6f1371bbff0c91821f0f6704b8671b382c/_data", "Type": "volume"}], "Name": "/t3ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "017de0d418e4e69cd3eb1032642f4c6a133abf7466221ab66b256a492a1aa47c", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:06", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "017de0d418e4e69cd3eb1032642f4c6a133abf7466221ab66b256a492a1aa47c", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:06", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "2f8dba3195774950dc89194146a0a50ade2e959538b84791eb9152eea5009b12", "SandboxKey": "/var/run/docker/netns/2f8dba319577", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/46fc313a0b760ec35c73ba0ccb4d5417f4af443cb007011a9294d1a2cc317154/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12493, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:27:15.806528163Z", "Status": "running"}}, "item": {"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vmif": "t3C3if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:27:16.783314788Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/fa2eabb1f2fcd1316106e52e8aaf841f0070188675965354c8ff858d9911dd12-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/fa2eabb1f2fcd1316106e52e8aaf841f0070188675965354c8ff858d9911dd12/merged", "UpperDir": "/var/lib/docker/overlay2/fa2eabb1f2fcd1316106e52e8aaf841f0070188675965354c8ff858d9911dd12/diff", "WorkDir": "/var/lib/docker/overlay2/fa2eabb1f2fcd1316106e52e8aaf841f0070188675965354c8ff858d9911dd12/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/1e1eaa65af019f0039dddbbce1a89c4299425f00ae891cf250ed710a4f33f3f7/hostname", "HostsPath": "/var/lib/docker/containers/1e1eaa65af019f0039dddbbce1a89c4299425f00ae891cf250ed710a4f33f3f7/hosts", "Id": "1e1eaa65af019f0039dddbbce1a89c4299425f00ae891cf250ed710a4f33f3f7", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/1e1eaa65af019f0039dddbbce1a89c4299425f00ae891cf250ed710a4f33f3f7/1e1eaa65af019f0039dddbbce1a89c4299425f00ae891cf250ed710a4f33f3f7-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "90c441e3bdaf225adf88483127b539a838e884ffa6c4dbcaf9725327b6074f0a", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/90c441e3bdaf225adf88483127b539a838e884ffa6c4dbcaf9725327b6074f0a/_data", "Type": "volume"}], "Name": "/t3ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "bac4932eaf23a6452f6dec39ff4f54df347f8f3d565f6bb28d1275b6f28d55e0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:07", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "bac4932eaf23a6452f6dec39ff4f54df347f8f3d565f6bb28d1275b6f28d55e0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:07", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "71b368c92771854aebd6a575e0b6e2db41051b385c30e6571bfdd5afbad1f496", "SandboxKey": "/var/run/docker/netns/71b368c92771", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/1e1eaa65af019f0039dddbbce1a89c4299425f00ae891cf250ed710a4f33f3f7/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 14754, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:27:17.700933967Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:27:16.783314788Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/fa2eabb1f2fcd1316106e52e8aaf841f0070188675965354c8ff858d9911dd12-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/fa2eabb1f2fcd1316106e52e8aaf841f0070188675965354c8ff858d9911dd12/merged", "UpperDir": "/var/lib/docker/overlay2/fa2eabb1f2fcd1316106e52e8aaf841f0070188675965354c8ff858d9911dd12/diff", "WorkDir": "/var/lib/docker/overlay2/fa2eabb1f2fcd1316106e52e8aaf841f0070188675965354c8ff858d9911dd12/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/1e1eaa65af019f0039dddbbce1a89c4299425f00ae891cf250ed710a4f33f3f7/hostname", "HostsPath": "/var/lib/docker/containers/1e1eaa65af019f0039dddbbce1a89c4299425f00ae891cf250ed710a4f33f3f7/hosts", "Id": "1e1eaa65af019f0039dddbbce1a89c4299425f00ae891cf250ed710a4f33f3f7", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/1e1eaa65af019f0039dddbbce1a89c4299425f00ae891cf250ed710a4f33f3f7/1e1eaa65af019f0039dddbbce1a89c4299425f00ae891cf250ed710a4f33f3f7-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "90c441e3bdaf225adf88483127b539a838e884ffa6c4dbcaf9725327b6074f0a", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/90c441e3bdaf225adf88483127b539a838e884ffa6c4dbcaf9725327b6074f0a/_data", "Type": "volume"}], "Name": "/t3ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "bac4932eaf23a6452f6dec39ff4f54df347f8f3d565f6bb28d1275b6f28d55e0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:07", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "bac4932eaf23a6452f6dec39ff4f54df347f8f3d565f6bb28d1275b6f28d55e0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:07", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "71b368c92771854aebd6a575e0b6e2db41051b385c30e6571bfdd5afbad1f496", "SandboxKey": "/var/run/docker/netns/71b368c92771", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/1e1eaa65af019f0039dddbbce1a89c4299425f00ae891cf250ed710a4f33f3f7/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 14754, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:27:17.700933967Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vmif": "t3C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 03:37:26.912479 Printing the yaml input file
INFO:root: 03:37:26.912600 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 03:37:26.912699 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 03:37:26.912752 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 03:37:26.912806 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:37:28.775027325Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/57c16076ffb62831c73d2ca896a36b2d93b2c2d71d82cb70eef3c62a40720c99-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/57c16076ffb62831c73d2ca896a36b2d93b2c2d71d82cb70eef3c62a40720c99/merged", "UpperDir": "/var/lib/docker/overlay2/57c16076ffb62831c73d2ca896a36b2d93b2c2d71d82cb70eef3c62a40720c99/diff", "WorkDir": "/var/lib/docker/overlay2/57c16076ffb62831c73d2ca896a36b2d93b2c2d71d82cb70eef3c62a40720c99/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4098485eaa5832b061bde74b754872684c2800033ed5704af2375952202bed5e/hostname", "HostsPath": "/var/lib/docker/containers/4098485eaa5832b061bde74b754872684c2800033ed5704af2375952202bed5e/hosts", "Id": "4098485eaa5832b061bde74b754872684c2800033ed5704af2375952202bed5e", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4098485eaa5832b061bde74b754872684c2800033ed5704af2375952202bed5e/4098485eaa5832b061bde74b754872684c2800033ed5704af2375952202bed5e-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "0fab4e13d46f3799d06fdcf6bcb57a4316aac436555b6292aa923e6428b6a233", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/0fab4e13d46f3799d06fdcf6bcb57a4316aac436555b6292aa923e6428b6a233/_data", "Type": "volume"}], "Name": "/t4", "NetworkSettings": {"Bridge": "", "EndpointID": "5a564d50336d568399d10279b7472562ec11b47f7434d978a675962104765777", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "5a564d50336d568399d10279b7472562ec11b47f7434d978a675962104765777", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "eb49d0ee9cde837b1cfc2e5109302a79a98779a4d2420d17a42cd23efab31e37", "SandboxKey": "/var/run/docker/netns/eb49d0ee9cde", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4098485eaa5832b061bde74b754872684c2800033ed5704af2375952202bed5e/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 22796, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:37:29.331073764Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:37:28.775027325Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/57c16076ffb62831c73d2ca896a36b2d93b2c2d71d82cb70eef3c62a40720c99-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/57c16076ffb62831c73d2ca896a36b2d93b2c2d71d82cb70eef3c62a40720c99/merged", "UpperDir": "/var/lib/docker/overlay2/57c16076ffb62831c73d2ca896a36b2d93b2c2d71d82cb70eef3c62a40720c99/diff", "WorkDir": "/var/lib/docker/overlay2/57c16076ffb62831c73d2ca896a36b2d93b2c2d71d82cb70eef3c62a40720c99/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4098485eaa5832b061bde74b754872684c2800033ed5704af2375952202bed5e/hostname", "HostsPath": "/var/lib/docker/containers/4098485eaa5832b061bde74b754872684c2800033ed5704af2375952202bed5e/hosts", "Id": "4098485eaa5832b061bde74b754872684c2800033ed5704af2375952202bed5e", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/4098485eaa5832b061bde74b754872684c2800033ed5704af2375952202bed5e/4098485eaa5832b061bde74b754872684c2800033ed5704af2375952202bed5e-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "0fab4e13d46f3799d06fdcf6bcb57a4316aac436555b6292aa923e6428b6a233", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/0fab4e13d46f3799d06fdcf6bcb57a4316aac436555b6292aa923e6428b6a233/_data", "Type": "volume"}], "Name": "/t4", "NetworkSettings": {"Bridge": "", "EndpointID": "5a564d50336d568399d10279b7472562ec11b47f7434d978a675962104765777", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "5a564d50336d568399d10279b7472562ec11b47f7434d978a675962104765777", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "eb49d0ee9cde837b1cfc2e5109302a79a98779a4d2420d17a42cd23efab31e37", "SandboxKey": "/var/run/docker/netns/eb49d0ee9cde", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4098485eaa5832b061bde74b754872684c2800033ed5704af2375952202bed5e/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 22796, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:37:29.331073764Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'tenant_route_ip': u'192.168.4.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.1.31.0/24', u'remote_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:37:29.908918408Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/50505bb83df7eeea290ca4d113530e1dfdbe2feb3ea770fbc354a90f225d7986-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/50505bb83df7eeea290ca4d113530e1dfdbe2feb3ea770fbc354a90f225d7986/merged", "UpperDir": "/var/lib/docker/overlay2/50505bb83df7eeea290ca4d113530e1dfdbe2feb3ea770fbc354a90f225d7986/diff", "WorkDir": "/var/lib/docker/overlay2/50505bb83df7eeea290ca4d113530e1dfdbe2feb3ea770fbc354a90f225d7986/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/a790231a50c74fc8e2186b902bf9059a5024c84ed9b655bf57e14f59bb6d8802/hostname", "HostsPath": "/var/lib/docker/containers/a790231a50c74fc8e2186b902bf9059a5024c84ed9b655bf57e14f59bb6d8802/hosts", "Id": "a790231a50c74fc8e2186b902bf9059a5024c84ed9b655bf57e14f59bb6d8802", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/a790231a50c74fc8e2186b902bf9059a5024c84ed9b655bf57e14f59bb6d8802/a790231a50c74fc8e2186b902bf9059a5024c84ed9b655bf57e14f59bb6d8802-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "75d1e6713376fd475308abd021b91998385cce33624ee5cd2809376ab191c123", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/75d1e6713376fd475308abd021b91998385cce33624ee5cd2809376ab191c123/_data", "Type": "volume"}], "Name": "/t4ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "5c4e9f10c82252b9f1f15373150a2e83eb40a181b890bd213c23058bfe234a18", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "5c4e9f10c82252b9f1f15373150a2e83eb40a181b890bd213c23058bfe234a18", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "6066bef4c1b9fdf5d29a68cb7d436f80b4a9b56682f22d5ef6801aa6bfb97760", "SandboxKey": "/var/run/docker/netns/6066bef4c1b9", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/a790231a50c74fc8e2186b902bf9059a5024c84ed9b655bf57e14f59bb6d8802/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 23537, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:37:30.962777312Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:37:29.908918408Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/50505bb83df7eeea290ca4d113530e1dfdbe2feb3ea770fbc354a90f225d7986-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/50505bb83df7eeea290ca4d113530e1dfdbe2feb3ea770fbc354a90f225d7986/merged", "UpperDir": "/var/lib/docker/overlay2/50505bb83df7eeea290ca4d113530e1dfdbe2feb3ea770fbc354a90f225d7986/diff", "WorkDir": "/var/lib/docker/overlay2/50505bb83df7eeea290ca4d113530e1dfdbe2feb3ea770fbc354a90f225d7986/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/a790231a50c74fc8e2186b902bf9059a5024c84ed9b655bf57e14f59bb6d8802/hostname", "HostsPath": "/var/lib/docker/containers/a790231a50c74fc8e2186b902bf9059a5024c84ed9b655bf57e14f59bb6d8802/hosts", "Id": "a790231a50c74fc8e2186b902bf9059a5024c84ed9b655bf57e14f59bb6d8802", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/a790231a50c74fc8e2186b902bf9059a5024c84ed9b655bf57e14f59bb6d8802/a790231a50c74fc8e2186b902bf9059a5024c84ed9b655bf57e14f59bb6d8802-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "75d1e6713376fd475308abd021b91998385cce33624ee5cd2809376ab191c123", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/75d1e6713376fd475308abd021b91998385cce33624ee5cd2809376ab191c123/_data", "Type": "volume"}], "Name": "/t4ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "5c4e9f10c82252b9f1f15373150a2e83eb40a181b890bd213c23058bfe234a18", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "5c4e9f10c82252b9f1f15373150a2e83eb40a181b890bd213c23058bfe234a18", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "12c9b885ab70652d0564df0177df260092bc76fda0b9b6473433e7fc43b01598"}}, "Ports": {}, "SandboxID": "6066bef4c1b9fdf5d29a68cb7d436f80b4a9b56682f22d5ef6801aa6bfb97760", "SandboxKey": "/var/run/docker/netns/6066bef4c1b9", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/a790231a50c74fc8e2186b902bf9059a5024c84ed9b655bf57e14f59bb6d8802/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 23537, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:37:30.962777312Z", "Status": "running"}}, "item": {"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.132.1', u'name': u't4', u'pns_ip': u'192.168.132.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.132.2/24', u'pns_if': u't4pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:37:34.923129348Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/7443e1bcc7db213c4205e12ac434d1d9f95cfcbc341e52224c9582cfe6505349-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/7443e1bcc7db213c4205e12ac434d1d9f95cfcbc341e52224c9582cfe6505349/merged", "UpperDir": "/var/lib/docker/overlay2/7443e1bcc7db213c4205e12ac434d1d9f95cfcbc341e52224c9582cfe6505349/diff", "WorkDir": "/var/lib/docker/overlay2/7443e1bcc7db213c4205e12ac434d1d9f95cfcbc341e52224c9582cfe6505349/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/0c7ef462af0559a7af3c083ca6f4260d610c8db319471d216a0798c1247d837a/hostname", "HostsPath": "/var/lib/docker/containers/0c7ef462af0559a7af3c083ca6f4260d610c8db319471d216a0798c1247d837a/hosts", "Id": "0c7ef462af0559a7af3c083ca6f4260d610c8db319471d216a0798c1247d837a", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/0c7ef462af0559a7af3c083ca6f4260d610c8db319471d216a0798c1247d837a/0c7ef462af0559a7af3c083ca6f4260d610c8db319471d216a0798c1247d837a-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "e798bd938645287d62654f6e989046970d7c7f4533e0591fe6ea72e8925b284e", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/e798bd938645287d62654f6e989046970d7c7f4533e0591fe6ea72e8925b284e/_data", "Type": "volume"}], "Name": "/t4", "NetworkSettings": {"Bridge": "", "EndpointID": "8db9450c60bf17eefdb4e59757d2540f6e5c842ce621639b200f2b8559989e7e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:08", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "8db9450c60bf17eefdb4e59757d2540f6e5c842ce621639b200f2b8559989e7e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:08", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "0dfacd172b04ceef79205a79e7398e99a8fab1e6981dd42ad30f6bd60a544485", "SandboxKey": "/var/run/docker/netns/0dfacd172b04", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/0c7ef462af0559a7af3c083ca6f4260d610c8db319471d216a0798c1247d837a/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 18664, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:37:35.41534188Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:37:34.923129348Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/7443e1bcc7db213c4205e12ac434d1d9f95cfcbc341e52224c9582cfe6505349-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/7443e1bcc7db213c4205e12ac434d1d9f95cfcbc341e52224c9582cfe6505349/merged", "UpperDir": "/var/lib/docker/overlay2/7443e1bcc7db213c4205e12ac434d1d9f95cfcbc341e52224c9582cfe6505349/diff", "WorkDir": "/var/lib/docker/overlay2/7443e1bcc7db213c4205e12ac434d1d9f95cfcbc341e52224c9582cfe6505349/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/0c7ef462af0559a7af3c083ca6f4260d610c8db319471d216a0798c1247d837a/hostname", "HostsPath": "/var/lib/docker/containers/0c7ef462af0559a7af3c083ca6f4260d610c8db319471d216a0798c1247d837a/hosts", "Id": "0c7ef462af0559a7af3c083ca6f4260d610c8db319471d216a0798c1247d837a", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/0c7ef462af0559a7af3c083ca6f4260d610c8db319471d216a0798c1247d837a/0c7ef462af0559a7af3c083ca6f4260d610c8db319471d216a0798c1247d837a-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "e798bd938645287d62654f6e989046970d7c7f4533e0591fe6ea72e8925b284e", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/e798bd938645287d62654f6e989046970d7c7f4533e0591fe6ea72e8925b284e/_data", "Type": "volume"}], "Name": "/t4", "NetworkSettings": {"Bridge": "", "EndpointID": "8db9450c60bf17eefdb4e59757d2540f6e5c842ce621639b200f2b8559989e7e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:08", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "8db9450c60bf17eefdb4e59757d2540f6e5c842ce621639b200f2b8559989e7e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:08", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "0dfacd172b04ceef79205a79e7398e99a8fab1e6981dd42ad30f6bd60a544485", "SandboxKey": "/var/run/docker/netns/0dfacd172b04", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/0c7ef462af0559a7af3c083ca6f4260d610c8db319471d216a0798c1247d837a/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 18664, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:37:35.41534188Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.132.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.132.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.132.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'tenant_route_ip': u'192.168.132.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.2.31.0/24', u'remote_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:37:36.302965536Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/ac3f96e693b45f24ed6ceb27d7f5f9fa2eb8a5bc49a5b05c266a5c1c7d06a957-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/ac3f96e693b45f24ed6ceb27d7f5f9fa2eb8a5bc49a5b05c266a5c1c7d06a957/merged", "UpperDir": "/var/lib/docker/overlay2/ac3f96e693b45f24ed6ceb27d7f5f9fa2eb8a5bc49a5b05c266a5c1c7d06a957/diff", "WorkDir": "/var/lib/docker/overlay2/ac3f96e693b45f24ed6ceb27d7f5f9fa2eb8a5bc49a5b05c266a5c1c7d06a957/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/cfe2e95863656d59c5b501cf35cb3d81d12951008599b546d81b6064dbae421c/hostname", "HostsPath": "/var/lib/docker/containers/cfe2e95863656d59c5b501cf35cb3d81d12951008599b546d81b6064dbae421c/hosts", "Id": "cfe2e95863656d59c5b501cf35cb3d81d12951008599b546d81b6064dbae421c", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/cfe2e95863656d59c5b501cf35cb3d81d12951008599b546d81b6064dbae421c/cfe2e95863656d59c5b501cf35cb3d81d12951008599b546d81b6064dbae421c-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "e14a9f324ccc10c544d5a6ca72f027ef07398c78fe452c28f7a941a00ecf329f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/e14a9f324ccc10c544d5a6ca72f027ef07398c78fe452c28f7a941a00ecf329f/_data", "Type": "volume"}], "Name": "/t4ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "ce351ec58fed205da4c9e5a68766dc9f0410fa50dbc13163e00432c8d562ff67", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:09", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "ce351ec58fed205da4c9e5a68766dc9f0410fa50dbc13163e00432c8d562ff67", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:09", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "fad561b8f1923a7f0716df87e3623bd7fc4079cc4e536d06265de08ad66a5f63", "SandboxKey": "/var/run/docker/netns/fad561b8f192", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/cfe2e95863656d59c5b501cf35cb3d81d12951008599b546d81b6064dbae421c/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 19774, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:37:37.348357837Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:37:36.302965536Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/ac3f96e693b45f24ed6ceb27d7f5f9fa2eb8a5bc49a5b05c266a5c1c7d06a957-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/ac3f96e693b45f24ed6ceb27d7f5f9fa2eb8a5bc49a5b05c266a5c1c7d06a957/merged", "UpperDir": "/var/lib/docker/overlay2/ac3f96e693b45f24ed6ceb27d7f5f9fa2eb8a5bc49a5b05c266a5c1c7d06a957/diff", "WorkDir": "/var/lib/docker/overlay2/ac3f96e693b45f24ed6ceb27d7f5f9fa2eb8a5bc49a5b05c266a5c1c7d06a957/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/cfe2e95863656d59c5b501cf35cb3d81d12951008599b546d81b6064dbae421c/hostname", "HostsPath": "/var/lib/docker/containers/cfe2e95863656d59c5b501cf35cb3d81d12951008599b546d81b6064dbae421c/hosts", "Id": "cfe2e95863656d59c5b501cf35cb3d81d12951008599b546d81b6064dbae421c", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/cfe2e95863656d59c5b501cf35cb3d81d12951008599b546d81b6064dbae421c/cfe2e95863656d59c5b501cf35cb3d81d12951008599b546d81b6064dbae421c-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "e14a9f324ccc10c544d5a6ca72f027ef07398c78fe452c28f7a941a00ecf329f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/e14a9f324ccc10c544d5a6ca72f027ef07398c78fe452c28f7a941a00ecf329f/_data", "Type": "volume"}], "Name": "/t4ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "ce351ec58fed205da4c9e5a68766dc9f0410fa50dbc13163e00432c8d562ff67", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:09", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "ce351ec58fed205da4c9e5a68766dc9f0410fa50dbc13163e00432c8d562ff67", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:09", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "fad561b8f1923a7f0716df87e3623bd7fc4079cc4e536d06265de08ad66a5f63", "SandboxKey": "/var/run/docker/netns/fad561b8f192", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/cfe2e95863656d59c5b501cf35cb3d81d12951008599b546d81b6064dbae421c/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 19774, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:37:37.348357837Z", "Status": "running"}}, "item": {"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vmif": "t4C3if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:37:38.093840864Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/2f0166947fef04e2133e9c1d485cf0b36324e9dd3c2f5903687ea40c765fa281-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/2f0166947fef04e2133e9c1d485cf0b36324e9dd3c2f5903687ea40c765fa281/merged", "UpperDir": "/var/lib/docker/overlay2/2f0166947fef04e2133e9c1d485cf0b36324e9dd3c2f5903687ea40c765fa281/diff", "WorkDir": "/var/lib/docker/overlay2/2f0166947fef04e2133e9c1d485cf0b36324e9dd3c2f5903687ea40c765fa281/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/161b7ee0ae4c98aa7e950e9280eaead909b529dfe630a66df441cc4036f3389f/hostname", "HostsPath": "/var/lib/docker/containers/161b7ee0ae4c98aa7e950e9280eaead909b529dfe630a66df441cc4036f3389f/hosts", "Id": "161b7ee0ae4c98aa7e950e9280eaead909b529dfe630a66df441cc4036f3389f", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/161b7ee0ae4c98aa7e950e9280eaead909b529dfe630a66df441cc4036f3389f/161b7ee0ae4c98aa7e950e9280eaead909b529dfe630a66df441cc4036f3389f-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "933bff187b3def0e9051b3c5a97608065703bce84cc4b41d800d0164e28a1e01", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/933bff187b3def0e9051b3c5a97608065703bce84cc4b41d800d0164e28a1e01/_data", "Type": "volume"}], "Name": "/t4ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "0f0335e48c71b6a3e1d9a625e5229b1e83fbd0b2d70a93c420664d0e3de4d419", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.10", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0a", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "0f0335e48c71b6a3e1d9a625e5229b1e83fbd0b2d70a93c420664d0e3de4d419", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.10", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0a", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "4455098c784dc5adc124cb9701b89fd00d4e4682a7687938947fe6981fe7ed41", "SandboxKey": "/var/run/docker/netns/4455098c784d", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/161b7ee0ae4c98aa7e950e9280eaead909b529dfe630a66df441cc4036f3389f/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 22020, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:37:39.16112162Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:37:38.093840864Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/2f0166947fef04e2133e9c1d485cf0b36324e9dd3c2f5903687ea40c765fa281-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/2f0166947fef04e2133e9c1d485cf0b36324e9dd3c2f5903687ea40c765fa281/merged", "UpperDir": "/var/lib/docker/overlay2/2f0166947fef04e2133e9c1d485cf0b36324e9dd3c2f5903687ea40c765fa281/diff", "WorkDir": "/var/lib/docker/overlay2/2f0166947fef04e2133e9c1d485cf0b36324e9dd3c2f5903687ea40c765fa281/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/161b7ee0ae4c98aa7e950e9280eaead909b529dfe630a66df441cc4036f3389f/hostname", "HostsPath": "/var/lib/docker/containers/161b7ee0ae4c98aa7e950e9280eaead909b529dfe630a66df441cc4036f3389f/hosts", "Id": "161b7ee0ae4c98aa7e950e9280eaead909b529dfe630a66df441cc4036f3389f", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/161b7ee0ae4c98aa7e950e9280eaead909b529dfe630a66df441cc4036f3389f/161b7ee0ae4c98aa7e950e9280eaead909b529dfe630a66df441cc4036f3389f-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "933bff187b3def0e9051b3c5a97608065703bce84cc4b41d800d0164e28a1e01", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/933bff187b3def0e9051b3c5a97608065703bce84cc4b41d800d0164e28a1e01/_data", "Type": "volume"}], "Name": "/t4ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "0f0335e48c71b6a3e1d9a625e5229b1e83fbd0b2d70a93c420664d0e3de4d419", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.10", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0a", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "0f0335e48c71b6a3e1d9a625e5229b1e83fbd0b2d70a93c420664d0e3de4d419", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.10", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0a", "NetworkID": "df8fa3f56d17f6c5eb251b90dd85f3ff5ff5a874bc62f574941b39e649e2a4b0"}}, "Ports": {}, "SandboxID": "4455098c784dc5adc124cb9701b89fd00d4e4682a7687938947fe6981fe7ed41", "SandboxKey": "/var/run/docker/netns/4455098c784d", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/161b7ee0ae4c98aa7e950e9280eaead909b529dfe630a66df441cc4036f3389f/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 22020, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T03:37:39.16112162Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vmif": "t4C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 08:16:31.833443 Printing the yaml input file
INFO:root: 08:16:31.841251 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True}, {'GUI': True}]}
INFO:root: 08:16:31.841397 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 08:16:31.841454 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 08:16:31.841497 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T08:16:34.110796432Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/70a50408df5735ad97bc8c2e7a7ed76c729d354aab2ca3f19c2614bd018b82fe-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/70a50408df5735ad97bc8c2e7a7ed76c729d354aab2ca3f19c2614bd018b82fe/merged", "UpperDir": "/var/lib/docker/overlay2/70a50408df5735ad97bc8c2e7a7ed76c729d354aab2ca3f19c2614bd018b82fe/diff", "WorkDir": "/var/lib/docker/overlay2/70a50408df5735ad97bc8c2e7a7ed76c729d354aab2ca3f19c2614bd018b82fe/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/2baf9ec93948da5a5d9ad49fa918936192d45da2335d0761a9165cdc31be78d6/hostname", "HostsPath": "/var/lib/docker/containers/2baf9ec93948da5a5d9ad49fa918936192d45da2335d0761a9165cdc31be78d6/hosts", "Id": "2baf9ec93948da5a5d9ad49fa918936192d45da2335d0761a9165cdc31be78d6", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/2baf9ec93948da5a5d9ad49fa918936192d45da2335d0761a9165cdc31be78d6/2baf9ec93948da5a5d9ad49fa918936192d45da2335d0761a9165cdc31be78d6-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "f4153433057f0afd4112cc79002353e3486e3acca2225ad04fa57de97e94c07e", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/f4153433057f0afd4112cc79002353e3486e3acca2225ad04fa57de97e94c07e/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "b83256ae331d593b57235f9a32243178326ccc95c80ccc1bbd5930f6ddcee523", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "b83256ae331d593b57235f9a32243178326ccc95c80ccc1bbd5930f6ddcee523", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "a962eef6f1adf37122b987a746f804ce1f2780d97ee8d2579b689d07dbb26402"}}, "Ports": {}, "SandboxID": "3b02e978ecb44bad1ec9cd2abdf1540de0777018f607f3d683b2ca459affd514", "SandboxKey": "/var/run/docker/netns/3b02e978ecb4", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/2baf9ec93948da5a5d9ad49fa918936192d45da2335d0761a9165cdc31be78d6/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 10706, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T08:16:34.870919726Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T08:16:34.110796432Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/70a50408df5735ad97bc8c2e7a7ed76c729d354aab2ca3f19c2614bd018b82fe-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/70a50408df5735ad97bc8c2e7a7ed76c729d354aab2ca3f19c2614bd018b82fe/merged", "UpperDir": "/var/lib/docker/overlay2/70a50408df5735ad97bc8c2e7a7ed76c729d354aab2ca3f19c2614bd018b82fe/diff", "WorkDir": "/var/lib/docker/overlay2/70a50408df5735ad97bc8c2e7a7ed76c729d354aab2ca3f19c2614bd018b82fe/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/2baf9ec93948da5a5d9ad49fa918936192d45da2335d0761a9165cdc31be78d6/hostname", "HostsPath": "/var/lib/docker/containers/2baf9ec93948da5a5d9ad49fa918936192d45da2335d0761a9165cdc31be78d6/hosts", "Id": "2baf9ec93948da5a5d9ad49fa918936192d45da2335d0761a9165cdc31be78d6", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/2baf9ec93948da5a5d9ad49fa918936192d45da2335d0761a9165cdc31be78d6/2baf9ec93948da5a5d9ad49fa918936192d45da2335d0761a9165cdc31be78d6-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "f4153433057f0afd4112cc79002353e3486e3acca2225ad04fa57de97e94c07e", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/f4153433057f0afd4112cc79002353e3486e3acca2225ad04fa57de97e94c07e/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "b83256ae331d593b57235f9a32243178326ccc95c80ccc1bbd5930f6ddcee523", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "b83256ae331d593b57235f9a32243178326ccc95c80ccc1bbd5930f6ddcee523", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "a962eef6f1adf37122b987a746f804ce1f2780d97ee8d2579b689d07dbb26402"}}, "Ports": {}, "SandboxID": "3b02e978ecb44bad1ec9cd2abdf1540de0777018f607f3d683b2ca459affd514", "SandboxKey": "/var/run/docker/netns/3b02e978ecb4", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/2baf9ec93948da5a5d9ad49fa918936192d45da2335d0761a9165cdc31be78d6/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 10706, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T08:16:34.870919726Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'tenant_route_ip': u'192.168.2.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.1.11.0/24', u'remote_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T08:16:35.39379142Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/df59c6f40d0e59cac7c959e1e0067fb055a95e96ff54f668d8d94ef587f365e0-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/df59c6f40d0e59cac7c959e1e0067fb055a95e96ff54f668d8d94ef587f365e0/merged", "UpperDir": "/var/lib/docker/overlay2/df59c6f40d0e59cac7c959e1e0067fb055a95e96ff54f668d8d94ef587f365e0/diff", "WorkDir": "/var/lib/docker/overlay2/df59c6f40d0e59cac7c959e1e0067fb055a95e96ff54f668d8d94ef587f365e0/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/76a0e8c8de8d63e75d9b68cf9126dc19e3736fc3385e9110c2b05a456384eeb2/hostname", "HostsPath": "/var/lib/docker/containers/76a0e8c8de8d63e75d9b68cf9126dc19e3736fc3385e9110c2b05a456384eeb2/hosts", "Id": "76a0e8c8de8d63e75d9b68cf9126dc19e3736fc3385e9110c2b05a456384eeb2", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/76a0e8c8de8d63e75d9b68cf9126dc19e3736fc3385e9110c2b05a456384eeb2/76a0e8c8de8d63e75d9b68cf9126dc19e3736fc3385e9110c2b05a456384eeb2-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "d8ca2b98dec649f8f0e983b07bb4164fb0f8f85207642bd23378ad21ddbbcfcf", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/d8ca2b98dec649f8f0e983b07bb4164fb0f8f85207642bd23378ad21ddbbcfcf/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "373239b518cc2ef800454755dec21a75a743b7ca1098459bdb39c1f58e4c950c", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "373239b518cc2ef800454755dec21a75a743b7ca1098459bdb39c1f58e4c950c", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "a962eef6f1adf37122b987a746f804ce1f2780d97ee8d2579b689d07dbb26402"}}, "Ports": {}, "SandboxID": "ee08e8fb3e54769c0cdef856ee01bb7c882b7eac962fe34cba95cbc632526d5c", "SandboxKey": "/var/run/docker/netns/ee08e8fb3e54", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/76a0e8c8de8d63e75d9b68cf9126dc19e3736fc3385e9110c2b05a456384eeb2/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 11321, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T08:16:36.19038795Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T08:16:35.39379142Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/df59c6f40d0e59cac7c959e1e0067fb055a95e96ff54f668d8d94ef587f365e0-init/diff:/var/lib/docker/overlay2/3c0c34f8997bde7fbe7e7942c96a5cca949b68d50b491ac1be3727f4bb96be96/diff:/var/lib/docker/overlay2/bf876a7a7f8e9c087075132cf21e69720b6ba54534ce43fbc7854dc8f91e3c2d/diff:/var/lib/docker/overlay2/d8c00cf21336aed4828fcb7a021fc1963de5af76b4dd766ceb9db07be86ff231/diff:/var/lib/docker/overlay2/029e9cf9fbe0ad3054ff8080d61e09619a4a0b6766795e66dc8fa5ea01220408/diff", "MergedDir": "/var/lib/docker/overlay2/df59c6f40d0e59cac7c959e1e0067fb055a95e96ff54f668d8d94ef587f365e0/merged", "UpperDir": "/var/lib/docker/overlay2/df59c6f40d0e59cac7c959e1e0067fb055a95e96ff54f668d8d94ef587f365e0/diff", "WorkDir": "/var/lib/docker/overlay2/df59c6f40d0e59cac7c959e1e0067fb055a95e96ff54f668d8d94ef587f365e0/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/76a0e8c8de8d63e75d9b68cf9126dc19e3736fc3385e9110c2b05a456384eeb2/hostname", "HostsPath": "/var/lib/docker/containers/76a0e8c8de8d63e75d9b68cf9126dc19e3736fc3385e9110c2b05a456384eeb2/hosts", "Id": "76a0e8c8de8d63e75d9b68cf9126dc19e3736fc3385e9110c2b05a456384eeb2", "Image": "sha256:531762d43abf16ef2ef5d84dc27f3a6d2fce1149d5f3fe530cd2b1e38a9ba949", "LogPath": "/var/lib/docker/containers/76a0e8c8de8d63e75d9b68cf9126dc19e3736fc3385e9110c2b05a456384eeb2/76a0e8c8de8d63e75d9b68cf9126dc19e3736fc3385e9110c2b05a456384eeb2-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "d8ca2b98dec649f8f0e983b07bb4164fb0f8f85207642bd23378ad21ddbbcfcf", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/d8ca2b98dec649f8f0e983b07bb4164fb0f8f85207642bd23378ad21ddbbcfcf/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "373239b518cc2ef800454755dec21a75a743b7ca1098459bdb39c1f58e4c950c", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "373239b518cc2ef800454755dec21a75a743b7ca1098459bdb39c1f58e4c950c", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "a962eef6f1adf37122b987a746f804ce1f2780d97ee8d2579b689d07dbb26402"}}, "Ports": {}, "SandboxID": "ee08e8fb3e54769c0cdef856ee01bb7c882b7eac962fe34cba95cbc632526d5c", "SandboxKey": "/var/run/docker/netns/ee08e8fb3e54", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/76a0e8c8de8d63e75d9b68cf9126dc19e3736fc3385e9110c2b05a456384eeb2/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 11321, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T08:16:36.19038795Z", "Status": "running"}}, "item": {"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:39.090639666Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673/merged", "UpperDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673/diff", "WorkDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": [], "DnsOptions": [], "DnsSearch": [], "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/hostname", "HostsPath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/hosts", "Id": "381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ed8f4c1e68aa23d38911f66d5606cc23928d0e65bc0ca656517ea28f16ad00dd", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ed8f4c1e68aa23d38911f66d5606cc23928d0e65bc0ca656517ea28f16ad00dd/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "65bc6aea83b7d8de16c4ee5d05a3b239db495a04ddf5b778cfefd016fa5546fd", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "65bc6aea83b7d8de16c4ee5d05a3b239db495a04ddf5b778cfefd016fa5546fd", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "94f0c502bf8ca2a63c9f7786064b4c895c179c575fb77fa60c06cbe0383f2be8"}}, "Ports": {}, "SandboxID": "d7d83d7e21742bb01aee8cde9221bdd03391d726a2fc3ab8b17a39e2bdc09368", "SandboxKey": "/var/run/docker/netns/d7d83d7e2174", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "2019-12-06T07:50:18.495424976Z", "OOMKilled": false, "Paused": false, "Pid": 5688, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T08:16:40.458272881Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:39.090639666Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673/merged", "UpperDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673/diff", "WorkDir": "/var/lib/docker/overlay2/9a55a63409328723b25dd667d5359b4997dc107177019b8e1aae6afbe5418673/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": [], "DnsOptions": [], "DnsSearch": [], "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/hostname", "HostsPath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/hosts", "Id": "381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ed8f4c1e68aa23d38911f66d5606cc23928d0e65bc0ca656517ea28f16ad00dd", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ed8f4c1e68aa23d38911f66d5606cc23928d0e65bc0ca656517ea28f16ad00dd/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "65bc6aea83b7d8de16c4ee5d05a3b239db495a04ddf5b778cfefd016fa5546fd", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "65bc6aea83b7d8de16c4ee5d05a3b239db495a04ddf5b778cfefd016fa5546fd", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "94f0c502bf8ca2a63c9f7786064b4c895c179c575fb77fa60c06cbe0383f2be8"}}, "Ports": {}, "SandboxID": "d7d83d7e21742bb01aee8cde9221bdd03391d726a2fc3ab8b17a39e2bdc09368", "SandboxKey": "/var/run/docker/netns/d7d83d7e2174", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/381072b462f106107b088e0f461f42f31cbec80465b2e00b761265d48999cad7/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "2019-12-06T07:50:18.495424976Z", "OOMKilled": false, "Paused": false, "Pid": 5688, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T08:16:40.458272881Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'tenant_route_ip': u'192.168.130.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.2.11.0/24', u'remote_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:41.971548875Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19/merged", "UpperDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19/diff", "WorkDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": [], "DnsOptions": [], "DnsSearch": [], "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/hostname", "HostsPath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/hosts", "Id": "a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "9b1b87e5e20036f2c5ace41968a33cc153074be7b8f04844712245750183a5f2", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/9b1b87e5e20036f2c5ace41968a33cc153074be7b8f04844712245750183a5f2/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "97896f7af0fce0f44bfe668ff1970a70c843c2f4efb1c59e4acda0146c984e97", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "97896f7af0fce0f44bfe668ff1970a70c843c2f4efb1c59e4acda0146c984e97", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "94f0c502bf8ca2a63c9f7786064b4c895c179c575fb77fa60c06cbe0383f2be8"}}, "Ports": {}, "SandboxID": "70816567d7b6044b3e8729e0519046d5a6c2c167aae416f44d57a6a9a586dfe7", "SandboxKey": "/var/run/docker/netns/70816567d7b6", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "2019-12-06T07:50:18.318082868Z", "OOMKilled": false, "Paused": false, "Pid": 6422, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T08:16:41.733636945Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:41.971548875Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19/merged", "UpperDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19/diff", "WorkDir": "/var/lib/docker/overlay2/74e2cdfd5d58d9af873f55c994fa9f20e641cf1b8b7f9532602fed3d68746a19/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": [], "DnsOptions": [], "DnsSearch": [], "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/hostname", "HostsPath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/hosts", "Id": "a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "9b1b87e5e20036f2c5ace41968a33cc153074be7b8f04844712245750183a5f2", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/9b1b87e5e20036f2c5ace41968a33cc153074be7b8f04844712245750183a5f2/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "97896f7af0fce0f44bfe668ff1970a70c843c2f4efb1c59e4acda0146c984e97", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "97896f7af0fce0f44bfe668ff1970a70c843c2f4efb1c59e4acda0146c984e97", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "94f0c502bf8ca2a63c9f7786064b4c895c179c575fb77fa60c06cbe0383f2be8"}}, "Ports": {}, "SandboxID": "70816567d7b6044b3e8729e0519046d5a6c2c167aae416f44d57a6a9a586dfe7", "SandboxKey": "/var/run/docker/netns/70816567d7b6", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/a01408b62745adbc2ea5cc2da0069b21942041490a49318a7c38e75c2f9af5eb/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "2019-12-06T07:50:18.318082868Z", "OOMKilled": false, "Paused": false, "Pid": 6422, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T08:16:41.733636945Z", "Status": "running"}}, "item": {"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:45.597688588Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0/merged", "UpperDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0/diff", "WorkDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": [], "DnsOptions": [], "DnsSearch": [], "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/hostname", "HostsPath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/hosts", "Id": "40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "3a47f27fd2b45c7d323fc207dab7de8a731edad2065f02deeda39ee8f724081d", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/3a47f27fd2b45c7d323fc207dab7de8a731edad2065f02deeda39ee8f724081d/_data", "Type": "volume"}], "Name": "/t2ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "d07edf4534ab30e5476f5f3c8d215090e049377c1e473f3d4d4913823895ad69", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d07edf4534ab30e5476f5f3c8d215090e049377c1e473f3d4d4913823895ad69", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "94f0c502bf8ca2a63c9f7786064b4c895c179c575fb77fa60c06cbe0383f2be8"}}, "Ports": {}, "SandboxID": "e2c093b2ca31c0bfde6b330b8a1d8ef302b6c205336883dc98490ed71dba68cf", "SandboxKey": "/var/run/docker/netns/e2c093b2ca31", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "2019-12-06T07:50:18.319647994Z", "OOMKilled": false, "Paused": false, "Pid": 7571, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T08:16:43.13522827Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T03:21:45.597688588Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0/merged", "UpperDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0/diff", "WorkDir": "/var/lib/docker/overlay2/897676a16935f52cdbafcba29baaf069460a598cfbff9951582e67be37fc5af0/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": [], "DnsOptions": [], "DnsSearch": [], "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/hostname", "HostsPath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/hosts", "Id": "40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "3a47f27fd2b45c7d323fc207dab7de8a731edad2065f02deeda39ee8f724081d", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/3a47f27fd2b45c7d323fc207dab7de8a731edad2065f02deeda39ee8f724081d/_data", "Type": "volume"}], "Name": "/t2ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "d07edf4534ab30e5476f5f3c8d215090e049377c1e473f3d4d4913823895ad69", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d07edf4534ab30e5476f5f3c8d215090e049377c1e473f3d4d4913823895ad69", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "94f0c502bf8ca2a63c9f7786064b4c895c179c575fb77fa60c06cbe0383f2be8"}}, "Ports": {}, "SandboxID": "e2c093b2ca31c0bfde6b330b8a1d8ef302b6c205336883dc98490ed71dba68cf", "SandboxKey": "/var/run/docker/netns/e2c093b2ca31", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/40ec74ab39cfb760de67209bccb414ca60d203d993ef08dd3d64cd679c66f03c/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "2019-12-06T07:50:18.319647994Z", "OOMKilled": false, "Paused": false, "Pid": 7571, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T08:16:43.13522827Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 10:03:00.112933 Printing the yaml input file
INFO:root: 10:03:00.113385 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 10:03:00.113498 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 10:03:00.113552 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 10:03:00.113596 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] **********************************************************************************************************

TASK [Build Docker Image] ********************************************************************************************
changed: [localhost] => {"actions": ["Built image centos7:latest from ./"], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": true, "image": {"Architecture": "amd64", "Author": "Prashanth_M", "Comment": "", "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "", "Image": "sha256:c4bb4e3fb52a907c3720dd6198fe7d9a9c60962aafd041071118ac3908e21adf", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Container": "e5a82d2c42c353eacaed72e405d33e9332543ca0ff4e5371efa945c2412c60d1", "ContainerConfig": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/bin/sh", "-c", "#(nop) ", "CMD [\"/usr/sbin/init\"]"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "e5a82d2c42c3", "Image": "sha256:c4bb4e3fb52a907c3720dd6198fe7d9a9c60962aafd041071118ac3908e21adf", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T10:05:24.983271122Z", "DockerVersion": "19.03.5", "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/a7396dbaedb7c62cbc156f94acff4f2d3ddb6ea33041a99c0aa2eca5e3a2076b/diff:/var/lib/docker/overlay2/463d36e2c6d6da4df3b866c48058434a951e0814e805d561c00c219879f08395/diff:/var/lib/docker/overlay2/0a33c105aaafed36444a836c8a0147ad06cf19079e9a9fb94c196e1b6a262e59/diff", "MergedDir": "/var/lib/docker/overlay2/f2289c8bfd28ee9121849a586dedf12fb3cb9c015f25ab46071fb8fb5422662b/merged", "UpperDir": "/var/lib/docker/overlay2/f2289c8bfd28ee9121849a586dedf12fb3cb9c015f25ab46071fb8fb5422662b/diff", "WorkDir": "/var/lib/docker/overlay2/f2289c8bfd28ee9121849a586dedf12fb3cb9c015f25ab46071fb8fb5422662b/work"}, "Name": "overlay2"}, "Id": "sha256:c6de17ae9c33d48e27ede4963d73003cdd3a8467206b23baacd984193a1478dc", "Metadata": {"LastTagTime": "2019-12-06T10:05:25.010989275Z"}, "Os": "linux", "Parent": "sha256:c4bb4e3fb52a907c3720dd6198fe7d9a9c60962aafd041071118ac3908e21adf", "RepoDigests": [], "RepoTags": ["centos7:latest"], "RootFS": {"Layers": ["sha256:77b174a6a187b610e4699546bd973a8d1e77663796e3724318a2a4b24cb07ea0", "sha256:938e7a9349ef7ea36e2d65ad90621011b8aa4268a603bd475d5ab8d423101a0d", "sha256:92e75c14f11f3a368a7c9575a283e3f4e20e879929f47ef65a84386203bfe38b", "sha256:1e5772eded2309ddb7e0bae68051559dada43aad646a8a51620d1a4715e2247c"], "Type": "layers"}, "Size": 362788750, "VirtualSize": 362788750}}

TASK [Spawning Tenant Container] *************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.1.1', u'name': u't1', u'pns_ip': u'192.168.1.1/24', u'tenant_if': u't1if', u'tenant_ip': u'192.168.1.2/24', u'pns_if': u't1pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T10:05:25.73059669Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/102176327ce75eb3a5b24a0cf17842a792e083900998ebe3d13b05bce53a7f3a-init/diff:/var/lib/docker/overlay2/f2289c8bfd28ee9121849a586dedf12fb3cb9c015f25ab46071fb8fb5422662b/diff:/var/lib/docker/overlay2/a7396dbaedb7c62cbc156f94acff4f2d3ddb6ea33041a99c0aa2eca5e3a2076b/diff:/var/lib/docker/overlay2/463d36e2c6d6da4df3b866c48058434a951e0814e805d561c00c219879f08395/diff:/var/lib/docker/overlay2/0a33c105aaafed36444a836c8a0147ad06cf19079e9a9fb94c196e1b6a262e59/diff", "MergedDir": "/var/lib/docker/overlay2/102176327ce75eb3a5b24a0cf17842a792e083900998ebe3d13b05bce53a7f3a/merged", "UpperDir": "/var/lib/docker/overlay2/102176327ce75eb3a5b24a0cf17842a792e083900998ebe3d13b05bce53a7f3a/diff", "WorkDir": "/var/lib/docker/overlay2/102176327ce75eb3a5b24a0cf17842a792e083900998ebe3d13b05bce53a7f3a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/ddecfc20d401fc31108496fb738e284c06b1129d03e16f10343e43b899ab389b/hostname", "HostsPath": "/var/lib/docker/containers/ddecfc20d401fc31108496fb738e284c06b1129d03e16f10343e43b899ab389b/hosts", "Id": "ddecfc20d401fc31108496fb738e284c06b1129d03e16f10343e43b899ab389b", "Image": "sha256:c6de17ae9c33d48e27ede4963d73003cdd3a8467206b23baacd984193a1478dc", "LogPath": "/var/lib/docker/containers/ddecfc20d401fc31108496fb738e284c06b1129d03e16f10343e43b899ab389b/ddecfc20d401fc31108496fb738e284c06b1129d03e16f10343e43b899ab389b-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "e9a22c981935d9197e13207e91556b3c9d578ff9200b92603dc0c76296717f63", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/e9a22c981935d9197e13207e91556b3c9d578ff9200b92603dc0c76296717f63/_data", "Type": "volume"}], "Name": "/t1", "NetworkSettings": {"Bridge": "", "EndpointID": "2388c9b14f5f9e0827846897e0f5b3a451afa1e1bd34df5b50e83afad65ed5ff", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "2388c9b14f5f9e0827846897e0f5b3a451afa1e1bd34df5b50e83afad65ed5ff", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "4b8f5b73c7c39a096b50977a5b92af8cfebee78d570591e19522b7b93e0f4d33"}}, "Ports": {}, "SandboxID": "aa7cffed7c5c8a82ec0bad616e061c1741272b4ab7d6e8005a4c80fff7de7e9e", "SandboxKey": "/var/run/docker/netns/aa7cffed7c5c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/ddecfc20d401fc31108496fb738e284c06b1129d03e16f10343e43b899ab389b/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 19028, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T10:05:26.188296164Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T10:05:25.73059669Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/102176327ce75eb3a5b24a0cf17842a792e083900998ebe3d13b05bce53a7f3a-init/diff:/var/lib/docker/overlay2/f2289c8bfd28ee9121849a586dedf12fb3cb9c015f25ab46071fb8fb5422662b/diff:/var/lib/docker/overlay2/a7396dbaedb7c62cbc156f94acff4f2d3ddb6ea33041a99c0aa2eca5e3a2076b/diff:/var/lib/docker/overlay2/463d36e2c6d6da4df3b866c48058434a951e0814e805d561c00c219879f08395/diff:/var/lib/docker/overlay2/0a33c105aaafed36444a836c8a0147ad06cf19079e9a9fb94c196e1b6a262e59/diff", "MergedDir": "/var/lib/docker/overlay2/102176327ce75eb3a5b24a0cf17842a792e083900998ebe3d13b05bce53a7f3a/merged", "UpperDir": "/var/lib/docker/overlay2/102176327ce75eb3a5b24a0cf17842a792e083900998ebe3d13b05bce53a7f3a/diff", "WorkDir": "/var/lib/docker/overlay2/102176327ce75eb3a5b24a0cf17842a792e083900998ebe3d13b05bce53a7f3a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/ddecfc20d401fc31108496fb738e284c06b1129d03e16f10343e43b899ab389b/hostname", "HostsPath": "/var/lib/docker/containers/ddecfc20d401fc31108496fb738e284c06b1129d03e16f10343e43b899ab389b/hosts", "Id": "ddecfc20d401fc31108496fb738e284c06b1129d03e16f10343e43b899ab389b", "Image": "sha256:c6de17ae9c33d48e27ede4963d73003cdd3a8467206b23baacd984193a1478dc", "LogPath": "/var/lib/docker/containers/ddecfc20d401fc31108496fb738e284c06b1129d03e16f10343e43b899ab389b/ddecfc20d401fc31108496fb738e284c06b1129d03e16f10343e43b899ab389b-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "e9a22c981935d9197e13207e91556b3c9d578ff9200b92603dc0c76296717f63", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/e9a22c981935d9197e13207e91556b3c9d578ff9200b92603dc0c76296717f63/_data", "Type": "volume"}], "Name": "/t1", "NetworkSettings": {"Bridge": "", "EndpointID": "2388c9b14f5f9e0827846897e0f5b3a451afa1e1bd34df5b50e83afad65ed5ff", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "2388c9b14f5f9e0827846897e0f5b3a451afa1e1bd34df5b50e83afad65ed5ff", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "4b8f5b73c7c39a096b50977a5b92af8cfebee78d570591e19522b7b93e0f4d33"}}, "Ports": {}, "SandboxID": "aa7cffed7c5c8a82ec0bad616e061c1741272b4ab7d6e8005a4c80fff7de7e9e", "SandboxKey": "/var/run/docker/netns/aa7cffed7c5c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/ddecfc20d401fc31108496fb738e284c06b1129d03e16f10343e43b899ab389b/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 19028, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T10:05:26.188296164Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.1.1", "name": "t1", "pns_if": "t1pns_if", "pns_ip": "192.168.1.1/24", "tenant_if": "t1if", "tenant_ip": "192.168.1.2/24"}}

TASK [Create Subnet Containers] **************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.1.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.1.2/24', u'tenant_ns_ip': u'10.1.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_ns_name': u't1', u'tenant_sub_if': u't1s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't1br1if1', u'vmif': u't1C1if1', u'name': u't1_C1'}, {u'brif': u't1br1if2', u'vmif': u't1C2if1', u'name': u't1_C2'}], u'vxlan': [{u'local_ip': u'10.1.1.2', u'tenant_route_ip': u'192.168.1.2', u'dsport': 4789, u'dev': u't1s1if', u'subnet_route': u'10.1.1.0/24', u'remote_route': u'10.2.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.2.1.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t1ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T10:05:26.871141027Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/8e58e3541b4d78eb8fd4dd230c10d999dfa7157172f0a6e832c255021471cb75-init/diff:/var/lib/docker/overlay2/f2289c8bfd28ee9121849a586dedf12fb3cb9c015f25ab46071fb8fb5422662b/diff:/var/lib/docker/overlay2/a7396dbaedb7c62cbc156f94acff4f2d3ddb6ea33041a99c0aa2eca5e3a2076b/diff:/var/lib/docker/overlay2/463d36e2c6d6da4df3b866c48058434a951e0814e805d561c00c219879f08395/diff:/var/lib/docker/overlay2/0a33c105aaafed36444a836c8a0147ad06cf19079e9a9fb94c196e1b6a262e59/diff", "MergedDir": "/var/lib/docker/overlay2/8e58e3541b4d78eb8fd4dd230c10d999dfa7157172f0a6e832c255021471cb75/merged", "UpperDir": "/var/lib/docker/overlay2/8e58e3541b4d78eb8fd4dd230c10d999dfa7157172f0a6e832c255021471cb75/diff", "WorkDir": "/var/lib/docker/overlay2/8e58e3541b4d78eb8fd4dd230c10d999dfa7157172f0a6e832c255021471cb75/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/f7e7a19c57a81113c4e434ca38c9983caa78159ebc121a9b383f9a86b93335c5/hostname", "HostsPath": "/var/lib/docker/containers/f7e7a19c57a81113c4e434ca38c9983caa78159ebc121a9b383f9a86b93335c5/hosts", "Id": "f7e7a19c57a81113c4e434ca38c9983caa78159ebc121a9b383f9a86b93335c5", "Image": "sha256:c6de17ae9c33d48e27ede4963d73003cdd3a8467206b23baacd984193a1478dc", "LogPath": "/var/lib/docker/containers/f7e7a19c57a81113c4e434ca38c9983caa78159ebc121a9b383f9a86b93335c5/f7e7a19c57a81113c4e434ca38c9983caa78159ebc121a9b383f9a86b93335c5-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "84eb8da99fd599137fc46839fae2ba3f1bb14b7253aa6963c6844ffa5c3ae7f9", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/84eb8da99fd599137fc46839fae2ba3f1bb14b7253aa6963c6844ffa5c3ae7f9/_data", "Type": "volume"}], "Name": "/t1ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "28c44c577abf1f6e469620bcbc97386b7067025921b5ec12b426be595e74573a", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "28c44c577abf1f6e469620bcbc97386b7067025921b5ec12b426be595e74573a", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "4b8f5b73c7c39a096b50977a5b92af8cfebee78d570591e19522b7b93e0f4d33"}}, "Ports": {}, "SandboxID": "578633e096ea58f7c1806790e43876126f3c1ef4af4715d19383448973ffba05", "SandboxKey": "/var/run/docker/netns/578633e096ea", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/f7e7a19c57a81113c4e434ca38c9983caa78159ebc121a9b383f9a86b93335c5/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 19643, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T10:05:27.542650337Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t1ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T10:05:26.871141027Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/8e58e3541b4d78eb8fd4dd230c10d999dfa7157172f0a6e832c255021471cb75-init/diff:/var/lib/docker/overlay2/f2289c8bfd28ee9121849a586dedf12fb3cb9c015f25ab46071fb8fb5422662b/diff:/var/lib/docker/overlay2/a7396dbaedb7c62cbc156f94acff4f2d3ddb6ea33041a99c0aa2eca5e3a2076b/diff:/var/lib/docker/overlay2/463d36e2c6d6da4df3b866c48058434a951e0814e805d561c00c219879f08395/diff:/var/lib/docker/overlay2/0a33c105aaafed36444a836c8a0147ad06cf19079e9a9fb94c196e1b6a262e59/diff", "MergedDir": "/var/lib/docker/overlay2/8e58e3541b4d78eb8fd4dd230c10d999dfa7157172f0a6e832c255021471cb75/merged", "UpperDir": "/var/lib/docker/overlay2/8e58e3541b4d78eb8fd4dd230c10d999dfa7157172f0a6e832c255021471cb75/diff", "WorkDir": "/var/lib/docker/overlay2/8e58e3541b4d78eb8fd4dd230c10d999dfa7157172f0a6e832c255021471cb75/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/f7e7a19c57a81113c4e434ca38c9983caa78159ebc121a9b383f9a86b93335c5/hostname", "HostsPath": "/var/lib/docker/containers/f7e7a19c57a81113c4e434ca38c9983caa78159ebc121a9b383f9a86b93335c5/hosts", "Id": "f7e7a19c57a81113c4e434ca38c9983caa78159ebc121a9b383f9a86b93335c5", "Image": "sha256:c6de17ae9c33d48e27ede4963d73003cdd3a8467206b23baacd984193a1478dc", "LogPath": "/var/lib/docker/containers/f7e7a19c57a81113c4e434ca38c9983caa78159ebc121a9b383f9a86b93335c5/f7e7a19c57a81113c4e434ca38c9983caa78159ebc121a9b383f9a86b93335c5-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "84eb8da99fd599137fc46839fae2ba3f1bb14b7253aa6963c6844ffa5c3ae7f9", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/84eb8da99fd599137fc46839fae2ba3f1bb14b7253aa6963c6844ffa5c3ae7f9/_data", "Type": "volume"}], "Name": "/t1ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "28c44c577abf1f6e469620bcbc97386b7067025921b5ec12b426be595e74573a", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "28c44c577abf1f6e469620bcbc97386b7067025921b5ec12b426be595e74573a", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "4b8f5b73c7c39a096b50977a5b92af8cfebee78d570591e19522b7b93e0f4d33"}}, "Ports": {}, "SandboxID": "578633e096ea58f7c1806790e43876126f3c1ef4af4715d19383448973ffba05", "SandboxKey": "/var/run/docker/netns/578633e096ea", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/f7e7a19c57a81113c4e434ca38c9983caa78159ebc121a9b383f9a86b93335c5/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 19643, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T10:05:27.542650337Z", "Status": "running"}}, "item": {"bridge_name": "t1br1", "default_route_ip": "10.1.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.1.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.1.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.1.1.2/24"}], "vms": [{"brif": "t1br1if1", "name": "t1_C1", "vmif": "t1C1if1"}, {"brif": "t1br1if2", "name": "t1_C2", "vmif": "t1C2if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.1.2", "remote_ip": "10.2.1.2", "remote_route": "10.2.1.0/24", "subnet_route": "10.1.1.0/24", "tenant_route_ip": "192.168.1.2", "v_name": "vxlan_t1s1"}]}}

PLAY RECAP ***********************************************************************************************************
localhost                  : ok=3    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ********************************************************************************************************

TASK [Build Docker Image] ********************************************************************************************
ok: [99.99.99.2] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] *************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.129.1', u'name': u't1', u'pns_ip': u'192.168.129.1/24', u'tenant_if': u't1if', u'tenant_ip': u'192.168.129.2/24', u'pns_if': u't1pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T10:05:31.625636206Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/665a4db28f377cbb3529b2dedbab8bbf4d07fe14ff4e147b08fe57072ab51691-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/665a4db28f377cbb3529b2dedbab8bbf4d07fe14ff4e147b08fe57072ab51691/merged", "UpperDir": "/var/lib/docker/overlay2/665a4db28f377cbb3529b2dedbab8bbf4d07fe14ff4e147b08fe57072ab51691/diff", "WorkDir": "/var/lib/docker/overlay2/665a4db28f377cbb3529b2dedbab8bbf4d07fe14ff4e147b08fe57072ab51691/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/155815d93c541159c6933cdda5cb14bbd820f8307958c79c034016001e75ea32/hostname", "HostsPath": "/var/lib/docker/containers/155815d93c541159c6933cdda5cb14bbd820f8307958c79c034016001e75ea32/hosts", "Id": "155815d93c541159c6933cdda5cb14bbd820f8307958c79c034016001e75ea32", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/155815d93c541159c6933cdda5cb14bbd820f8307958c79c034016001e75ea32/155815d93c541159c6933cdda5cb14bbd820f8307958c79c034016001e75ea32-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "088dd73921c495a1e93603bf0a0a123a5ccb29ca2f3bb1d7beaa2bcabe418e4f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/088dd73921c495a1e93603bf0a0a123a5ccb29ca2f3bb1d7beaa2bcabe418e4f/_data", "Type": "volume"}], "Name": "/t1", "NetworkSettings": {"Bridge": "", "EndpointID": "d97119b71f3eec1e9e99a5e604833b6fc2166c158f56d9d1d707a2dc0109b6a2", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d97119b71f3eec1e9e99a5e604833b6fc2166c158f56d9d1d707a2dc0109b6a2", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "4d9d866badc7ef0ec7470f274f7e92d4a70ed17f2a50381955738de4ec78997d"}}, "Ports": {}, "SandboxID": "e9882017dd304dfc2a23561d7ba3edd368bc840b24ba0935c194a4d4130f1665", "SandboxKey": "/var/run/docker/netns/e9882017dd30", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/155815d93c541159c6933cdda5cb14bbd820f8307958c79c034016001e75ea32/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 7949, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T10:05:32.250093591Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T10:05:31.625636206Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/665a4db28f377cbb3529b2dedbab8bbf4d07fe14ff4e147b08fe57072ab51691-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/665a4db28f377cbb3529b2dedbab8bbf4d07fe14ff4e147b08fe57072ab51691/merged", "UpperDir": "/var/lib/docker/overlay2/665a4db28f377cbb3529b2dedbab8bbf4d07fe14ff4e147b08fe57072ab51691/diff", "WorkDir": "/var/lib/docker/overlay2/665a4db28f377cbb3529b2dedbab8bbf4d07fe14ff4e147b08fe57072ab51691/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/155815d93c541159c6933cdda5cb14bbd820f8307958c79c034016001e75ea32/hostname", "HostsPath": "/var/lib/docker/containers/155815d93c541159c6933cdda5cb14bbd820f8307958c79c034016001e75ea32/hosts", "Id": "155815d93c541159c6933cdda5cb14bbd820f8307958c79c034016001e75ea32", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/155815d93c541159c6933cdda5cb14bbd820f8307958c79c034016001e75ea32/155815d93c541159c6933cdda5cb14bbd820f8307958c79c034016001e75ea32-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "088dd73921c495a1e93603bf0a0a123a5ccb29ca2f3bb1d7beaa2bcabe418e4f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/088dd73921c495a1e93603bf0a0a123a5ccb29ca2f3bb1d7beaa2bcabe418e4f/_data", "Type": "volume"}], "Name": "/t1", "NetworkSettings": {"Bridge": "", "EndpointID": "d97119b71f3eec1e9e99a5e604833b6fc2166c158f56d9d1d707a2dc0109b6a2", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d97119b71f3eec1e9e99a5e604833b6fc2166c158f56d9d1d707a2dc0109b6a2", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "4d9d866badc7ef0ec7470f274f7e92d4a70ed17f2a50381955738de4ec78997d"}}, "Ports": {}, "SandboxID": "e9882017dd304dfc2a23561d7ba3edd368bc840b24ba0935c194a4d4130f1665", "SandboxKey": "/var/run/docker/netns/e9882017dd30", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/155815d93c541159c6933cdda5cb14bbd820f8307958c79c034016001e75ea32/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 7949, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T10:05:32.250093591Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.129.1", "name": "t1", "pns_if": "t1pns_if", "pns_ip": "192.168.129.1/24", "tenant_if": "t1if", "tenant_ip": "192.168.129.2/24"}}

TASK [Create Subnet Containers] **************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.1.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.1.1', u'bridge_name': u't1br1', u'dns': [{u'dnsif': u't1s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s1_dnsbrif'}], u'ns_name': u't1ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.1.2/24', u'tenant_ns_ip': u'10.2.1.1/24', u'tenant_ns_if': u't1ns1if', u'tenant_ns_name': u't1', u'tenant_sub_if': u't1s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't1br1if1', u'vmif': u't1C3if1', u'name': u't1_C3'}], u'vxlan': [{u'local_ip': u'10.2.1.2', u'tenant_route_ip': u'192.168.129.2', u'dsport': 4789, u'dev': u't1s1if', u'subnet_route': u'10.2.1.0/24', u'remote_route': u'10.1.1.0/24', u'v_name': u'vxlan_t1s1', u'id': 42, u'remote_ip': u'10.1.1.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t1ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T10:05:32.974016183Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/48f984d61acafa77f77e7607234c6bf74e0aaee8f16eebd13a329ce9d4b47a19-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/48f984d61acafa77f77e7607234c6bf74e0aaee8f16eebd13a329ce9d4b47a19/merged", "UpperDir": "/var/lib/docker/overlay2/48f984d61acafa77f77e7607234c6bf74e0aaee8f16eebd13a329ce9d4b47a19/diff", "WorkDir": "/var/lib/docker/overlay2/48f984d61acafa77f77e7607234c6bf74e0aaee8f16eebd13a329ce9d4b47a19/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/adf155883ea80de36f60d647e0ed9ba714cb3ffa70bdf8d648d062ee492d3349/hostname", "HostsPath": "/var/lib/docker/containers/adf155883ea80de36f60d647e0ed9ba714cb3ffa70bdf8d648d062ee492d3349/hosts", "Id": "adf155883ea80de36f60d647e0ed9ba714cb3ffa70bdf8d648d062ee492d3349", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/adf155883ea80de36f60d647e0ed9ba714cb3ffa70bdf8d648d062ee492d3349/adf155883ea80de36f60d647e0ed9ba714cb3ffa70bdf8d648d062ee492d3349-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "50c270e15770b7f471e2237d036f900833db8b9a909813e0e91984f43aa5a243", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/50c270e15770b7f471e2237d036f900833db8b9a909813e0e91984f43aa5a243/_data", "Type": "volume"}], "Name": "/t1ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "3d32eac160f0429388cd8f19bddd0d2bde7dbdffb064e6af17529113764cd6a0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "3d32eac160f0429388cd8f19bddd0d2bde7dbdffb064e6af17529113764cd6a0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "4d9d866badc7ef0ec7470f274f7e92d4a70ed17f2a50381955738de4ec78997d"}}, "Ports": {}, "SandboxID": "5f4dd83a6e2a993e454f3d31b4c7e0ce758bc09d9c6a465cb749a4105958ab5a", "SandboxKey": "/var/run/docker/netns/5f4dd83a6e2a", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/adf155883ea80de36f60d647e0ed9ba714cb3ffa70bdf8d648d062ee492d3349/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8597, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T10:05:33.685172638Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t1ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T10:05:32.974016183Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/48f984d61acafa77f77e7607234c6bf74e0aaee8f16eebd13a329ce9d4b47a19-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/48f984d61acafa77f77e7607234c6bf74e0aaee8f16eebd13a329ce9d4b47a19/merged", "UpperDir": "/var/lib/docker/overlay2/48f984d61acafa77f77e7607234c6bf74e0aaee8f16eebd13a329ce9d4b47a19/diff", "WorkDir": "/var/lib/docker/overlay2/48f984d61acafa77f77e7607234c6bf74e0aaee8f16eebd13a329ce9d4b47a19/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/adf155883ea80de36f60d647e0ed9ba714cb3ffa70bdf8d648d062ee492d3349/hostname", "HostsPath": "/var/lib/docker/containers/adf155883ea80de36f60d647e0ed9ba714cb3ffa70bdf8d648d062ee492d3349/hosts", "Id": "adf155883ea80de36f60d647e0ed9ba714cb3ffa70bdf8d648d062ee492d3349", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/adf155883ea80de36f60d647e0ed9ba714cb3ffa70bdf8d648d062ee492d3349/adf155883ea80de36f60d647e0ed9ba714cb3ffa70bdf8d648d062ee492d3349-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "50c270e15770b7f471e2237d036f900833db8b9a909813e0e91984f43aa5a243", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/50c270e15770b7f471e2237d036f900833db8b9a909813e0e91984f43aa5a243/_data", "Type": "volume"}], "Name": "/t1ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "3d32eac160f0429388cd8f19bddd0d2bde7dbdffb064e6af17529113764cd6a0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "3d32eac160f0429388cd8f19bddd0d2bde7dbdffb064e6af17529113764cd6a0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "4d9d866badc7ef0ec7470f274f7e92d4a70ed17f2a50381955738de4ec78997d"}}, "Ports": {}, "SandboxID": "5f4dd83a6e2a993e454f3d31b4c7e0ce758bc09d9c6a465cb749a4105958ab5a", "SandboxKey": "/var/run/docker/netns/5f4dd83a6e2a", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/adf155883ea80de36f60d647e0ed9ba714cb3ffa70bdf8d648d062ee492d3349/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8597, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T10:05:33.685172638Z", "Status": "running"}}, "item": {"bridge_name": "t1br1", "default_route_ip": "10.2.1.1", "dns": [{"brif": "t1s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t1s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns1", "route": [{"if": "p1", "ip": "10.2.1.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns1if", "tenant_ns_ip": "10.2.1.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s1if", "tenant_sub_ip": "10.2.1.2/24"}], "vms": [{"brif": "t1br1if1", "name": "t1_C3", "vmif": "t1C3if1"}], "vxlan": [{"dev": "t1s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.1.2", "remote_ip": "10.1.1.2", "remote_route": "10.1.1.0/24", "subnet_route": "10.2.1.0/24", "tenant_route_ip": "192.168.129.2", "v_name": "vxlan_t1s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.2.1/24', u'ns_name': u't1', u'ns_if': u't1if', u'if': u'p1'}], u'default_route_ip': u'10.2.2.1', u'bridge_name': u't1br2', u'dns': [{u'dnsif': u't1s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't1s2_dnsbrif'}], u'ns_name': u't1ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.2.2/24', u'tenant_ns_ip': u'10.2.2.1/24', u'tenant_ns_if': u't1ns2if', u'tenant_ns_name': u't1', u'tenant_sub_if': u't1s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't1br2if1', u'vmif': u't1C4if1', u'name': u't1_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t1ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T10:05:34.642513459Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/7abb49fadd0342f97468cefd813c498e7954570962d59f608bae1a8c0b98caf5-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/7abb49fadd0342f97468cefd813c498e7954570962d59f608bae1a8c0b98caf5/merged", "UpperDir": "/var/lib/docker/overlay2/7abb49fadd0342f97468cefd813c498e7954570962d59f608bae1a8c0b98caf5/diff", "WorkDir": "/var/lib/docker/overlay2/7abb49fadd0342f97468cefd813c498e7954570962d59f608bae1a8c0b98caf5/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/2b8e95872f88d83f673457caf2b5b05dee47b8fcfcbe5556b4fe5a866692bb04/hostname", "HostsPath": "/var/lib/docker/containers/2b8e95872f88d83f673457caf2b5b05dee47b8fcfcbe5556b4fe5a866692bb04/hosts", "Id": "2b8e95872f88d83f673457caf2b5b05dee47b8fcfcbe5556b4fe5a866692bb04", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/2b8e95872f88d83f673457caf2b5b05dee47b8fcfcbe5556b4fe5a866692bb04/2b8e95872f88d83f673457caf2b5b05dee47b8fcfcbe5556b4fe5a866692bb04-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "4c38654b052c2d8a7b92d70fa4b14950ddd25815c64e1239fe1eb47377df6420", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/4c38654b052c2d8a7b92d70fa4b14950ddd25815c64e1239fe1eb47377df6420/_data", "Type": "volume"}], "Name": "/t1ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "976ca243aa4fe7220dd45699deddd14e6852cfff2d08f30bfd763cfa208473a2", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "976ca243aa4fe7220dd45699deddd14e6852cfff2d08f30bfd763cfa208473a2", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "4d9d866badc7ef0ec7470f274f7e92d4a70ed17f2a50381955738de4ec78997d"}}, "Ports": {}, "SandboxID": "52c81b9b512fced40bbc6ab294585a70b72a572341e868d7c6fb62b47b25afd5", "SandboxKey": "/var/run/docker/netns/52c81b9b512f", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/2b8e95872f88d83f673457caf2b5b05dee47b8fcfcbe5556b4fe5a866692bb04/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 9823, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T10:05:35.191271526Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t1ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T10:05:34.642513459Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/7abb49fadd0342f97468cefd813c498e7954570962d59f608bae1a8c0b98caf5-init/diff:/var/lib/docker/overlay2/d9948bb01c38e47dfa095bb554dc091aa211fef980df9cf0e980bea4c58dc88f/diff:/var/lib/docker/overlay2/41ef33d5840c2eedcac2d96698791802fb3e110fa6e9916e6bb4a319d1adaa8a/diff:/var/lib/docker/overlay2/92f78c90517e5bd6736b69ed30aa3ce964626ae071e5b11267b9131c9c43864e/diff:/var/lib/docker/overlay2/92e64ba0eccaa566fbcec0ab66cb88dcba08507b93011b14060e737ca9c9420f/diff", "MergedDir": "/var/lib/docker/overlay2/7abb49fadd0342f97468cefd813c498e7954570962d59f608bae1a8c0b98caf5/merged", "UpperDir": "/var/lib/docker/overlay2/7abb49fadd0342f97468cefd813c498e7954570962d59f608bae1a8c0b98caf5/diff", "WorkDir": "/var/lib/docker/overlay2/7abb49fadd0342f97468cefd813c498e7954570962d59f608bae1a8c0b98caf5/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/2b8e95872f88d83f673457caf2b5b05dee47b8fcfcbe5556b4fe5a866692bb04/hostname", "HostsPath": "/var/lib/docker/containers/2b8e95872f88d83f673457caf2b5b05dee47b8fcfcbe5556b4fe5a866692bb04/hosts", "Id": "2b8e95872f88d83f673457caf2b5b05dee47b8fcfcbe5556b4fe5a866692bb04", "Image": "sha256:c1fa00f30342a469dd64f6ea0e9b8ac391af6994d5ca72e987ced8c4cf3c6fc7", "LogPath": "/var/lib/docker/containers/2b8e95872f88d83f673457caf2b5b05dee47b8fcfcbe5556b4fe5a866692bb04/2b8e95872f88d83f673457caf2b5b05dee47b8fcfcbe5556b4fe5a866692bb04-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "4c38654b052c2d8a7b92d70fa4b14950ddd25815c64e1239fe1eb47377df6420", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/4c38654b052c2d8a7b92d70fa4b14950ddd25815c64e1239fe1eb47377df6420/_data", "Type": "volume"}], "Name": "/t1ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "976ca243aa4fe7220dd45699deddd14e6852cfff2d08f30bfd763cfa208473a2", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "976ca243aa4fe7220dd45699deddd14e6852cfff2d08f30bfd763cfa208473a2", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "4d9d866badc7ef0ec7470f274f7e92d4a70ed17f2a50381955738de4ec78997d"}}, "Ports": {}, "SandboxID": "52c81b9b512fced40bbc6ab294585a70b72a572341e868d7c6fb62b47b25afd5", "SandboxKey": "/var/run/docker/netns/52c81b9b512f", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/2b8e95872f88d83f673457caf2b5b05dee47b8fcfcbe5556b4fe5a866692bb04/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 9823, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T10:05:35.191271526Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t1br2", "default_route_ip": "10.2.2.1", "dns": [{"brif": "t1s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t1s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t1ns2", "route": [{"if": "p1", "ip": "10.2.2.1/24", "ns_if": "t1if", "ns_name": "t1"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t1ns2if", "tenant_ns_ip": "10.2.2.1/24", "tenant_ns_name": "t1", "tenant_sub_if": "t1s2if", "tenant_sub_ip": "10.2.2.2/24"}], "vms": [{"brif": "t1br2if1", "name": "t1_C4", "vmif": "t1C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP ***********************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 16:00:17.561369 Printing the yaml input file
INFO:root: 16:00:17.561494 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 16:00:17.561611 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 16:00:17.561665 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 16:00:17.561708 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] ***********************************************************************************************************

TASK [Build Docker Image] *********************************************************************************************
changed: [localhost] => {"actions": ["Built image centos7:latest from ./"], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": true, "image": {"Architecture": "amd64", "Author": "Prashanth_M", "Comment": "", "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "", "Image": "sha256:b8805e90bf94a4762f8be50dbe68f93d2d24d08e42e51256b7a8d61d733d44c1", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Container": "b7ef42c3221d8d10893b7def848e097706542ceffe39753f67744d07de5abf60", "ContainerConfig": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/bin/sh", "-c", "#(nop) ", "CMD [\"/usr/sbin/init\"]"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "b7ef42c3221d", "Image": "sha256:b8805e90bf94a4762f8be50dbe68f93d2d24d08e42e51256b7a8d61d733d44c1", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:02:28.484822405Z", "DockerVersion": "19.03.5", "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/53c4be3c7029c2d4103fbb99e6c9de960561f5b6bf4a536def2b27b32c6f0413/diff:/var/lib/docker/overlay2/94ccbacc8e369e79c32d933fa4941863772919f7e9c5ed54f17063a3b688769d/diff:/var/lib/docker/overlay2/62936bb087cab4526bdf3602631725cf35459122b5b0cdd8e65e0a888dbf7c9a/diff", "MergedDir": "/var/lib/docker/overlay2/b0fabb7ca67a824ea4a5a6e69ba44d80cd20e037ce649371ec57eec230d52b96/merged", "UpperDir": "/var/lib/docker/overlay2/b0fabb7ca67a824ea4a5a6e69ba44d80cd20e037ce649371ec57eec230d52b96/diff", "WorkDir": "/var/lib/docker/overlay2/b0fabb7ca67a824ea4a5a6e69ba44d80cd20e037ce649371ec57eec230d52b96/work"}, "Name": "overlay2"}, "Id": "sha256:8dcad47c41c0f4aab5e572c95c1c40cf02222fcf8de37e66233ca12a79050fd6", "Metadata": {"LastTagTime": "2019-12-06T16:02:28.515069863Z"}, "Os": "linux", "Parent": "sha256:b8805e90bf94a4762f8be50dbe68f93d2d24d08e42e51256b7a8d61d733d44c1", "RepoDigests": [], "RepoTags": ["centos7:latest"], "RootFS": {"Layers": ["sha256:77b174a6a187b610e4699546bd973a8d1e77663796e3724318a2a4b24cb07ea0", "sha256:a6d782d1802cb889cd7d1ac889e685958f507607a91dd7e98aff09beb57d449c", "sha256:5037c26c068b9e3554f0527130fb43e0c67d3e1264c7a618d3fb57c6f2285fd9", "sha256:1d083027eb438e83ffdf5252657c814b31e40ee957e5727c13e5542a5d2ccee1"], "Type": "layers"}, "Size": 362788889, "VirtualSize": 362788889}}

TASK [Spawning Tenant Container] **************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:02:29.216608826Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/c111ec6ea21a3180623191f13f3bbc6ccc6be22d1f754944056df1c533039f0a-init/diff:/var/lib/docker/overlay2/b0fabb7ca67a824ea4a5a6e69ba44d80cd20e037ce649371ec57eec230d52b96/diff:/var/lib/docker/overlay2/53c4be3c7029c2d4103fbb99e6c9de960561f5b6bf4a536def2b27b32c6f0413/diff:/var/lib/docker/overlay2/94ccbacc8e369e79c32d933fa4941863772919f7e9c5ed54f17063a3b688769d/diff:/var/lib/docker/overlay2/62936bb087cab4526bdf3602631725cf35459122b5b0cdd8e65e0a888dbf7c9a/diff", "MergedDir": "/var/lib/docker/overlay2/c111ec6ea21a3180623191f13f3bbc6ccc6be22d1f754944056df1c533039f0a/merged", "UpperDir": "/var/lib/docker/overlay2/c111ec6ea21a3180623191f13f3bbc6ccc6be22d1f754944056df1c533039f0a/diff", "WorkDir": "/var/lib/docker/overlay2/c111ec6ea21a3180623191f13f3bbc6ccc6be22d1f754944056df1c533039f0a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/9bddaa29783716d3698edae91cf70dfab19ad9cdfa023a82f4ad1d8f6a7a0823/hostname", "HostsPath": "/var/lib/docker/containers/9bddaa29783716d3698edae91cf70dfab19ad9cdfa023a82f4ad1d8f6a7a0823/hosts", "Id": "9bddaa29783716d3698edae91cf70dfab19ad9cdfa023a82f4ad1d8f6a7a0823", "Image": "sha256:8dcad47c41c0f4aab5e572c95c1c40cf02222fcf8de37e66233ca12a79050fd6", "LogPath": "/var/lib/docker/containers/9bddaa29783716d3698edae91cf70dfab19ad9cdfa023a82f4ad1d8f6a7a0823/9bddaa29783716d3698edae91cf70dfab19ad9cdfa023a82f4ad1d8f6a7a0823-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "e5bfd2370171c714f05a4aa57dd7b9b941663ed9c7af4bcb9bb0a804fb4a66e9", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/e5bfd2370171c714f05a4aa57dd7b9b941663ed9c7af4bcb9bb0a804fb4a66e9/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "a97bdd774e4dbe7c171fa0c876344de53f2b6f7e809bac1706b221afc6eef8b8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "a97bdd774e4dbe7c171fa0c876344de53f2b6f7e809bac1706b221afc6eef8b8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "95d0b79be20481dbe08ecf6c4ef267326376793062b0dc8d4cba58c2f8574b1f"}}, "Ports": {}, "SandboxID": "182b00d6d66e8a9a8dabbf509abe0792e2f8cd61a72a6ddf10ad25da47798c8e", "SandboxKey": "/var/run/docker/netns/182b00d6d66e", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/9bddaa29783716d3698edae91cf70dfab19ad9cdfa023a82f4ad1d8f6a7a0823/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 14627, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:02:29.648632863Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:02:29.216608826Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/c111ec6ea21a3180623191f13f3bbc6ccc6be22d1f754944056df1c533039f0a-init/diff:/var/lib/docker/overlay2/b0fabb7ca67a824ea4a5a6e69ba44d80cd20e037ce649371ec57eec230d52b96/diff:/var/lib/docker/overlay2/53c4be3c7029c2d4103fbb99e6c9de960561f5b6bf4a536def2b27b32c6f0413/diff:/var/lib/docker/overlay2/94ccbacc8e369e79c32d933fa4941863772919f7e9c5ed54f17063a3b688769d/diff:/var/lib/docker/overlay2/62936bb087cab4526bdf3602631725cf35459122b5b0cdd8e65e0a888dbf7c9a/diff", "MergedDir": "/var/lib/docker/overlay2/c111ec6ea21a3180623191f13f3bbc6ccc6be22d1f754944056df1c533039f0a/merged", "UpperDir": "/var/lib/docker/overlay2/c111ec6ea21a3180623191f13f3bbc6ccc6be22d1f754944056df1c533039f0a/diff", "WorkDir": "/var/lib/docker/overlay2/c111ec6ea21a3180623191f13f3bbc6ccc6be22d1f754944056df1c533039f0a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/9bddaa29783716d3698edae91cf70dfab19ad9cdfa023a82f4ad1d8f6a7a0823/hostname", "HostsPath": "/var/lib/docker/containers/9bddaa29783716d3698edae91cf70dfab19ad9cdfa023a82f4ad1d8f6a7a0823/hosts", "Id": "9bddaa29783716d3698edae91cf70dfab19ad9cdfa023a82f4ad1d8f6a7a0823", "Image": "sha256:8dcad47c41c0f4aab5e572c95c1c40cf02222fcf8de37e66233ca12a79050fd6", "LogPath": "/var/lib/docker/containers/9bddaa29783716d3698edae91cf70dfab19ad9cdfa023a82f4ad1d8f6a7a0823/9bddaa29783716d3698edae91cf70dfab19ad9cdfa023a82f4ad1d8f6a7a0823-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "e5bfd2370171c714f05a4aa57dd7b9b941663ed9c7af4bcb9bb0a804fb4a66e9", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/e5bfd2370171c714f05a4aa57dd7b9b941663ed9c7af4bcb9bb0a804fb4a66e9/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "a97bdd774e4dbe7c171fa0c876344de53f2b6f7e809bac1706b221afc6eef8b8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "a97bdd774e4dbe7c171fa0c876344de53f2b6f7e809bac1706b221afc6eef8b8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "95d0b79be20481dbe08ecf6c4ef267326376793062b0dc8d4cba58c2f8574b1f"}}, "Ports": {}, "SandboxID": "182b00d6d66e8a9a8dabbf509abe0792e2f8cd61a72a6ddf10ad25da47798c8e", "SandboxKey": "/var/run/docker/netns/182b00d6d66e", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/9bddaa29783716d3698edae91cf70dfab19ad9cdfa023a82f4ad1d8f6a7a0823/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 14627, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:02:29.648632863Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}}

TASK [Create Subnet Containers] ***************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'tenant_route_ip': u'192.168.2.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.1.11.0/24', u'remote_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:02:30.118925323Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/5e2ce3b5b5a79e4b7e74c8c450e190610c7986d358f288f600292984c870fd56-init/diff:/var/lib/docker/overlay2/b0fabb7ca67a824ea4a5a6e69ba44d80cd20e037ce649371ec57eec230d52b96/diff:/var/lib/docker/overlay2/53c4be3c7029c2d4103fbb99e6c9de960561f5b6bf4a536def2b27b32c6f0413/diff:/var/lib/docker/overlay2/94ccbacc8e369e79c32d933fa4941863772919f7e9c5ed54f17063a3b688769d/diff:/var/lib/docker/overlay2/62936bb087cab4526bdf3602631725cf35459122b5b0cdd8e65e0a888dbf7c9a/diff", "MergedDir": "/var/lib/docker/overlay2/5e2ce3b5b5a79e4b7e74c8c450e190610c7986d358f288f600292984c870fd56/merged", "UpperDir": "/var/lib/docker/overlay2/5e2ce3b5b5a79e4b7e74c8c450e190610c7986d358f288f600292984c870fd56/diff", "WorkDir": "/var/lib/docker/overlay2/5e2ce3b5b5a79e4b7e74c8c450e190610c7986d358f288f600292984c870fd56/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/7332480e031e60df59ad1af846e5494f76c4d5eb22c15cb3de291ff68fd22179/hostname", "HostsPath": "/var/lib/docker/containers/7332480e031e60df59ad1af846e5494f76c4d5eb22c15cb3de291ff68fd22179/hosts", "Id": "7332480e031e60df59ad1af846e5494f76c4d5eb22c15cb3de291ff68fd22179", "Image": "sha256:8dcad47c41c0f4aab5e572c95c1c40cf02222fcf8de37e66233ca12a79050fd6", "LogPath": "/var/lib/docker/containers/7332480e031e60df59ad1af846e5494f76c4d5eb22c15cb3de291ff68fd22179/7332480e031e60df59ad1af846e5494f76c4d5eb22c15cb3de291ff68fd22179-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "64c6761e4857bd7201e124b767817ec7eaf222dab9b52364bd6d328a01fbdc0c", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/64c6761e4857bd7201e124b767817ec7eaf222dab9b52364bd6d328a01fbdc0c/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "e363553522691a8a6f24d560395d9a351405a54ad8ea31d1a4c641db1f788f4f", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "e363553522691a8a6f24d560395d9a351405a54ad8ea31d1a4c641db1f788f4f", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "95d0b79be20481dbe08ecf6c4ef267326376793062b0dc8d4cba58c2f8574b1f"}}, "Ports": {}, "SandboxID": "ab897e58968edd7913d23475334352cbb9e8c33c33ea4ec42fc983eea452f6b5", "SandboxKey": "/var/run/docker/netns/ab897e58968e", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/7332480e031e60df59ad1af846e5494f76c4d5eb22c15cb3de291ff68fd22179/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 15250, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:02:30.741676417Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:02:30.118925323Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/5e2ce3b5b5a79e4b7e74c8c450e190610c7986d358f288f600292984c870fd56-init/diff:/var/lib/docker/overlay2/b0fabb7ca67a824ea4a5a6e69ba44d80cd20e037ce649371ec57eec230d52b96/diff:/var/lib/docker/overlay2/53c4be3c7029c2d4103fbb99e6c9de960561f5b6bf4a536def2b27b32c6f0413/diff:/var/lib/docker/overlay2/94ccbacc8e369e79c32d933fa4941863772919f7e9c5ed54f17063a3b688769d/diff:/var/lib/docker/overlay2/62936bb087cab4526bdf3602631725cf35459122b5b0cdd8e65e0a888dbf7c9a/diff", "MergedDir": "/var/lib/docker/overlay2/5e2ce3b5b5a79e4b7e74c8c450e190610c7986d358f288f600292984c870fd56/merged", "UpperDir": "/var/lib/docker/overlay2/5e2ce3b5b5a79e4b7e74c8c450e190610c7986d358f288f600292984c870fd56/diff", "WorkDir": "/var/lib/docker/overlay2/5e2ce3b5b5a79e4b7e74c8c450e190610c7986d358f288f600292984c870fd56/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/7332480e031e60df59ad1af846e5494f76c4d5eb22c15cb3de291ff68fd22179/hostname", "HostsPath": "/var/lib/docker/containers/7332480e031e60df59ad1af846e5494f76c4d5eb22c15cb3de291ff68fd22179/hosts", "Id": "7332480e031e60df59ad1af846e5494f76c4d5eb22c15cb3de291ff68fd22179", "Image": "sha256:8dcad47c41c0f4aab5e572c95c1c40cf02222fcf8de37e66233ca12a79050fd6", "LogPath": "/var/lib/docker/containers/7332480e031e60df59ad1af846e5494f76c4d5eb22c15cb3de291ff68fd22179/7332480e031e60df59ad1af846e5494f76c4d5eb22c15cb3de291ff68fd22179-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "64c6761e4857bd7201e124b767817ec7eaf222dab9b52364bd6d328a01fbdc0c", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/64c6761e4857bd7201e124b767817ec7eaf222dab9b52364bd6d328a01fbdc0c/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "e363553522691a8a6f24d560395d9a351405a54ad8ea31d1a4c641db1f788f4f", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "e363553522691a8a6f24d560395d9a351405a54ad8ea31d1a4c641db1f788f4f", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "95d0b79be20481dbe08ecf6c4ef267326376793062b0dc8d4cba58c2f8574b1f"}}, "Ports": {}, "SandboxID": "ab897e58968edd7913d23475334352cbb9e8c33c33ea4ec42fc983eea452f6b5", "SandboxKey": "/var/run/docker/netns/ab897e58968e", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/7332480e031e60df59ad1af846e5494f76c4d5eb22c15cb3de291ff68fd22179/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 15250, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:02:30.741676417Z", "Status": "running"}}, "item": {"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}}

PLAY RECAP ************************************************************************************************************
localhost                  : ok=3    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] *********************************************************************************************************

TASK [Build Docker Image] *********************************************************************************************
changed: [99.99.99.2] => {"actions": ["Built image centos7:latest from /root"], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": true, "image": {"Architecture": "amd64", "Author": "Prashanth_M", "Comment": "", "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "", "Image": "sha256:924cb0c4f29593eb57db4b15ed4a8ed1c2fd40cfb9c020d505b3cdf681e6d5dd", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Container": "797160cb9203491e15d0a7c2ffeb9d061ffd9adf45c68f2fee1c47a594948d03", "ContainerConfig": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/bin/sh", "-c", "#(nop) ", "CMD [\"/usr/sbin/init\"]"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "797160cb9203", "Image": "sha256:924cb0c4f29593eb57db4b15ed4a8ed1c2fd40cfb9c020d505b3cdf681e6d5dd", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:06:05.773893116Z", "DockerVersion": "19.03.5", "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/merged", "UpperDir": "/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff", "WorkDir": "/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/work"}, "Name": "overlay2"}, "Id": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "Metadata": {"LastTagTime": "2019-12-06T16:06:06.591060678Z"}, "Os": "linux", "Parent": "sha256:924cb0c4f29593eb57db4b15ed4a8ed1c2fd40cfb9c020d505b3cdf681e6d5dd", "RepoDigests": [], "RepoTags": ["centos7:latest"], "RootFS": {"Layers": ["sha256:77b174a6a187b610e4699546bd973a8d1e77663796e3724318a2a4b24cb07ea0", "sha256:88e31b23ae0c6e0b16d2a0bcfe957c0f4cdc6976b6e395ad216add72337b1668", "sha256:e05906b4b38a8f99c05e028dd3e1b6e2695ae0e9298091e84812e08e8db8836a", "sha256:95d7acbf6d57f0ed8d7664963f7c36d58ba2130ab5e3c3085b0adbc5aed427d8"], "Type": "layers"}, "Size": 362755559, "VirtualSize": 362755559}}

TASK [Spawning Tenant Container] **************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:06:07.508573499Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/eaf87aaca185f64649e74b764b087fe7aa2b094da71158ec3eb06738bd156517-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/eaf87aaca185f64649e74b764b087fe7aa2b094da71158ec3eb06738bd156517/merged", "UpperDir": "/var/lib/docker/overlay2/eaf87aaca185f64649e74b764b087fe7aa2b094da71158ec3eb06738bd156517/diff", "WorkDir": "/var/lib/docker/overlay2/eaf87aaca185f64649e74b764b087fe7aa2b094da71158ec3eb06738bd156517/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/562be20763c860398c2d9e33c7bf8c543cc3c584565ffbdeba6fba9c84c98e92/hostname", "HostsPath": "/var/lib/docker/containers/562be20763c860398c2d9e33c7bf8c543cc3c584565ffbdeba6fba9c84c98e92/hosts", "Id": "562be20763c860398c2d9e33c7bf8c543cc3c584565ffbdeba6fba9c84c98e92", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/562be20763c860398c2d9e33c7bf8c543cc3c584565ffbdeba6fba9c84c98e92/562be20763c860398c2d9e33c7bf8c543cc3c584565ffbdeba6fba9c84c98e92-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "17d835e918fc7ff22921e2faff46c25a11741255923124ea817c44d4ef85a4b5", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/17d835e918fc7ff22921e2faff46c25a11741255923124ea817c44d4ef85a4b5/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "7be8e3ef38b6be52e37fc592f284abb0e4e3b2e316c028b2e6d055ba60d9370d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "7be8e3ef38b6be52e37fc592f284abb0e4e3b2e316c028b2e6d055ba60d9370d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "8185d4848c29da4359e6090d56ae20c49b76f6ec43c77f305868298082542e95"}}, "Ports": {}, "SandboxID": "87829dd3fbc2649442e7988b4de8f64b45d7c28f445be758bf3450fa665adb3d", "SandboxKey": "/var/run/docker/netns/87829dd3fbc2", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/562be20763c860398c2d9e33c7bf8c543cc3c584565ffbdeba6fba9c84c98e92/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8568, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:06:08.074066924Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:06:07.508573499Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/eaf87aaca185f64649e74b764b087fe7aa2b094da71158ec3eb06738bd156517-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/eaf87aaca185f64649e74b764b087fe7aa2b094da71158ec3eb06738bd156517/merged", "UpperDir": "/var/lib/docker/overlay2/eaf87aaca185f64649e74b764b087fe7aa2b094da71158ec3eb06738bd156517/diff", "WorkDir": "/var/lib/docker/overlay2/eaf87aaca185f64649e74b764b087fe7aa2b094da71158ec3eb06738bd156517/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/562be20763c860398c2d9e33c7bf8c543cc3c584565ffbdeba6fba9c84c98e92/hostname", "HostsPath": "/var/lib/docker/containers/562be20763c860398c2d9e33c7bf8c543cc3c584565ffbdeba6fba9c84c98e92/hosts", "Id": "562be20763c860398c2d9e33c7bf8c543cc3c584565ffbdeba6fba9c84c98e92", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/562be20763c860398c2d9e33c7bf8c543cc3c584565ffbdeba6fba9c84c98e92/562be20763c860398c2d9e33c7bf8c543cc3c584565ffbdeba6fba9c84c98e92-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "17d835e918fc7ff22921e2faff46c25a11741255923124ea817c44d4ef85a4b5", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/17d835e918fc7ff22921e2faff46c25a11741255923124ea817c44d4ef85a4b5/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "7be8e3ef38b6be52e37fc592f284abb0e4e3b2e316c028b2e6d055ba60d9370d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "7be8e3ef38b6be52e37fc592f284abb0e4e3b2e316c028b2e6d055ba60d9370d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "8185d4848c29da4359e6090d56ae20c49b76f6ec43c77f305868298082542e95"}}, "Ports": {}, "SandboxID": "87829dd3fbc2649442e7988b4de8f64b45d7c28f445be758bf3450fa665adb3d", "SandboxKey": "/var/run/docker/netns/87829dd3fbc2", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/562be20763c860398c2d9e33c7bf8c543cc3c584565ffbdeba6fba9c84c98e92/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8568, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:06:08.074066924Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}}

TASK [Create Subnet Containers] ***************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'tenant_route_ip': u'192.168.130.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.2.11.0/24', u'remote_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:06:08.862158278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/402be950c74fc7a6682e1c79c7213a03cd9093ab8e68f05536e7fc671af06577-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/402be950c74fc7a6682e1c79c7213a03cd9093ab8e68f05536e7fc671af06577/merged", "UpperDir": "/var/lib/docker/overlay2/402be950c74fc7a6682e1c79c7213a03cd9093ab8e68f05536e7fc671af06577/diff", "WorkDir": "/var/lib/docker/overlay2/402be950c74fc7a6682e1c79c7213a03cd9093ab8e68f05536e7fc671af06577/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/71f0ab656bd026cfccff55dfdf8d5dab27297cdcb4845b646917b079cdff4fe1/hostname", "HostsPath": "/var/lib/docker/containers/71f0ab656bd026cfccff55dfdf8d5dab27297cdcb4845b646917b079cdff4fe1/hosts", "Id": "71f0ab656bd026cfccff55dfdf8d5dab27297cdcb4845b646917b079cdff4fe1", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/71f0ab656bd026cfccff55dfdf8d5dab27297cdcb4845b646917b079cdff4fe1/71f0ab656bd026cfccff55dfdf8d5dab27297cdcb4845b646917b079cdff4fe1-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "9ec812864ebe7bc9d1fb72199e04835db9cf863698b83537cd8d16a3c8904094", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/9ec812864ebe7bc9d1fb72199e04835db9cf863698b83537cd8d16a3c8904094/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d8254ab7d796ade404ee43c72f96bff6ceb56c8fd4236c6305487bc05e1bb286", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d8254ab7d796ade404ee43c72f96bff6ceb56c8fd4236c6305487bc05e1bb286", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "8185d4848c29da4359e6090d56ae20c49b76f6ec43c77f305868298082542e95"}}, "Ports": {}, "SandboxID": "d9546586477cf8eeacce475254ce1d65944a8e3b241eb04849909106ae8dc848", "SandboxKey": "/var/run/docker/netns/d9546586477c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/71f0ab656bd026cfccff55dfdf8d5dab27297cdcb4845b646917b079cdff4fe1/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 9190, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:06:09.385277372Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:06:08.862158278Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/402be950c74fc7a6682e1c79c7213a03cd9093ab8e68f05536e7fc671af06577-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/402be950c74fc7a6682e1c79c7213a03cd9093ab8e68f05536e7fc671af06577/merged", "UpperDir": "/var/lib/docker/overlay2/402be950c74fc7a6682e1c79c7213a03cd9093ab8e68f05536e7fc671af06577/diff", "WorkDir": "/var/lib/docker/overlay2/402be950c74fc7a6682e1c79c7213a03cd9093ab8e68f05536e7fc671af06577/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/71f0ab656bd026cfccff55dfdf8d5dab27297cdcb4845b646917b079cdff4fe1/hostname", "HostsPath": "/var/lib/docker/containers/71f0ab656bd026cfccff55dfdf8d5dab27297cdcb4845b646917b079cdff4fe1/hosts", "Id": "71f0ab656bd026cfccff55dfdf8d5dab27297cdcb4845b646917b079cdff4fe1", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/71f0ab656bd026cfccff55dfdf8d5dab27297cdcb4845b646917b079cdff4fe1/71f0ab656bd026cfccff55dfdf8d5dab27297cdcb4845b646917b079cdff4fe1-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "9ec812864ebe7bc9d1fb72199e04835db9cf863698b83537cd8d16a3c8904094", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/9ec812864ebe7bc9d1fb72199e04835db9cf863698b83537cd8d16a3c8904094/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d8254ab7d796ade404ee43c72f96bff6ceb56c8fd4236c6305487bc05e1bb286", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d8254ab7d796ade404ee43c72f96bff6ceb56c8fd4236c6305487bc05e1bb286", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "8185d4848c29da4359e6090d56ae20c49b76f6ec43c77f305868298082542e95"}}, "Ports": {}, "SandboxID": "d9546586477cf8eeacce475254ce1d65944a8e3b241eb04849909106ae8dc848", "SandboxKey": "/var/run/docker/netns/d9546586477c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/71f0ab656bd026cfccff55dfdf8d5dab27297cdcb4845b646917b079cdff4fe1/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 9190, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:06:09.385277372Z", "Status": "running"}}, "item": {"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:06:10.246482554Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/cfddeb55d795aabf18a23eb2996b89079990200d98d053263a433df0fee6e4dd-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/cfddeb55d795aabf18a23eb2996b89079990200d98d053263a433df0fee6e4dd/merged", "UpperDir": "/var/lib/docker/overlay2/cfddeb55d795aabf18a23eb2996b89079990200d98d053263a433df0fee6e4dd/diff", "WorkDir": "/var/lib/docker/overlay2/cfddeb55d795aabf18a23eb2996b89079990200d98d053263a433df0fee6e4dd/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/420befa8596c34f3fe679a2b52185dda786200c92703560b45aee03ac79385de/hostname", "HostsPath": "/var/lib/docker/containers/420befa8596c34f3fe679a2b52185dda786200c92703560b45aee03ac79385de/hosts", "Id": "420befa8596c34f3fe679a2b52185dda786200c92703560b45aee03ac79385de", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/420befa8596c34f3fe679a2b52185dda786200c92703560b45aee03ac79385de/420befa8596c34f3fe679a2b52185dda786200c92703560b45aee03ac79385de-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "79a1eeaf718f814ff6cbc57eb665fa69b242a28d651a6fb4f2fb6df419d3d0bb", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/79a1eeaf718f814ff6cbc57eb665fa69b242a28d651a6fb4f2fb6df419d3d0bb/_data", "Type": "volume"}], "Name": "/t2ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "22dd31c27e3ca2bd6fe68ec10691d0a92923855935b192becf790f240b4b3ba6", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "22dd31c27e3ca2bd6fe68ec10691d0a92923855935b192becf790f240b4b3ba6", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "8185d4848c29da4359e6090d56ae20c49b76f6ec43c77f305868298082542e95"}}, "Ports": {}, "SandboxID": "ad10d8aea9048d7880ca0207728b4bb22967b5b3a3c00601cb6850e019396ea3", "SandboxKey": "/var/run/docker/netns/ad10d8aea904", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/420befa8596c34f3fe679a2b52185dda786200c92703560b45aee03ac79385de/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 10366, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:06:10.840595597Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:06:10.246482554Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/cfddeb55d795aabf18a23eb2996b89079990200d98d053263a433df0fee6e4dd-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/cfddeb55d795aabf18a23eb2996b89079990200d98d053263a433df0fee6e4dd/merged", "UpperDir": "/var/lib/docker/overlay2/cfddeb55d795aabf18a23eb2996b89079990200d98d053263a433df0fee6e4dd/diff", "WorkDir": "/var/lib/docker/overlay2/cfddeb55d795aabf18a23eb2996b89079990200d98d053263a433df0fee6e4dd/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/420befa8596c34f3fe679a2b52185dda786200c92703560b45aee03ac79385de/hostname", "HostsPath": "/var/lib/docker/containers/420befa8596c34f3fe679a2b52185dda786200c92703560b45aee03ac79385de/hosts", "Id": "420befa8596c34f3fe679a2b52185dda786200c92703560b45aee03ac79385de", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/420befa8596c34f3fe679a2b52185dda786200c92703560b45aee03ac79385de/420befa8596c34f3fe679a2b52185dda786200c92703560b45aee03ac79385de-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "79a1eeaf718f814ff6cbc57eb665fa69b242a28d651a6fb4f2fb6df419d3d0bb", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/79a1eeaf718f814ff6cbc57eb665fa69b242a28d651a6fb4f2fb6df419d3d0bb/_data", "Type": "volume"}], "Name": "/t2ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "22dd31c27e3ca2bd6fe68ec10691d0a92923855935b192becf790f240b4b3ba6", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "22dd31c27e3ca2bd6fe68ec10691d0a92923855935b192becf790f240b4b3ba6", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "8185d4848c29da4359e6090d56ae20c49b76f6ec43c77f305868298082542e95"}}, "Ports": {}, "SandboxID": "ad10d8aea9048d7880ca0207728b4bb22967b5b3a3c00601cb6850e019396ea3", "SandboxKey": "/var/run/docker/netns/ad10d8aea904", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/420befa8596c34f3fe679a2b52185dda786200c92703560b45aee03ac79385de/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 10366, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:06:10.840595597Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP ************************************************************************************************************
99.99.99.2                 : ok=3    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 16:30:03.801984 Printing the yaml input file
INFO:root: 16:30:03.802388 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 16:30:03.802524 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 16:30:03.802579 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 16:30:03.802622 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] ***********************************************************************************************************

TASK [Build Docker Image] *********************************************************************************************
changed: [localhost] => {"actions": ["Built image centos7:latest from ./"], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": true, "image": {"Architecture": "amd64", "Author": "Prashanth_M", "Comment": "", "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "", "Image": "sha256:433a1e68f1dadedbd5573f6332d3d43918e7c9fff1a7413a200d4877971385e9", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Container": "c52584dbe369bfebb30a2290ad097865d42c2f6627b6fc84306afa541ce30e46", "ContainerConfig": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/bin/sh", "-c", "#(nop) ", "CMD [\"/usr/sbin/init\"]"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "c52584dbe369", "Image": "sha256:433a1e68f1dadedbd5573f6332d3d43918e7c9fff1a7413a200d4877971385e9", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:32:38.520156859Z", "DockerVersion": "19.03.5", "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/merged", "UpperDir": "/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff", "WorkDir": "/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/work"}, "Name": "overlay2"}, "Id": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "Metadata": {"LastTagTime": "2019-12-06T16:32:38.55370278Z"}, "Os": "linux", "Parent": "sha256:433a1e68f1dadedbd5573f6332d3d43918e7c9fff1a7413a200d4877971385e9", "RepoDigests": [], "RepoTags": ["centos7:latest"], "RootFS": {"Layers": ["sha256:77b174a6a187b610e4699546bd973a8d1e77663796e3724318a2a4b24cb07ea0", "sha256:137e253be89adf380bbf1352510f76b4f3095d6071967262c4ae81525babd1b7", "sha256:3ef4a510c99206e14240785890b7dec2058148e3112b59cde7f7267e3fd95ef8", "sha256:cc21b3071f5d0f6d03981a1c004c42d38fe02d96f72f59751da91aa13c11debb"], "Type": "layers"}, "Size": 363172449, "VirtualSize": 363172449}}

TASK [Spawning Tenant Container] **************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.3.1', u'name': u't3', u'pns_ip': u'192.168.3.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.3.2/24', u'pns_if': u't3pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:32:39.368568573Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/003f8e74731176da39663a151cf5af817cfc9eb5000edce1a698adc8cf45a86a-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/003f8e74731176da39663a151cf5af817cfc9eb5000edce1a698adc8cf45a86a/merged", "UpperDir": "/var/lib/docker/overlay2/003f8e74731176da39663a151cf5af817cfc9eb5000edce1a698adc8cf45a86a/diff", "WorkDir": "/var/lib/docker/overlay2/003f8e74731176da39663a151cf5af817cfc9eb5000edce1a698adc8cf45a86a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/15beeed9a2369da000a82bd0b00a03259d66e3a050834099e39c6d32227bf18d/hostname", "HostsPath": "/var/lib/docker/containers/15beeed9a2369da000a82bd0b00a03259d66e3a050834099e39c6d32227bf18d/hosts", "Id": "15beeed9a2369da000a82bd0b00a03259d66e3a050834099e39c6d32227bf18d", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/15beeed9a2369da000a82bd0b00a03259d66e3a050834099e39c6d32227bf18d/15beeed9a2369da000a82bd0b00a03259d66e3a050834099e39c6d32227bf18d-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "d89d7e5601c8174babb86bae3f74d924e4e16033c94d9ad71d1a5a6244d157fc", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/d89d7e5601c8174babb86bae3f74d924e4e16033c94d9ad71d1a5a6244d157fc/_data", "Type": "volume"}], "Name": "/t3", "NetworkSettings": {"Bridge": "", "EndpointID": "ce56c2c0907645df8000f123981ca315935cb84f2fccdf0ce939dd3b1b911fe5", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "ce56c2c0907645df8000f123981ca315935cb84f2fccdf0ce939dd3b1b911fe5", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "95d0b79be20481dbe08ecf6c4ef267326376793062b0dc8d4cba58c2f8574b1f"}}, "Ports": {}, "SandboxID": "7fe5515a75cdd255bedfde540c18e082e1a37e001c677c9dff09fbb5ace8fba2", "SandboxKey": "/var/run/docker/netns/7fe5515a75cd", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/15beeed9a2369da000a82bd0b00a03259d66e3a050834099e39c6d32227bf18d/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 2909, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:32:39.838042842Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:32:39.368568573Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/003f8e74731176da39663a151cf5af817cfc9eb5000edce1a698adc8cf45a86a-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/003f8e74731176da39663a151cf5af817cfc9eb5000edce1a698adc8cf45a86a/merged", "UpperDir": "/var/lib/docker/overlay2/003f8e74731176da39663a151cf5af817cfc9eb5000edce1a698adc8cf45a86a/diff", "WorkDir": "/var/lib/docker/overlay2/003f8e74731176da39663a151cf5af817cfc9eb5000edce1a698adc8cf45a86a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/15beeed9a2369da000a82bd0b00a03259d66e3a050834099e39c6d32227bf18d/hostname", "HostsPath": "/var/lib/docker/containers/15beeed9a2369da000a82bd0b00a03259d66e3a050834099e39c6d32227bf18d/hosts", "Id": "15beeed9a2369da000a82bd0b00a03259d66e3a050834099e39c6d32227bf18d", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/15beeed9a2369da000a82bd0b00a03259d66e3a050834099e39c6d32227bf18d/15beeed9a2369da000a82bd0b00a03259d66e3a050834099e39c6d32227bf18d-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "d89d7e5601c8174babb86bae3f74d924e4e16033c94d9ad71d1a5a6244d157fc", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/d89d7e5601c8174babb86bae3f74d924e4e16033c94d9ad71d1a5a6244d157fc/_data", "Type": "volume"}], "Name": "/t3", "NetworkSettings": {"Bridge": "", "EndpointID": "ce56c2c0907645df8000f123981ca315935cb84f2fccdf0ce939dd3b1b911fe5", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "ce56c2c0907645df8000f123981ca315935cb84f2fccdf0ce939dd3b1b911fe5", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "95d0b79be20481dbe08ecf6c4ef267326376793062b0dc8d4cba58c2f8574b1f"}}, "Ports": {}, "SandboxID": "7fe5515a75cdd255bedfde540c18e082e1a37e001c677c9dff09fbb5ace8fba2", "SandboxKey": "/var/run/docker/netns/7fe5515a75cd", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/15beeed9a2369da000a82bd0b00a03259d66e3a050834099e39c6d32227bf18d/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 2909, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:32:39.838042842Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.3.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.3.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.3.2/24"}}

TASK [Create Subnet Containers] ***************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'tenant_route_ip': u'192.168.3.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.1.21.0/24', u'remote_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:32:40.412959324Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/8acebbcafb32c06f0149a9805e6fa9fabf5da2064881c0d1ade2a9026c9c2661-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/8acebbcafb32c06f0149a9805e6fa9fabf5da2064881c0d1ade2a9026c9c2661/merged", "UpperDir": "/var/lib/docker/overlay2/8acebbcafb32c06f0149a9805e6fa9fabf5da2064881c0d1ade2a9026c9c2661/diff", "WorkDir": "/var/lib/docker/overlay2/8acebbcafb32c06f0149a9805e6fa9fabf5da2064881c0d1ade2a9026c9c2661/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/2c8dd27bca9271ce040c1577e2191934f47d787edf6b8f6f0f5e2ecb420047b8/hostname", "HostsPath": "/var/lib/docker/containers/2c8dd27bca9271ce040c1577e2191934f47d787edf6b8f6f0f5e2ecb420047b8/hosts", "Id": "2c8dd27bca9271ce040c1577e2191934f47d787edf6b8f6f0f5e2ecb420047b8", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/2c8dd27bca9271ce040c1577e2191934f47d787edf6b8f6f0f5e2ecb420047b8/2c8dd27bca9271ce040c1577e2191934f47d787edf6b8f6f0f5e2ecb420047b8-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "38120cc145b0e4a62fbd3314b68ea630bd9a5d1ef7e76f355e1cec692452d0b6", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/38120cc145b0e4a62fbd3314b68ea630bd9a5d1ef7e76f355e1cec692452d0b6/_data", "Type": "volume"}], "Name": "/t3ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "52e2ef0cae22a0fe584beb7c3fa01ae790ae9ce2f14385094ff2f97b588f1fa7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "52e2ef0cae22a0fe584beb7c3fa01ae790ae9ce2f14385094ff2f97b588f1fa7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "95d0b79be20481dbe08ecf6c4ef267326376793062b0dc8d4cba58c2f8574b1f"}}, "Ports": {}, "SandboxID": "93cf5a6080f658cd863ff43c4fbddd2dc935b494e1b4c0eec08067c5791e72a7", "SandboxKey": "/var/run/docker/netns/93cf5a6080f6", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/2c8dd27bca9271ce040c1577e2191934f47d787edf6b8f6f0f5e2ecb420047b8/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 3529, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:32:40.931087218Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:32:40.412959324Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/8acebbcafb32c06f0149a9805e6fa9fabf5da2064881c0d1ade2a9026c9c2661-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/8acebbcafb32c06f0149a9805e6fa9fabf5da2064881c0d1ade2a9026c9c2661/merged", "UpperDir": "/var/lib/docker/overlay2/8acebbcafb32c06f0149a9805e6fa9fabf5da2064881c0d1ade2a9026c9c2661/diff", "WorkDir": "/var/lib/docker/overlay2/8acebbcafb32c06f0149a9805e6fa9fabf5da2064881c0d1ade2a9026c9c2661/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/2c8dd27bca9271ce040c1577e2191934f47d787edf6b8f6f0f5e2ecb420047b8/hostname", "HostsPath": "/var/lib/docker/containers/2c8dd27bca9271ce040c1577e2191934f47d787edf6b8f6f0f5e2ecb420047b8/hosts", "Id": "2c8dd27bca9271ce040c1577e2191934f47d787edf6b8f6f0f5e2ecb420047b8", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/2c8dd27bca9271ce040c1577e2191934f47d787edf6b8f6f0f5e2ecb420047b8/2c8dd27bca9271ce040c1577e2191934f47d787edf6b8f6f0f5e2ecb420047b8-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "38120cc145b0e4a62fbd3314b68ea630bd9a5d1ef7e76f355e1cec692452d0b6", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/38120cc145b0e4a62fbd3314b68ea630bd9a5d1ef7e76f355e1cec692452d0b6/_data", "Type": "volume"}], "Name": "/t3ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "52e2ef0cae22a0fe584beb7c3fa01ae790ae9ce2f14385094ff2f97b588f1fa7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "52e2ef0cae22a0fe584beb7c3fa01ae790ae9ce2f14385094ff2f97b588f1fa7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "95d0b79be20481dbe08ecf6c4ef267326376793062b0dc8d4cba58c2f8574b1f"}}, "Ports": {}, "SandboxID": "93cf5a6080f658cd863ff43c4fbddd2dc935b494e1b4c0eec08067c5791e72a7", "SandboxKey": "/var/run/docker/netns/93cf5a6080f6", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/2c8dd27bca9271ce040c1577e2191934f47d787edf6b8f6f0f5e2ecb420047b8/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 3529, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:32:40.931087218Z", "Status": "running"}}, "item": {"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vmif": "t3C2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}}

PLAY RECAP ************************************************************************************************************
localhost                  : ok=3    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] *********************************************************************************************************

TASK [Build Docker Image] *********************************************************************************************
ok: [99.99.99.2] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] **************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.131.1', u'name': u't3', u'pns_ip': u'192.168.131.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.131.2/24', u'pns_if': u't3pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:32:44.82254354Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/2d3ee7af0730cc7f1453d9da41d0fd1a9bd83994db2ae1da695f27e852a2c580-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/2d3ee7af0730cc7f1453d9da41d0fd1a9bd83994db2ae1da695f27e852a2c580/merged", "UpperDir": "/var/lib/docker/overlay2/2d3ee7af0730cc7f1453d9da41d0fd1a9bd83994db2ae1da695f27e852a2c580/diff", "WorkDir": "/var/lib/docker/overlay2/2d3ee7af0730cc7f1453d9da41d0fd1a9bd83994db2ae1da695f27e852a2c580/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/134c33fd47c3fa91d1968a14b456461a0bb5c65db4f16afa62271e96374b43fa/hostname", "HostsPath": "/var/lib/docker/containers/134c33fd47c3fa91d1968a14b456461a0bb5c65db4f16afa62271e96374b43fa/hosts", "Id": "134c33fd47c3fa91d1968a14b456461a0bb5c65db4f16afa62271e96374b43fa", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/134c33fd47c3fa91d1968a14b456461a0bb5c65db4f16afa62271e96374b43fa/134c33fd47c3fa91d1968a14b456461a0bb5c65db4f16afa62271e96374b43fa-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "0061748b02e79bfa63af8a9ee946600e0764ff4fe6d0f9f86cd5e1f50a428bea", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/0061748b02e79bfa63af8a9ee946600e0764ff4fe6d0f9f86cd5e1f50a428bea/_data", "Type": "volume"}], "Name": "/t3", "NetworkSettings": {"Bridge": "", "EndpointID": "56d11aca9df3c2bb8bb314338ae76658605aa9ff78bb506870790c25609be337", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "56d11aca9df3c2bb8bb314338ae76658605aa9ff78bb506870790c25609be337", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "8185d4848c29da4359e6090d56ae20c49b76f6ec43c77f305868298082542e95"}}, "Ports": {}, "SandboxID": "76d2aa9da6d88ddb5cde9538a0ff2c876ac3e0a4da307f679f2477004a61baef", "SandboxKey": "/var/run/docker/netns/76d2aa9da6d8", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/134c33fd47c3fa91d1968a14b456461a0bb5c65db4f16afa62271e96374b43fa/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12523, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:32:45.441772058Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:32:44.82254354Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/2d3ee7af0730cc7f1453d9da41d0fd1a9bd83994db2ae1da695f27e852a2c580-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/2d3ee7af0730cc7f1453d9da41d0fd1a9bd83994db2ae1da695f27e852a2c580/merged", "UpperDir": "/var/lib/docker/overlay2/2d3ee7af0730cc7f1453d9da41d0fd1a9bd83994db2ae1da695f27e852a2c580/diff", "WorkDir": "/var/lib/docker/overlay2/2d3ee7af0730cc7f1453d9da41d0fd1a9bd83994db2ae1da695f27e852a2c580/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/134c33fd47c3fa91d1968a14b456461a0bb5c65db4f16afa62271e96374b43fa/hostname", "HostsPath": "/var/lib/docker/containers/134c33fd47c3fa91d1968a14b456461a0bb5c65db4f16afa62271e96374b43fa/hosts", "Id": "134c33fd47c3fa91d1968a14b456461a0bb5c65db4f16afa62271e96374b43fa", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/134c33fd47c3fa91d1968a14b456461a0bb5c65db4f16afa62271e96374b43fa/134c33fd47c3fa91d1968a14b456461a0bb5c65db4f16afa62271e96374b43fa-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "0061748b02e79bfa63af8a9ee946600e0764ff4fe6d0f9f86cd5e1f50a428bea", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/0061748b02e79bfa63af8a9ee946600e0764ff4fe6d0f9f86cd5e1f50a428bea/_data", "Type": "volume"}], "Name": "/t3", "NetworkSettings": {"Bridge": "", "EndpointID": "56d11aca9df3c2bb8bb314338ae76658605aa9ff78bb506870790c25609be337", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "56d11aca9df3c2bb8bb314338ae76658605aa9ff78bb506870790c25609be337", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "8185d4848c29da4359e6090d56ae20c49b76f6ec43c77f305868298082542e95"}}, "Ports": {}, "SandboxID": "76d2aa9da6d88ddb5cde9538a0ff2c876ac3e0a4da307f679f2477004a61baef", "SandboxKey": "/var/run/docker/netns/76d2aa9da6d8", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/134c33fd47c3fa91d1968a14b456461a0bb5c65db4f16afa62271e96374b43fa/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12523, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:32:45.441772058Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.131.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.131.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.131.2/24"}}

TASK [Create Subnet Containers] ***************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'tenant_route_ip': u'192.168.131.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.2.21.0/24', u'remote_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:32:46.306274182Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/9c4010304a3968f8f790ba44f71186e3418891573fe814df3f0a289be414f3b3-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/9c4010304a3968f8f790ba44f71186e3418891573fe814df3f0a289be414f3b3/merged", "UpperDir": "/var/lib/docker/overlay2/9c4010304a3968f8f790ba44f71186e3418891573fe814df3f0a289be414f3b3/diff", "WorkDir": "/var/lib/docker/overlay2/9c4010304a3968f8f790ba44f71186e3418891573fe814df3f0a289be414f3b3/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/f840e77e1a69068e077fd527a5a1288fc61d0ba8197cc25bd82406746633d7f2/hostname", "HostsPath": "/var/lib/docker/containers/f840e77e1a69068e077fd527a5a1288fc61d0ba8197cc25bd82406746633d7f2/hosts", "Id": "f840e77e1a69068e077fd527a5a1288fc61d0ba8197cc25bd82406746633d7f2", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/f840e77e1a69068e077fd527a5a1288fc61d0ba8197cc25bd82406746633d7f2/f840e77e1a69068e077fd527a5a1288fc61d0ba8197cc25bd82406746633d7f2-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "51412d295b87535ac720dcd69e1a403cf55e659123066a9daa55c4fda013a116", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/51412d295b87535ac720dcd69e1a403cf55e659123066a9daa55c4fda013a116/_data", "Type": "volume"}], "Name": "/t3ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "b4b59bb452accfd7cf449c71716c049e5d2cb302ae6d820a4bc48968219729a1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:06", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "b4b59bb452accfd7cf449c71716c049e5d2cb302ae6d820a4bc48968219729a1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:06", "NetworkID": "8185d4848c29da4359e6090d56ae20c49b76f6ec43c77f305868298082542e95"}}, "Ports": {}, "SandboxID": "05051451747fbe334a2796a51088ac4905162e7fb908f0b67dc06571ffd92da7", "SandboxKey": "/var/run/docker/netns/05051451747f", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/f840e77e1a69068e077fd527a5a1288fc61d0ba8197cc25bd82406746633d7f2/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 13644, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:32:47.266456532Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:32:46.306274182Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/9c4010304a3968f8f790ba44f71186e3418891573fe814df3f0a289be414f3b3-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/9c4010304a3968f8f790ba44f71186e3418891573fe814df3f0a289be414f3b3/merged", "UpperDir": "/var/lib/docker/overlay2/9c4010304a3968f8f790ba44f71186e3418891573fe814df3f0a289be414f3b3/diff", "WorkDir": "/var/lib/docker/overlay2/9c4010304a3968f8f790ba44f71186e3418891573fe814df3f0a289be414f3b3/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/f840e77e1a69068e077fd527a5a1288fc61d0ba8197cc25bd82406746633d7f2/hostname", "HostsPath": "/var/lib/docker/containers/f840e77e1a69068e077fd527a5a1288fc61d0ba8197cc25bd82406746633d7f2/hosts", "Id": "f840e77e1a69068e077fd527a5a1288fc61d0ba8197cc25bd82406746633d7f2", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/f840e77e1a69068e077fd527a5a1288fc61d0ba8197cc25bd82406746633d7f2/f840e77e1a69068e077fd527a5a1288fc61d0ba8197cc25bd82406746633d7f2-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "51412d295b87535ac720dcd69e1a403cf55e659123066a9daa55c4fda013a116", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/51412d295b87535ac720dcd69e1a403cf55e659123066a9daa55c4fda013a116/_data", "Type": "volume"}], "Name": "/t3ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "b4b59bb452accfd7cf449c71716c049e5d2cb302ae6d820a4bc48968219729a1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:06", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "b4b59bb452accfd7cf449c71716c049e5d2cb302ae6d820a4bc48968219729a1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:06", "NetworkID": "8185d4848c29da4359e6090d56ae20c49b76f6ec43c77f305868298082542e95"}}, "Ports": {}, "SandboxID": "05051451747fbe334a2796a51088ac4905162e7fb908f0b67dc06571ffd92da7", "SandboxKey": "/var/run/docker/netns/05051451747f", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/f840e77e1a69068e077fd527a5a1288fc61d0ba8197cc25bd82406746633d7f2/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 13644, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:32:47.266456532Z", "Status": "running"}}, "item": {"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vmif": "t3C3if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:32:48.137700003Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/f9832be32c997d61acb93b20e8a1c2039f77a75ae9fb4abd9211174d1bdf896f-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/f9832be32c997d61acb93b20e8a1c2039f77a75ae9fb4abd9211174d1bdf896f/merged", "UpperDir": "/var/lib/docker/overlay2/f9832be32c997d61acb93b20e8a1c2039f77a75ae9fb4abd9211174d1bdf896f/diff", "WorkDir": "/var/lib/docker/overlay2/f9832be32c997d61acb93b20e8a1c2039f77a75ae9fb4abd9211174d1bdf896f/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/cee94a5288cc529a8d74963824cf5bbcd75807ad4d81e7f7e5e668f05c121d0d/hostname", "HostsPath": "/var/lib/docker/containers/cee94a5288cc529a8d74963824cf5bbcd75807ad4d81e7f7e5e668f05c121d0d/hosts", "Id": "cee94a5288cc529a8d74963824cf5bbcd75807ad4d81e7f7e5e668f05c121d0d", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/cee94a5288cc529a8d74963824cf5bbcd75807ad4d81e7f7e5e668f05c121d0d/cee94a5288cc529a8d74963824cf5bbcd75807ad4d81e7f7e5e668f05c121d0d-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "1ba726f305b094b68650de80d27f094373b3a8e4a9814ade549e64db13b84735", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/1ba726f305b094b68650de80d27f094373b3a8e4a9814ade549e64db13b84735/_data", "Type": "volume"}], "Name": "/t3ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "9334ce8d5da63164c5293986a374b42ed64e8e3fc04940298da08a8973b9ee78", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:07", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "9334ce8d5da63164c5293986a374b42ed64e8e3fc04940298da08a8973b9ee78", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:07", "NetworkID": "8185d4848c29da4359e6090d56ae20c49b76f6ec43c77f305868298082542e95"}}, "Ports": {}, "SandboxID": "663d961e142e1b7f15468adeebe88377ead7cbaa1c5b399720ca49d61d9ac0dd", "SandboxKey": "/var/run/docker/netns/663d961e142e", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/cee94a5288cc529a8d74963824cf5bbcd75807ad4d81e7f7e5e668f05c121d0d/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 15531, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:32:49.130033296Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T16:32:48.137700003Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/f9832be32c997d61acb93b20e8a1c2039f77a75ae9fb4abd9211174d1bdf896f-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/f9832be32c997d61acb93b20e8a1c2039f77a75ae9fb4abd9211174d1bdf896f/merged", "UpperDir": "/var/lib/docker/overlay2/f9832be32c997d61acb93b20e8a1c2039f77a75ae9fb4abd9211174d1bdf896f/diff", "WorkDir": "/var/lib/docker/overlay2/f9832be32c997d61acb93b20e8a1c2039f77a75ae9fb4abd9211174d1bdf896f/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/cee94a5288cc529a8d74963824cf5bbcd75807ad4d81e7f7e5e668f05c121d0d/hostname", "HostsPath": "/var/lib/docker/containers/cee94a5288cc529a8d74963824cf5bbcd75807ad4d81e7f7e5e668f05c121d0d/hosts", "Id": "cee94a5288cc529a8d74963824cf5bbcd75807ad4d81e7f7e5e668f05c121d0d", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/cee94a5288cc529a8d74963824cf5bbcd75807ad4d81e7f7e5e668f05c121d0d/cee94a5288cc529a8d74963824cf5bbcd75807ad4d81e7f7e5e668f05c121d0d-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "1ba726f305b094b68650de80d27f094373b3a8e4a9814ade549e64db13b84735", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/1ba726f305b094b68650de80d27f094373b3a8e4a9814ade549e64db13b84735/_data", "Type": "volume"}], "Name": "/t3ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "9334ce8d5da63164c5293986a374b42ed64e8e3fc04940298da08a8973b9ee78", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:07", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "9334ce8d5da63164c5293986a374b42ed64e8e3fc04940298da08a8973b9ee78", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:07", "NetworkID": "8185d4848c29da4359e6090d56ae20c49b76f6ec43c77f305868298082542e95"}}, "Ports": {}, "SandboxID": "663d961e142e1b7f15468adeebe88377ead7cbaa1c5b399720ca49d61d9ac0dd", "SandboxKey": "/var/run/docker/netns/663d961e142e", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/cee94a5288cc529a8d74963824cf5bbcd75807ad4d81e7f7e5e668f05c121d0d/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 15531, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T16:32:49.130033296Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vmif": "t3C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP ************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 17:24:45.130514 Printing the yaml input file
INFO:root: 17:24:45.130821 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 17:24:45.130938 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 17:24:45.130992 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 17:24:45.131035 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T17:24:47.538500888Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/8daaa3154fd7ce0e75b2b7a4a63d4f28c94616d8276b79b92ee535e21988a24a-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/8daaa3154fd7ce0e75b2b7a4a63d4f28c94616d8276b79b92ee535e21988a24a/merged", "UpperDir": "/var/lib/docker/overlay2/8daaa3154fd7ce0e75b2b7a4a63d4f28c94616d8276b79b92ee535e21988a24a/diff", "WorkDir": "/var/lib/docker/overlay2/8daaa3154fd7ce0e75b2b7a4a63d4f28c94616d8276b79b92ee535e21988a24a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/e111adcd991546c7dba8ec88ed04d66ee82f66aa264dd536572dba56b62aaeeb/hostname", "HostsPath": "/var/lib/docker/containers/e111adcd991546c7dba8ec88ed04d66ee82f66aa264dd536572dba56b62aaeeb/hosts", "Id": "e111adcd991546c7dba8ec88ed04d66ee82f66aa264dd536572dba56b62aaeeb", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/e111adcd991546c7dba8ec88ed04d66ee82f66aa264dd536572dba56b62aaeeb/e111adcd991546c7dba8ec88ed04d66ee82f66aa264dd536572dba56b62aaeeb-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "02e70c6983ee769f4a406deff4b507f26463391a502391e1e8b81a24fc5a1c80", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/02e70c6983ee769f4a406deff4b507f26463391a502391e1e8b81a24fc5a1c80/_data", "Type": "volume"}], "Name": "/t4", "NetworkSettings": {"Bridge": "", "EndpointID": "bab709ff42b55c01ecc5f542e769d768ea9d738ee13803eb8f24cc319af8f209", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "bab709ff42b55c01ecc5f542e769d768ea9d738ee13803eb8f24cc319af8f209", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "33c04096536482a2aea5d4c25d5fa898be06fc4e4c2466d1f4644bfd68dd8109"}}, "Ports": {}, "SandboxID": "18f14480c94dad98b231e6c193fba92e69b887ba759679f8b09fa5b402932308", "SandboxKey": "/var/run/docker/netns/18f14480c94d", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/e111adcd991546c7dba8ec88ed04d66ee82f66aa264dd536572dba56b62aaeeb/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12264, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T17:24:48.311428881Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T17:24:47.538500888Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/8daaa3154fd7ce0e75b2b7a4a63d4f28c94616d8276b79b92ee535e21988a24a-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/8daaa3154fd7ce0e75b2b7a4a63d4f28c94616d8276b79b92ee535e21988a24a/merged", "UpperDir": "/var/lib/docker/overlay2/8daaa3154fd7ce0e75b2b7a4a63d4f28c94616d8276b79b92ee535e21988a24a/diff", "WorkDir": "/var/lib/docker/overlay2/8daaa3154fd7ce0e75b2b7a4a63d4f28c94616d8276b79b92ee535e21988a24a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/e111adcd991546c7dba8ec88ed04d66ee82f66aa264dd536572dba56b62aaeeb/hostname", "HostsPath": "/var/lib/docker/containers/e111adcd991546c7dba8ec88ed04d66ee82f66aa264dd536572dba56b62aaeeb/hosts", "Id": "e111adcd991546c7dba8ec88ed04d66ee82f66aa264dd536572dba56b62aaeeb", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/e111adcd991546c7dba8ec88ed04d66ee82f66aa264dd536572dba56b62aaeeb/e111adcd991546c7dba8ec88ed04d66ee82f66aa264dd536572dba56b62aaeeb-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "02e70c6983ee769f4a406deff4b507f26463391a502391e1e8b81a24fc5a1c80", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/02e70c6983ee769f4a406deff4b507f26463391a502391e1e8b81a24fc5a1c80/_data", "Type": "volume"}], "Name": "/t4", "NetworkSettings": {"Bridge": "", "EndpointID": "bab709ff42b55c01ecc5f542e769d768ea9d738ee13803eb8f24cc319af8f209", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "bab709ff42b55c01ecc5f542e769d768ea9d738ee13803eb8f24cc319af8f209", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "33c04096536482a2aea5d4c25d5fa898be06fc4e4c2466d1f4644bfd68dd8109"}}, "Ports": {}, "SandboxID": "18f14480c94dad98b231e6c193fba92e69b887ba759679f8b09fa5b402932308", "SandboxKey": "/var/run/docker/netns/18f14480c94d", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/e111adcd991546c7dba8ec88ed04d66ee82f66aa264dd536572dba56b62aaeeb/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12264, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T17:24:48.311428881Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'tenant_route_ip': u'192.168.4.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.1.31.0/24', u'remote_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T17:24:48.97313716Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/00b4caea055efde28fb61d6d1b0f143daff549d097c6a3cabf5bc96027bf41ab-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/00b4caea055efde28fb61d6d1b0f143daff549d097c6a3cabf5bc96027bf41ab/merged", "UpperDir": "/var/lib/docker/overlay2/00b4caea055efde28fb61d6d1b0f143daff549d097c6a3cabf5bc96027bf41ab/diff", "WorkDir": "/var/lib/docker/overlay2/00b4caea055efde28fb61d6d1b0f143daff549d097c6a3cabf5bc96027bf41ab/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/ab9d70b13cdedf9fef78cb3c17c4320f72193f451c9ded070923bb67f3998a63/hostname", "HostsPath": "/var/lib/docker/containers/ab9d70b13cdedf9fef78cb3c17c4320f72193f451c9ded070923bb67f3998a63/hosts", "Id": "ab9d70b13cdedf9fef78cb3c17c4320f72193f451c9ded070923bb67f3998a63", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/ab9d70b13cdedf9fef78cb3c17c4320f72193f451c9ded070923bb67f3998a63/ab9d70b13cdedf9fef78cb3c17c4320f72193f451c9ded070923bb67f3998a63-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "a7a6a7fb5734fd0ad1e181c00094b2ac5903b26a18729eed9bbbc3bbed9ecd52", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/a7a6a7fb5734fd0ad1e181c00094b2ac5903b26a18729eed9bbbc3bbed9ecd52/_data", "Type": "volume"}], "Name": "/t4ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "5b6d01ff8169f3a4e71b31ec34e7686fd43e5fae35de7518cbf518b3102c0944", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "5b6d01ff8169f3a4e71b31ec34e7686fd43e5fae35de7518cbf518b3102c0944", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "33c04096536482a2aea5d4c25d5fa898be06fc4e4c2466d1f4644bfd68dd8109"}}, "Ports": {}, "SandboxID": "06e53cc9f495524aab1d3bc139c836ec29c2852062bc73eac14f4e10ec00c7aa", "SandboxKey": "/var/run/docker/netns/06e53cc9f495", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/ab9d70b13cdedf9fef78cb3c17c4320f72193f451c9ded070923bb67f3998a63/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12884, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T17:24:49.668660719Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T17:24:48.97313716Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/00b4caea055efde28fb61d6d1b0f143daff549d097c6a3cabf5bc96027bf41ab-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/00b4caea055efde28fb61d6d1b0f143daff549d097c6a3cabf5bc96027bf41ab/merged", "UpperDir": "/var/lib/docker/overlay2/00b4caea055efde28fb61d6d1b0f143daff549d097c6a3cabf5bc96027bf41ab/diff", "WorkDir": "/var/lib/docker/overlay2/00b4caea055efde28fb61d6d1b0f143daff549d097c6a3cabf5bc96027bf41ab/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/ab9d70b13cdedf9fef78cb3c17c4320f72193f451c9ded070923bb67f3998a63/hostname", "HostsPath": "/var/lib/docker/containers/ab9d70b13cdedf9fef78cb3c17c4320f72193f451c9ded070923bb67f3998a63/hosts", "Id": "ab9d70b13cdedf9fef78cb3c17c4320f72193f451c9ded070923bb67f3998a63", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/ab9d70b13cdedf9fef78cb3c17c4320f72193f451c9ded070923bb67f3998a63/ab9d70b13cdedf9fef78cb3c17c4320f72193f451c9ded070923bb67f3998a63-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "a7a6a7fb5734fd0ad1e181c00094b2ac5903b26a18729eed9bbbc3bbed9ecd52", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/a7a6a7fb5734fd0ad1e181c00094b2ac5903b26a18729eed9bbbc3bbed9ecd52/_data", "Type": "volume"}], "Name": "/t4ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "5b6d01ff8169f3a4e71b31ec34e7686fd43e5fae35de7518cbf518b3102c0944", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "5b6d01ff8169f3a4e71b31ec34e7686fd43e5fae35de7518cbf518b3102c0944", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "33c04096536482a2aea5d4c25d5fa898be06fc4e4c2466d1f4644bfd68dd8109"}}, "Ports": {}, "SandboxID": "06e53cc9f495524aab1d3bc139c836ec29c2852062bc73eac14f4e10ec00c7aa", "SandboxKey": "/var/run/docker/netns/06e53cc9f495", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/ab9d70b13cdedf9fef78cb3c17c4320f72193f451c9ded070923bb67f3998a63/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12884, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T17:24:49.668660719Z", "Status": "running"}}, "item": {"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.132.1', u'name': u't4', u'pns_ip': u'192.168.132.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.132.2/24', u'pns_if': u't4pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T17:24:53.872108928Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/5e59aa16dae9caa538ff2b12df1f9ccfa256f757efc5adabf55fc475df037e8a-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/5e59aa16dae9caa538ff2b12df1f9ccfa256f757efc5adabf55fc475df037e8a/merged", "UpperDir": "/var/lib/docker/overlay2/5e59aa16dae9caa538ff2b12df1f9ccfa256f757efc5adabf55fc475df037e8a/diff", "WorkDir": "/var/lib/docker/overlay2/5e59aa16dae9caa538ff2b12df1f9ccfa256f757efc5adabf55fc475df037e8a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/b6c953124cc2eef75ed5c701fb7f9ac4a45e7ab036e5450243aae5f7c31062ab/hostname", "HostsPath": "/var/lib/docker/containers/b6c953124cc2eef75ed5c701fb7f9ac4a45e7ab036e5450243aae5f7c31062ab/hosts", "Id": "b6c953124cc2eef75ed5c701fb7f9ac4a45e7ab036e5450243aae5f7c31062ab", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/b6c953124cc2eef75ed5c701fb7f9ac4a45e7ab036e5450243aae5f7c31062ab/b6c953124cc2eef75ed5c701fb7f9ac4a45e7ab036e5450243aae5f7c31062ab-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "34a23bbe892b077af2663c40c9faa902e33f7d624547eafe52d47bef8514c1b6", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/34a23bbe892b077af2663c40c9faa902e33f7d624547eafe52d47bef8514c1b6/_data", "Type": "volume"}], "Name": "/t4", "NetworkSettings": {"Bridge": "", "EndpointID": "b1b13f93464254fac809e05053970129409f4a4cb972404999957aeb7dcf62b9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "b1b13f93464254fac809e05053970129409f4a4cb972404999957aeb7dcf62b9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "55325f4bdd1be2aaf2ae9c15c9858401ec981f16c8cba10d9af8b390cff04bfc", "SandboxKey": "/var/run/docker/netns/55325f4bdd1b", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/b6c953124cc2eef75ed5c701fb7f9ac4a45e7ab036e5450243aae5f7c31062ab/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4513, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T17:24:54.582298344Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T17:24:53.872108928Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/5e59aa16dae9caa538ff2b12df1f9ccfa256f757efc5adabf55fc475df037e8a-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/5e59aa16dae9caa538ff2b12df1f9ccfa256f757efc5adabf55fc475df037e8a/merged", "UpperDir": "/var/lib/docker/overlay2/5e59aa16dae9caa538ff2b12df1f9ccfa256f757efc5adabf55fc475df037e8a/diff", "WorkDir": "/var/lib/docker/overlay2/5e59aa16dae9caa538ff2b12df1f9ccfa256f757efc5adabf55fc475df037e8a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/b6c953124cc2eef75ed5c701fb7f9ac4a45e7ab036e5450243aae5f7c31062ab/hostname", "HostsPath": "/var/lib/docker/containers/b6c953124cc2eef75ed5c701fb7f9ac4a45e7ab036e5450243aae5f7c31062ab/hosts", "Id": "b6c953124cc2eef75ed5c701fb7f9ac4a45e7ab036e5450243aae5f7c31062ab", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/b6c953124cc2eef75ed5c701fb7f9ac4a45e7ab036e5450243aae5f7c31062ab/b6c953124cc2eef75ed5c701fb7f9ac4a45e7ab036e5450243aae5f7c31062ab-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "34a23bbe892b077af2663c40c9faa902e33f7d624547eafe52d47bef8514c1b6", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/34a23bbe892b077af2663c40c9faa902e33f7d624547eafe52d47bef8514c1b6/_data", "Type": "volume"}], "Name": "/t4", "NetworkSettings": {"Bridge": "", "EndpointID": "b1b13f93464254fac809e05053970129409f4a4cb972404999957aeb7dcf62b9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "b1b13f93464254fac809e05053970129409f4a4cb972404999957aeb7dcf62b9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "55325f4bdd1be2aaf2ae9c15c9858401ec981f16c8cba10d9af8b390cff04bfc", "SandboxKey": "/var/run/docker/netns/55325f4bdd1b", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/b6c953124cc2eef75ed5c701fb7f9ac4a45e7ab036e5450243aae5f7c31062ab/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4513, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T17:24:54.582298344Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.132.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.132.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.132.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'tenant_route_ip': u'192.168.132.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.2.31.0/24', u'remote_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T17:24:55.513383767Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/6ab64c5a17e98c3f63e26cae41f7d974a0fe6b5a4ba9488252ad25b257628804-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/6ab64c5a17e98c3f63e26cae41f7d974a0fe6b5a4ba9488252ad25b257628804/merged", "UpperDir": "/var/lib/docker/overlay2/6ab64c5a17e98c3f63e26cae41f7d974a0fe6b5a4ba9488252ad25b257628804/diff", "WorkDir": "/var/lib/docker/overlay2/6ab64c5a17e98c3f63e26cae41f7d974a0fe6b5a4ba9488252ad25b257628804/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/6d763dc7a8ac6adef2e347c2c3121bd38be0e2e006f0acf081aacaddb63ee8da/hostname", "HostsPath": "/var/lib/docker/containers/6d763dc7a8ac6adef2e347c2c3121bd38be0e2e006f0acf081aacaddb63ee8da/hosts", "Id": "6d763dc7a8ac6adef2e347c2c3121bd38be0e2e006f0acf081aacaddb63ee8da", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/6d763dc7a8ac6adef2e347c2c3121bd38be0e2e006f0acf081aacaddb63ee8da/6d763dc7a8ac6adef2e347c2c3121bd38be0e2e006f0acf081aacaddb63ee8da-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "b3e7d654aec0f68e018f054ba2af45a63432cc4bf15e642c0f3d453d5686bde9", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/b3e7d654aec0f68e018f054ba2af45a63432cc4bf15e642c0f3d453d5686bde9/_data", "Type": "volume"}], "Name": "/t4ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "83123e78128681e1bafa735431d862e452fe867c6ed08a347d2bca560d9a2f93", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "83123e78128681e1bafa735431d862e452fe867c6ed08a347d2bca560d9a2f93", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "506b290765adea02221711be619dcdb0c76371c073736829cf84f70f06d54dd1", "SandboxKey": "/var/run/docker/netns/506b290765ad", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/6d763dc7a8ac6adef2e347c2c3121bd38be0e2e006f0acf081aacaddb63ee8da/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 5257, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T17:24:56.054586853Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T17:24:55.513383767Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/6ab64c5a17e98c3f63e26cae41f7d974a0fe6b5a4ba9488252ad25b257628804-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/6ab64c5a17e98c3f63e26cae41f7d974a0fe6b5a4ba9488252ad25b257628804/merged", "UpperDir": "/var/lib/docker/overlay2/6ab64c5a17e98c3f63e26cae41f7d974a0fe6b5a4ba9488252ad25b257628804/diff", "WorkDir": "/var/lib/docker/overlay2/6ab64c5a17e98c3f63e26cae41f7d974a0fe6b5a4ba9488252ad25b257628804/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/6d763dc7a8ac6adef2e347c2c3121bd38be0e2e006f0acf081aacaddb63ee8da/hostname", "HostsPath": "/var/lib/docker/containers/6d763dc7a8ac6adef2e347c2c3121bd38be0e2e006f0acf081aacaddb63ee8da/hosts", "Id": "6d763dc7a8ac6adef2e347c2c3121bd38be0e2e006f0acf081aacaddb63ee8da", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/6d763dc7a8ac6adef2e347c2c3121bd38be0e2e006f0acf081aacaddb63ee8da/6d763dc7a8ac6adef2e347c2c3121bd38be0e2e006f0acf081aacaddb63ee8da-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "b3e7d654aec0f68e018f054ba2af45a63432cc4bf15e642c0f3d453d5686bde9", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/b3e7d654aec0f68e018f054ba2af45a63432cc4bf15e642c0f3d453d5686bde9/_data", "Type": "volume"}], "Name": "/t4ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "83123e78128681e1bafa735431d862e452fe867c6ed08a347d2bca560d9a2f93", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "83123e78128681e1bafa735431d862e452fe867c6ed08a347d2bca560d9a2f93", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "506b290765adea02221711be619dcdb0c76371c073736829cf84f70f06d54dd1", "SandboxKey": "/var/run/docker/netns/506b290765ad", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/6d763dc7a8ac6adef2e347c2c3121bd38be0e2e006f0acf081aacaddb63ee8da/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 5257, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T17:24:56.054586853Z", "Status": "running"}}, "item": {"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vmif": "t4C3if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T17:24:57.160725483Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/fc0de67d40aa3cb52bcccd982c08b0a1de80ef7941a58aef719fa2b59e70a026-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/fc0de67d40aa3cb52bcccd982c08b0a1de80ef7941a58aef719fa2b59e70a026/merged", "UpperDir": "/var/lib/docker/overlay2/fc0de67d40aa3cb52bcccd982c08b0a1de80ef7941a58aef719fa2b59e70a026/diff", "WorkDir": "/var/lib/docker/overlay2/fc0de67d40aa3cb52bcccd982c08b0a1de80ef7941a58aef719fa2b59e70a026/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/6c01d949693a6cc698f3d52812b4805f9468304473b6d102f8278d189d5fb824/hostname", "HostsPath": "/var/lib/docker/containers/6c01d949693a6cc698f3d52812b4805f9468304473b6d102f8278d189d5fb824/hosts", "Id": "6c01d949693a6cc698f3d52812b4805f9468304473b6d102f8278d189d5fb824", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/6c01d949693a6cc698f3d52812b4805f9468304473b6d102f8278d189d5fb824/6c01d949693a6cc698f3d52812b4805f9468304473b6d102f8278d189d5fb824-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "948e1767bf89a674a8cff6909b71787751a8ef996395cfc9b2012124747cea71", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/948e1767bf89a674a8cff6909b71787751a8ef996395cfc9b2012124747cea71/_data", "Type": "volume"}], "Name": "/t4ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "d6947f94c8f6fe5c089a235daf482aa9e5e47c50360b0dac1e8e71ac2ee17508", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d6947f94c8f6fe5c089a235daf482aa9e5e47c50360b0dac1e8e71ac2ee17508", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "3851f721870a9a5c8c05a49f5afb0a34d4ca83330d2c3a6c8c0537f6573af05a", "SandboxKey": "/var/run/docker/netns/3851f721870a", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/6c01d949693a6cc698f3d52812b4805f9468304473b6d102f8278d189d5fb824/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 6408, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T17:24:57.684236722Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T17:24:57.160725483Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/fc0de67d40aa3cb52bcccd982c08b0a1de80ef7941a58aef719fa2b59e70a026-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/fc0de67d40aa3cb52bcccd982c08b0a1de80ef7941a58aef719fa2b59e70a026/merged", "UpperDir": "/var/lib/docker/overlay2/fc0de67d40aa3cb52bcccd982c08b0a1de80ef7941a58aef719fa2b59e70a026/diff", "WorkDir": "/var/lib/docker/overlay2/fc0de67d40aa3cb52bcccd982c08b0a1de80ef7941a58aef719fa2b59e70a026/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/6c01d949693a6cc698f3d52812b4805f9468304473b6d102f8278d189d5fb824/hostname", "HostsPath": "/var/lib/docker/containers/6c01d949693a6cc698f3d52812b4805f9468304473b6d102f8278d189d5fb824/hosts", "Id": "6c01d949693a6cc698f3d52812b4805f9468304473b6d102f8278d189d5fb824", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/6c01d949693a6cc698f3d52812b4805f9468304473b6d102f8278d189d5fb824/6c01d949693a6cc698f3d52812b4805f9468304473b6d102f8278d189d5fb824-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "948e1767bf89a674a8cff6909b71787751a8ef996395cfc9b2012124747cea71", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/948e1767bf89a674a8cff6909b71787751a8ef996395cfc9b2012124747cea71/_data", "Type": "volume"}], "Name": "/t4ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "d6947f94c8f6fe5c089a235daf482aa9e5e47c50360b0dac1e8e71ac2ee17508", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d6947f94c8f6fe5c089a235daf482aa9e5e47c50360b0dac1e8e71ac2ee17508", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "3851f721870a9a5c8c05a49f5afb0a34d4ca83330d2c3a6c8c0537f6573af05a", "SandboxKey": "/var/run/docker/netns/3851f721870a", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/6c01d949693a6cc698f3d52812b4805f9468304473b6d102f8278d189d5fb824/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 6408, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T17:24:57.684236722Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vmif": "t4C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'pid': u'12264', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link show \"t4if\" ; if [ $? -ne 0 ] ; then ip link add \"t4if\" type veth peer name \"t4pns_if\" ; fi\n", "delta": "0:00:00.283910", "end": "2019-12-06 17:24:59.483415", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pid": "12264", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-06 17:24:59.199505", "stderr": "Device \"t4if\" does not exist.", "stderr_lines": ["Device \"t4if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'pid': u'12264', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t4pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t4pns_if\" netns pns1 ; fi\ndocker exec \"t4\" ip link show \"t4if\" ; if [ $? -ne 0 ] ; then ip link set \"t4if\" netns \"12264\" ; fi\nip netns exec pns1 ip link set dev \"t4pns_if\" up\ndocker exec \"t4\" ip link set dev \"t4if\" up\n", "delta": "0:00:00.492864", "end": "2019-12-06 17:25:00.219895", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pid": "12264", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-06 17:24:59.727031", "stderr": "Device \"t4pns_if\" does not exist.\nDevice \"t4if\" does not exist.", "stderr_lines": ["Device \"t4pns_if\" does not exist.", "Device \"t4if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'pid': u'12264', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t4pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.4.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.4.1/24\" dev \"t4pns_if\" ; fi\ndocker exec \"t4\" ip addr show \"t4if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.4.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t4\" ip addr add \"192.168.4.2/24\" dev \"t4if\" ; fi\n", "delta": "0:00:00.460876", "end": "2019-12-06 17:25:00.912040", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pid": "12264", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-06 17:25:00.451164", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link show \"t4ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t4ns1if\" type veth peer name \"t4s1if\" ; fi\n", "delta": "0:00:00.208784", "end": "2019-12-06 17:25:01.342479", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "rc": 0, "start": "2019-12-06 17:25:01.133695", "stderr": "Device \"t4ns1if\" does not exist.", "stderr_lines": ["Device \"t4ns1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link show \"t4ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t4ns1if\" netns \"12264\" ; fi\ndocker exec \"t4ns1\" ip link show \"t4s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t4s1if\" netns \"12884\" ; fi\n", "delta": "0:00:00.412015", "end": "2019-12-06 17:25:02.011095", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "rc": 0, "start": "2019-12-06 17:25:01.599080", "stderr": "Device \"t4ns1if\" does not exist.\nDevice \"t4s1if\" does not exist.", "stderr_lines": ["Device \"t4ns1if\" does not exist.", "Device \"t4s1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link set dev \"t4ns1if\" up\ndocker exec \"t4ns1\" ip link set dev \"t4s1if\" up\n", "delta": "0:00:00.377249", "end": "2019-12-06 17:25:02.636433", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "rc": 0, "start": "2019-12-06 17:25:02.259184", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip addr show \"t4s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.31.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip addr add \"10.1.31.2/24\" dev \"t4s1if\" ; fi\n\ndocker exec \"t4\" ip addr show \"t4ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.31.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t4\" ip addr add \"10.1.31.1/24\" dev \"t4ns1if\" ; fi\n", "delta": "0:00:00.779092", "end": "2019-12-06 17:25:03.656110", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "rc": 0, "start": "2019-12-06 17:25:02.877018", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route] *********************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'pid': u'12264', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t4\" ip route del default ; fi\n", "delta": "0:00:00.345657", "end": "2019-12-06 17:25:04.243016", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pid": "12264", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-06 17:25:03.897359", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'pid': u'12264', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip route show default | grep -w '[d]efault via 192.168.4.1' ; if [ $? -ne 0 ] ; then docker exec \"t4\" ip route add default via \"192.168.4.1\" ; fi\n", "delta": "0:00:00.367660", "end": "2019-12-06 17:25:04.828824", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pid": "12264", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-06 17:25:04.461164", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_ns_name': u't4', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'tenant_route_ip': u'192.168.4.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.1.31.0/24', u'remote_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t4ns1\" ip route del default ; fi\n", "delta": "0:00:00.432132", "end": "2019-12-06 17:25:05.504175", "item": {"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-06 17:25:05.072043", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_ns_name': u't4', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'tenant_route_ip': u'192.168.4.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.1.31.0/24', u'remote_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip route show default | grep -w '[d]efault via 10.1.31.1' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip route add default via \"10.1.31.1\" ; fi\n", "delta": "0:00:00.392700", "end": "2019-12-06 17:25:06.152998", "item": {"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-06 17:25:05.760298", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside container] ***********************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_ns_name': u't4', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'tenant_route_ip': u'192.168.4.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.1.31.0/24', u'remote_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" brctl show | grep -w '^t4br1'; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" brctl addbr \"t4br1\" ; fi\ndocker exec \"t4ns1\" ip link set dev \"t4br1\" up\n", "delta": "0:00:00.610139", "end": "2019-12-06 17:25:07.019009", "item": {"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-06 17:25:06.408870", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link show \"t4s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip link add \"t4s1_dnsbrif\" type veth peer name \"t4s1_dnsif\" ; fi\ndocker exec \"t4ns1\" ip link set dev \"t4s1_dnsbrif\" up\ndocker exec \"t4ns1\" ip link set dev \"t4s1_dnsif\" up\n", "delta": "0:00:00.804341", "end": "2019-12-06 17:25:08.072070", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 17:25:07.267729", "stderr": "Device \"t4s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t4s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" brctl show \"t4br1\" | grep -w 't4s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" brctl addif \"t4br1\" \"t4s1_dnsbrif\" ; fi\n", "delta": "0:00:00.390783", "end": "2019-12-06 17:25:08.737442", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 17:25:08.346659", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link show \"t4br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t4C1if1\" type veth peer name \"t4br1if1\" ; fi\nip link set dev \"t4br1if1\" up\nip link set dev \"t4C1if1\" up\n", "delta": "0:00:00.212957", "end": "2019-12-06 17:25:09.196480", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}], "rc": 0, "start": "2019-12-06 17:25:08.983523", "stderr": "Device \"t4br1if1\" does not exist.", "stderr_lines": ["Device \"t4br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link show \"t4br1if2\" ; if [ $? -ne 0 ] ; then ip link add \"t4C2if1\" type veth peer name \"t4br1if2\" ; fi\nip link set dev \"t4br1if2\" up\nip link set dev \"t4C2if1\" up\n", "delta": "0:00:00.189192", "end": "2019-12-06 17:25:09.581851", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "rc": 0, "start": "2019-12-06 17:25:09.392659", "stderr": "Device \"t4br1if2\" does not exist.", "stderr_lines": ["Device \"t4br1if2\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t4br1if1\" netns \"12884\" ; fi\ndocker exec \"t4ns1\" brctl show \"t4br1\" | grep -w 't4br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" brctl addif \"t4br1\" \"t4br1if1\" ; fi\n", "delta": "0:00:00.440268", "end": "2019-12-06 17:25:10.293478", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}], "rc": 0, "start": "2019-12-06 17:25:09.853210", "stderr": "", "stderr_lines": [], "stdout": "40: t4br1if1@t4C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 72:98:fd:a0:4b:59 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["40: t4br1if1@t4C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 72:98:fd:a0:4b:59 brd ff:ff:ff:ff:ff:ff"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4br1if2\" ; if [ $? -eq 0 ] ; then ip link set \"t4br1if2\" netns \"12884\" ; fi\ndocker exec \"t4ns1\" brctl show \"t4br1\" | grep -w 't4br1if2' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" brctl addif \"t4br1\" \"t4br1if2\" ; fi\n", "delta": "0:00:00.379003", "end": "2019-12-06 17:25:10.833977", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "rc": 0, "start": "2019-12-06 17:25:10.454974", "stderr": "", "stderr_lines": [], "stdout": "42: t4br1if2@t4C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 56:d5:18:51:69:dc brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["42: t4br1if2@t4C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 56:d5:18:51:69:dc brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link set \"t4br1if1\" up\ndocker exec \"t4ns1\" ip link set dev \"t4br1\" up\n", "delta": "0:00:00.401760", "end": "2019-12-06 17:25:11.478035", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}], "rc": 0, "start": "2019-12-06 17:25:11.076275", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link set \"t4br1if2\" up\ndocker exec \"t4ns1\" ip link set dev \"t4br1\" up\n", "delta": "0:00:00.413663", "end": "2019-12-06 17:25:12.079814", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "rc": 0, "start": "2019-12-06 17:25:11.666151", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip addr show \"t4s1_dnsif\" | awk 'FNR==3{ print $2 }' | grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip addr add \"1.1.1.1/24\" dev \"t4s1_dnsif\" ; fi\n", "delta": "0:00:00.379327", "end": "2019-12-06 17:25:12.714406", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 17:25:12.335079", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ps aux | grep -w '[d]nsmasq --interface t4s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" dnsmasq --interface \"t4s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.878849", "end": "2019-12-06 17:25:13.829090", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 17:25:12.950241", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}]}, {u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link show \"vxlan_t4s1\" ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip link add \"vxlan_t4s1\" type vxlan id \"42\" local \"10.1.31.2\" remote \"10.2.31.2\" dstport \"4789\" dev \"t4s1if\"; docker exec \"t4ns1\" ip link set dev \"vxlan_t4s1\" up ; fi\n", "delta": "0:00:00.596473", "end": "2019-12-06 17:25:14.700141", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-06 17:25:14.103668", "stderr": "Device \"vxlan_t4s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t4s1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'12884', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12264', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}]}, {u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" brctl show \"t4br1\" | grep -w 'vxlan_t4s1' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" brctl addif \"t4br1\" \"vxlan_t4s1\" ; fi\n", "delta": "0:00:00.369867", "end": "2019-12-06 17:25:15.310704", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12884", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12264", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-06 17:25:14.940837", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 20:19:07.632418 Printing the yaml input file
INFO:root: 20:19:07.632654 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 20:19:07.632838 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 20:19:07.632926 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 20:19:07.633003 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:19:09.778543359Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/edbb248eaf2647b10b3bc67e38fbd21297747142596bc1f801de94e3c2e42e9b-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/edbb248eaf2647b10b3bc67e38fbd21297747142596bc1f801de94e3c2e42e9b/merged", "UpperDir": "/var/lib/docker/overlay2/edbb248eaf2647b10b3bc67e38fbd21297747142596bc1f801de94e3c2e42e9b/diff", "WorkDir": "/var/lib/docker/overlay2/edbb248eaf2647b10b3bc67e38fbd21297747142596bc1f801de94e3c2e42e9b/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c251e32b8b8e59e8d360f9a7643f4c34a4beeac5300163d19b10ca55f9ae0fee/hostname", "HostsPath": "/var/lib/docker/containers/c251e32b8b8e59e8d360f9a7643f4c34a4beeac5300163d19b10ca55f9ae0fee/hosts", "Id": "c251e32b8b8e59e8d360f9a7643f4c34a4beeac5300163d19b10ca55f9ae0fee", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/c251e32b8b8e59e8d360f9a7643f4c34a4beeac5300163d19b10ca55f9ae0fee/c251e32b8b8e59e8d360f9a7643f4c34a4beeac5300163d19b10ca55f9ae0fee-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "080e1eeef73e62d32a7fcd01672b8cba768948136aedc07a447dd7e38b06da41", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/080e1eeef73e62d32a7fcd01672b8cba768948136aedc07a447dd7e38b06da41/_data", "Type": "volume"}], "Name": "/t5", "NetworkSettings": {"Bridge": "", "EndpointID": "7bb711dd6b0729b7709463bdf9a354df379fb5f370329324f2869c36fc29c782", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "7bb711dd6b0729b7709463bdf9a354df379fb5f370329324f2869c36fc29c782", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "33c04096536482a2aea5d4c25d5fa898be06fc4e4c2466d1f4644bfd68dd8109"}}, "Ports": {}, "SandboxID": "4146db288cf9483c6501b93cdb663e8e8ad9702433dd88c2626ad82c58105db1", "SandboxKey": "/var/run/docker/netns/4146db288cf9", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c251e32b8b8e59e8d360f9a7643f4c34a4beeac5300163d19b10ca55f9ae0fee/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8754, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:19:10.491395764Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:19:09.778543359Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/edbb248eaf2647b10b3bc67e38fbd21297747142596bc1f801de94e3c2e42e9b-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/edbb248eaf2647b10b3bc67e38fbd21297747142596bc1f801de94e3c2e42e9b/merged", "UpperDir": "/var/lib/docker/overlay2/edbb248eaf2647b10b3bc67e38fbd21297747142596bc1f801de94e3c2e42e9b/diff", "WorkDir": "/var/lib/docker/overlay2/edbb248eaf2647b10b3bc67e38fbd21297747142596bc1f801de94e3c2e42e9b/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c251e32b8b8e59e8d360f9a7643f4c34a4beeac5300163d19b10ca55f9ae0fee/hostname", "HostsPath": "/var/lib/docker/containers/c251e32b8b8e59e8d360f9a7643f4c34a4beeac5300163d19b10ca55f9ae0fee/hosts", "Id": "c251e32b8b8e59e8d360f9a7643f4c34a4beeac5300163d19b10ca55f9ae0fee", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/c251e32b8b8e59e8d360f9a7643f4c34a4beeac5300163d19b10ca55f9ae0fee/c251e32b8b8e59e8d360f9a7643f4c34a4beeac5300163d19b10ca55f9ae0fee-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "080e1eeef73e62d32a7fcd01672b8cba768948136aedc07a447dd7e38b06da41", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/080e1eeef73e62d32a7fcd01672b8cba768948136aedc07a447dd7e38b06da41/_data", "Type": "volume"}], "Name": "/t5", "NetworkSettings": {"Bridge": "", "EndpointID": "7bb711dd6b0729b7709463bdf9a354df379fb5f370329324f2869c36fc29c782", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "7bb711dd6b0729b7709463bdf9a354df379fb5f370329324f2869c36fc29c782", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "33c04096536482a2aea5d4c25d5fa898be06fc4e4c2466d1f4644bfd68dd8109"}}, "Ports": {}, "SandboxID": "4146db288cf9483c6501b93cdb663e8e8ad9702433dd88c2626ad82c58105db1", "SandboxKey": "/var/run/docker/netns/4146db288cf9", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c251e32b8b8e59e8d360f9a7643f4c34a4beeac5300163d19b10ca55f9ae0fee/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8754, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:19:10.491395764Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'tenant_route_ip': u'192.168.5.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.1.41.0/24', u'remote_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:19:11.028831617Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/3766c0cd5c3db91d7546fa62df50b155b07fd755f261d1472188207003d1ff75-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/3766c0cd5c3db91d7546fa62df50b155b07fd755f261d1472188207003d1ff75/merged", "UpperDir": "/var/lib/docker/overlay2/3766c0cd5c3db91d7546fa62df50b155b07fd755f261d1472188207003d1ff75/diff", "WorkDir": "/var/lib/docker/overlay2/3766c0cd5c3db91d7546fa62df50b155b07fd755f261d1472188207003d1ff75/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/fb27d0d807bf6dc5a4964bd13df7da35bd970e9313c5aecf5004f8971c72b7bd/hostname", "HostsPath": "/var/lib/docker/containers/fb27d0d807bf6dc5a4964bd13df7da35bd970e9313c5aecf5004f8971c72b7bd/hosts", "Id": "fb27d0d807bf6dc5a4964bd13df7da35bd970e9313c5aecf5004f8971c72b7bd", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/fb27d0d807bf6dc5a4964bd13df7da35bd970e9313c5aecf5004f8971c72b7bd/fb27d0d807bf6dc5a4964bd13df7da35bd970e9313c5aecf5004f8971c72b7bd-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ae09283b24f198bf4d4fc18ad83c77f79a8dbfb6cb184f96c1ba6255d59cbede", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ae09283b24f198bf4d4fc18ad83c77f79a8dbfb6cb184f96c1ba6255d59cbede/_data", "Type": "volume"}], "Name": "/t5ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "02b02a7f27adc5a2c0300d58a68a4ce3e88cb2a01306f0d2543b093da276eaca", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "02b02a7f27adc5a2c0300d58a68a4ce3e88cb2a01306f0d2543b093da276eaca", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "33c04096536482a2aea5d4c25d5fa898be06fc4e4c2466d1f4644bfd68dd8109"}}, "Ports": {}, "SandboxID": "f5ccf8a18d6cefd6abdcfb1dd6196b3fca47f4314121bbfabc168d20241285af", "SandboxKey": "/var/run/docker/netns/f5ccf8a18d6c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/fb27d0d807bf6dc5a4964bd13df7da35bd970e9313c5aecf5004f8971c72b7bd/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8923, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:19:11.623445091Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:19:11.028831617Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/3766c0cd5c3db91d7546fa62df50b155b07fd755f261d1472188207003d1ff75-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/3766c0cd5c3db91d7546fa62df50b155b07fd755f261d1472188207003d1ff75/merged", "UpperDir": "/var/lib/docker/overlay2/3766c0cd5c3db91d7546fa62df50b155b07fd755f261d1472188207003d1ff75/diff", "WorkDir": "/var/lib/docker/overlay2/3766c0cd5c3db91d7546fa62df50b155b07fd755f261d1472188207003d1ff75/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/fb27d0d807bf6dc5a4964bd13df7da35bd970e9313c5aecf5004f8971c72b7bd/hostname", "HostsPath": "/var/lib/docker/containers/fb27d0d807bf6dc5a4964bd13df7da35bd970e9313c5aecf5004f8971c72b7bd/hosts", "Id": "fb27d0d807bf6dc5a4964bd13df7da35bd970e9313c5aecf5004f8971c72b7bd", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/fb27d0d807bf6dc5a4964bd13df7da35bd970e9313c5aecf5004f8971c72b7bd/fb27d0d807bf6dc5a4964bd13df7da35bd970e9313c5aecf5004f8971c72b7bd-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ae09283b24f198bf4d4fc18ad83c77f79a8dbfb6cb184f96c1ba6255d59cbede", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ae09283b24f198bf4d4fc18ad83c77f79a8dbfb6cb184f96c1ba6255d59cbede/_data", "Type": "volume"}], "Name": "/t5ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "02b02a7f27adc5a2c0300d58a68a4ce3e88cb2a01306f0d2543b093da276eaca", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "02b02a7f27adc5a2c0300d58a68a4ce3e88cb2a01306f0d2543b093da276eaca", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "33c04096536482a2aea5d4c25d5fa898be06fc4e4c2466d1f4644bfd68dd8109"}}, "Ports": {}, "SandboxID": "f5ccf8a18d6cefd6abdcfb1dd6196b3fca47f4314121bbfabc168d20241285af", "SandboxKey": "/var/run/docker/netns/f5ccf8a18d6c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/fb27d0d807bf6dc5a4964bd13df7da35bd970e9313c5aecf5004f8971c72b7bd/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8923, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:19:11.623445091Z", "Status": "running"}}, "item": {"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.133.1', u'name': u't5', u'pns_ip': u'192.168.133.1/24', u'tenant_if': u't5if', u'tenant_ip': u'192.168.133.2/24', u'pns_if': u't5pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:19:15.600945016Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/5108a6aad5d1551b8112576c46c0892e3b6895c7fc3e1e9252919534e425f0c8-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/5108a6aad5d1551b8112576c46c0892e3b6895c7fc3e1e9252919534e425f0c8/merged", "UpperDir": "/var/lib/docker/overlay2/5108a6aad5d1551b8112576c46c0892e3b6895c7fc3e1e9252919534e425f0c8/diff", "WorkDir": "/var/lib/docker/overlay2/5108a6aad5d1551b8112576c46c0892e3b6895c7fc3e1e9252919534e425f0c8/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/86deba492410b68b25e356780f575c000f09a51239e7960e971dd834293f82cb/hostname", "HostsPath": "/var/lib/docker/containers/86deba492410b68b25e356780f575c000f09a51239e7960e971dd834293f82cb/hosts", "Id": "86deba492410b68b25e356780f575c000f09a51239e7960e971dd834293f82cb", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/86deba492410b68b25e356780f575c000f09a51239e7960e971dd834293f82cb/86deba492410b68b25e356780f575c000f09a51239e7960e971dd834293f82cb-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "9f49f03fb62ae2cd15001ba32da5b50081ebfa7b1e63c587a7ae6996d5c1fcac", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/9f49f03fb62ae2cd15001ba32da5b50081ebfa7b1e63c587a7ae6996d5c1fcac/_data", "Type": "volume"}], "Name": "/t5", "NetworkSettings": {"Bridge": "", "EndpointID": "d27197b5a31c2c8ad445904cd4d0be6a2c0d52e261e830f3c71cdca32137e9ef", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d27197b5a31c2c8ad445904cd4d0be6a2c0d52e261e830f3c71cdca32137e9ef", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "21c5cefb5a2dc380e7146270e8dc314455077e4fe4fc3b49e22806d74f31ae00", "SandboxKey": "/var/run/docker/netns/21c5cefb5a2d", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/86deba492410b68b25e356780f575c000f09a51239e7960e971dd834293f82cb/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 19417, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:19:16.252055779Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:19:15.600945016Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/5108a6aad5d1551b8112576c46c0892e3b6895c7fc3e1e9252919534e425f0c8-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/5108a6aad5d1551b8112576c46c0892e3b6895c7fc3e1e9252919534e425f0c8/merged", "UpperDir": "/var/lib/docker/overlay2/5108a6aad5d1551b8112576c46c0892e3b6895c7fc3e1e9252919534e425f0c8/diff", "WorkDir": "/var/lib/docker/overlay2/5108a6aad5d1551b8112576c46c0892e3b6895c7fc3e1e9252919534e425f0c8/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/86deba492410b68b25e356780f575c000f09a51239e7960e971dd834293f82cb/hostname", "HostsPath": "/var/lib/docker/containers/86deba492410b68b25e356780f575c000f09a51239e7960e971dd834293f82cb/hosts", "Id": "86deba492410b68b25e356780f575c000f09a51239e7960e971dd834293f82cb", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/86deba492410b68b25e356780f575c000f09a51239e7960e971dd834293f82cb/86deba492410b68b25e356780f575c000f09a51239e7960e971dd834293f82cb-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "9f49f03fb62ae2cd15001ba32da5b50081ebfa7b1e63c587a7ae6996d5c1fcac", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/9f49f03fb62ae2cd15001ba32da5b50081ebfa7b1e63c587a7ae6996d5c1fcac/_data", "Type": "volume"}], "Name": "/t5", "NetworkSettings": {"Bridge": "", "EndpointID": "d27197b5a31c2c8ad445904cd4d0be6a2c0d52e261e830f3c71cdca32137e9ef", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d27197b5a31c2c8ad445904cd4d0be6a2c0d52e261e830f3c71cdca32137e9ef", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "21c5cefb5a2dc380e7146270e8dc314455077e4fe4fc3b49e22806d74f31ae00", "SandboxKey": "/var/run/docker/netns/21c5cefb5a2d", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/86deba492410b68b25e356780f575c000f09a51239e7960e971dd834293f82cb/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 19417, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:19:16.252055779Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.133.1", "name": "t5", "pns_if": "t5pns_if", "pns_ip": "192.168.133.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.133.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'tenant_route_ip': u'192.168.133.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.2.41.0/24', u'remote_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:19:16.950916618Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/3b00ce091c3405d672d3a6696e4b8ce1216c613e8d52f473dd17f6945ab9f8fd-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/3b00ce091c3405d672d3a6696e4b8ce1216c613e8d52f473dd17f6945ab9f8fd/merged", "UpperDir": "/var/lib/docker/overlay2/3b00ce091c3405d672d3a6696e4b8ce1216c613e8d52f473dd17f6945ab9f8fd/diff", "WorkDir": "/var/lib/docker/overlay2/3b00ce091c3405d672d3a6696e4b8ce1216c613e8d52f473dd17f6945ab9f8fd/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c575fcc78253368a1c80c5e257d4bd89ce8bae4d09f02addb44b4b4e3c6435b6/hostname", "HostsPath": "/var/lib/docker/containers/c575fcc78253368a1c80c5e257d4bd89ce8bae4d09f02addb44b4b4e3c6435b6/hosts", "Id": "c575fcc78253368a1c80c5e257d4bd89ce8bae4d09f02addb44b4b4e3c6435b6", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/c575fcc78253368a1c80c5e257d4bd89ce8bae4d09f02addb44b4b4e3c6435b6/c575fcc78253368a1c80c5e257d4bd89ce8bae4d09f02addb44b4b4e3c6435b6-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "9ca2809d4522d00fc480ce264c0177edc0a0a87ceaf8672ff16ac2ffaf0f930f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/9ca2809d4522d00fc480ce264c0177edc0a0a87ceaf8672ff16ac2ffaf0f930f/_data", "Type": "volume"}], "Name": "/t5ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "20ee732ccf550e2171394125f89c23684faefb14a3ee7ef7c6e2c13109954ce3", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "20ee732ccf550e2171394125f89c23684faefb14a3ee7ef7c6e2c13109954ce3", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "c71031547196d630148c22ebcb33fbf860cc87427143bb841f6607edc2f659e5", "SandboxKey": "/var/run/docker/netns/c71031547196", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c575fcc78253368a1c80c5e257d4bd89ce8bae4d09f02addb44b4b4e3c6435b6/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 20153, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:19:17.457283411Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:19:16.950916618Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/3b00ce091c3405d672d3a6696e4b8ce1216c613e8d52f473dd17f6945ab9f8fd-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/3b00ce091c3405d672d3a6696e4b8ce1216c613e8d52f473dd17f6945ab9f8fd/merged", "UpperDir": "/var/lib/docker/overlay2/3b00ce091c3405d672d3a6696e4b8ce1216c613e8d52f473dd17f6945ab9f8fd/diff", "WorkDir": "/var/lib/docker/overlay2/3b00ce091c3405d672d3a6696e4b8ce1216c613e8d52f473dd17f6945ab9f8fd/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c575fcc78253368a1c80c5e257d4bd89ce8bae4d09f02addb44b4b4e3c6435b6/hostname", "HostsPath": "/var/lib/docker/containers/c575fcc78253368a1c80c5e257d4bd89ce8bae4d09f02addb44b4b4e3c6435b6/hosts", "Id": "c575fcc78253368a1c80c5e257d4bd89ce8bae4d09f02addb44b4b4e3c6435b6", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/c575fcc78253368a1c80c5e257d4bd89ce8bae4d09f02addb44b4b4e3c6435b6/c575fcc78253368a1c80c5e257d4bd89ce8bae4d09f02addb44b4b4e3c6435b6-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "9ca2809d4522d00fc480ce264c0177edc0a0a87ceaf8672ff16ac2ffaf0f930f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/9ca2809d4522d00fc480ce264c0177edc0a0a87ceaf8672ff16ac2ffaf0f930f/_data", "Type": "volume"}], "Name": "/t5ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "20ee732ccf550e2171394125f89c23684faefb14a3ee7ef7c6e2c13109954ce3", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "20ee732ccf550e2171394125f89c23684faefb14a3ee7ef7c6e2c13109954ce3", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "c71031547196d630148c22ebcb33fbf860cc87427143bb841f6607edc2f659e5", "SandboxKey": "/var/run/docker/netns/c71031547196", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c575fcc78253368a1c80c5e257d4bd89ce8bae4d09f02addb44b4b4e3c6435b6/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 20153, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:19:17.457283411Z", "Status": "running"}}, "item": {"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5', u'tenant_sub_if': u't5s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:19:18.198718881Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/0f4a127ca45accf802378449787a37589253cf576e7742e90d11b50ce74e9d17-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/0f4a127ca45accf802378449787a37589253cf576e7742e90d11b50ce74e9d17/merged", "UpperDir": "/var/lib/docker/overlay2/0f4a127ca45accf802378449787a37589253cf576e7742e90d11b50ce74e9d17/diff", "WorkDir": "/var/lib/docker/overlay2/0f4a127ca45accf802378449787a37589253cf576e7742e90d11b50ce74e9d17/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/79880c99eb34881340c737fe925e11bfb7427e21f6f7c47a159a726b0012b43c/hostname", "HostsPath": "/var/lib/docker/containers/79880c99eb34881340c737fe925e11bfb7427e21f6f7c47a159a726b0012b43c/hosts", "Id": "79880c99eb34881340c737fe925e11bfb7427e21f6f7c47a159a726b0012b43c", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/79880c99eb34881340c737fe925e11bfb7427e21f6f7c47a159a726b0012b43c/79880c99eb34881340c737fe925e11bfb7427e21f6f7c47a159a726b0012b43c-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "e1682dfe51ae8f2aa96fa7b50adc41a0cd9db8e780b80d6814cb0aab2b2e3f2a", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/e1682dfe51ae8f2aa96fa7b50adc41a0cd9db8e780b80d6814cb0aab2b2e3f2a/_data", "Type": "volume"}], "Name": "/t5ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "493307b382460dbb8f3e55752548d00eb0258df2d329b14a4297d5768d648967", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "493307b382460dbb8f3e55752548d00eb0258df2d329b14a4297d5768d648967", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "ee517cae519919ba8d00f7f040cb5c9b274e9b274acbffd1aa87f34465f557fa", "SandboxKey": "/var/run/docker/netns/ee517cae5199", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/79880c99eb34881340c737fe925e11bfb7427e21f6f7c47a159a726b0012b43c/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 21245, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:19:18.830453092Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:19:18.198718881Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/0f4a127ca45accf802378449787a37589253cf576e7742e90d11b50ce74e9d17-init/diff:/var/lib/docker/overlay2/06a2621b8381c055036ede6e010ce848ebb60787b3eb2d7924a55dc71c7f16ae/diff:/var/lib/docker/overlay2/fd5e98996be9e54b1cb4df27949a668daecf94c392c274b6cf76d86674ac8845/diff:/var/lib/docker/overlay2/050cd45e5ad5a25e34033326226805c16852b88d46cc2fff78eb6da9f6ccbf79/diff:/var/lib/docker/overlay2/55a4a31a96cee4356b4eca5c5b684dd685ea4906fcd3a6d546da9815b690618e/diff", "MergedDir": "/var/lib/docker/overlay2/0f4a127ca45accf802378449787a37589253cf576e7742e90d11b50ce74e9d17/merged", "UpperDir": "/var/lib/docker/overlay2/0f4a127ca45accf802378449787a37589253cf576e7742e90d11b50ce74e9d17/diff", "WorkDir": "/var/lib/docker/overlay2/0f4a127ca45accf802378449787a37589253cf576e7742e90d11b50ce74e9d17/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/79880c99eb34881340c737fe925e11bfb7427e21f6f7c47a159a726b0012b43c/hostname", "HostsPath": "/var/lib/docker/containers/79880c99eb34881340c737fe925e11bfb7427e21f6f7c47a159a726b0012b43c/hosts", "Id": "79880c99eb34881340c737fe925e11bfb7427e21f6f7c47a159a726b0012b43c", "Image": "sha256:fcd942dea8b42b59b95ab83f3444d2f6432d674c0a8b7a33f135b1eb10de86e7", "LogPath": "/var/lib/docker/containers/79880c99eb34881340c737fe925e11bfb7427e21f6f7c47a159a726b0012b43c/79880c99eb34881340c737fe925e11bfb7427e21f6f7c47a159a726b0012b43c-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "e1682dfe51ae8f2aa96fa7b50adc41a0cd9db8e780b80d6814cb0aab2b2e3f2a", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/e1682dfe51ae8f2aa96fa7b50adc41a0cd9db8e780b80d6814cb0aab2b2e3f2a/_data", "Type": "volume"}], "Name": "/t5ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "493307b382460dbb8f3e55752548d00eb0258df2d329b14a4297d5768d648967", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "493307b382460dbb8f3e55752548d00eb0258df2d329b14a4297d5768d648967", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "ee517cae519919ba8d00f7f040cb5c9b274e9b274acbffd1aa87f34465f557fa", "SandboxKey": "/var/run/docker/netns/ee517cae5199", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/79880c99eb34881340c737fe925e11bfb7427e21f6f7c47a159a726b0012b43c/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 21245, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:19:18.830453092Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'8754', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5if\" ; if [ $? -ne 0 ] ; then ip link add \"t5if\" type veth peer name \"t5pns_if\" ; fi\n", "delta": "0:00:00.233846", "end": "2019-12-06 20:19:23.599900", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "8754", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 20:19:23.366054", "stderr": "Device \"t5if\" does not exist.", "stderr_lines": ["Device \"t5if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'8754', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t5pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t5pns_if\" netns pns1 ; fi\ndocker exec \"t5\" ip link show \"t5if\" ; if [ $? -ne 0 ] ; then ip link set \"t5if\" netns \"8754\" ; fi\nip netns exec pns1 ip link set dev \"t5pns_if\" up\ndocker exec \"t5\" ip link set dev \"t5if\" up\n", "delta": "0:00:00.449167", "end": "2019-12-06 20:19:24.274248", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "8754", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 20:19:23.825081", "stderr": "Device \"t5pns_if\" does not exist.\nDevice \"t5if\" does not exist.", "stderr_lines": ["Device \"t5pns_if\" does not exist.", "Device \"t5if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'8754', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t5pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.5.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.5.1/24\" dev \"t5pns_if\" ; fi\ndocker exec \"t5\" ip addr show \"t5if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.5.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip addr add \"192.168.5.2/24\" dev \"t5if\" ; fi\n", "delta": "0:00:00.445057", "end": "2019-12-06 20:19:24.935301", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "8754", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 20:19:24.490244", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t5ns1if\" type veth peer name \"t5s1if\" ; fi\n", "delta": "0:00:00.184594", "end": "2019-12-06 20:19:25.371871", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "rc": 0, "start": "2019-12-06 20:19:25.187277", "stderr": "Device \"t5ns1if\" does not exist.", "stderr_lines": ["Device \"t5ns1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t5ns1if\" netns \"8754\" ; fi\ndocker exec \"t5ns1\" ip link show \"t5s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t5s1if\" netns \"8923\" ; fi\n", "delta": "0:00:00.422659", "end": "2019-12-06 20:19:26.036127", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "rc": 0, "start": "2019-12-06 20:19:25.613468", "stderr": "Device \"t5ns1if\" does not exist.\nDevice \"t5s1if\" does not exist.", "stderr_lines": ["Device \"t5ns1if\" does not exist.", "Device \"t5s1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link set dev \"t5ns1if\" up\ndocker exec \"t5ns1\" ip link set dev \"t5s1if\" up\n", "delta": "0:00:00.340028", "end": "2019-12-06 20:19:26.602297", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "rc": 0, "start": "2019-12-06 20:19:26.262269", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip addr show \"t5s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.41.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip addr add \"10.1.41.2/24\" dev \"t5s1if\" ; fi\n\ndocker exec \"t5\" ip addr show \"t5ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.41.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip addr add \"10.1.41.1/24\" dev \"t5ns1if\" ; fi\n", "delta": "0:00:00.748416", "end": "2019-12-06 20:19:27.604192", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "rc": 0, "start": "2019-12-06 20:19:26.855776", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route] *********************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'8754', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t5\" ip route del default ; fi\n", "delta": "0:00:00.365417", "end": "2019-12-06 20:19:28.217711", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "8754", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 20:19:27.852294", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'8754', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip route show default | grep -w '[d]efault via 192.168.5.1' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip route add default via \"192.168.5.1\" ; fi\n", "delta": "0:00:00.409956", "end": "2019-12-06 20:19:28.861239", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "8754", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 20:19:28.451283", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'tenant_route_ip': u'192.168.5.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.1.41.0/24', u'remote_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t5ns1\" ip route del default ; fi\n", "delta": "0:00:00.346955", "end": "2019-12-06 20:19:29.471095", "item": {"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 20:19:29.124140", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'tenant_route_ip': u'192.168.5.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.1.41.0/24', u'remote_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip route show default | grep -w '[d]efault via 10.1.41.1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip route add default via \"10.1.41.1\" ; fi\n", "delta": "0:00:00.359584", "end": "2019-12-06 20:19:30.079647", "item": {"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 20:19:29.720063", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside container] ***********************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'tenant_route_ip': u'192.168.5.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.1.41.0/24', u'remote_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show | grep -w '^t5br1'; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addbr \"t5br1\" ; fi\ndocker exec \"t5ns1\" ip link set dev \"t5br1\" up\n", "delta": "0:00:00.551809", "end": "2019-12-06 20:19:30.841680", "item": {"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 20:19:30.289871", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"t5s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip link add \"t5s1_dnsbrif\" type veth peer name \"t5s1_dnsif\" ; fi\ndocker exec \"t5ns1\" ip link set dev \"t5s1_dnsbrif\" up\ndocker exec \"t5ns1\" ip link set dev \"t5s1_dnsif\" up\n", "delta": "0:00:00.770441", "end": "2019-12-06 20:19:31.843304", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 20:19:31.072863", "stderr": "Device \"t5s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t5s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 't5s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"t5s1_dnsbrif\" ; fi\n", "delta": "0:00:00.360842", "end": "2019-12-06 20:19:32.433675", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 20:19:32.072833", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"t5br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t5C1if1\" type veth peer name \"t5br1if1\" ; fi\nip link set dev \"t5br1if1\" up\nip link set dev \"t5C1if1\" up\n", "delta": "0:00:00.196505", "end": "2019-12-06 20:19:32.867890", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}], "rc": 0, "start": "2019-12-06 20:19:32.671385", "stderr": "Device \"t5br1if1\" does not exist.", "stderr_lines": ["Device \"t5br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"t5br1if2\" ; if [ $? -ne 0 ] ; then ip link add \"t5C2if1\" type veth peer name \"t5br1if2\" ; fi\nip link set dev \"t5br1if2\" up\nip link set dev \"t5C2if1\" up\n", "delta": "0:00:00.191946", "end": "2019-12-06 20:19:33.247635", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "rc": 0, "start": "2019-12-06 20:19:33.055689", "stderr": "Device \"t5br1if2\" does not exist.", "stderr_lines": ["Device \"t5br1if2\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t5br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t5br1if1\" netns \"8923\" ; fi\ndocker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 't5br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"t5br1if1\" ; fi\n", "delta": "0:00:00.425482", "end": "2019-12-06 20:19:33.922800", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}], "rc": 0, "start": "2019-12-06 20:19:33.497318", "stderr": "", "stderr_lines": [], "stdout": "64: t5br1if1@t5C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 36:e6:44:42:cd:6a brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["64: t5br1if1@t5C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 36:e6:44:42:cd:6a brd ff:ff:ff:ff:ff:ff"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t5br1if2\" ; if [ $? -eq 0 ] ; then ip link set \"t5br1if2\" netns \"8923\" ; fi\ndocker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 't5br1if2' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"t5br1if2\" ; fi\n", "delta": "0:00:00.393495", "end": "2019-12-06 20:19:34.529183", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "rc": 0, "start": "2019-12-06 20:19:34.135688", "stderr": "", "stderr_lines": [], "stdout": "66: t5br1if2@t5C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 32:fc:e3:cb:c0:5f brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["66: t5br1if2@t5C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 32:fc:e3:cb:c0:5f brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link set \"t5br1if1\" up\ndocker exec \"t5ns1\" ip link set dev \"t5br1\" up\n", "delta": "0:00:00.390749", "end": "2019-12-06 20:19:35.160586", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}], "rc": 0, "start": "2019-12-06 20:19:34.769837", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link set \"t5br1if2\" up\ndocker exec \"t5ns1\" ip link set dev \"t5br1\" up\n", "delta": "0:00:00.382810", "end": "2019-12-06 20:19:35.733134", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "rc": 0, "start": "2019-12-06 20:19:35.350324", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip addr show \"t5s1_dnsif\" | awk 'FNR==3{ print $2 }' | grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip addr add \"1.1.1.1/24\" dev \"t5s1_dnsif\" ; fi\n", "delta": "0:00:00.375202", "end": "2019-12-06 20:19:36.335667", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 20:19:35.960465", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ps aux | grep -w '[d]nsmasq --interface t5s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" dnsmasq --interface \"t5s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.841977", "end": "2019-12-06 20:19:37.411386", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 20:19:36.569409", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]}, {u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"vxlan_t5s1\" ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip link add \"vxlan_t5s1\" type vxlan id \"42\" local \"10.1.41.2\" remote \"10.2.41.2\" dstport \"4789\" dev \"t5s1if\"; docker exec \"t5ns1\" ip link set dev \"vxlan_t5s1\" up ; fi\n", "delta": "0:00:00.530817", "end": "2019-12-06 20:19:38.173862", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 20:19:37.643045", "stderr": "Device \"vxlan_t5s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t5s1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'8923', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'8754', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]}, {u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 'vxlan_t5s1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"vxlan_t5s1\" ; fi\n", "delta": "0:00:00.370657", "end": "2019-12-06 20:19:38.767592", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "8923", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "8754", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 20:19:38.396935", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 20:44:42.142722 Printing the yaml input file
INFO:root: 20:44:42.142951 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 20:44:42.143119 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 20:44:42.143217 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 20:44:42.143287 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:44:44.349114596Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/57afb3c4e536ad3a0e02364f2cea93c058539c81abb4fc2a3074d69b8e9f5789-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/57afb3c4e536ad3a0e02364f2cea93c058539c81abb4fc2a3074d69b8e9f5789/merged", "UpperDir": "/var/lib/docker/overlay2/57afb3c4e536ad3a0e02364f2cea93c058539c81abb4fc2a3074d69b8e9f5789/diff", "WorkDir": "/var/lib/docker/overlay2/57afb3c4e536ad3a0e02364f2cea93c058539c81abb4fc2a3074d69b8e9f5789/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/0de8822f0dbbcf83d2fa164290aaeed57c3ae2e68c34d4c997a5147988909efc/hostname", "HostsPath": "/var/lib/docker/containers/0de8822f0dbbcf83d2fa164290aaeed57c3ae2e68c34d4c997a5147988909efc/hosts", "Id": "0de8822f0dbbcf83d2fa164290aaeed57c3ae2e68c34d4c997a5147988909efc", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/0de8822f0dbbcf83d2fa164290aaeed57c3ae2e68c34d4c997a5147988909efc/0de8822f0dbbcf83d2fa164290aaeed57c3ae2e68c34d4c997a5147988909efc-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "44b20f4d205d17a0bfbe2b7fcb14946bd3d3e856b7ee9d22b7621c37f7b58cb3", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/44b20f4d205d17a0bfbe2b7fcb14946bd3d3e856b7ee9d22b7621c37f7b58cb3/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "6fa51b26e88824b183553d1ac29610b726ca52b31c9ad655b0174dbb8b5524b1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "6fa51b26e88824b183553d1ac29610b726ca52b31c9ad655b0174dbb8b5524b1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "33c04096536482a2aea5d4c25d5fa898be06fc4e4c2466d1f4644bfd68dd8109"}}, "Ports": {}, "SandboxID": "61b171388a8c463caeb529b0e501fb1a0e3930159415ec75f4040ce2f3e4153d", "SandboxKey": "/var/run/docker/netns/61b171388a8c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/0de8822f0dbbcf83d2fa164290aaeed57c3ae2e68c34d4c997a5147988909efc/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25852, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:44:44.991535149Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:44:44.349114596Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/57afb3c4e536ad3a0e02364f2cea93c058539c81abb4fc2a3074d69b8e9f5789-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/57afb3c4e536ad3a0e02364f2cea93c058539c81abb4fc2a3074d69b8e9f5789/merged", "UpperDir": "/var/lib/docker/overlay2/57afb3c4e536ad3a0e02364f2cea93c058539c81abb4fc2a3074d69b8e9f5789/diff", "WorkDir": "/var/lib/docker/overlay2/57afb3c4e536ad3a0e02364f2cea93c058539c81abb4fc2a3074d69b8e9f5789/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/0de8822f0dbbcf83d2fa164290aaeed57c3ae2e68c34d4c997a5147988909efc/hostname", "HostsPath": "/var/lib/docker/containers/0de8822f0dbbcf83d2fa164290aaeed57c3ae2e68c34d4c997a5147988909efc/hosts", "Id": "0de8822f0dbbcf83d2fa164290aaeed57c3ae2e68c34d4c997a5147988909efc", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/0de8822f0dbbcf83d2fa164290aaeed57c3ae2e68c34d4c997a5147988909efc/0de8822f0dbbcf83d2fa164290aaeed57c3ae2e68c34d4c997a5147988909efc-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "44b20f4d205d17a0bfbe2b7fcb14946bd3d3e856b7ee9d22b7621c37f7b58cb3", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/44b20f4d205d17a0bfbe2b7fcb14946bd3d3e856b7ee9d22b7621c37f7b58cb3/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "6fa51b26e88824b183553d1ac29610b726ca52b31c9ad655b0174dbb8b5524b1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "6fa51b26e88824b183553d1ac29610b726ca52b31c9ad655b0174dbb8b5524b1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "33c04096536482a2aea5d4c25d5fa898be06fc4e4c2466d1f4644bfd68dd8109"}}, "Ports": {}, "SandboxID": "61b171388a8c463caeb529b0e501fb1a0e3930159415ec75f4040ce2f3e4153d", "SandboxKey": "/var/run/docker/netns/61b171388a8c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/0de8822f0dbbcf83d2fa164290aaeed57c3ae2e68c34d4c997a5147988909efc/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 25852, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:44:44.991535149Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:44:45.717953969Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/0c884c786e3d52f351a64688c9c7bd3c93f5ab7dbee51b361c210463f190444d-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/0c884c786e3d52f351a64688c9c7bd3c93f5ab7dbee51b361c210463f190444d/merged", "UpperDir": "/var/lib/docker/overlay2/0c884c786e3d52f351a64688c9c7bd3c93f5ab7dbee51b361c210463f190444d/diff", "WorkDir": "/var/lib/docker/overlay2/0c884c786e3d52f351a64688c9c7bd3c93f5ab7dbee51b361c210463f190444d/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/aa5e7224a043bde8be3d0d1ff2572ab24602eba31fffcafccc327b4575375634/hostname", "HostsPath": "/var/lib/docker/containers/aa5e7224a043bde8be3d0d1ff2572ab24602eba31fffcafccc327b4575375634/hosts", "Id": "aa5e7224a043bde8be3d0d1ff2572ab24602eba31fffcafccc327b4575375634", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/aa5e7224a043bde8be3d0d1ff2572ab24602eba31fffcafccc327b4575375634/aa5e7224a043bde8be3d0d1ff2572ab24602eba31fffcafccc327b4575375634-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "364cd323eebdad2ef4f251a8d6d1f00c74c051b479e6a6749f8e48d3997a0d65", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/364cd323eebdad2ef4f251a8d6d1f00c74c051b479e6a6749f8e48d3997a0d65/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "674f7f0e5c7008c31667c61c009685def27b31434f69280799a879e970e97083", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "674f7f0e5c7008c31667c61c009685def27b31434f69280799a879e970e97083", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "33c04096536482a2aea5d4c25d5fa898be06fc4e4c2466d1f4644bfd68dd8109"}}, "Ports": {}, "SandboxID": "537b68ca4bb012e4f40c6166c6df821b57054c3542e05e82f70060cea06c93db", "SandboxKey": "/var/run/docker/netns/537b68ca4bb0", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/aa5e7224a043bde8be3d0d1ff2572ab24602eba31fffcafccc327b4575375634/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 26450, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:44:46.781825945Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:44:45.717953969Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/0c884c786e3d52f351a64688c9c7bd3c93f5ab7dbee51b361c210463f190444d-init/diff:/var/lib/docker/overlay2/2bcd32f48a072011fc2d4ccc3ed0159b8bc0488eb7b9bb0f6e5ad32de4561ddf/diff:/var/lib/docker/overlay2/87ba6e7ab6257e2e6b870fedbd389b251751e69f1688651ecbf06a7e623a5565/diff:/var/lib/docker/overlay2/21a7e72906f495d29543120c31c0dbd4ff202730c998cd0f7861aae8394dad11/diff:/var/lib/docker/overlay2/e9ba2c30353174d3ee7e370f3660c8db7b780a4e42e66c41e9a1b8abfc7411f3/diff", "MergedDir": "/var/lib/docker/overlay2/0c884c786e3d52f351a64688c9c7bd3c93f5ab7dbee51b361c210463f190444d/merged", "UpperDir": "/var/lib/docker/overlay2/0c884c786e3d52f351a64688c9c7bd3c93f5ab7dbee51b361c210463f190444d/diff", "WorkDir": "/var/lib/docker/overlay2/0c884c786e3d52f351a64688c9c7bd3c93f5ab7dbee51b361c210463f190444d/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/aa5e7224a043bde8be3d0d1ff2572ab24602eba31fffcafccc327b4575375634/hostname", "HostsPath": "/var/lib/docker/containers/aa5e7224a043bde8be3d0d1ff2572ab24602eba31fffcafccc327b4575375634/hosts", "Id": "aa5e7224a043bde8be3d0d1ff2572ab24602eba31fffcafccc327b4575375634", "Image": "sha256:3090b53999cd61e6cf9e422145fecb677cb96d8f30e7d9b7039bba5a3586bcac", "LogPath": "/var/lib/docker/containers/aa5e7224a043bde8be3d0d1ff2572ab24602eba31fffcafccc327b4575375634/aa5e7224a043bde8be3d0d1ff2572ab24602eba31fffcafccc327b4575375634-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "364cd323eebdad2ef4f251a8d6d1f00c74c051b479e6a6749f8e48d3997a0d65", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/364cd323eebdad2ef4f251a8d6d1f00c74c051b479e6a6749f8e48d3997a0d65/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "674f7f0e5c7008c31667c61c009685def27b31434f69280799a879e970e97083", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "674f7f0e5c7008c31667c61c009685def27b31434f69280799a879e970e97083", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "33c04096536482a2aea5d4c25d5fa898be06fc4e4c2466d1f4644bfd68dd8109"}}, "Ports": {}, "SandboxID": "537b68ca4bb012e4f40c6166c6df821b57054c3542e05e82f70060cea06c93db", "SandboxKey": "/var/run/docker/netns/537b68ca4bb0", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/aa5e7224a043bde8be3d0d1ff2572ab24602eba31fffcafccc327b4575375634/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 26450, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:44:46.781825945Z", "Status": "running"}}, "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
changed: [99.99.99.2] => {"actions": ["Built image centos7:latest from /root"], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": true, "image": {"Architecture": "amd64", "Author": "Prashanth_M", "Comment": "", "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "", "Image": "sha256:f56c97ed955fbb3e6c62cde51c8ebdb3df96da11873ddbe76800f9df084daeba", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Container": "4969dd2ccdf13e8f8ed2090bf56a8285fcd44a76bd233c275004e76360b4fbc7", "ContainerConfig": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/bin/sh", "-c", "#(nop) ", "CMD [\"/usr/sbin/init\"]"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "4969dd2ccdf1", "Image": "sha256:f56c97ed955fbb3e6c62cde51c8ebdb3df96da11873ddbe76800f9df084daeba", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:52:16.893170277Z", "DockerVersion": "19.03.5", "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/b79f8193dea4276d8794bc62c79efb51d10b778d1fe9ba26352bfa73bd925225/diff:/var/lib/docker/overlay2/ccfc2379fc1c10ee4e3ef9f014d2e640574f8321fc3ca810eb74352da7e82694/diff:/var/lib/docker/overlay2/046982c34cafa6011488e28be6fd454a1b07db35452090aa7307df7bd94ade5b/diff", "MergedDir": "/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/merged", "UpperDir": "/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/diff", "WorkDir": "/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/work"}, "Name": "overlay2"}, "Id": "sha256:f23a021c327e53ac497355dbc0b447fe010b30821bb5baa03cc2686f3b0f50a5", "Metadata": {"LastTagTime": "2019-12-06T20:52:18.241794059Z"}, "Os": "linux", "Parent": "sha256:f56c97ed955fbb3e6c62cde51c8ebdb3df96da11873ddbe76800f9df084daeba", "RepoDigests": [], "RepoTags": ["centos7:latest"], "RootFS": {"Layers": ["sha256:77b174a6a187b610e4699546bd973a8d1e77663796e3724318a2a4b24cb07ea0", "sha256:4806b29bc85140230b59fe711eca1a49b76f37920f66acb8d901a9dff95887c0", "sha256:45fa859e93310d5d13761d419d606ed6171b510383cc381103d0322b2a8631c5", "sha256:416796ad3fc6151cf7cb61254e4303ba52a446b593f5d32de3b45e29bf04665d"], "Type": "layers"}, "Size": 363174329, "VirtualSize": 363174329}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.134.1', u'name': u't6', u'pns_ip': u'192.168.134.1/24', u'tenant_if': u't6if', u'tenant_ip': u'192.168.134.2/24', u'pns_if': u't6pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:52:19.545896332Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/2b26058ac9cf6b10db6b3a29955a9b0d58534f22df0bbea912ab7e4d130b7ba8-init/diff:/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/diff:/var/lib/docker/overlay2/b79f8193dea4276d8794bc62c79efb51d10b778d1fe9ba26352bfa73bd925225/diff:/var/lib/docker/overlay2/ccfc2379fc1c10ee4e3ef9f014d2e640574f8321fc3ca810eb74352da7e82694/diff:/var/lib/docker/overlay2/046982c34cafa6011488e28be6fd454a1b07db35452090aa7307df7bd94ade5b/diff", "MergedDir": "/var/lib/docker/overlay2/2b26058ac9cf6b10db6b3a29955a9b0d58534f22df0bbea912ab7e4d130b7ba8/merged", "UpperDir": "/var/lib/docker/overlay2/2b26058ac9cf6b10db6b3a29955a9b0d58534f22df0bbea912ab7e4d130b7ba8/diff", "WorkDir": "/var/lib/docker/overlay2/2b26058ac9cf6b10db6b3a29955a9b0d58534f22df0bbea912ab7e4d130b7ba8/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/821a8d20a4ff2faf0aaddf9e8c5746c535140666d6a14e6dd0197fc998371d08/hostname", "HostsPath": "/var/lib/docker/containers/821a8d20a4ff2faf0aaddf9e8c5746c535140666d6a14e6dd0197fc998371d08/hosts", "Id": "821a8d20a4ff2faf0aaddf9e8c5746c535140666d6a14e6dd0197fc998371d08", "Image": "sha256:f23a021c327e53ac497355dbc0b447fe010b30821bb5baa03cc2686f3b0f50a5", "LogPath": "/var/lib/docker/containers/821a8d20a4ff2faf0aaddf9e8c5746c535140666d6a14e6dd0197fc998371d08/821a8d20a4ff2faf0aaddf9e8c5746c535140666d6a14e6dd0197fc998371d08-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "4d3749cbf924b0628a3ffdfa8a5fba3a57c5ca3c0ee761998dd1d17ab4df1593", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/4d3749cbf924b0628a3ffdfa8a5fba3a57c5ca3c0ee761998dd1d17ab4df1593/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "0e35320202c5e375667d9c0fda4514e597196b25c7587475a89ebc4f4be5b824", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "0e35320202c5e375667d9c0fda4514e597196b25c7587475a89ebc4f4be5b824", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "acb7164780d82c21c9781307b2e07bcfd8dc84ef63a5cde38ae14cdd51f6b650", "SandboxKey": "/var/run/docker/netns/acb7164780d8", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/821a8d20a4ff2faf0aaddf9e8c5746c535140666d6a14e6dd0197fc998371d08/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 20072, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:52:20.001627119Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:52:19.545896332Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/2b26058ac9cf6b10db6b3a29955a9b0d58534f22df0bbea912ab7e4d130b7ba8-init/diff:/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/diff:/var/lib/docker/overlay2/b79f8193dea4276d8794bc62c79efb51d10b778d1fe9ba26352bfa73bd925225/diff:/var/lib/docker/overlay2/ccfc2379fc1c10ee4e3ef9f014d2e640574f8321fc3ca810eb74352da7e82694/diff:/var/lib/docker/overlay2/046982c34cafa6011488e28be6fd454a1b07db35452090aa7307df7bd94ade5b/diff", "MergedDir": "/var/lib/docker/overlay2/2b26058ac9cf6b10db6b3a29955a9b0d58534f22df0bbea912ab7e4d130b7ba8/merged", "UpperDir": "/var/lib/docker/overlay2/2b26058ac9cf6b10db6b3a29955a9b0d58534f22df0bbea912ab7e4d130b7ba8/diff", "WorkDir": "/var/lib/docker/overlay2/2b26058ac9cf6b10db6b3a29955a9b0d58534f22df0bbea912ab7e4d130b7ba8/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/821a8d20a4ff2faf0aaddf9e8c5746c535140666d6a14e6dd0197fc998371d08/hostname", "HostsPath": "/var/lib/docker/containers/821a8d20a4ff2faf0aaddf9e8c5746c535140666d6a14e6dd0197fc998371d08/hosts", "Id": "821a8d20a4ff2faf0aaddf9e8c5746c535140666d6a14e6dd0197fc998371d08", "Image": "sha256:f23a021c327e53ac497355dbc0b447fe010b30821bb5baa03cc2686f3b0f50a5", "LogPath": "/var/lib/docker/containers/821a8d20a4ff2faf0aaddf9e8c5746c535140666d6a14e6dd0197fc998371d08/821a8d20a4ff2faf0aaddf9e8c5746c535140666d6a14e6dd0197fc998371d08-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "4d3749cbf924b0628a3ffdfa8a5fba3a57c5ca3c0ee761998dd1d17ab4df1593", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/4d3749cbf924b0628a3ffdfa8a5fba3a57c5ca3c0ee761998dd1d17ab4df1593/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "0e35320202c5e375667d9c0fda4514e597196b25c7587475a89ebc4f4be5b824", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "0e35320202c5e375667d9c0fda4514e597196b25c7587475a89ebc4f4be5b824", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "acb7164780d82c21c9781307b2e07bcfd8dc84ef63a5cde38ae14cdd51f6b650", "SandboxKey": "/var/run/docker/netns/acb7164780d8", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/821a8d20a4ff2faf0aaddf9e8c5746c535140666d6a14e6dd0197fc998371d08/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 20072, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:52:20.001627119Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.134.1", "name": "t6", "pns_if": "t6pns_if", "pns_ip": "192.168.134.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.134.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}], u'vxlan': [{u'local_ip': u'10.2.51.2', u'tenant_route_ip': u'192.168.134.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.2.51.0/24', u'remote_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:52:20.748691406Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/b89a0c9eeb11f08f71b3c0ff36dcd0c83a2572abde90aea887ca55cf4abca676-init/diff:/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/diff:/var/lib/docker/overlay2/b79f8193dea4276d8794bc62c79efb51d10b778d1fe9ba26352bfa73bd925225/diff:/var/lib/docker/overlay2/ccfc2379fc1c10ee4e3ef9f014d2e640574f8321fc3ca810eb74352da7e82694/diff:/var/lib/docker/overlay2/046982c34cafa6011488e28be6fd454a1b07db35452090aa7307df7bd94ade5b/diff", "MergedDir": "/var/lib/docker/overlay2/b89a0c9eeb11f08f71b3c0ff36dcd0c83a2572abde90aea887ca55cf4abca676/merged", "UpperDir": "/var/lib/docker/overlay2/b89a0c9eeb11f08f71b3c0ff36dcd0c83a2572abde90aea887ca55cf4abca676/diff", "WorkDir": "/var/lib/docker/overlay2/b89a0c9eeb11f08f71b3c0ff36dcd0c83a2572abde90aea887ca55cf4abca676/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/d8c4059adbfcea01096f1922a6a88b956d40adc17ac507181e2bab567d15b18a/hostname", "HostsPath": "/var/lib/docker/containers/d8c4059adbfcea01096f1922a6a88b956d40adc17ac507181e2bab567d15b18a/hosts", "Id": "d8c4059adbfcea01096f1922a6a88b956d40adc17ac507181e2bab567d15b18a", "Image": "sha256:f23a021c327e53ac497355dbc0b447fe010b30821bb5baa03cc2686f3b0f50a5", "LogPath": "/var/lib/docker/containers/d8c4059adbfcea01096f1922a6a88b956d40adc17ac507181e2bab567d15b18a/d8c4059adbfcea01096f1922a6a88b956d40adc17ac507181e2bab567d15b18a-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "cfab041c58604472f25aac08c6af0388e00093a6354189fb50843584635e5987", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/cfab041c58604472f25aac08c6af0388e00093a6354189fb50843584635e5987/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "0e05f8e935a44f0109bd62a339971cb4de894640086c74f9f8df49c6f8c7bf99", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "0e05f8e935a44f0109bd62a339971cb4de894640086c74f9f8df49c6f8c7bf99", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "e4f9641289cd1f14f940983f3bf6885549a40d1e286aa5fca71e52af6cf36c31", "SandboxKey": "/var/run/docker/netns/e4f9641289cd", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/d8c4059adbfcea01096f1922a6a88b956d40adc17ac507181e2bab567d15b18a/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 20765, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:52:21.27248325Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:52:20.748691406Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/b89a0c9eeb11f08f71b3c0ff36dcd0c83a2572abde90aea887ca55cf4abca676-init/diff:/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/diff:/var/lib/docker/overlay2/b79f8193dea4276d8794bc62c79efb51d10b778d1fe9ba26352bfa73bd925225/diff:/var/lib/docker/overlay2/ccfc2379fc1c10ee4e3ef9f014d2e640574f8321fc3ca810eb74352da7e82694/diff:/var/lib/docker/overlay2/046982c34cafa6011488e28be6fd454a1b07db35452090aa7307df7bd94ade5b/diff", "MergedDir": "/var/lib/docker/overlay2/b89a0c9eeb11f08f71b3c0ff36dcd0c83a2572abde90aea887ca55cf4abca676/merged", "UpperDir": "/var/lib/docker/overlay2/b89a0c9eeb11f08f71b3c0ff36dcd0c83a2572abde90aea887ca55cf4abca676/diff", "WorkDir": "/var/lib/docker/overlay2/b89a0c9eeb11f08f71b3c0ff36dcd0c83a2572abde90aea887ca55cf4abca676/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/d8c4059adbfcea01096f1922a6a88b956d40adc17ac507181e2bab567d15b18a/hostname", "HostsPath": "/var/lib/docker/containers/d8c4059adbfcea01096f1922a6a88b956d40adc17ac507181e2bab567d15b18a/hosts", "Id": "d8c4059adbfcea01096f1922a6a88b956d40adc17ac507181e2bab567d15b18a", "Image": "sha256:f23a021c327e53ac497355dbc0b447fe010b30821bb5baa03cc2686f3b0f50a5", "LogPath": "/var/lib/docker/containers/d8c4059adbfcea01096f1922a6a88b956d40adc17ac507181e2bab567d15b18a/d8c4059adbfcea01096f1922a6a88b956d40adc17ac507181e2bab567d15b18a-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "cfab041c58604472f25aac08c6af0388e00093a6354189fb50843584635e5987", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/cfab041c58604472f25aac08c6af0388e00093a6354189fb50843584635e5987/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "0e05f8e935a44f0109bd62a339971cb4de894640086c74f9f8df49c6f8c7bf99", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "0e05f8e935a44f0109bd62a339971cb4de894640086c74f9f8df49c6f8c7bf99", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "e4f9641289cd1f14f940983f3bf6885549a40d1e286aa5fca71e52af6cf36c31", "SandboxKey": "/var/run/docker/netns/e4f9641289cd", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/d8c4059adbfcea01096f1922a6a88b956d40adc17ac507181e2bab567d15b18a/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 20765, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:52:21.27248325Z", "Status": "running"}}, "item": {"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vmif": "t6C3if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6', u'tenant_sub_if': u't6s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:52:22.197946918Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/2b2524ed74f74df669a16603465f2a48412683fdf974384c5e69820d34c29720-init/diff:/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/diff:/var/lib/docker/overlay2/b79f8193dea4276d8794bc62c79efb51d10b778d1fe9ba26352bfa73bd925225/diff:/var/lib/docker/overlay2/ccfc2379fc1c10ee4e3ef9f014d2e640574f8321fc3ca810eb74352da7e82694/diff:/var/lib/docker/overlay2/046982c34cafa6011488e28be6fd454a1b07db35452090aa7307df7bd94ade5b/diff", "MergedDir": "/var/lib/docker/overlay2/2b2524ed74f74df669a16603465f2a48412683fdf974384c5e69820d34c29720/merged", "UpperDir": "/var/lib/docker/overlay2/2b2524ed74f74df669a16603465f2a48412683fdf974384c5e69820d34c29720/diff", "WorkDir": "/var/lib/docker/overlay2/2b2524ed74f74df669a16603465f2a48412683fdf974384c5e69820d34c29720/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/a64e7f5d11aa38e10406a377a0a556f8ab37acc1d98d93049170a695bf2dde8a/hostname", "HostsPath": "/var/lib/docker/containers/a64e7f5d11aa38e10406a377a0a556f8ab37acc1d98d93049170a695bf2dde8a/hosts", "Id": "a64e7f5d11aa38e10406a377a0a556f8ab37acc1d98d93049170a695bf2dde8a", "Image": "sha256:f23a021c327e53ac497355dbc0b447fe010b30821bb5baa03cc2686f3b0f50a5", "LogPath": "/var/lib/docker/containers/a64e7f5d11aa38e10406a377a0a556f8ab37acc1d98d93049170a695bf2dde8a/a64e7f5d11aa38e10406a377a0a556f8ab37acc1d98d93049170a695bf2dde8a-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "98d8e1059b8935f253963a7fcd603095707433b85ab407b0d8647e86a8a942b7", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/98d8e1059b8935f253963a7fcd603095707433b85ab407b0d8647e86a8a942b7/_data", "Type": "volume"}], "Name": "/t6ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "d222861ab72eb5eee36392b5d84431d9c23dc67cc9fe5cd66db6c3f95df233e7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d222861ab72eb5eee36392b5d84431d9c23dc67cc9fe5cd66db6c3f95df233e7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "15335a839adf6a198c126eaf2d6dbdf5b7c9f58c73a1a18ab00a6fdf87702f02", "SandboxKey": "/var/run/docker/netns/15335a839adf", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/a64e7f5d11aa38e10406a377a0a556f8ab37acc1d98d93049170a695bf2dde8a/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 21941, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:52:22.739478972Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T20:52:22.197946918Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/2b2524ed74f74df669a16603465f2a48412683fdf974384c5e69820d34c29720-init/diff:/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/diff:/var/lib/docker/overlay2/b79f8193dea4276d8794bc62c79efb51d10b778d1fe9ba26352bfa73bd925225/diff:/var/lib/docker/overlay2/ccfc2379fc1c10ee4e3ef9f014d2e640574f8321fc3ca810eb74352da7e82694/diff:/var/lib/docker/overlay2/046982c34cafa6011488e28be6fd454a1b07db35452090aa7307df7bd94ade5b/diff", "MergedDir": "/var/lib/docker/overlay2/2b2524ed74f74df669a16603465f2a48412683fdf974384c5e69820d34c29720/merged", "UpperDir": "/var/lib/docker/overlay2/2b2524ed74f74df669a16603465f2a48412683fdf974384c5e69820d34c29720/diff", "WorkDir": "/var/lib/docker/overlay2/2b2524ed74f74df669a16603465f2a48412683fdf974384c5e69820d34c29720/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/a64e7f5d11aa38e10406a377a0a556f8ab37acc1d98d93049170a695bf2dde8a/hostname", "HostsPath": "/var/lib/docker/containers/a64e7f5d11aa38e10406a377a0a556f8ab37acc1d98d93049170a695bf2dde8a/hosts", "Id": "a64e7f5d11aa38e10406a377a0a556f8ab37acc1d98d93049170a695bf2dde8a", "Image": "sha256:f23a021c327e53ac497355dbc0b447fe010b30821bb5baa03cc2686f3b0f50a5", "LogPath": "/var/lib/docker/containers/a64e7f5d11aa38e10406a377a0a556f8ab37acc1d98d93049170a695bf2dde8a/a64e7f5d11aa38e10406a377a0a556f8ab37acc1d98d93049170a695bf2dde8a-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "98d8e1059b8935f253963a7fcd603095707433b85ab407b0d8647e86a8a942b7", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/98d8e1059b8935f253963a7fcd603095707433b85ab407b0d8647e86a8a942b7/_data", "Type": "volume"}], "Name": "/t6ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "d222861ab72eb5eee36392b5d84431d9c23dc67cc9fe5cd66db6c3f95df233e7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d222861ab72eb5eee36392b5d84431d9c23dc67cc9fe5cd66db6c3f95df233e7", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "161c0be591d532f63c63d122cd57ad631a17ac000406f6e6a5b11e528264fe40"}}, "Ports": {}, "SandboxID": "15335a839adf6a198c126eaf2d6dbdf5b7c9f58c73a1a18ab00a6fdf87702f02", "SandboxKey": "/var/run/docker/netns/15335a839adf", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/a64e7f5d11aa38e10406a377a0a556f8ab37acc1d98d93049170a695bf2dde8a/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 21941, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T20:52:22.739478972Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vmif": "t6C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'pid': u'25852', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link show \"t6if\" ; if [ $? -ne 0 ] ; then ip link add \"t6if\" type veth peer name \"t6pns_if\" ; fi\n", "delta": "0:00:00.318075", "end": "2019-12-06 20:52:28.347463", "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pid": "25852", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}, "rc": 0, "start": "2019-12-06 20:52:28.029388", "stderr": "Device \"t6if\" does not exist.", "stderr_lines": ["Device \"t6if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'pid': u'25852', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t6pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t6pns_if\" netns pns1 ; fi\ndocker exec \"t6\" ip link show \"t6if\" ; if [ $? -ne 0 ] ; then ip link set \"t6if\" netns \"25852\" ; fi\nip netns exec pns1 ip link set dev \"t6pns_if\" up\ndocker exec \"t6\" ip link set dev \"t6if\" up\n", "delta": "0:00:00.542125", "end": "2019-12-06 20:52:29.116781", "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pid": "25852", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}, "rc": 0, "start": "2019-12-06 20:52:28.574656", "stderr": "Device \"t6pns_if\" does not exist.\nDevice \"t6if\" does not exist.", "stderr_lines": ["Device \"t6pns_if\" does not exist.", "Device \"t6if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'pid': u'25852', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t6pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.6.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.6.1/24\" dev \"t6pns_if\" ; fi\ndocker exec \"t6\" ip addr show \"t6if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.6.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t6\" ip addr add \"192.168.6.2/24\" dev \"t6if\" ; fi\n", "delta": "0:00:00.512003", "end": "2019-12-06 20:52:29.877863", "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pid": "25852", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}, "rc": 0, "start": "2019-12-06 20:52:29.365860", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link show \"t6ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t6ns1if\" type veth peer name \"t6s1if\" ; fi\n", "delta": "0:00:00.183445", "end": "2019-12-06 20:52:30.306127", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "rc": 0, "start": "2019-12-06 20:52:30.122682", "stderr": "Device \"t6ns1if\" does not exist.", "stderr_lines": ["Device \"t6ns1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link show \"t6ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t6ns1if\" netns \"25852\" ; fi\ndocker exec \"t6ns1\" ip link show \"t6s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t6s1if\" netns \"26450\" ; fi\n", "delta": "0:00:00.421966", "end": "2019-12-06 20:52:30.960222", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "rc": 0, "start": "2019-12-06 20:52:30.538256", "stderr": "Device \"t6ns1if\" does not exist.\nDevice \"t6s1if\" does not exist.", "stderr_lines": ["Device \"t6ns1if\" does not exist.", "Device \"t6s1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link set dev \"t6ns1if\" up\ndocker exec \"t6ns1\" ip link set dev \"t6s1if\" up\n", "delta": "0:00:00.348164", "end": "2019-12-06 20:52:31.536439", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "rc": 0, "start": "2019-12-06 20:52:31.188275", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip addr show \"t6s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.51.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip addr add \"10.1.51.2/24\" dev \"t6s1if\" ; fi\n\ndocker exec \"t6\" ip addr show \"t6ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.51.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t6\" ip addr add \"10.1.51.1/24\" dev \"t6ns1if\" ; fi\n", "delta": "0:00:00.746133", "end": "2019-12-06 20:52:32.524773", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "rc": 0, "start": "2019-12-06 20:52:31.778640", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route] *********************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'pid': u'25852', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t6\" ip route del default ; fi\n", "delta": "0:00:00.380338", "end": "2019-12-06 20:52:33.136446", "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pid": "25852", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}, "rc": 0, "start": "2019-12-06 20:52:32.756108", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'pid': u'25852', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip route show default | grep -w '[d]efault via 192.168.6.1' ; if [ $? -ne 0 ] ; then docker exec \"t6\" ip route add default via \"192.168.6.1\" ; fi\n", "delta": "0:00:00.369990", "end": "2019-12-06 20:52:33.733629", "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pid": "25852", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}, "rc": 0, "start": "2019-12-06 20:52:33.363639", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_ns_name': u't6', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t6ns1\" ip route del default ; fi\n", "delta": "0:00:00.415398", "end": "2019-12-06 20:52:34.405530", "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, "rc": 0, "start": "2019-12-06 20:52:33.990132", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_ns_name': u't6', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip route show default | grep -w '[d]efault via 10.1.51.1' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip route add default via \"10.1.51.1\" ; fi\n", "delta": "0:00:00.342896", "end": "2019-12-06 20:52:34.973663", "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, "rc": 0, "start": "2019-12-06 20:52:34.630767", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside container] ***********************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_ns_name': u't6', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" brctl show | grep -w '^t6br1'; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" brctl addbr \"t6br1\" ; fi\ndocker exec \"t6ns1\" ip link set dev \"t6br1\" up\n", "delta": "0:00:00.558080", "end": "2019-12-06 20:52:35.762298", "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, "rc": 0, "start": "2019-12-06 20:52:35.204218", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link show \"t6s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip link add \"t6s1_dnsbrif\" type veth peer name \"t6s1_dnsif\" ; fi\ndocker exec \"t6ns1\" ip link set dev \"t6s1_dnsbrif\" up\ndocker exec \"t6ns1\" ip link set dev \"t6s1_dnsif\" up\n", "delta": "0:00:00.786589", "end": "2019-12-06 20:52:36.819020", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 20:52:36.032431", "stderr": "Device \"t6s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t6s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" brctl show \"t6br1\" | grep -w 't6s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" brctl addif \"t6br1\" \"t6s1_dnsbrif\" ; fi\n", "delta": "0:00:00.384431", "end": "2019-12-06 20:52:37.425428", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 20:52:37.040997", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link show \"t6br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t6C1if1\" type veth peer name \"t6br1if1\" ; fi\nip link set dev \"t6br1if1\" up\nip link set dev \"t6C1if1\" up\n", "delta": "0:00:00.197858", "end": "2019-12-06 20:52:37.861695", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}], "rc": 0, "start": "2019-12-06 20:52:37.663837", "stderr": "Device \"t6br1if1\" does not exist.", "stderr_lines": ["Device \"t6br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link show \"t6br1if2\" ; if [ $? -ne 0 ] ; then ip link add \"t6C2if1\" type veth peer name \"t6br1if2\" ; fi\nip link set dev \"t6br1if2\" up\nip link set dev \"t6C2if1\" up\n", "delta": "0:00:00.191304", "end": "2019-12-06 20:52:38.251060", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "rc": 0, "start": "2019-12-06 20:52:38.059756", "stderr": "Device \"t6br1if2\" does not exist.", "stderr_lines": ["Device \"t6br1if2\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t6br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t6br1if1\" netns \"26450\" ; fi\ndocker exec \"t6ns1\" brctl show \"t6br1\" | grep -w 't6br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" brctl addif \"t6br1\" \"t6br1if1\" ; fi\n", "delta": "0:00:00.420908", "end": "2019-12-06 20:52:38.925225", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}], "rc": 0, "start": "2019-12-06 20:52:38.504317", "stderr": "", "stderr_lines": [], "stdout": "76: t6br1if1@t6C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 1a:be:13:02:79:f0 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["76: t6br1if1@t6C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 1a:be:13:02:79:f0 brd ff:ff:ff:ff:ff:ff"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t6br1if2\" ; if [ $? -eq 0 ] ; then ip link set \"t6br1if2\" netns \"26450\" ; fi\ndocker exec \"t6ns1\" brctl show \"t6br1\" | grep -w 't6br1if2' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" brctl addif \"t6br1\" \"t6br1if2\" ; fi\n", "delta": "0:00:00.439654", "end": "2019-12-06 20:52:39.539764", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "rc": 0, "start": "2019-12-06 20:52:39.100110", "stderr": "", "stderr_lines": [], "stdout": "78: t6br1if2@t6C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 02:36:a8:30:d9:69 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["78: t6br1if2@t6C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 02:36:a8:30:d9:69 brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link set \"t6br1if1\" up\ndocker exec \"t6ns1\" ip link set dev \"t6br1\" up\n", "delta": "0:00:00.347226", "end": "2019-12-06 20:52:40.152504", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}], "rc": 0, "start": "2019-12-06 20:52:39.805278", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link set \"t6br1if2\" up\ndocker exec \"t6ns1\" ip link set dev \"t6br1\" up\n", "delta": "0:00:00.371095", "end": "2019-12-06 20:52:40.698865", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "rc": 0, "start": "2019-12-06 20:52:40.327770", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip addr show \"t6s1_dnsif\" | awk 'FNR==3{ print $2 }' | grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip addr add \"1.1.1.1/24\" dev \"t6s1_dnsif\" ; fi\n", "delta": "0:00:00.398964", "end": "2019-12-06 20:52:41.354094", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 20:52:40.955130", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ps aux | grep -w '[d]nsmasq --interface t6s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" dnsmasq --interface \"t6s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.860657", "end": "2019-12-06 20:52:42.483494", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 20:52:41.622837", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}]}, {u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link show \"vxlan_t6s1\" ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip link add \"vxlan_t6s1\" type vxlan id \"42\" local \"10.1.51.2\" remote \"10.2.51.2\" dstport \"4789\" dev \"t6s1if\"; docker exec \"t6ns1\" ip link set dev \"vxlan_t6s1\" up ; fi\n", "delta": "0:00:00.623522", "end": "2019-12-06 20:52:43.387348", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}]}, {"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}], "rc": 0, "start": "2019-12-06 20:52:42.763826", "stderr": "Device \"vxlan_t6s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t6s1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'26450', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'25852', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}]}, {u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" brctl show \"t6br1\" | grep -w 'vxlan_t6s1' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" brctl addif \"t6br1\" \"vxlan_t6s1\" ; fi\n", "delta": "0:00:00.361875", "end": "2019-12-06 20:52:44.007299", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "26450", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "25852", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}]}, {"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}], "rc": 0, "start": "2019-12-06 20:52:43.645424", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 22:06:45.985469 Printing the yaml input file
INFO:root: 22:06:45.985666 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 22:06:45.985784 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 22:06:45.985836 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 22:06:45.985877 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file
INFO:root: 22:16:36.373174 Printing the yaml input file
INFO:root: 22:16:36.373310 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 22:16:36.373464 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 22:16:36.373516 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 22:16:36.373558 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
changed: [localhost] => {"actions": ["Built image centos7:latest from ./"], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": true, "image": {"Architecture": "amd64", "Author": "Prashanth_M", "Comment": "", "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "", "Image": "sha256:be2dda899eb1c9331e12a76cb9116c3e16d040f7f3ee9a4ad2b59816c823409a", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Container": "d071a196075b5e7c35695a91813328ac28aaded46633b394491f388c74791d15", "ContainerConfig": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/bin/sh", "-c", "#(nop) ", "CMD [\"/usr/sbin/init\"]"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "d071a196075b", "Image": "sha256:be2dda899eb1c9331e12a76cb9116c3e16d040f7f3ee9a4ad2b59816c823409a", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T22:18:48.874732876Z", "DockerVersion": "19.03.5", "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/86243f2b92a069cd3f84c04abe6750ff53e6efd04e2fb99a539d7ddee275a99c/diff:/var/lib/docker/overlay2/8bcf7c1b8a8f8ab2404c120f4fa6abe372378c932333787895ad9898cde088e6/diff:/var/lib/docker/overlay2/ac0c67692df61e20c1e318cd2645f7e2d8b201b293ec637fc6b72c1e52f7e909/diff", "MergedDir": "/var/lib/docker/overlay2/4b867a863a543273b961a611c146fafb96e3b2ef4c7a5183f3a9ac6e7242ab88/merged", "UpperDir": "/var/lib/docker/overlay2/4b867a863a543273b961a611c146fafb96e3b2ef4c7a5183f3a9ac6e7242ab88/diff", "WorkDir": "/var/lib/docker/overlay2/4b867a863a543273b961a611c146fafb96e3b2ef4c7a5183f3a9ac6e7242ab88/work"}, "Name": "overlay2"}, "Id": "sha256:20c5b4804ab0e8ce751642ca7a8429ae09c15f9d03ef1162a493af0240777223", "Metadata": {"LastTagTime": "2019-12-06T22:18:48.907042167Z"}, "Os": "linux", "Parent": "sha256:be2dda899eb1c9331e12a76cb9116c3e16d040f7f3ee9a4ad2b59816c823409a", "RepoDigests": [], "RepoTags": ["centos7:latest"], "RootFS": {"Layers": ["sha256:77b174a6a187b610e4699546bd973a8d1e77663796e3724318a2a4b24cb07ea0", "sha256:f4b2bcc6039767663403d23b530543bbcff8c9ca50ca4e0dc08e434575f3d8de", "sha256:820591ebf3b1fce59b33f1ef22d8cbe095f2736ae770defa5a4f4505cf1bc71c", "sha256:b5766d96f86ef3660c4cdfb02d95871a57d755492c82828fe754781f123d5075"], "Type": "layers"}, "Size": 363172314, "VirtualSize": 363172314}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T22:18:49.559788831Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/067bf1431ca94461e4c848d1ea41f1d3e51acb2d3301ee67ae88ea3427dc72fe-init/diff:/var/lib/docker/overlay2/4b867a863a543273b961a611c146fafb96e3b2ef4c7a5183f3a9ac6e7242ab88/diff:/var/lib/docker/overlay2/86243f2b92a069cd3f84c04abe6750ff53e6efd04e2fb99a539d7ddee275a99c/diff:/var/lib/docker/overlay2/8bcf7c1b8a8f8ab2404c120f4fa6abe372378c932333787895ad9898cde088e6/diff:/var/lib/docker/overlay2/ac0c67692df61e20c1e318cd2645f7e2d8b201b293ec637fc6b72c1e52f7e909/diff", "MergedDir": "/var/lib/docker/overlay2/067bf1431ca94461e4c848d1ea41f1d3e51acb2d3301ee67ae88ea3427dc72fe/merged", "UpperDir": "/var/lib/docker/overlay2/067bf1431ca94461e4c848d1ea41f1d3e51acb2d3301ee67ae88ea3427dc72fe/diff", "WorkDir": "/var/lib/docker/overlay2/067bf1431ca94461e4c848d1ea41f1d3e51acb2d3301ee67ae88ea3427dc72fe/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c113ee639a876b3b81e7e3a302c1d5b753f3dda0755e5027ea5b0cfb31f4b70d/hostname", "HostsPath": "/var/lib/docker/containers/c113ee639a876b3b81e7e3a302c1d5b753f3dda0755e5027ea5b0cfb31f4b70d/hosts", "Id": "c113ee639a876b3b81e7e3a302c1d5b753f3dda0755e5027ea5b0cfb31f4b70d", "Image": "sha256:20c5b4804ab0e8ce751642ca7a8429ae09c15f9d03ef1162a493af0240777223", "LogPath": "/var/lib/docker/containers/c113ee639a876b3b81e7e3a302c1d5b753f3dda0755e5027ea5b0cfb31f4b70d/c113ee639a876b3b81e7e3a302c1d5b753f3dda0755e5027ea5b0cfb31f4b70d-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ca6cc89c75b6f6620633908e3a1197acd9d2b3cfb86a731052e759cad3cd21d1", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ca6cc89c75b6f6620633908e3a1197acd9d2b3cfb86a731052e759cad3cd21d1/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "4f215bbdff65c2f4366ca8a59970e9ea549a0e8c6d09fa8d437b7c7a5d31015d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "4f215bbdff65c2f4366ca8a59970e9ea549a0e8c6d09fa8d437b7c7a5d31015d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "76993ff78319ca67e940bd57d8c3f0829c13e025f3d7ca2a1c9035adef3654d7", "SandboxKey": "/var/run/docker/netns/76993ff78319", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c113ee639a876b3b81e7e3a302c1d5b753f3dda0755e5027ea5b0cfb31f4b70d/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 13008, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T22:18:49.959088847Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T22:18:49.559788831Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/067bf1431ca94461e4c848d1ea41f1d3e51acb2d3301ee67ae88ea3427dc72fe-init/diff:/var/lib/docker/overlay2/4b867a863a543273b961a611c146fafb96e3b2ef4c7a5183f3a9ac6e7242ab88/diff:/var/lib/docker/overlay2/86243f2b92a069cd3f84c04abe6750ff53e6efd04e2fb99a539d7ddee275a99c/diff:/var/lib/docker/overlay2/8bcf7c1b8a8f8ab2404c120f4fa6abe372378c932333787895ad9898cde088e6/diff:/var/lib/docker/overlay2/ac0c67692df61e20c1e318cd2645f7e2d8b201b293ec637fc6b72c1e52f7e909/diff", "MergedDir": "/var/lib/docker/overlay2/067bf1431ca94461e4c848d1ea41f1d3e51acb2d3301ee67ae88ea3427dc72fe/merged", "UpperDir": "/var/lib/docker/overlay2/067bf1431ca94461e4c848d1ea41f1d3e51acb2d3301ee67ae88ea3427dc72fe/diff", "WorkDir": "/var/lib/docker/overlay2/067bf1431ca94461e4c848d1ea41f1d3e51acb2d3301ee67ae88ea3427dc72fe/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c113ee639a876b3b81e7e3a302c1d5b753f3dda0755e5027ea5b0cfb31f4b70d/hostname", "HostsPath": "/var/lib/docker/containers/c113ee639a876b3b81e7e3a302c1d5b753f3dda0755e5027ea5b0cfb31f4b70d/hosts", "Id": "c113ee639a876b3b81e7e3a302c1d5b753f3dda0755e5027ea5b0cfb31f4b70d", "Image": "sha256:20c5b4804ab0e8ce751642ca7a8429ae09c15f9d03ef1162a493af0240777223", "LogPath": "/var/lib/docker/containers/c113ee639a876b3b81e7e3a302c1d5b753f3dda0755e5027ea5b0cfb31f4b70d/c113ee639a876b3b81e7e3a302c1d5b753f3dda0755e5027ea5b0cfb31f4b70d-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ca6cc89c75b6f6620633908e3a1197acd9d2b3cfb86a731052e759cad3cd21d1", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ca6cc89c75b6f6620633908e3a1197acd9d2b3cfb86a731052e759cad3cd21d1/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "4f215bbdff65c2f4366ca8a59970e9ea549a0e8c6d09fa8d437b7c7a5d31015d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "4f215bbdff65c2f4366ca8a59970e9ea549a0e8c6d09fa8d437b7c7a5d31015d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "76993ff78319ca67e940bd57d8c3f0829c13e025f3d7ca2a1c9035adef3654d7", "SandboxKey": "/var/run/docker/netns/76993ff78319", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c113ee639a876b3b81e7e3a302c1d5b753f3dda0755e5027ea5b0cfb31f4b70d/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 13008, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T22:18:49.959088847Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'tenant_route_ip': u'192.168.2.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.1.11.0/24', u'remote_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T22:18:50.51822258Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/4746054d12c8826cfcd3dcc9c969a5877de2cfee069191c9602e5490ccd73a1f-init/diff:/var/lib/docker/overlay2/4b867a863a543273b961a611c146fafb96e3b2ef4c7a5183f3a9ac6e7242ab88/diff:/var/lib/docker/overlay2/86243f2b92a069cd3f84c04abe6750ff53e6efd04e2fb99a539d7ddee275a99c/diff:/var/lib/docker/overlay2/8bcf7c1b8a8f8ab2404c120f4fa6abe372378c932333787895ad9898cde088e6/diff:/var/lib/docker/overlay2/ac0c67692df61e20c1e318cd2645f7e2d8b201b293ec637fc6b72c1e52f7e909/diff", "MergedDir": "/var/lib/docker/overlay2/4746054d12c8826cfcd3dcc9c969a5877de2cfee069191c9602e5490ccd73a1f/merged", "UpperDir": "/var/lib/docker/overlay2/4746054d12c8826cfcd3dcc9c969a5877de2cfee069191c9602e5490ccd73a1f/diff", "WorkDir": "/var/lib/docker/overlay2/4746054d12c8826cfcd3dcc9c969a5877de2cfee069191c9602e5490ccd73a1f/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/ff6a850a5171fe850e4515853e270a1ae2fc34858cec38effca25bf546b59af4/hostname", "HostsPath": "/var/lib/docker/containers/ff6a850a5171fe850e4515853e270a1ae2fc34858cec38effca25bf546b59af4/hosts", "Id": "ff6a850a5171fe850e4515853e270a1ae2fc34858cec38effca25bf546b59af4", "Image": "sha256:20c5b4804ab0e8ce751642ca7a8429ae09c15f9d03ef1162a493af0240777223", "LogPath": "/var/lib/docker/containers/ff6a850a5171fe850e4515853e270a1ae2fc34858cec38effca25bf546b59af4/ff6a850a5171fe850e4515853e270a1ae2fc34858cec38effca25bf546b59af4-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "d7ff41d760fa309a14d16d4ee8d0c82204139ec514aa072d04f8cf5f4f7fb30e", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/d7ff41d760fa309a14d16d4ee8d0c82204139ec514aa072d04f8cf5f4f7fb30e/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "c7f82fbfbde221d30ec2333db21b4bde0d64d3eee67af2b3749286acb2267f0d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "c7f82fbfbde221d30ec2333db21b4bde0d64d3eee67af2b3749286acb2267f0d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "714eb26ca929052fe1ed1247fd6ae744c9186d96900bf0498a227310ff1a56f3", "SandboxKey": "/var/run/docker/netns/714eb26ca929", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/ff6a850a5171fe850e4515853e270a1ae2fc34858cec38effca25bf546b59af4/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 13611, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T22:18:51.08601913Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T22:18:50.51822258Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/4746054d12c8826cfcd3dcc9c969a5877de2cfee069191c9602e5490ccd73a1f-init/diff:/var/lib/docker/overlay2/4b867a863a543273b961a611c146fafb96e3b2ef4c7a5183f3a9ac6e7242ab88/diff:/var/lib/docker/overlay2/86243f2b92a069cd3f84c04abe6750ff53e6efd04e2fb99a539d7ddee275a99c/diff:/var/lib/docker/overlay2/8bcf7c1b8a8f8ab2404c120f4fa6abe372378c932333787895ad9898cde088e6/diff:/var/lib/docker/overlay2/ac0c67692df61e20c1e318cd2645f7e2d8b201b293ec637fc6b72c1e52f7e909/diff", "MergedDir": "/var/lib/docker/overlay2/4746054d12c8826cfcd3dcc9c969a5877de2cfee069191c9602e5490ccd73a1f/merged", "UpperDir": "/var/lib/docker/overlay2/4746054d12c8826cfcd3dcc9c969a5877de2cfee069191c9602e5490ccd73a1f/diff", "WorkDir": "/var/lib/docker/overlay2/4746054d12c8826cfcd3dcc9c969a5877de2cfee069191c9602e5490ccd73a1f/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/ff6a850a5171fe850e4515853e270a1ae2fc34858cec38effca25bf546b59af4/hostname", "HostsPath": "/var/lib/docker/containers/ff6a850a5171fe850e4515853e270a1ae2fc34858cec38effca25bf546b59af4/hosts", "Id": "ff6a850a5171fe850e4515853e270a1ae2fc34858cec38effca25bf546b59af4", "Image": "sha256:20c5b4804ab0e8ce751642ca7a8429ae09c15f9d03ef1162a493af0240777223", "LogPath": "/var/lib/docker/containers/ff6a850a5171fe850e4515853e270a1ae2fc34858cec38effca25bf546b59af4/ff6a850a5171fe850e4515853e270a1ae2fc34858cec38effca25bf546b59af4-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "d7ff41d760fa309a14d16d4ee8d0c82204139ec514aa072d04f8cf5f4f7fb30e", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/d7ff41d760fa309a14d16d4ee8d0c82204139ec514aa072d04f8cf5f4f7fb30e/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "c7f82fbfbde221d30ec2333db21b4bde0d64d3eee67af2b3749286acb2267f0d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "c7f82fbfbde221d30ec2333db21b4bde0d64d3eee67af2b3749286acb2267f0d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "714eb26ca929052fe1ed1247fd6ae744c9186d96900bf0498a227310ff1a56f3", "SandboxKey": "/var/run/docker/netns/714eb26ca929", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/ff6a850a5171fe850e4515853e270a1ae2fc34858cec38effca25bf546b59af4/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 13611, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T22:18:51.08601913Z", "Status": "running"}}, "item": {"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T22:18:54.922624772Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/953604febff0cf5ebacb527d1a6f57b4c732d66de7dba28aaa75f9dc373deef6-init/diff:/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/diff:/var/lib/docker/overlay2/b79f8193dea4276d8794bc62c79efb51d10b778d1fe9ba26352bfa73bd925225/diff:/var/lib/docker/overlay2/ccfc2379fc1c10ee4e3ef9f014d2e640574f8321fc3ca810eb74352da7e82694/diff:/var/lib/docker/overlay2/046982c34cafa6011488e28be6fd454a1b07db35452090aa7307df7bd94ade5b/diff", "MergedDir": "/var/lib/docker/overlay2/953604febff0cf5ebacb527d1a6f57b4c732d66de7dba28aaa75f9dc373deef6/merged", "UpperDir": "/var/lib/docker/overlay2/953604febff0cf5ebacb527d1a6f57b4c732d66de7dba28aaa75f9dc373deef6/diff", "WorkDir": "/var/lib/docker/overlay2/953604febff0cf5ebacb527d1a6f57b4c732d66de7dba28aaa75f9dc373deef6/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/0dfd156fcc14c394616bb550fcfda78dfffebaf56b714f68d9388b4cc008a341/hostname", "HostsPath": "/var/lib/docker/containers/0dfd156fcc14c394616bb550fcfda78dfffebaf56b714f68d9388b4cc008a341/hosts", "Id": "0dfd156fcc14c394616bb550fcfda78dfffebaf56b714f68d9388b4cc008a341", "Image": "sha256:f23a021c327e53ac497355dbc0b447fe010b30821bb5baa03cc2686f3b0f50a5", "LogPath": "/var/lib/docker/containers/0dfd156fcc14c394616bb550fcfda78dfffebaf56b714f68d9388b4cc008a341/0dfd156fcc14c394616bb550fcfda78dfffebaf56b714f68d9388b4cc008a341-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "880e6c43afaa6983edff5f19585571dc5074e246a2645ba6c031c9c7547615da", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/880e6c43afaa6983edff5f19585571dc5074e246a2645ba6c031c9c7547615da/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "4c2d6d60c3d1fb864081390429838b398540ac0b2e2a4f2f6e32de4b00ae4186", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "4c2d6d60c3d1fb864081390429838b398540ac0b2e2a4f2f6e32de4b00ae4186", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "dfb93f1645931af2affc0550cb68cd034995d2fb679d9551fd768a7faa45be3a", "SandboxKey": "/var/run/docker/netns/dfb93f164593", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/0dfd156fcc14c394616bb550fcfda78dfffebaf56b714f68d9388b4cc008a341/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 3124, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T22:18:55.583821537Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T22:18:54.922624772Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/953604febff0cf5ebacb527d1a6f57b4c732d66de7dba28aaa75f9dc373deef6-init/diff:/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/diff:/var/lib/docker/overlay2/b79f8193dea4276d8794bc62c79efb51d10b778d1fe9ba26352bfa73bd925225/diff:/var/lib/docker/overlay2/ccfc2379fc1c10ee4e3ef9f014d2e640574f8321fc3ca810eb74352da7e82694/diff:/var/lib/docker/overlay2/046982c34cafa6011488e28be6fd454a1b07db35452090aa7307df7bd94ade5b/diff", "MergedDir": "/var/lib/docker/overlay2/953604febff0cf5ebacb527d1a6f57b4c732d66de7dba28aaa75f9dc373deef6/merged", "UpperDir": "/var/lib/docker/overlay2/953604febff0cf5ebacb527d1a6f57b4c732d66de7dba28aaa75f9dc373deef6/diff", "WorkDir": "/var/lib/docker/overlay2/953604febff0cf5ebacb527d1a6f57b4c732d66de7dba28aaa75f9dc373deef6/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/0dfd156fcc14c394616bb550fcfda78dfffebaf56b714f68d9388b4cc008a341/hostname", "HostsPath": "/var/lib/docker/containers/0dfd156fcc14c394616bb550fcfda78dfffebaf56b714f68d9388b4cc008a341/hosts", "Id": "0dfd156fcc14c394616bb550fcfda78dfffebaf56b714f68d9388b4cc008a341", "Image": "sha256:f23a021c327e53ac497355dbc0b447fe010b30821bb5baa03cc2686f3b0f50a5", "LogPath": "/var/lib/docker/containers/0dfd156fcc14c394616bb550fcfda78dfffebaf56b714f68d9388b4cc008a341/0dfd156fcc14c394616bb550fcfda78dfffebaf56b714f68d9388b4cc008a341-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "880e6c43afaa6983edff5f19585571dc5074e246a2645ba6c031c9c7547615da", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/880e6c43afaa6983edff5f19585571dc5074e246a2645ba6c031c9c7547615da/_data", "Type": "volume"}], "Name": "/t2", "NetworkSettings": {"Bridge": "", "EndpointID": "4c2d6d60c3d1fb864081390429838b398540ac0b2e2a4f2f6e32de4b00ae4186", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "4c2d6d60c3d1fb864081390429838b398540ac0b2e2a4f2f6e32de4b00ae4186", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "dfb93f1645931af2affc0550cb68cd034995d2fb679d9551fd768a7faa45be3a", "SandboxKey": "/var/run/docker/netns/dfb93f164593", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/0dfd156fcc14c394616bb550fcfda78dfffebaf56b714f68d9388b4cc008a341/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 3124, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T22:18:55.583821537Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'tenant_route_ip': u'192.168.130.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.2.11.0/24', u'remote_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T22:18:56.256553782Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/4d01ab336cdb280b0cd95168de209733a01d2e7f77f0edff07d55dec0bb3cfed-init/diff:/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/diff:/var/lib/docker/overlay2/b79f8193dea4276d8794bc62c79efb51d10b778d1fe9ba26352bfa73bd925225/diff:/var/lib/docker/overlay2/ccfc2379fc1c10ee4e3ef9f014d2e640574f8321fc3ca810eb74352da7e82694/diff:/var/lib/docker/overlay2/046982c34cafa6011488e28be6fd454a1b07db35452090aa7307df7bd94ade5b/diff", "MergedDir": "/var/lib/docker/overlay2/4d01ab336cdb280b0cd95168de209733a01d2e7f77f0edff07d55dec0bb3cfed/merged", "UpperDir": "/var/lib/docker/overlay2/4d01ab336cdb280b0cd95168de209733a01d2e7f77f0edff07d55dec0bb3cfed/diff", "WorkDir": "/var/lib/docker/overlay2/4d01ab336cdb280b0cd95168de209733a01d2e7f77f0edff07d55dec0bb3cfed/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/91ef6077ff6f35a5961c1870e1571a37d9a184bdaa0d46a310b4fce6993213a7/hostname", "HostsPath": "/var/lib/docker/containers/91ef6077ff6f35a5961c1870e1571a37d9a184bdaa0d46a310b4fce6993213a7/hosts", "Id": "91ef6077ff6f35a5961c1870e1571a37d9a184bdaa0d46a310b4fce6993213a7", "Image": "sha256:f23a021c327e53ac497355dbc0b447fe010b30821bb5baa03cc2686f3b0f50a5", "LogPath": "/var/lib/docker/containers/91ef6077ff6f35a5961c1870e1571a37d9a184bdaa0d46a310b4fce6993213a7/91ef6077ff6f35a5961c1870e1571a37d9a184bdaa0d46a310b4fce6993213a7-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ebc8d2d328d4b0dc67344a2491b38133f1f37c82cde83c296a36e85f3cac6aaa", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ebc8d2d328d4b0dc67344a2491b38133f1f37c82cde83c296a36e85f3cac6aaa/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "1bf515df47c84b8d7b0b7bcb292879263edb34c8823bd26e1992f51e61e7dc97", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "1bf515df47c84b8d7b0b7bcb292879263edb34c8823bd26e1992f51e61e7dc97", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "b28d47343b7e44cec88930320db49e2b1580508cc0d052066ea8f503adee262b", "SandboxKey": "/var/run/docker/netns/b28d47343b7e", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/91ef6077ff6f35a5961c1870e1571a37d9a184bdaa0d46a310b4fce6993213a7/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 3751, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T22:18:56.810105405Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T22:18:56.256553782Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/4d01ab336cdb280b0cd95168de209733a01d2e7f77f0edff07d55dec0bb3cfed-init/diff:/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/diff:/var/lib/docker/overlay2/b79f8193dea4276d8794bc62c79efb51d10b778d1fe9ba26352bfa73bd925225/diff:/var/lib/docker/overlay2/ccfc2379fc1c10ee4e3ef9f014d2e640574f8321fc3ca810eb74352da7e82694/diff:/var/lib/docker/overlay2/046982c34cafa6011488e28be6fd454a1b07db35452090aa7307df7bd94ade5b/diff", "MergedDir": "/var/lib/docker/overlay2/4d01ab336cdb280b0cd95168de209733a01d2e7f77f0edff07d55dec0bb3cfed/merged", "UpperDir": "/var/lib/docker/overlay2/4d01ab336cdb280b0cd95168de209733a01d2e7f77f0edff07d55dec0bb3cfed/diff", "WorkDir": "/var/lib/docker/overlay2/4d01ab336cdb280b0cd95168de209733a01d2e7f77f0edff07d55dec0bb3cfed/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/91ef6077ff6f35a5961c1870e1571a37d9a184bdaa0d46a310b4fce6993213a7/hostname", "HostsPath": "/var/lib/docker/containers/91ef6077ff6f35a5961c1870e1571a37d9a184bdaa0d46a310b4fce6993213a7/hosts", "Id": "91ef6077ff6f35a5961c1870e1571a37d9a184bdaa0d46a310b4fce6993213a7", "Image": "sha256:f23a021c327e53ac497355dbc0b447fe010b30821bb5baa03cc2686f3b0f50a5", "LogPath": "/var/lib/docker/containers/91ef6077ff6f35a5961c1870e1571a37d9a184bdaa0d46a310b4fce6993213a7/91ef6077ff6f35a5961c1870e1571a37d9a184bdaa0d46a310b4fce6993213a7-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ebc8d2d328d4b0dc67344a2491b38133f1f37c82cde83c296a36e85f3cac6aaa", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ebc8d2d328d4b0dc67344a2491b38133f1f37c82cde83c296a36e85f3cac6aaa/_data", "Type": "volume"}], "Name": "/t2ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "1bf515df47c84b8d7b0b7bcb292879263edb34c8823bd26e1992f51e61e7dc97", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "1bf515df47c84b8d7b0b7bcb292879263edb34c8823bd26e1992f51e61e7dc97", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "b28d47343b7e44cec88930320db49e2b1580508cc0d052066ea8f503adee262b", "SandboxKey": "/var/run/docker/netns/b28d47343b7e", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/91ef6077ff6f35a5961c1870e1571a37d9a184bdaa0d46a310b4fce6993213a7/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 3751, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T22:18:56.810105405Z", "Status": "running"}}, "item": {"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2', u'tenant_sub_if': u't2s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T22:18:57.731999857Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/c1229b028ccbd39f1a1cf6795776df8566005fcfc7f41bb8efba27ac2e2a8ad7-init/diff:/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/diff:/var/lib/docker/overlay2/b79f8193dea4276d8794bc62c79efb51d10b778d1fe9ba26352bfa73bd925225/diff:/var/lib/docker/overlay2/ccfc2379fc1c10ee4e3ef9f014d2e640574f8321fc3ca810eb74352da7e82694/diff:/var/lib/docker/overlay2/046982c34cafa6011488e28be6fd454a1b07db35452090aa7307df7bd94ade5b/diff", "MergedDir": "/var/lib/docker/overlay2/c1229b028ccbd39f1a1cf6795776df8566005fcfc7f41bb8efba27ac2e2a8ad7/merged", "UpperDir": "/var/lib/docker/overlay2/c1229b028ccbd39f1a1cf6795776df8566005fcfc7f41bb8efba27ac2e2a8ad7/diff", "WorkDir": "/var/lib/docker/overlay2/c1229b028ccbd39f1a1cf6795776df8566005fcfc7f41bb8efba27ac2e2a8ad7/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/7ddee9c95beb5d1ba7ae34309daa49e72ed87e7005ebcf7521f61c0e62202515/hostname", "HostsPath": "/var/lib/docker/containers/7ddee9c95beb5d1ba7ae34309daa49e72ed87e7005ebcf7521f61c0e62202515/hosts", "Id": "7ddee9c95beb5d1ba7ae34309daa49e72ed87e7005ebcf7521f61c0e62202515", "Image": "sha256:f23a021c327e53ac497355dbc0b447fe010b30821bb5baa03cc2686f3b0f50a5", "LogPath": "/var/lib/docker/containers/7ddee9c95beb5d1ba7ae34309daa49e72ed87e7005ebcf7521f61c0e62202515/7ddee9c95beb5d1ba7ae34309daa49e72ed87e7005ebcf7521f61c0e62202515-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "a43e2bec49dee4abac4078842533fb90844a6abcf03d0e9ff985cf11ab491c83", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/a43e2bec49dee4abac4078842533fb90844a6abcf03d0e9ff985cf11ab491c83/_data", "Type": "volume"}], "Name": "/t2ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "87fd8691ffee56b60d6cba435275b761976f0bdb160c2b985750b10e3977db5e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "87fd8691ffee56b60d6cba435275b761976f0bdb160c2b985750b10e3977db5e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "fd68f01f22f0f818158dcd92e02cdfdc291edb02ea7439823819aa805751737f", "SandboxKey": "/var/run/docker/netns/fd68f01f22f0", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/7ddee9c95beb5d1ba7ae34309daa49e72ed87e7005ebcf7521f61c0e62202515/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4994, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T22:18:58.208634325Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t2ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T22:18:57.731999857Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/c1229b028ccbd39f1a1cf6795776df8566005fcfc7f41bb8efba27ac2e2a8ad7-init/diff:/var/lib/docker/overlay2/e99a2710256d1e60a5bbf5dab9c00d0f8d925e299f2c5e90e083c3648917e9f1/diff:/var/lib/docker/overlay2/b79f8193dea4276d8794bc62c79efb51d10b778d1fe9ba26352bfa73bd925225/diff:/var/lib/docker/overlay2/ccfc2379fc1c10ee4e3ef9f014d2e640574f8321fc3ca810eb74352da7e82694/diff:/var/lib/docker/overlay2/046982c34cafa6011488e28be6fd454a1b07db35452090aa7307df7bd94ade5b/diff", "MergedDir": "/var/lib/docker/overlay2/c1229b028ccbd39f1a1cf6795776df8566005fcfc7f41bb8efba27ac2e2a8ad7/merged", "UpperDir": "/var/lib/docker/overlay2/c1229b028ccbd39f1a1cf6795776df8566005fcfc7f41bb8efba27ac2e2a8ad7/diff", "WorkDir": "/var/lib/docker/overlay2/c1229b028ccbd39f1a1cf6795776df8566005fcfc7f41bb8efba27ac2e2a8ad7/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/7ddee9c95beb5d1ba7ae34309daa49e72ed87e7005ebcf7521f61c0e62202515/hostname", "HostsPath": "/var/lib/docker/containers/7ddee9c95beb5d1ba7ae34309daa49e72ed87e7005ebcf7521f61c0e62202515/hosts", "Id": "7ddee9c95beb5d1ba7ae34309daa49e72ed87e7005ebcf7521f61c0e62202515", "Image": "sha256:f23a021c327e53ac497355dbc0b447fe010b30821bb5baa03cc2686f3b0f50a5", "LogPath": "/var/lib/docker/containers/7ddee9c95beb5d1ba7ae34309daa49e72ed87e7005ebcf7521f61c0e62202515/7ddee9c95beb5d1ba7ae34309daa49e72ed87e7005ebcf7521f61c0e62202515-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "a43e2bec49dee4abac4078842533fb90844a6abcf03d0e9ff985cf11ab491c83", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/a43e2bec49dee4abac4078842533fb90844a6abcf03d0e9ff985cf11ab491c83/_data", "Type": "volume"}], "Name": "/t2ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "87fd8691ffee56b60d6cba435275b761976f0bdb160c2b985750b10e3977db5e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "87fd8691ffee56b60d6cba435275b761976f0bdb160c2b985750b10e3977db5e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "fd68f01f22f0f818158dcd92e02cdfdc291edb02ea7439823819aa805751737f", "SandboxKey": "/var/run/docker/netns/fd68f01f22f0", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/7ddee9c95beb5d1ba7ae34309daa49e72ed87e7005ebcf7521f61c0e62202515/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 4994, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T22:18:58.208634325Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'pid': u'13008', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip link show \"t2if\" ; if [ $? -ne 0 ] ; then ip link add \"t2if\" type veth peer name \"t2pns_if\" ; fi\n", "delta": "0:00:00.170328", "end": "2019-12-06 22:19:02.975190", "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pid": "13008", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}, "rc": 0, "start": "2019-12-06 22:19:02.804862", "stderr": "Device \"t2if\" does not exist.", "stderr_lines": ["Device \"t2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'pid': u'13008', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t2pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t2pns_if\" netns pns1 ; fi\ndocker exec \"t2\" ip link show \"t2if\" ; if [ $? -ne 0 ] ; then ip link set \"t2if\" netns \"13008\" ; fi\nip netns exec pns1 ip link set dev \"t2pns_if\" up\ndocker exec \"t2\" ip link set dev \"t2if\" up\n", "delta": "0:00:00.486604", "end": "2019-12-06 22:19:03.708391", "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pid": "13008", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}, "rc": 0, "start": "2019-12-06 22:19:03.221787", "stderr": "Device \"t2pns_if\" does not exist.\nDevice \"t2if\" does not exist.", "stderr_lines": ["Device \"t2pns_if\" does not exist.", "Device \"t2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'pid': u'13008', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t2pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.2.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.2.1/24\" dev \"t2pns_if\" ; fi\ndocker exec \"t2\" ip addr show \"t2if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.2.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t2\" ip addr add \"192.168.2.2/24\" dev \"t2if\" ; fi\n", "delta": "0:00:00.440288", "end": "2019-12-06 22:19:04.380462", "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pid": "13008", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}, "rc": 0, "start": "2019-12-06 22:19:03.940174", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip link show \"t2ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t2ns1if\" type veth peer name \"t2s1if\" ; fi\n", "delta": "0:00:00.165590", "end": "2019-12-06 22:19:04.777507", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "rc": 0, "start": "2019-12-06 22:19:04.611917", "stderr": "Device \"t2ns1if\" does not exist.", "stderr_lines": ["Device \"t2ns1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip link show \"t2ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t2ns1if\" netns \"13008\" ; fi\ndocker exec \"t2ns1\" ip link show \"t2s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t2s1if\" netns \"13611\" ; fi\n", "delta": "0:00:00.396768", "end": "2019-12-06 22:19:05.434918", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "rc": 0, "start": "2019-12-06 22:19:05.038150", "stderr": "Device \"t2ns1if\" does not exist.\nDevice \"t2s1if\" does not exist.", "stderr_lines": ["Device \"t2ns1if\" does not exist.", "Device \"t2s1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip link set dev \"t2ns1if\" up\ndocker exec \"t2ns1\" ip link set dev \"t2s1if\" up\n", "delta": "0:00:00.375252", "end": "2019-12-06 22:19:06.038089", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "rc": 0, "start": "2019-12-06 22:19:05.662837", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip addr show \"t2s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.11.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" ip addr add \"10.1.11.2/24\" dev \"t2s1if\" ; fi\n\ndocker exec \"t2\" ip addr show \"t2ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.11.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t2\" ip addr add \"10.1.11.1/24\" dev \"t2ns1if\" ; fi\n", "delta": "0:00:00.772404", "end": "2019-12-06 22:19:07.039199", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "rc": 0, "start": "2019-12-06 22:19:06.266795", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route] *********************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'pid': u'13008', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t2\" ip route del default ; fi\n", "delta": "0:00:00.356133", "end": "2019-12-06 22:19:07.634744", "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pid": "13008", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}, "rc": 0, "start": "2019-12-06 22:19:07.278611", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.2.1', u'name': u't2', u'pns_ip': u'192.168.2.1/24', u'tenant_if': u't2if', u'pid': u'13008', u'tenant_ip': u'192.168.2.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip route show default | grep -w '[d]efault via 192.168.2.1' ; if [ $? -ne 0 ] ; then docker exec \"t2\" ip route add default via \"192.168.2.1\" ; fi\n", "delta": "0:00:00.417986", "end": "2019-12-06 22:19:08.286486", "item": {"default_route_ip": "192.168.2.1", "name": "t2", "pid": "13008", "pns_if": "t2pns_if", "pns_ip": "192.168.2.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.2.2/24"}, "rc": 0, "start": "2019-12-06 22:19:07.868500", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_ns_name': u't2', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'tenant_route_ip': u'192.168.2.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.1.11.0/24', u'remote_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t2ns1\" ip route del default ; fi\n", "delta": "0:00:00.397467", "end": "2019-12-06 22:19:08.916330", "item": {"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, "rc": 0, "start": "2019-12-06 22:19:08.518863", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_ns_name': u't2', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'tenant_route_ip': u'192.168.2.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.1.11.0/24', u'remote_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip route show default | grep -w '[d]efault via 10.1.11.1' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" ip route add default via \"10.1.11.1\" ; fi\n", "delta": "0:00:00.353466", "end": "2019-12-06 22:19:09.507614", "item": {"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, "rc": 0, "start": "2019-12-06 22:19:09.154148", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside container] ***********************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_ns_name': u't2', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'tenant_route_ip': u'192.168.2.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.1.11.0/24', u'remote_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" brctl show | grep -w '^t2br1'; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" brctl addbr \"t2br1\" ; fi\ndocker exec \"t2ns1\" ip link set dev \"t2br1\" up\n", "delta": "0:00:00.560289", "end": "2019-12-06 22:19:10.288883", "item": {"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, "rc": 0, "start": "2019-12-06 22:19:09.728594", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip link show \"t2s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" ip link add \"t2s1_dnsbrif\" type veth peer name \"t2s1_dnsif\" ; fi\ndocker exec \"t2ns1\" ip link set dev \"t2s1_dnsbrif\" up\ndocker exec \"t2ns1\" ip link set dev \"t2s1_dnsif\" up\n", "delta": "0:00:00.750094", "end": "2019-12-06 22:19:11.271547", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 22:19:10.521453", "stderr": "Device \"t2s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t2s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" brctl show \"t2br1\" | grep -w 't2s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" brctl addif \"t2br1\" \"t2s1_dnsbrif\" ; fi\n", "delta": "0:00:00.344175", "end": "2019-12-06 22:19:11.890484", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 22:19:11.546309", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip link show \"t2br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t2C1if1\" type veth peer name \"t2br1if1\" ; fi\nip link set dev \"t2br1if1\" up\nip link set dev \"t2C1if1\" up\n", "delta": "0:00:00.174355", "end": "2019-12-06 22:19:12.279571", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}], "rc": 0, "start": "2019-12-06 22:19:12.105216", "stderr": "Device \"t2br1if1\" does not exist.", "stderr_lines": ["Device \"t2br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip link show \"t2br1if2\" ; if [ $? -ne 0 ] ; then ip link add \"t2C2if1\" type veth peer name \"t2br1if2\" ; fi\nip link set dev \"t2br1if2\" up\nip link set dev \"t2C2if1\" up\n", "delta": "0:00:00.175686", "end": "2019-12-06 22:19:12.625120", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "rc": 0, "start": "2019-12-06 22:19:12.449434", "stderr": "Device \"t2br1if2\" does not exist.", "stderr_lines": ["Device \"t2br1if2\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t2br1if1\" netns \"13611\" ; fi\ndocker exec \"t2ns1\" brctl show \"t2br1\" | grep -w 't2br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" brctl addif \"t2br1\" \"t2br1if1\" ; fi\n", "delta": "0:00:00.385618", "end": "2019-12-06 22:19:13.237750", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}], "rc": 0, "start": "2019-12-06 22:19:12.852132", "stderr": "", "stderr_lines": [], "stdout": "32: t2br1if1@t2C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 5a:d6:42:2e:8d:d1 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["32: t2br1if1@t2C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 5a:d6:42:2e:8d:d1 brd ff:ff:ff:ff:ff:ff"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2br1if2\" ; if [ $? -eq 0 ] ; then ip link set \"t2br1if2\" netns \"13611\" ; fi\ndocker exec \"t2ns1\" brctl show \"t2br1\" | grep -w 't2br1if2' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" brctl addif \"t2br1\" \"t2br1if2\" ; fi\n", "delta": "0:00:00.385027", "end": "2019-12-06 22:19:13.767042", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "rc": 0, "start": "2019-12-06 22:19:13.382015", "stderr": "", "stderr_lines": [], "stdout": "34: t2br1if2@t2C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether d2:ec:bf:73:74:3a brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["34: t2br1if2@t2C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether d2:ec:bf:73:74:3a brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip link set \"t2br1if1\" up\ndocker exec \"t2ns1\" ip link set dev \"t2br1\" up\n", "delta": "0:00:00.370960", "end": "2019-12-06 22:19:14.365278", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}], "rc": 0, "start": "2019-12-06 22:19:13.994318", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip link set \"t2br1if2\" up\ndocker exec \"t2ns1\" ip link set dev \"t2br1\" up\n", "delta": "0:00:00.344983", "end": "2019-12-06 22:19:14.864763", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "rc": 0, "start": "2019-12-06 22:19:14.519780", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip addr show \"t2s1_dnsif\" | awk 'FNR==3{ print $2 }' | grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" ip addr add \"1.1.1.1/24\" dev \"t2s1_dnsif\" ; fi\n", "delta": "0:00:00.329849", "end": "2019-12-06 22:19:15.444540", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 22:19:15.114691", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}], u'vxlan': [{u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ps aux | grep -w '[d]nsmasq --interface t2s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" dnsmasq --interface \"t2s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.796589", "end": "2019-12-06 22:19:16.473337", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 22:19:15.676748", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}]}, {u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip link show \"vxlan_t2s1\" ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" ip link add \"vxlan_t2s1\" type vxlan id \"42\" local \"10.1.11.2\" remote \"10.2.11.2\" dstport \"4789\" dev \"t2s1if\"; docker exec \"t2ns1\" ip link set dev \"vxlan_t2s1\" up ; fi\n", "delta": "0:00:00.540056", "end": "2019-12-06 22:19:17.243338", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-06 22:19:16.703282", "stderr": "Device \"vxlan_t2s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t2s1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}]}, {u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" brctl show \"t2br1\" | grep -w 'vxlan_t2s1' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" brctl addif \"t2br1\" \"vxlan_t2s1\" ; fi\n", "delta": "0:00:00.337433", "end": "2019-12-06 22:19:17.808948", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-06 22:19:17.471515", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'pid': u'3124', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip link show \"t2if\" ; if [ $? -ne 0 ] ; then ip link add \"t2if\" type veth peer name \"t2pns_if\" ; fi\n", "delta": "0:00:00.199920", "end": "2019-12-06 22:19:19.180485", "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pid": "3124", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}, "rc": 0, "start": "2019-12-06 22:19:18.980565", "stderr": "Device \"t2if\" does not exist.", "stderr_lines": ["Device \"t2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'pid': u'3124', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t2pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t2pns_if\" netns pns1 ; fi\ndocker exec \"t2\" ip link show \"t2if\" ; if [ $? -ne 0 ] ; then ip link set \"t2if\" netns \"3124\" ; fi\nip netns exec pns1 ip link set dev \"t2pns_if\" up\ndocker exec \"t2\" ip link set dev \"t2if\" up\n", "delta": "0:00:00.480980", "end": "2019-12-06 22:19:19.978615", "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pid": "3124", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}, "rc": 0, "start": "2019-12-06 22:19:19.497635", "stderr": "Device \"t2pns_if\" does not exist.\nDevice \"t2if\" does not exist.", "stderr_lines": ["Device \"t2pns_if\" does not exist.", "Device \"t2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'pid': u'3124', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t2pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.130.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.130.1/24\" dev \"t2pns_if\" ; fi\ndocker exec \"t2\" ip addr show \"t2if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.130.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t2\" ip addr add \"192.168.130.2/24\" dev \"t2if\" ; fi\n", "delta": "0:00:00.417961", "end": "2019-12-06 22:19:20.716733", "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pid": "3124", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}, "rc": 0, "start": "2019-12-06 22:19:20.298772", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip link show \"t2ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t2ns1if\" type veth peer name \"t2s1if\" ; fi\n", "delta": "0:00:00.171995", "end": "2019-12-06 22:19:21.222721", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "rc": 0, "start": "2019-12-06 22:19:21.050726", "stderr": "Device \"t2ns1if\" does not exist.", "stderr_lines": ["Device \"t2ns1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip link show \"t2ns2if\" ; if [ $? -ne 0 ] ; then ip link add \"t2ns2if\" type veth peer name \"t2s2if\" ; fi\n", "delta": "0:00:00.166093", "end": "2019-12-06 22:19:21.664796", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "rc": 0, "start": "2019-12-06 22:19:21.498703", "stderr": "Device \"t2ns2if\" does not exist.", "stderr_lines": ["Device \"t2ns2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip link show \"t2ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t2ns1if\" netns \"3124\" ; fi\ndocker exec \"t2ns1\" ip link show \"t2s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t2s1if\" netns \"3751\" ; fi\n", "delta": "0:00:00.362420", "end": "2019-12-06 22:19:22.355351", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "rc": 0, "start": "2019-12-06 22:19:21.992931", "stderr": "Device \"t2ns1if\" does not exist.\nDevice \"t2s1if\" does not exist.", "stderr_lines": ["Device \"t2ns1if\" does not exist.", "Device \"t2s1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip link show \"t2ns2if\" ; if [ $? -ne 0 ] ; then ip link set \"t2ns2if\" netns \"3124\" ; fi\ndocker exec \"t2ns2\" ip link show \"t2s2if\" ; if [ $? -ne 0 ] ; then ip link set \"t2s2if\" netns \"4994\" ; fi\n", "delta": "0:00:00.375975", "end": "2019-12-06 22:19:22.983292", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "rc": 0, "start": "2019-12-06 22:19:22.607317", "stderr": "Device \"t2ns2if\" does not exist.\nDevice \"t2s2if\" does not exist.", "stderr_lines": ["Device \"t2ns2if\" does not exist.", "Device \"t2s2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip link set dev \"t2ns1if\" up\ndocker exec \"t2ns1\" ip link set dev \"t2s1if\" up\n", "delta": "0:00:00.326474", "end": "2019-12-06 22:19:23.642313", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "rc": 0, "start": "2019-12-06 22:19:23.315839", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip link set dev \"t2ns2if\" up\ndocker exec \"t2ns2\" ip link set dev \"t2s2if\" up\n", "delta": "0:00:00.320658", "end": "2019-12-06 22:19:24.239422", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "rc": 0, "start": "2019-12-06 22:19:23.918764", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip addr show \"t2s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.11.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" ip addr add \"10.2.11.2/24\" dev \"t2s1if\" ; fi\n\ndocker exec \"t2\" ip addr show \"t2ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.11.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t2\" ip addr add \"10.2.11.1/24\" dev \"t2ns1if\" ; fi\n", "delta": "0:00:00.686829", "end": "2019-12-06 22:19:25.300207", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "rc": 0, "start": "2019-12-06 22:19:24.613378", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns2\" ip addr show \"t2s2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.12.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t2ns2\" ip addr add \"10.2.12.2/24\" dev \"t2s2if\" ; fi\n\ndocker exec \"t2\" ip addr show \"t2ns2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.12.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t2\" ip addr add \"10.2.12.1/24\" dev \"t2ns2if\" ; fi\n", "delta": "0:00:00.705914", "end": "2019-12-06 22:19:26.264276", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "rc": 0, "start": "2019-12-06 22:19:25.558362", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route] *********************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'pid': u'3124', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t2\" ip route del default ; fi\n", "delta": "0:00:00.358241", "end": "2019-12-06 22:19:26.966933", "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pid": "3124", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}, "rc": 0, "start": "2019-12-06 22:19:26.608692", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.130.1', u'name': u't2', u'pns_ip': u'192.168.130.1/24', u'tenant_if': u't2if', u'pid': u'3124', u'tenant_ip': u'192.168.130.2/24', u'pns_if': u't2pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2\" ip route show default | grep -w '[d]efault via 192.168.130.1' ; if [ $? -ne 0 ] ; then docker exec \"t2\" ip route add default via \"192.168.130.1\" ; fi\n", "delta": "0:00:00.381212", "end": "2019-12-06 22:19:27.671039", "item": {"default_route_ip": "192.168.130.1", "name": "t2", "pid": "3124", "pns_if": "t2pns_if", "pns_ip": "192.168.130.1/24", "tenant_if": "t2if", "tenant_ip": "192.168.130.2/24"}, "rc": 0, "start": "2019-12-06 22:19:27.289827", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_ns_name': u't2', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'tenant_route_ip': u'192.168.130.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.2.11.0/24', u'remote_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t2ns1\" ip route del default ; fi\n", "delta": "0:00:00.375564", "end": "2019-12-06 22:19:28.385672", "item": {"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, "rc": 0, "start": "2019-12-06 22:19:28.010108", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_ns_name': u't2', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns2\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t2ns2\" ip route del default ; fi\n", "delta": "0:00:00.364242", "end": "2019-12-06 22:19:29.007296", "item": {"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 22:19:28.643054", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_ns_name': u't2', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'tenant_route_ip': u'192.168.130.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.2.11.0/24', u'remote_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip route show default | grep -w '[d]efault via 10.2.11.1' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" ip route add default via \"10.2.11.1\" ; fi\n", "delta": "0:00:00.361549", "end": "2019-12-06 22:19:29.729658", "item": {"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, "rc": 0, "start": "2019-12-06 22:19:29.368109", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_ns_name': u't2', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns2\" ip route show default | grep -w '[d]efault via 10.2.12.1' ; if [ $? -ne 0 ] ; then docker exec \"t2ns2\" ip route add default via \"10.2.12.1\" ; fi\n", "delta": "0:00:00.373235", "end": "2019-12-06 22:19:30.376777", "item": {"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 22:19:30.003542", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside namespace] ***********************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_ns_name': u't2', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_sub_if': u't2s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'tenant_route_ip': u'192.168.130.2', u'dsport': 4789, u'dev': u't2s1if', u'subnet_route': u'10.2.11.0/24', u'remote_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" brctl show | grep -w '^t2br1'; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" brctl addbr \"t2br1\" ; fi\ndocker exec \"t2ns1\" ip link set dev \"t2br1\" up\n", "delta": "0:00:00.519903", "end": "2019-12-06 22:19:31.227460", "item": {"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, "rc": 0, "start": "2019-12-06 22:19:30.707557", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_ns_name': u't2', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_sub_if': u't2s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns2\" brctl show | grep -w '^t2br2'; if [ $? -ne 0 ] ; then docker exec \"t2ns2\" brctl addbr \"t2br2\" ; fi\ndocker exec \"t2ns2\" ip link set dev \"t2br2\" up\n", "delta": "0:00:00.517540", "end": "2019-12-06 22:19:32.003909", "item": {"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 22:19:31.486369", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip link show \"t2s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" ip link add \"t2s1_dnsbrif\" type veth peer name \"t2s1_dnsif\" ; fi\ndocker exec \"t2ns1\" ip link set dev \"t2s1_dnsbrif\" up\ndocker exec \"t2ns1\" ip link set dev \"t2s1_dnsif\" up\n", "delta": "0:00:00.723834", "end": "2019-12-06 22:19:33.086828", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 22:19:32.362994", "stderr": "Device \"t2s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t2s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns2\" ip link show \"t2s2_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t2ns2\" ip link add \"t2s2_dnsbrif\" type veth peer name \"t2s2_dnsif\" ; fi\ndocker exec \"t2ns2\" ip link set dev \"t2s2_dnsbrif\" up\ndocker exec \"t2ns2\" ip link set dev \"t2s2_dnsif\" up\n", "delta": "0:00:00.669207", "end": "2019-12-06 22:19:34.024585", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 22:19:33.355378", "stderr": "Device \"t2s2_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t2s2_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" brctl show \"t2br1\" | grep -w 't2s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" brctl addif \"t2br1\" \"t2s1_dnsbrif\" ; fi\n", "delta": "0:00:00.339491", "end": "2019-12-06 22:19:34.717290", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 22:19:34.377799", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns2\" brctl show \"t2br2\" | grep -w 't2s2_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t2ns2\" brctl addif \"t2br2\" \"t2s2_dnsbrif\" ; fi\n", "delta": "0:00:00.400689", "end": "2019-12-06 22:19:35.388374", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 22:19:34.987685", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip link show \"t2br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t2C3if1\" type veth peer name \"t2br1if1\" ; fi\nip link set dev \"t2br1if1\" up\nip link set dev \"t2C3if1\" up\n", "delta": "0:00:00.190109", "end": "2019-12-06 22:19:35.947398", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "rc": 0, "start": "2019-12-06 22:19:35.757289", "stderr": "Device \"t2br1if1\" does not exist.", "stderr_lines": ["Device \"t2br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns2\" ip link show \"t2br2if1\" ; if [ $? -ne 0 ] ; then ip link add \"t2C4if1\" type veth peer name \"t2br2if1\" ; fi\nip link set dev \"t2br2if1\" up\nip link set dev \"t2C4if1\" up\n", "delta": "0:00:00.178283", "end": "2019-12-06 22:19:36.423061", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "rc": 0, "start": "2019-12-06 22:19:36.244778", "stderr": "Device \"t2br2if1\" does not exist.", "stderr_lines": ["Device \"t2br2if1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t2br1if1\" netns \"3751\" ; fi\ndocker exec \"t2ns1\" brctl show \"t2br1\" | grep -w 't2br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" brctl addif \"t2br1\" \"t2br1if1\" ; fi\n", "delta": "0:00:00.381822", "end": "2019-12-06 22:19:37.154906", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "rc": 0, "start": "2019-12-06 22:19:36.773084", "stderr": "", "stderr_lines": [], "stdout": "29: t2br1if1@t2C3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 36:99:cc:71:2a:56 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["29: t2br1if1@t2C3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 36:99:cc:71:2a:56 brd ff:ff:ff:ff:ff:ff"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2br2if1\" ; if [ $? -eq 0 ] ; then ip link set \"t2br2if1\" netns \"4994\" ; fi\ndocker exec \"t2ns2\" brctl show \"t2br2\" | grep -w 't2br2if1' ; if [ $? -ne 0 ] ; then docker exec \"t2ns2\" brctl addif \"t2br2\" \"t2br2if1\" ; fi\n", "delta": "0:00:00.389775", "end": "2019-12-06 22:19:37.801395", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "rc": 0, "start": "2019-12-06 22:19:37.411620", "stderr": "", "stderr_lines": [], "stdout": "31: t2br2if1@t2C4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 36:17:5a:76:e1:d6 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["31: t2br2if1@t2C4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 36:17:5a:76:e1:d6 brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip link set \"t2br1if1\" up\ndocker exec \"t2ns1\" ip link set dev \"t2br1\" up\n", "delta": "0:00:00.363405", "end": "2019-12-06 22:19:38.495059", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "rc": 0, "start": "2019-12-06 22:19:38.131654", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns2\" ip link set \"t2br2if1\" up\ndocker exec \"t2ns2\" ip link set dev \"t2br2\" up\n", "delta": "0:00:00.349485", "end": "2019-12-06 22:19:39.125032", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "rc": 0, "start": "2019-12-06 22:19:38.775547", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip addr show \"t2s1_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" ip addr add \"1.1.1.1/24\" dev \"t2s1_dnsif\" ; fi\n", "delta": "0:00:00.362628", "end": "2019-12-06 22:19:39.842396", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 22:19:39.479768", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns2\" ip addr show \"t2s2_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^2.2.2.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t2ns2\" ip addr add \"2.2.2.1/24\" dev \"t2s2_dnsif\" ; fi\n", "delta": "0:00:00.338256", "end": "2019-12-06 22:19:40.459630", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 22:19:40.121374", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}], u'vxlan': [{u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]}, {u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ps aux | grep -w '[d]nsmasq --interface t2s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" dnsmasq --interface \"t2s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.875223", "end": "2019-12-06 22:19:41.667334", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}], "vxlan": [{"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}]}, {"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 22:19:40.792111", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns2\" ps aux | grep -w '[d]nsmasq --interface t2s2_dnsif -z --dhcp-range=2.2.2.5,2.2.2.254' ; if [ $? -ne 0 ] ; then docker exec \"t2ns2\" dnsmasq --interface \"t2s2_dnsif\" -z --dhcp-range=2.2.2.5,'2.2.2.254' ; fi\n", "delta": "0:00:00.785355", "end": "2019-12-06 22:19:42.724703", "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 22:19:41.939348", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}]}, {u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" ip link show \"vxlan_t2s1\" ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" ip link add \"vxlan_t2s1\" type vxlan id \"42\" local \"10.2.11.2\" remote \"10.1.11.2\" dstport \"4789\" dev \"t2s1if\" ; docker exec \"t2ns1\" ip link set dev \"vxlan_t2s1\" up ; fi\n", "delta": "0:00:00.532471", "end": "2019-12-06 22:19:43.574312", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-06 22:19:43.041841", "stderr": "Device \"vxlan_t2s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t2s1\" does not exist."], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}]}, {u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t2ns1\" brctl show \"t2br1\" | grep -w 'vxlan_t2s1' ; if [ $? -ne 0 ] ; then docker exec \"t2ns1\" brctl addif \"t2br1\" \"vxlan_t2s1\" ; fi\n", "delta": "0:00:00.355181", "end": "2019-12-06 22:19:44.271651", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-06 22:19:43.916470", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}]}, {u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip route show \"10.1.11.0/24\" via \"192.168.2.2\" | grep -w '^10.1.11.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip route add \"10.1.11.0/24\" via \"192.168.2.2\" ; fi\n", "delta": "0:00:00.079293", "end": "2019-12-06 22:19:45.562039", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-06 22:19:45.482746", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": "ip netns exec pns1 ip addr show p11 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.045497", "end": "2019-12-06 22:19:45.822502", "rc": 0, "start": "2019-12-06 22:19:45.777005", "stderr": "", "stderr_lines": [], "stdout": "192.168.200.207", "stdout_lines": ["192.168.200.207"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.1.11.1', u'pid': u'13611', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13008', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.1.11.2/24', u'tenant_ns_ip': u'10.1.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C1if1', u'name': u't2_C1'}, {u'brif': u't2br1if2', u'vmif': u't2C2if1', u'name': u't2_C2'}]}, {u'local_ip': u'10.1.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.2.2', u'remote_route': u'10.2.11.0/24', u'subnet_route': u'10.1.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.2.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.1.11.0/24\" via \"192.168.200.207\" | grep -w '^10.1.11.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.1.11.0/24\" via \"192.168.200.207\" ; fi\nip route show \"10.2.11.0/24\" via 99.99.99.2 | grep -w '^10.2.11.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.2.11.0/24\" via 99.99.99.2 ; fi\n", "delta": "0:00:00.009785", "end": "2019-12-06 22:19:46.084449", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.1.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "13611", "route": [{"if": "p1", "ip": "10.1.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.1.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "13008", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.1.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C1", "vmif": "t2C1if1"}, {"brif": "t2br1if2", "name": "t2_C2", "vmif": "t2C2if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.11.2", "remote_ip": "10.2.11.2", "remote_route": "10.2.11.0/24", "subnet_route": "10.1.11.0/24", "tenant_route_ip": "192.168.2.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-06 22:19:46.074664", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}]}, {u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip route show \"10.2.11.0/24\" via \"192.168.130.2\" | grep -w '^10.2.11.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip route add \"10.2.11.0/24\" via \"192.168.130.2\" ; fi\n", "delta": "0:00:00.069452", "end": "2019-12-06 22:19:47.302980", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-06 22:19:47.233528", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": "ip netns exec pns1 ip addr show p11 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.044436", "end": "2019-12-06 22:19:47.658846", "rc": 0, "start": "2019-12-06 22:19:47.614410", "stderr": "", "stderr_lines": [], "stdout": "192.168.200.5", "stdout_lines": ["192.168.200.5"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.11.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.11.1', u'pid': u'3751', u'bridge_name': u't2br1', u'dns': [{u'dnsif': u't2s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s1_dnsbrif'}], u'ns_name': u't2ns1', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s1if', u'tenant_sub_ip': u'10.2.11.2/24', u'tenant_ns_ip': u'10.2.11.1/24', u'tenant_ns_if': u't2ns1if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't2br1if1', u'vmif': u't2C3if1', u'name': u't2_C3'}]}, {u'local_ip': u'10.2.11.2', u'dsport': 4789, u'dev': u't2s1if', u'tenant_route_ip': u'192.168.130.2', u'remote_route': u'10.1.11.0/24', u'subnet_route': u'10.2.11.0/24', u'v_name': u'vxlan_t2s1', u'id': 42, u'remote_ip': u'10.1.11.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.2.11.0/24\" via \"192.168.200.5\" | grep -w '^10.2.11.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.2.11.0/24\" via \"192.168.200.5\" ; fi\nip route show \"10.1.11.0/24\" via 99.99.99.1 | grep -w '^10.1.11.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.1.11.0/24\" via 99.99.99.1 ; fi\n", "delta": "0:00:00.008807", "end": "2019-12-06 22:19:48.018677", "item": [{"bridge_name": "t2br1", "default_route_ip": "10.2.11.1", "dns": [{"brif": "t2s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t2s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns1", "pid": "3751", "route": [{"if": "p1", "ip": "10.2.11.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns1if", "tenant_ns_ip": "10.2.11.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s1if", "tenant_sub_ip": "10.2.11.2/24"}], "vms": [{"brif": "t2br1if1", "name": "t2_C3", "vmif": "t2C3if1"}]}, {"dev": "t2s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.11.2", "remote_ip": "10.1.11.2", "remote_route": "10.1.11.0/24", "subnet_route": "10.2.11.0/24", "tenant_route_ip": "192.168.130.2", "v_name": "vxlan_t2s1"}], "rc": 0, "start": "2019-12-06 22:19:48.009870", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.12.1/24', u'ns_name': u't2', u'ns_if': u't2if', u'if': u'p1'}], u'default_route_ip': u'10.2.12.1', u'pid': u'4994', u'bridge_name': u't2br2', u'dns': [{u'dnsif': u't2s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't2s2_dnsbrif'}], u'ns_name': u't2ns2', u'tenant_ns': [{u'tenant_ns_pid': u'3124', u'tenant_sub_if': u't2s2if', u'tenant_sub_ip': u'10.2.12.2/24', u'tenant_ns_ip': u'10.2.12.1/24', u'tenant_ns_if': u't2ns2if', u'tenant_ns_name': u't2'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't2br2if1', u'vmif': u't2C4if1', u'name': u't2_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t2br2", "default_route_ip": "10.2.12.1", "dns": [{"brif": "t2s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t2s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t2ns2", "pid": "4994", "route": [{"if": "p1", "ip": "10.2.12.1/24", "ns_if": "t2if", "ns_name": "t2"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t2ns2if", "tenant_ns_ip": "10.2.12.1/24", "tenant_ns_name": "t2", "tenant_ns_pid": "3124", "tenant_sub_if": "t2s2if", "tenant_sub_ip": "10.2.12.2/24"}], "vms": [{"brif": "t2br2if1", "name": "t2_C4", "vmif": "t2C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 23:18:15.434973 Printing the yaml input file
INFO:root: 23:18:15.435181 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 23:18:15.435326 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 23:18:15.435382 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 23:18:15.435425 Provided subnet in C2: 2.2.2.0/24 is valid
INFO:root: 23:18:15.463675 Printing the yaml input file
INFO:root: 23:18:15.463851 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 23:18:15.463991 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 23:18:15.464059 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 23:18:15.464137 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
INFO:root: 23:19:44.063840 Printing the yaml input file
INFO:root: 23:19:44.064018 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 23:19:44.064127 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 23:19:44.064192 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 23:19:44.064434 Provided subnet in C2: 2.2.2.0/24 is valid
changed: [localhost] => {"actions": ["Built image centos7:latest from ./"], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": true, "image": {"Architecture": "amd64", "Author": "Prashanth_M", "Comment": "", "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "", "Image": "sha256:bc1779d531b38facc87816ccaa32f4f59230b212ee9360d26099c13b5de92722", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Container": "62c79c3739b456f8ba3a5fce7a373a6aa3695c9df8fec23435586214c4d1544f", "ContainerConfig": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/bin/sh", "-c", "#(nop) ", "CMD [\"/usr/sbin/init\"]"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "62c79c3739b4", "Image": "sha256:bc1779d531b38facc87816ccaa32f4f59230b212ee9360d26099c13b5de92722", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:20:57.083794585Z", "DockerVersion": "19.03.5", "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/merged", "UpperDir": "/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff", "WorkDir": "/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/work"}, "Name": "overlay2"}, "Id": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "Metadata": {"LastTagTime": "2019-12-06T23:20:57.120035436Z"}, "Os": "linux", "Parent": "sha256:bc1779d531b38facc87816ccaa32f4f59230b212ee9360d26099c13b5de92722", "RepoDigests": [], "RepoTags": ["centos7:latest"], "RootFS": {"Layers": ["sha256:77b174a6a187b610e4699546bd973a8d1e77663796e3724318a2a4b24cb07ea0", "sha256:e676031558188991d46469996bd0216feae9b9d63bb0f0dcf972ecfae9d04e95", "sha256:1758c12f997d310bce8a408d41e4798a649d82fb8c25cb7e91eba08a89c9f405", "sha256:82fa9e2e8b51a69ad75382b15cd42d676de40fc97fcb436aeff834df8e6d0366"], "Type": "layers"}, "Size": 366801034, "VirtualSize": 366801034}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.3.1', u'name': u't3', u'pns_ip': u'192.168.3.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.3.2/24', u'pns_if': u't3pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:20:57.83229221Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/7fc87fcacd686181d3f912194a4884786259643e0e3b00f70bddb4fb1cc27f2b-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/7fc87fcacd686181d3f912194a4884786259643e0e3b00f70bddb4fb1cc27f2b/merged", "UpperDir": "/var/lib/docker/overlay2/7fc87fcacd686181d3f912194a4884786259643e0e3b00f70bddb4fb1cc27f2b/diff", "WorkDir": "/var/lib/docker/overlay2/7fc87fcacd686181d3f912194a4884786259643e0e3b00f70bddb4fb1cc27f2b/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/0082f04b18b77800c901c0397116f27e7b02b6801e67fc9f2197648f4c096f7b/hostname", "HostsPath": "/var/lib/docker/containers/0082f04b18b77800c901c0397116f27e7b02b6801e67fc9f2197648f4c096f7b/hosts", "Id": "0082f04b18b77800c901c0397116f27e7b02b6801e67fc9f2197648f4c096f7b", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/0082f04b18b77800c901c0397116f27e7b02b6801e67fc9f2197648f4c096f7b/0082f04b18b77800c901c0397116f27e7b02b6801e67fc9f2197648f4c096f7b-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "234548102f7d9187ceb60695736702c845b2e09d8a38e15d01f44ae521b7de25", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/234548102f7d9187ceb60695736702c845b2e09d8a38e15d01f44ae521b7de25/_data", "Type": "volume"}], "Name": "/t3", "NetworkSettings": {"Bridge": "", "EndpointID": "01096555bd56504f7d1e2e42a25f0a60d83e442bea301933d6eb5e26ffd42eef", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "01096555bd56504f7d1e2e42a25f0a60d83e442bea301933d6eb5e26ffd42eef", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "a74b67a6b0f9d379814283b93162da43a1549f6e0ccc098d428c2c9616617259", "SandboxKey": "/var/run/docker/netns/a74b67a6b0f9", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/0082f04b18b77800c901c0397116f27e7b02b6801e67fc9f2197648f4c096f7b/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 18329, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:20:58.361176217Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:20:57.83229221Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/7fc87fcacd686181d3f912194a4884786259643e0e3b00f70bddb4fb1cc27f2b-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/7fc87fcacd686181d3f912194a4884786259643e0e3b00f70bddb4fb1cc27f2b/merged", "UpperDir": "/var/lib/docker/overlay2/7fc87fcacd686181d3f912194a4884786259643e0e3b00f70bddb4fb1cc27f2b/diff", "WorkDir": "/var/lib/docker/overlay2/7fc87fcacd686181d3f912194a4884786259643e0e3b00f70bddb4fb1cc27f2b/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/0082f04b18b77800c901c0397116f27e7b02b6801e67fc9f2197648f4c096f7b/hostname", "HostsPath": "/var/lib/docker/containers/0082f04b18b77800c901c0397116f27e7b02b6801e67fc9f2197648f4c096f7b/hosts", "Id": "0082f04b18b77800c901c0397116f27e7b02b6801e67fc9f2197648f4c096f7b", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/0082f04b18b77800c901c0397116f27e7b02b6801e67fc9f2197648f4c096f7b/0082f04b18b77800c901c0397116f27e7b02b6801e67fc9f2197648f4c096f7b-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "234548102f7d9187ceb60695736702c845b2e09d8a38e15d01f44ae521b7de25", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/234548102f7d9187ceb60695736702c845b2e09d8a38e15d01f44ae521b7de25/_data", "Type": "volume"}], "Name": "/t3", "NetworkSettings": {"Bridge": "", "EndpointID": "01096555bd56504f7d1e2e42a25f0a60d83e442bea301933d6eb5e26ffd42eef", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "01096555bd56504f7d1e2e42a25f0a60d83e442bea301933d6eb5e26ffd42eef", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "a74b67a6b0f9d379814283b93162da43a1549f6e0ccc098d428c2c9616617259", "SandboxKey": "/var/run/docker/netns/a74b67a6b0f9", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/0082f04b18b77800c901c0397116f27e7b02b6801e67fc9f2197648f4c096f7b/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 18329, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:20:58.361176217Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.3.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.3.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.3.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'tenant_route_ip': u'192.168.3.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.1.21.0/24', u'remote_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:20:58.875555695Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/0a4d0134ed76978ea163199ad3ac3b9bf72c8997ea127058f48d7947dbcfb62d-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/0a4d0134ed76978ea163199ad3ac3b9bf72c8997ea127058f48d7947dbcfb62d/merged", "UpperDir": "/var/lib/docker/overlay2/0a4d0134ed76978ea163199ad3ac3b9bf72c8997ea127058f48d7947dbcfb62d/diff", "WorkDir": "/var/lib/docker/overlay2/0a4d0134ed76978ea163199ad3ac3b9bf72c8997ea127058f48d7947dbcfb62d/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/9dc81fe010e1511d0321f6c29b1f52009e7ac9850215ea39a793b3e03696c376/hostname", "HostsPath": "/var/lib/docker/containers/9dc81fe010e1511d0321f6c29b1f52009e7ac9850215ea39a793b3e03696c376/hosts", "Id": "9dc81fe010e1511d0321f6c29b1f52009e7ac9850215ea39a793b3e03696c376", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/9dc81fe010e1511d0321f6c29b1f52009e7ac9850215ea39a793b3e03696c376/9dc81fe010e1511d0321f6c29b1f52009e7ac9850215ea39a793b3e03696c376-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "295b34b462a7a2599506667e40bc6cb29069ea587cf716f725ca74aff1bf6039", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/295b34b462a7a2599506667e40bc6cb29069ea587cf716f725ca74aff1bf6039/_data", "Type": "volume"}], "Name": "/t3ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "cb9bf40664400e1a29cbbcdc3087d26a79a888100ca49895207cb12442750b72", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "cb9bf40664400e1a29cbbcdc3087d26a79a888100ca49895207cb12442750b72", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "51e8ba81eeeafe14c09009da85bda974d114294225ea59a629469b7c2c5523b6", "SandboxKey": "/var/run/docker/netns/51e8ba81eeea", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/9dc81fe010e1511d0321f6c29b1f52009e7ac9850215ea39a793b3e03696c376/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 18941, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:20:59.535471194Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:20:58.875555695Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/0a4d0134ed76978ea163199ad3ac3b9bf72c8997ea127058f48d7947dbcfb62d-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/0a4d0134ed76978ea163199ad3ac3b9bf72c8997ea127058f48d7947dbcfb62d/merged", "UpperDir": "/var/lib/docker/overlay2/0a4d0134ed76978ea163199ad3ac3b9bf72c8997ea127058f48d7947dbcfb62d/diff", "WorkDir": "/var/lib/docker/overlay2/0a4d0134ed76978ea163199ad3ac3b9bf72c8997ea127058f48d7947dbcfb62d/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/9dc81fe010e1511d0321f6c29b1f52009e7ac9850215ea39a793b3e03696c376/hostname", "HostsPath": "/var/lib/docker/containers/9dc81fe010e1511d0321f6c29b1f52009e7ac9850215ea39a793b3e03696c376/hosts", "Id": "9dc81fe010e1511d0321f6c29b1f52009e7ac9850215ea39a793b3e03696c376", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/9dc81fe010e1511d0321f6c29b1f52009e7ac9850215ea39a793b3e03696c376/9dc81fe010e1511d0321f6c29b1f52009e7ac9850215ea39a793b3e03696c376-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "295b34b462a7a2599506667e40bc6cb29069ea587cf716f725ca74aff1bf6039", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/295b34b462a7a2599506667e40bc6cb29069ea587cf716f725ca74aff1bf6039/_data", "Type": "volume"}], "Name": "/t3ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "cb9bf40664400e1a29cbbcdc3087d26a79a888100ca49895207cb12442750b72", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "cb9bf40664400e1a29cbbcdc3087d26a79a888100ca49895207cb12442750b72", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "51e8ba81eeeafe14c09009da85bda974d114294225ea59a629469b7c2c5523b6", "SandboxKey": "/var/run/docker/netns/51e8ba81eeea", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/9dc81fe010e1511d0321f6c29b1f52009e7ac9850215ea39a793b3e03696c376/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 18941, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:20:59.535471194Z", "Status": "running"}}, "item": {"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vmif": "t3C2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
INFO:root: 23:21:29.593553 Printing the yaml input file
INFO:root: 23:21:29.593688 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 23:21:29.593788 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 23:21:29.593840 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 23:21:29.593894 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:21:31.579416019Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf/merged", "UpperDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf/diff", "WorkDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/hostname", "HostsPath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/hosts", "Id": "bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "46ecbf9850aef3bb9dc4eda61aed4cc599eae7634573747b97c38496d9f73bd5", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/46ecbf9850aef3bb9dc4eda61aed4cc599eae7634573747b97c38496d9f73bd5/_data", "Type": "volume"}], "Name": "/t5", "NetworkSettings": {"Bridge": "", "EndpointID": "f273a7d6fc912f03ae79096b9850084d60522325f8dbe8cca40531cdfdf15be9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "f273a7d6fc912f03ae79096b9850084d60522325f8dbe8cca40531cdfdf15be9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "465418fd411c7711c7beb56613a1637dcda79e5201340d409019a447c0550b11", "SandboxKey": "/var/run/docker/netns/465418fd411c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 20484, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:21:32.080693846Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:21:31.579416019Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf/merged", "UpperDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf/diff", "WorkDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/hostname", "HostsPath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/hosts", "Id": "bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "46ecbf9850aef3bb9dc4eda61aed4cc599eae7634573747b97c38496d9f73bd5", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/46ecbf9850aef3bb9dc4eda61aed4cc599eae7634573747b97c38496d9f73bd5/_data", "Type": "volume"}], "Name": "/t5", "NetworkSettings": {"Bridge": "", "EndpointID": "f273a7d6fc912f03ae79096b9850084d60522325f8dbe8cca40531cdfdf15be9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "f273a7d6fc912f03ae79096b9850084d60522325f8dbe8cca40531cdfdf15be9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "465418fd411c7711c7beb56613a1637dcda79e5201340d409019a447c0550b11", "SandboxKey": "/var/run/docker/netns/465418fd411c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 20484, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:21:32.080693846Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'tenant_route_ip': u'192.168.5.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.1.41.0/24', u'remote_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:21:32.631591395Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8/merged", "UpperDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8/diff", "WorkDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/hostname", "HostsPath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/hosts", "Id": "127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "c4f7c8a05d82c2c7c64237006ee6452403e4c9b2c952244a3fed8c0bb0db6e8d", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/c4f7c8a05d82c2c7c64237006ee6452403e4c9b2c952244a3fed8c0bb0db6e8d/_data", "Type": "volume"}], "Name": "/t5ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "1bad37271fb04f9606ed710ce1f0117ad401ec8887e1b39da6dda9b464e005c8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "1bad37271fb04f9606ed710ce1f0117ad401ec8887e1b39da6dda9b464e005c8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "861a74b36197d918bbdc34d7320511875474fe458a730b0201c6f84fd9409a49", "SandboxKey": "/var/run/docker/netns/861a74b36197", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 21100, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:21:33.515535762Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:21:32.631591395Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8/merged", "UpperDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8/diff", "WorkDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/hostname", "HostsPath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/hosts", "Id": "127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "c4f7c8a05d82c2c7c64237006ee6452403e4c9b2c952244a3fed8c0bb0db6e8d", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/c4f7c8a05d82c2c7c64237006ee6452403e4c9b2c952244a3fed8c0bb0db6e8d/_data", "Type": "volume"}], "Name": "/t5ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "1bad37271fb04f9606ed710ce1f0117ad401ec8887e1b39da6dda9b464e005c8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "1bad37271fb04f9606ed710ce1f0117ad401ec8887e1b39da6dda9b464e005c8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "861a74b36197d918bbdc34d7320511875474fe458a730b0201c6f84fd9409a49", "SandboxKey": "/var/run/docker/netns/861a74b36197", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 21100, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:21:33.515535762Z", "Status": "running"}}, "item": {"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
changed: [99.99.99.2] => {"actions": ["Built image centos7:latest from /root"], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": true, "image": {"Architecture": "amd64", "Author": "Prashanth_Mallayampatti", "Comment": "", "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "", "Image": "sha256:45acccd0193269523ac3c05e7e3cc2ed8cef1eef86c85adee72c3e40fc3a8b45", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Container": "88d7514ffae039bfeaf54aa75692c9d67ac8eaf46f2c61fd81545d63fdc063c0", "ContainerConfig": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/bin/sh", "-c", "#(nop) ", "CMD [\"/usr/sbin/init\"]"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "88d7514ffae0", "Image": "sha256:45acccd0193269523ac3c05e7e3cc2ed8cef1eef86c85adee72c3e40fc3a8b45", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:33:06.861190767Z", "DockerVersion": "19.03.5", "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/7b0cdb08294f5795adb55c01424d963e1c058c3a40cf48ab65947aabe007fc35/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/72bcbedaa001e03f14b06d9003dd7ebb62aa89cd44115578cdb03be000ed2986/merged", "UpperDir": "/var/lib/docker/overlay2/72bcbedaa001e03f14b06d9003dd7ebb62aa89cd44115578cdb03be000ed2986/diff", "WorkDir": "/var/lib/docker/overlay2/72bcbedaa001e03f14b06d9003dd7ebb62aa89cd44115578cdb03be000ed2986/work"}, "Name": "overlay2"}, "Id": "sha256:b57ecf607c9f147db9dc22979a367cd36485427bfadc25c847cbce99ef14c160", "Metadata": {"LastTagTime": "2019-12-06T23:33:07.058218823Z"}, "Os": "linux", "Parent": "sha256:45acccd0193269523ac3c05e7e3cc2ed8cef1eef86c85adee72c3e40fc3a8b45", "RepoDigests": [], "RepoTags": ["centos7:latest"], "RootFS": {"Layers": ["sha256:77b174a6a187b610e4699546bd973a8d1e77663796e3724318a2a4b24cb07ea0", "sha256:3dec159da41d5cce0d24fc3acbe61037ad62d6a0952a43e5dcb27f89aaf42efd", "sha256:a6495d56ea3a912998d79cbe4917488e8b62e5d0cf29005561ed705848b1db90", "sha256:0834547033f5c8f0949a897dc8b5a927d3b11bcbaa2ca24fee151134136ff9fd"], "Type": "layers"}, "Size": 366803263, "VirtualSize": 366803263}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.133.1', u'name': u't5', u'pns_ip': u'192.168.133.1/24', u'tenant_if': u't5if', u'tenant_ip': u'192.168.133.2/24', u'pns_if': u't5pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:33:09.085654698Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/b59af99a6175e104ce7bd5c5a8352751e7dbb1e06acc22d32d6df781338cea4e-init/diff:/var/lib/docker/overlay2/72bcbedaa001e03f14b06d9003dd7ebb62aa89cd44115578cdb03be000ed2986/diff:/var/lib/docker/overlay2/7b0cdb08294f5795adb55c01424d963e1c058c3a40cf48ab65947aabe007fc35/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/b59af99a6175e104ce7bd5c5a8352751e7dbb1e06acc22d32d6df781338cea4e/merged", "UpperDir": "/var/lib/docker/overlay2/b59af99a6175e104ce7bd5c5a8352751e7dbb1e06acc22d32d6df781338cea4e/diff", "WorkDir": "/var/lib/docker/overlay2/b59af99a6175e104ce7bd5c5a8352751e7dbb1e06acc22d32d6df781338cea4e/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/3c7ac77748e86791617a3fec689a0eea674888cea493015881c3febac0161c4f/hostname", "HostsPath": "/var/lib/docker/containers/3c7ac77748e86791617a3fec689a0eea674888cea493015881c3febac0161c4f/hosts", "Id": "3c7ac77748e86791617a3fec689a0eea674888cea493015881c3febac0161c4f", "Image": "sha256:b57ecf607c9f147db9dc22979a367cd36485427bfadc25c847cbce99ef14c160", "LogPath": "/var/lib/docker/containers/3c7ac77748e86791617a3fec689a0eea674888cea493015881c3febac0161c4f/3c7ac77748e86791617a3fec689a0eea674888cea493015881c3febac0161c4f-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "628ee284dce4b2922460e32f79da2ba9e29591046dbc2b578f2550520a1c931d", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/628ee284dce4b2922460e32f79da2ba9e29591046dbc2b578f2550520a1c931d/_data", "Type": "volume"}], "Name": "/t5", "NetworkSettings": {"Bridge": "", "EndpointID": "77e65c7358c60d2d525785f28941efe33b5a2f732b1d7b7e7bf663dad0d04297", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "77e65c7358c60d2d525785f28941efe33b5a2f732b1d7b7e7bf663dad0d04297", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "7237083195e85894a079d1e430de02164936c9359627a606cf91b1ee31ef2cae", "SandboxKey": "/var/run/docker/netns/7237083195e8", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/3c7ac77748e86791617a3fec689a0eea674888cea493015881c3febac0161c4f/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 17607, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:33:09.670102858Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:33:09.085654698Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/b59af99a6175e104ce7bd5c5a8352751e7dbb1e06acc22d32d6df781338cea4e-init/diff:/var/lib/docker/overlay2/72bcbedaa001e03f14b06d9003dd7ebb62aa89cd44115578cdb03be000ed2986/diff:/var/lib/docker/overlay2/7b0cdb08294f5795adb55c01424d963e1c058c3a40cf48ab65947aabe007fc35/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/b59af99a6175e104ce7bd5c5a8352751e7dbb1e06acc22d32d6df781338cea4e/merged", "UpperDir": "/var/lib/docker/overlay2/b59af99a6175e104ce7bd5c5a8352751e7dbb1e06acc22d32d6df781338cea4e/diff", "WorkDir": "/var/lib/docker/overlay2/b59af99a6175e104ce7bd5c5a8352751e7dbb1e06acc22d32d6df781338cea4e/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/3c7ac77748e86791617a3fec689a0eea674888cea493015881c3febac0161c4f/hostname", "HostsPath": "/var/lib/docker/containers/3c7ac77748e86791617a3fec689a0eea674888cea493015881c3febac0161c4f/hosts", "Id": "3c7ac77748e86791617a3fec689a0eea674888cea493015881c3febac0161c4f", "Image": "sha256:b57ecf607c9f147db9dc22979a367cd36485427bfadc25c847cbce99ef14c160", "LogPath": "/var/lib/docker/containers/3c7ac77748e86791617a3fec689a0eea674888cea493015881c3febac0161c4f/3c7ac77748e86791617a3fec689a0eea674888cea493015881c3febac0161c4f-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "628ee284dce4b2922460e32f79da2ba9e29591046dbc2b578f2550520a1c931d", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/628ee284dce4b2922460e32f79da2ba9e29591046dbc2b578f2550520a1c931d/_data", "Type": "volume"}], "Name": "/t5", "NetworkSettings": {"Bridge": "", "EndpointID": "77e65c7358c60d2d525785f28941efe33b5a2f732b1d7b7e7bf663dad0d04297", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "77e65c7358c60d2d525785f28941efe33b5a2f732b1d7b7e7bf663dad0d04297", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "7237083195e85894a079d1e430de02164936c9359627a606cf91b1ee31ef2cae", "SandboxKey": "/var/run/docker/netns/7237083195e8", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/3c7ac77748e86791617a3fec689a0eea674888cea493015881c3febac0161c4f/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 17607, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:33:09.670102858Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.133.1", "name": "t5", "pns_if": "t5pns_if", "pns_ip": "192.168.133.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.133.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'tenant_route_ip': u'192.168.133.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.2.41.0/24', u'remote_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:33:10.598257595Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/d28ce2a7265e98d2f4960dd2cd2c857be8ebee4057aa36605e1210247a3eeeb1-init/diff:/var/lib/docker/overlay2/72bcbedaa001e03f14b06d9003dd7ebb62aa89cd44115578cdb03be000ed2986/diff:/var/lib/docker/overlay2/7b0cdb08294f5795adb55c01424d963e1c058c3a40cf48ab65947aabe007fc35/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/d28ce2a7265e98d2f4960dd2cd2c857be8ebee4057aa36605e1210247a3eeeb1/merged", "UpperDir": "/var/lib/docker/overlay2/d28ce2a7265e98d2f4960dd2cd2c857be8ebee4057aa36605e1210247a3eeeb1/diff", "WorkDir": "/var/lib/docker/overlay2/d28ce2a7265e98d2f4960dd2cd2c857be8ebee4057aa36605e1210247a3eeeb1/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4b2d921ca39a9b8bc93ab48bfd67408295a6817b815d7c6a1dac70c3cb940e2c/hostname", "HostsPath": "/var/lib/docker/containers/4b2d921ca39a9b8bc93ab48bfd67408295a6817b815d7c6a1dac70c3cb940e2c/hosts", "Id": "4b2d921ca39a9b8bc93ab48bfd67408295a6817b815d7c6a1dac70c3cb940e2c", "Image": "sha256:b57ecf607c9f147db9dc22979a367cd36485427bfadc25c847cbce99ef14c160", "LogPath": "/var/lib/docker/containers/4b2d921ca39a9b8bc93ab48bfd67408295a6817b815d7c6a1dac70c3cb940e2c/4b2d921ca39a9b8bc93ab48bfd67408295a6817b815d7c6a1dac70c3cb940e2c-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "d2b7db089c348b49d14f3dfe33be887f695e5bd5afe5b89f2d6ce0017fb82c32", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/d2b7db089c348b49d14f3dfe33be887f695e5bd5afe5b89f2d6ce0017fb82c32/_data", "Type": "volume"}], "Name": "/t5ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d323a67928c69710180f8600b32168a0464c912704facefba0a039221cf2e1c0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d323a67928c69710180f8600b32168a0464c912704facefba0a039221cf2e1c0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "f4193ad66374792a9670c6b5de05be67a971d8d92a0ca35ade73a99d9301be7a", "SandboxKey": "/var/run/docker/netns/f4193ad66374", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4b2d921ca39a9b8bc93ab48bfd67408295a6817b815d7c6a1dac70c3cb940e2c/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 18346, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:33:11.160857487Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:33:10.598257595Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/d28ce2a7265e98d2f4960dd2cd2c857be8ebee4057aa36605e1210247a3eeeb1-init/diff:/var/lib/docker/overlay2/72bcbedaa001e03f14b06d9003dd7ebb62aa89cd44115578cdb03be000ed2986/diff:/var/lib/docker/overlay2/7b0cdb08294f5795adb55c01424d963e1c058c3a40cf48ab65947aabe007fc35/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/d28ce2a7265e98d2f4960dd2cd2c857be8ebee4057aa36605e1210247a3eeeb1/merged", "UpperDir": "/var/lib/docker/overlay2/d28ce2a7265e98d2f4960dd2cd2c857be8ebee4057aa36605e1210247a3eeeb1/diff", "WorkDir": "/var/lib/docker/overlay2/d28ce2a7265e98d2f4960dd2cd2c857be8ebee4057aa36605e1210247a3eeeb1/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/4b2d921ca39a9b8bc93ab48bfd67408295a6817b815d7c6a1dac70c3cb940e2c/hostname", "HostsPath": "/var/lib/docker/containers/4b2d921ca39a9b8bc93ab48bfd67408295a6817b815d7c6a1dac70c3cb940e2c/hosts", "Id": "4b2d921ca39a9b8bc93ab48bfd67408295a6817b815d7c6a1dac70c3cb940e2c", "Image": "sha256:b57ecf607c9f147db9dc22979a367cd36485427bfadc25c847cbce99ef14c160", "LogPath": "/var/lib/docker/containers/4b2d921ca39a9b8bc93ab48bfd67408295a6817b815d7c6a1dac70c3cb940e2c/4b2d921ca39a9b8bc93ab48bfd67408295a6817b815d7c6a1dac70c3cb940e2c-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "d2b7db089c348b49d14f3dfe33be887f695e5bd5afe5b89f2d6ce0017fb82c32", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/d2b7db089c348b49d14f3dfe33be887f695e5bd5afe5b89f2d6ce0017fb82c32/_data", "Type": "volume"}], "Name": "/t5ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "d323a67928c69710180f8600b32168a0464c912704facefba0a039221cf2e1c0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "d323a67928c69710180f8600b32168a0464c912704facefba0a039221cf2e1c0", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "f4193ad66374792a9670c6b5de05be67a971d8d92a0ca35ade73a99d9301be7a", "SandboxKey": "/var/run/docker/netns/f4193ad66374", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/4b2d921ca39a9b8bc93ab48bfd67408295a6817b815d7c6a1dac70c3cb940e2c/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 18346, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:33:11.160857487Z", "Status": "running"}}, "item": {"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}}
changed: [99.99.99.2] => {"actions": ["Built image centos7:latest from /root"], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": true, "image": {"Architecture": "amd64", "Author": "Prashanth_Mallayampatti", "Comment": "", "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "", "Image": "sha256:35a11dda3126d437cf1ad048980ef594c42eb6bbc4b8760c0b7161f23bb7cfc0", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Container": "e61623c46b1af360122a517ea72c3fdc225c927b1d917692ce081d6a434e2861", "ContainerConfig": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/bin/sh", "-c", "#(nop) ", "CMD [\"/usr/sbin/init\"]"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "e61623c46b1a", "Image": "sha256:35a11dda3126d437cf1ad048980ef594c42eb6bbc4b8760c0b7161f23bb7cfc0", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:33:10.680821307Z", "DockerVersion": "19.03.5", "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/merged", "UpperDir": "/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff", "WorkDir": "/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/work"}, "Name": "overlay2"}, "Id": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "Metadata": {"LastTagTime": "2019-12-06T23:33:12.534679265Z"}, "Os": "linux", "Parent": "sha256:35a11dda3126d437cf1ad048980ef594c42eb6bbc4b8760c0b7161f23bb7cfc0", "RepoDigests": [], "RepoTags": ["centos7:latest"], "RootFS": {"Layers": ["sha256:77b174a6a187b610e4699546bd973a8d1e77663796e3724318a2a4b24cb07ea0", "sha256:3dec159da41d5cce0d24fc3acbe61037ad62d6a0952a43e5dcb27f89aaf42efd", "sha256:35f74557994a0267645593f0d8797be5c5d0503c88bdeba93af5d82320489a28", "sha256:46e885ee1b591d18a3574b149691fee0c38c7fee98d8d1472cb0bff65fc570f3"], "Type": "layers"}, "Size": 366803144, "VirtualSize": 366803144}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5', u'tenant_sub_if': u't5s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:33:12.112531225Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/abfa883496abf4a13f712f9a7d6a52a9b1e397a3e24f77587e9ff164b6a7ea6f-init/diff:/var/lib/docker/overlay2/72bcbedaa001e03f14b06d9003dd7ebb62aa89cd44115578cdb03be000ed2986/diff:/var/lib/docker/overlay2/7b0cdb08294f5795adb55c01424d963e1c058c3a40cf48ab65947aabe007fc35/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/abfa883496abf4a13f712f9a7d6a52a9b1e397a3e24f77587e9ff164b6a7ea6f/merged", "UpperDir": "/var/lib/docker/overlay2/abfa883496abf4a13f712f9a7d6a52a9b1e397a3e24f77587e9ff164b6a7ea6f/diff", "WorkDir": "/var/lib/docker/overlay2/abfa883496abf4a13f712f9a7d6a52a9b1e397a3e24f77587e9ff164b6a7ea6f/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/e581bcde65018b3d44364250a09fcd8c8f4f373dcea15e083dfd125a1e131c91/hostname", "HostsPath": "/var/lib/docker/containers/e581bcde65018b3d44364250a09fcd8c8f4f373dcea15e083dfd125a1e131c91/hosts", "Id": "e581bcde65018b3d44364250a09fcd8c8f4f373dcea15e083dfd125a1e131c91", "Image": "sha256:b57ecf607c9f147db9dc22979a367cd36485427bfadc25c847cbce99ef14c160", "LogPath": "/var/lib/docker/containers/e581bcde65018b3d44364250a09fcd8c8f4f373dcea15e083dfd125a1e131c91/e581bcde65018b3d44364250a09fcd8c8f4f373dcea15e083dfd125a1e131c91-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "3f5c8b2c480856f9b0cb93c0644f246742b887750d2803f0839ebb3f95bdcf01", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/3f5c8b2c480856f9b0cb93c0644f246742b887750d2803f0839ebb3f95bdcf01/_data", "Type": "volume"}], "Name": "/t5ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "4850f7bdf4920e57cb4e277e047192553c0e91c03d77c2fbecc75faacd3f6630", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "4850f7bdf4920e57cb4e277e047192553c0e91c03d77c2fbecc75faacd3f6630", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "9862bf32f9f28d6af199096661a00ded9fbc4c6386016444c2a29ea3ce59f7d2", "SandboxKey": "/var/run/docker/netns/9862bf32f9f2", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/e581bcde65018b3d44364250a09fcd8c8f4f373dcea15e083dfd125a1e131c91/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 19475, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:33:12.767470128Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:33:12.112531225Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/abfa883496abf4a13f712f9a7d6a52a9b1e397a3e24f77587e9ff164b6a7ea6f-init/diff:/var/lib/docker/overlay2/72bcbedaa001e03f14b06d9003dd7ebb62aa89cd44115578cdb03be000ed2986/diff:/var/lib/docker/overlay2/7b0cdb08294f5795adb55c01424d963e1c058c3a40cf48ab65947aabe007fc35/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/abfa883496abf4a13f712f9a7d6a52a9b1e397a3e24f77587e9ff164b6a7ea6f/merged", "UpperDir": "/var/lib/docker/overlay2/abfa883496abf4a13f712f9a7d6a52a9b1e397a3e24f77587e9ff164b6a7ea6f/diff", "WorkDir": "/var/lib/docker/overlay2/abfa883496abf4a13f712f9a7d6a52a9b1e397a3e24f77587e9ff164b6a7ea6f/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/e581bcde65018b3d44364250a09fcd8c8f4f373dcea15e083dfd125a1e131c91/hostname", "HostsPath": "/var/lib/docker/containers/e581bcde65018b3d44364250a09fcd8c8f4f373dcea15e083dfd125a1e131c91/hosts", "Id": "e581bcde65018b3d44364250a09fcd8c8f4f373dcea15e083dfd125a1e131c91", "Image": "sha256:b57ecf607c9f147db9dc22979a367cd36485427bfadc25c847cbce99ef14c160", "LogPath": "/var/lib/docker/containers/e581bcde65018b3d44364250a09fcd8c8f4f373dcea15e083dfd125a1e131c91/e581bcde65018b3d44364250a09fcd8c8f4f373dcea15e083dfd125a1e131c91-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "3f5c8b2c480856f9b0cb93c0644f246742b887750d2803f0839ebb3f95bdcf01", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/3f5c8b2c480856f9b0cb93c0644f246742b887750d2803f0839ebb3f95bdcf01/_data", "Type": "volume"}], "Name": "/t5ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "4850f7bdf4920e57cb4e277e047192553c0e91c03d77c2fbecc75faacd3f6630", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "4850f7bdf4920e57cb4e277e047192553c0e91c03d77c2fbecc75faacd3f6630", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "9862bf32f9f28d6af199096661a00ded9fbc4c6386016444c2a29ea3ce59f7d2", "SandboxKey": "/var/run/docker/netns/9862bf32f9f2", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/e581bcde65018b3d44364250a09fcd8c8f4f373dcea15e083dfd125a1e131c91/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 19475, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:33:12.767470128Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.131.1', u'name': u't3', u'pns_ip': u'192.168.131.1/24', u'tenant_if': u't3if', u'tenant_ip': u'192.168.131.2/24', u'pns_if': u't3pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:33:13.708488347Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/2d97be20341dd3d7d53c488330243d732ca11b428a523a17496831b13f475816-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/2d97be20341dd3d7d53c488330243d732ca11b428a523a17496831b13f475816/merged", "UpperDir": "/var/lib/docker/overlay2/2d97be20341dd3d7d53c488330243d732ca11b428a523a17496831b13f475816/diff", "WorkDir": "/var/lib/docker/overlay2/2d97be20341dd3d7d53c488330243d732ca11b428a523a17496831b13f475816/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/549cf95f9a874ed055d19c2c1f14872cc5de624e26e72eaafcc35ac58c463aec/hostname", "HostsPath": "/var/lib/docker/containers/549cf95f9a874ed055d19c2c1f14872cc5de624e26e72eaafcc35ac58c463aec/hosts", "Id": "549cf95f9a874ed055d19c2c1f14872cc5de624e26e72eaafcc35ac58c463aec", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/549cf95f9a874ed055d19c2c1f14872cc5de624e26e72eaafcc35ac58c463aec/549cf95f9a874ed055d19c2c1f14872cc5de624e26e72eaafcc35ac58c463aec-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "c82ac58d97fea5945794a03ef684af59ecf978ffe09ec0b0a3d2dc5e6a44bfd1", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/c82ac58d97fea5945794a03ef684af59ecf978ffe09ec0b0a3d2dc5e6a44bfd1/_data", "Type": "volume"}], "Name": "/t3", "NetworkSettings": {"Bridge": "", "EndpointID": "00d0041d5883d0132380d0bb71fa86064ba30f47803dcf6835099253c8e27792", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "00d0041d5883d0132380d0bb71fa86064ba30f47803dcf6835099253c8e27792", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "e5f966132aea72d00c2033d37c2055a092a0850c3b02dbbad0037ec55604bd9d", "SandboxKey": "/var/run/docker/netns/e5f966132aea", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/549cf95f9a874ed055d19c2c1f14872cc5de624e26e72eaafcc35ac58c463aec/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 21000, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:33:14.499907148Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:33:13.708488347Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/2d97be20341dd3d7d53c488330243d732ca11b428a523a17496831b13f475816-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/2d97be20341dd3d7d53c488330243d732ca11b428a523a17496831b13f475816/merged", "UpperDir": "/var/lib/docker/overlay2/2d97be20341dd3d7d53c488330243d732ca11b428a523a17496831b13f475816/diff", "WorkDir": "/var/lib/docker/overlay2/2d97be20341dd3d7d53c488330243d732ca11b428a523a17496831b13f475816/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/549cf95f9a874ed055d19c2c1f14872cc5de624e26e72eaafcc35ac58c463aec/hostname", "HostsPath": "/var/lib/docker/containers/549cf95f9a874ed055d19c2c1f14872cc5de624e26e72eaafcc35ac58c463aec/hosts", "Id": "549cf95f9a874ed055d19c2c1f14872cc5de624e26e72eaafcc35ac58c463aec", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/549cf95f9a874ed055d19c2c1f14872cc5de624e26e72eaafcc35ac58c463aec/549cf95f9a874ed055d19c2c1f14872cc5de624e26e72eaafcc35ac58c463aec-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "c82ac58d97fea5945794a03ef684af59ecf978ffe09ec0b0a3d2dc5e6a44bfd1", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/c82ac58d97fea5945794a03ef684af59ecf978ffe09ec0b0a3d2dc5e6a44bfd1/_data", "Type": "volume"}], "Name": "/t3", "NetworkSettings": {"Bridge": "", "EndpointID": "00d0041d5883d0132380d0bb71fa86064ba30f47803dcf6835099253c8e27792", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "00d0041d5883d0132380d0bb71fa86064ba30f47803dcf6835099253c8e27792", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "e5f966132aea72d00c2033d37c2055a092a0850c3b02dbbad0037ec55604bd9d", "SandboxKey": "/var/run/docker/netns/e5f966132aea", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/549cf95f9a874ed055d19c2c1f14872cc5de624e26e72eaafcc35ac58c463aec/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 21000, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:33:14.499907148Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.131.1", "name": "t3", "pns_if": "t3pns_if", "pns_ip": "192.168.131.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.131.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'tenant_route_ip': u'192.168.131.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.2.21.0/24', u'remote_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:33:15.457087184Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/fd07ab6224d80d618277510a7dd78a7d49f120ea0feace0429ed480b6805bb9a-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/fd07ab6224d80d618277510a7dd78a7d49f120ea0feace0429ed480b6805bb9a/merged", "UpperDir": "/var/lib/docker/overlay2/fd07ab6224d80d618277510a7dd78a7d49f120ea0feace0429ed480b6805bb9a/diff", "WorkDir": "/var/lib/docker/overlay2/fd07ab6224d80d618277510a7dd78a7d49f120ea0feace0429ed480b6805bb9a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/1f2992d32269bfba6510ab20358dbfe593e97907e1739ce3c27ef99b3f67988e/hostname", "HostsPath": "/var/lib/docker/containers/1f2992d32269bfba6510ab20358dbfe593e97907e1739ce3c27ef99b3f67988e/hosts", "Id": "1f2992d32269bfba6510ab20358dbfe593e97907e1739ce3c27ef99b3f67988e", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/1f2992d32269bfba6510ab20358dbfe593e97907e1739ce3c27ef99b3f67988e/1f2992d32269bfba6510ab20358dbfe593e97907e1739ce3c27ef99b3f67988e-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "7d926bdd56ab7e8d2a3569e7fe150cf1a893760970c5721cd373db47c9c72919", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/7d926bdd56ab7e8d2a3569e7fe150cf1a893760970c5721cd373db47c9c72919/_data", "Type": "volume"}], "Name": "/t3ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "5d94cd732d419c322e2b72911e927b02b309d96ed8ba92112a109a114f319565", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:06", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "5d94cd732d419c322e2b72911e927b02b309d96ed8ba92112a109a114f319565", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:06", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "ca1998dda6697f54cd8cebc4ba572f11a2a547e716ef0440a254093c8599bae7", "SandboxKey": "/var/run/docker/netns/ca1998dda669", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/1f2992d32269bfba6510ab20358dbfe593e97907e1739ce3c27ef99b3f67988e/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 22985, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:33:16.344576497Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:33:15.457087184Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/fd07ab6224d80d618277510a7dd78a7d49f120ea0feace0429ed480b6805bb9a-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/fd07ab6224d80d618277510a7dd78a7d49f120ea0feace0429ed480b6805bb9a/merged", "UpperDir": "/var/lib/docker/overlay2/fd07ab6224d80d618277510a7dd78a7d49f120ea0feace0429ed480b6805bb9a/diff", "WorkDir": "/var/lib/docker/overlay2/fd07ab6224d80d618277510a7dd78a7d49f120ea0feace0429ed480b6805bb9a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/1f2992d32269bfba6510ab20358dbfe593e97907e1739ce3c27ef99b3f67988e/hostname", "HostsPath": "/var/lib/docker/containers/1f2992d32269bfba6510ab20358dbfe593e97907e1739ce3c27ef99b3f67988e/hosts", "Id": "1f2992d32269bfba6510ab20358dbfe593e97907e1739ce3c27ef99b3f67988e", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/1f2992d32269bfba6510ab20358dbfe593e97907e1739ce3c27ef99b3f67988e/1f2992d32269bfba6510ab20358dbfe593e97907e1739ce3c27ef99b3f67988e-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "7d926bdd56ab7e8d2a3569e7fe150cf1a893760970c5721cd373db47c9c72919", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/7d926bdd56ab7e8d2a3569e7fe150cf1a893760970c5721cd373db47c9c72919/_data", "Type": "volume"}], "Name": "/t3ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "5d94cd732d419c322e2b72911e927b02b309d96ed8ba92112a109a114f319565", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:06", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "5d94cd732d419c322e2b72911e927b02b309d96ed8ba92112a109a114f319565", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:06", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "ca1998dda6697f54cd8cebc4ba572f11a2a547e716ef0440a254093c8599bae7", "SandboxKey": "/var/run/docker/netns/ca1998dda669", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/1f2992d32269bfba6510ab20358dbfe593e97907e1739ce3c27ef99b3f67988e/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 22985, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:33:16.344576497Z", "Status": "running"}}, "item": {"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vmif": "t3C3if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}}
Using /etc/ansible/ansible.cfg as config file
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3', u'tenant_sub_if': u't3s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:33:17.427291174Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/41f770dd7adb9e45bd1526ffd9b139170279fab5c73b624ae751ca5ff11f2451-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/41f770dd7adb9e45bd1526ffd9b139170279fab5c73b624ae751ca5ff11f2451/merged", "UpperDir": "/var/lib/docker/overlay2/41f770dd7adb9e45bd1526ffd9b139170279fab5c73b624ae751ca5ff11f2451/diff", "WorkDir": "/var/lib/docker/overlay2/41f770dd7adb9e45bd1526ffd9b139170279fab5c73b624ae751ca5ff11f2451/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/5f46cbfc3d38c6dd1b4c83791c5b1e60e88b03d21cf3ceca6559e5e8894cc764/hostname", "HostsPath": "/var/lib/docker/containers/5f46cbfc3d38c6dd1b4c83791c5b1e60e88b03d21cf3ceca6559e5e8894cc764/hosts", "Id": "5f46cbfc3d38c6dd1b4c83791c5b1e60e88b03d21cf3ceca6559e5e8894cc764", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/5f46cbfc3d38c6dd1b4c83791c5b1e60e88b03d21cf3ceca6559e5e8894cc764/5f46cbfc3d38c6dd1b4c83791c5b1e60e88b03d21cf3ceca6559e5e8894cc764-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "5ace6a6c345fbfd406a6ea946deb140cb9ba733f804b5ceb5c1f4339784d5cff", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/5ace6a6c345fbfd406a6ea946deb140cb9ba733f804b5ceb5c1f4339784d5cff/_data", "Type": "volume"}], "Name": "/t3ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "3856686b12ba211864dc62ede5b2091b1b77e3da3a335e0ef10de38a6c53c4fe", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:07", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "3856686b12ba211864dc62ede5b2091b1b77e3da3a335e0ef10de38a6c53c4fe", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:07", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "ccaca22017aaedfabd0b57607864687e3551a59e19324c313571bcd67324569f", "SandboxKey": "/var/run/docker/netns/ccaca22017aa", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/5f46cbfc3d38c6dd1b4c83791c5b1e60e88b03d21cf3ceca6559e5e8894cc764/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24775, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:33:18.487974646Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t3ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:33:17.427291174Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/41f770dd7adb9e45bd1526ffd9b139170279fab5c73b624ae751ca5ff11f2451-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/41f770dd7adb9e45bd1526ffd9b139170279fab5c73b624ae751ca5ff11f2451/merged", "UpperDir": "/var/lib/docker/overlay2/41f770dd7adb9e45bd1526ffd9b139170279fab5c73b624ae751ca5ff11f2451/diff", "WorkDir": "/var/lib/docker/overlay2/41f770dd7adb9e45bd1526ffd9b139170279fab5c73b624ae751ca5ff11f2451/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/5f46cbfc3d38c6dd1b4c83791c5b1e60e88b03d21cf3ceca6559e5e8894cc764/hostname", "HostsPath": "/var/lib/docker/containers/5f46cbfc3d38c6dd1b4c83791c5b1e60e88b03d21cf3ceca6559e5e8894cc764/hosts", "Id": "5f46cbfc3d38c6dd1b4c83791c5b1e60e88b03d21cf3ceca6559e5e8894cc764", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/5f46cbfc3d38c6dd1b4c83791c5b1e60e88b03d21cf3ceca6559e5e8894cc764/5f46cbfc3d38c6dd1b4c83791c5b1e60e88b03d21cf3ceca6559e5e8894cc764-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "5ace6a6c345fbfd406a6ea946deb140cb9ba733f804b5ceb5c1f4339784d5cff", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/5ace6a6c345fbfd406a6ea946deb140cb9ba733f804b5ceb5c1f4339784d5cff/_data", "Type": "volume"}], "Name": "/t3ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "3856686b12ba211864dc62ede5b2091b1b77e3da3a335e0ef10de38a6c53c4fe", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:07", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "3856686b12ba211864dc62ede5b2091b1b77e3da3a335e0ef10de38a6c53c4fe", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:07", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "ccaca22017aaedfabd0b57607864687e3551a59e19324c313571bcd67324569f", "SandboxKey": "/var/run/docker/netns/ccaca22017aa", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/5f46cbfc3d38c6dd1b4c83791c5b1e60e88b03d21cf3ceca6559e5e8894cc764/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 24775, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:33:18.487974646Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vmif": "t3C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   


PLAY [main] *************************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'20484', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5if\" ; if [ $? -ne 0 ] ; then ip link add \"t5if\" type veth peer name \"t5pns_if\" ; fi\n", "delta": "0:00:00.242619", "end": "2019-12-06 23:33:19.465621", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "20484", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 23:33:19.223002", "stderr": "Device \"t5if\" does not exist.", "stderr_lines": ["Device \"t5if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'20484', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t5pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t5pns_if\" netns pns1 ; fi\ndocker exec \"t5\" ip link show \"t5if\" ; if [ $? -ne 0 ] ; then ip link set \"t5if\" netns \"20484\" ; fi\nip netns exec pns1 ip link set dev \"t5pns_if\" up\ndocker exec \"t5\" ip link set dev \"t5if\" up\n", "delta": "0:00:00.495300", "end": "2019-12-06 23:33:20.172821", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "20484", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 23:33:19.677521", "stderr": "Device \"t5pns_if\" does not exist.\nDevice \"t5if\" does not exist.", "stderr_lines": ["Device \"t5pns_if\" does not exist.", "Device \"t5if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'20484', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t5pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.5.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.5.1/24\" dev \"t5pns_if\" ; fi\ndocker exec \"t5\" ip addr show \"t5if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.5.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip addr add \"192.168.5.2/24\" dev \"t5if\" ; fi\n", "delta": "0:00:00.451335", "end": "2019-12-06 23:33:20.858645", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "20484", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 23:33:20.407310", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t5ns1if\" type veth peer name \"t5s1if\" ; fi\n", "delta": "0:00:00.221234", "end": "2019-12-06 23:33:21.312332", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "rc": 0, "start": "2019-12-06 23:33:21.091098", "stderr": "Device \"t5ns1if\" does not exist.", "stderr_lines": ["Device \"t5ns1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t5ns1if\" netns \"20484\" ; fi\ndocker exec \"t5ns1\" ip link show \"t5s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t5s1if\" netns \"21100\" ; fi\n", "delta": "0:00:00.404840", "end": "2019-12-06 23:33:21.950988", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "rc": 0, "start": "2019-12-06 23:33:21.546148", "stderr": "Device \"t5ns1if\" does not exist.\nDevice \"t5s1if\" does not exist.", "stderr_lines": ["Device \"t5ns1if\" does not exist.", "Device \"t5s1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link set dev \"t5ns1if\" up\ndocker exec \"t5ns1\" ip link set dev \"t5s1if\" up\n", "delta": "0:00:00.347485", "end": "2019-12-06 23:33:22.525571", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "rc": 0, "start": "2019-12-06 23:33:22.178086", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip addr show \"t5s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.41.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip addr add \"10.1.41.2/24\" dev \"t5s1if\" ; fi\n\ndocker exec \"t5\" ip addr show \"t5ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.41.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip addr add \"10.1.41.1/24\" dev \"t5ns1if\" ; fi\n", "delta": "0:00:00.827978", "end": "2019-12-06 23:33:23.587794", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "rc": 0, "start": "2019-12-06 23:33:22.759816", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route] *********************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.3.1', u'name': u't3', u'pns_ip': u'192.168.3.1/24', u'tenant_if': u't3if', u'pid': u'18329', u'tenant_ip': u'192.168.3.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip link show \"t3if\" ; if [ $? -ne 0 ] ; then ip link add \"t3if\" type veth peer name \"t3pns_if\" ; fi\n", "delta": "0:00:00.222743", "end": "2019-12-06 23:33:24.045096", "item": {"default_route_ip": "192.168.3.1", "name": "t3", "pid": "18329", "pns_if": "t3pns_if", "pns_ip": "192.168.3.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.3.2/24"}, "rc": 0, "start": "2019-12-06 23:33:23.822353", "stderr": "Device \"t3if\" does not exist.", "stderr_lines": ["Device \"t3if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'20484', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t5\" ip route del default ; fi\n", "delta": "0:00:00.494209", "end": "2019-12-06 23:33:24.316545", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "20484", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 23:33:23.822336", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.3.1', u'name': u't3', u'pns_ip': u'192.168.3.1/24', u'tenant_if': u't3if', u'pid': u'18329', u'tenant_ip': u'192.168.3.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t3pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t3pns_if\" netns pns1 ; fi\ndocker exec \"t3\" ip link show \"t3if\" ; if [ $? -ne 0 ] ; then ip link set \"t3if\" netns \"18329\" ; fi\nip netns exec pns1 ip link set dev \"t3pns_if\" up\ndocker exec \"t3\" ip link set dev \"t3if\" up\n", "delta": "0:00:00.581867", "end": "2019-12-06 23:33:24.907739", "item": {"default_route_ip": "192.168.3.1", "name": "t3", "pid": "18329", "pns_if": "t3pns_if", "pns_ip": "192.168.3.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.3.2/24"}, "rc": 0, "start": "2019-12-06 23:33:24.325872", "stderr": "Device \"t3pns_if\" does not exist.\nDevice \"t3if\" does not exist.", "stderr_lines": ["Device \"t3pns_if\" does not exist.", "Device \"t3if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'20484', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip route show default | grep -w '[d]efault via 192.168.5.1' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip route add default via \"192.168.5.1\" ; fi\n", "delta": "0:00:00.437572", "end": "2019-12-06 23:33:25.020875", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "20484", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 23:33:24.583303", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.3.1', u'name': u't3', u'pns_ip': u'192.168.3.1/24', u'tenant_if': u't3if', u'pid': u'18329', u'tenant_ip': u'192.168.3.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t3pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.3.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.3.1/24\" dev \"t3pns_if\" ; fi\ndocker exec \"t3\" ip addr show \"t3if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.3.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t3\" ip addr add \"192.168.3.2/24\" dev \"t3if\" ; fi\n", "delta": "0:00:00.570534", "end": "2019-12-06 23:33:25.762049", "item": {"default_route_ip": "192.168.3.1", "name": "t3", "pid": "18329", "pns_if": "t3pns_if", "pns_ip": "192.168.3.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.3.2/24"}, "rc": 0, "start": "2019-12-06 23:33:25.191515", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'tenant_route_ip': u'192.168.5.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.1.41.0/24', u'remote_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t5ns1\" ip route del default ; fi\n", "delta": "0:00:00.549527", "end": "2019-12-06 23:33:25.846198", "item": {"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 23:33:25.296671", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip link show \"t3ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t3ns1if\" type veth peer name \"t3s1if\" ; fi\n", "delta": "0:00:00.228836", "end": "2019-12-06 23:33:26.241517", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "rc": 0, "start": "2019-12-06 23:33:26.012681", "stderr": "Device \"t3ns1if\" does not exist.", "stderr_lines": ["Device \"t3ns1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'tenant_route_ip': u'192.168.5.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.1.41.0/24', u'remote_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip route show default | grep -w '[d]efault via 10.1.41.1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip route add default via \"10.1.41.1\" ; fi\n", "delta": "0:00:00.491740", "end": "2019-12-06 23:33:26.577554", "item": {"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 23:33:26.085814", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside container] ***********************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip link show \"t3ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t3ns1if\" netns \"18329\" ; fi\ndocker exec \"t3ns1\" ip link show \"t3s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t3s1if\" netns \"18941\" ; fi\n", "delta": "0:00:00.464350", "end": "2019-12-06 23:33:26.974699", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "rc": 0, "start": "2019-12-06 23:33:26.510349", "stderr": "Device \"t3ns1if\" does not exist.\nDevice \"t3s1if\" does not exist.", "stderr_lines": ["Device \"t3ns1if\" does not exist.", "Device \"t3s1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'tenant_route_ip': u'192.168.5.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.1.41.0/24', u'remote_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show | grep -w '^t5br1'; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addbr \"t5br1\" ; fi\ndocker exec \"t5ns1\" ip link set dev \"t5br1\" up\n", "delta": "0:00:00.669735", "end": "2019-12-06 23:33:27.513074", "item": {"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 23:33:26.843339", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip link set dev \"t3ns1if\" up\ndocker exec \"t3ns1\" ip link set dev \"t3s1if\" up\n", "delta": "0:00:00.447878", "end": "2019-12-06 23:33:27.668826", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "rc": 0, "start": "2019-12-06 23:33:27.220948", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"t5s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip link add \"t5s1_dnsbrif\" type veth peer name \"t5s1_dnsif\" ; fi\ndocker exec \"t5ns1\" ip link set dev \"t5s1_dnsbrif\" up\ndocker exec \"t5ns1\" ip link set dev \"t5s1_dnsif\" up\n", "delta": "0:00:00.972172", "end": "2019-12-06 23:33:28.805049", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:33:27.832877", "stderr": "Device \"t5s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t5s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip addr show \"t3s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.21.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" ip addr add \"10.1.21.2/24\" dev \"t3s1if\" ; fi\n\ndocker exec \"t3\" ip addr show \"t3ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.21.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t3\" ip addr add \"10.1.21.1/24\" dev \"t3ns1if\" ; fi\n", "delta": "0:00:00.964349", "end": "2019-12-06 23:33:28.883986", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "rc": 0, "start": "2019-12-06 23:33:27.919637", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 't5s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"t5s1_dnsbrif\" ; fi\n", "delta": "0:00:00.422276", "end": "2019-12-06 23:33:29.470441", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:33:29.048165", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.3.1', u'name': u't3', u'pns_ip': u'192.168.3.1/24', u'tenant_if': u't3if', u'pid': u'18329', u'tenant_ip': u'192.168.3.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t3\" ip route del default ; fi\n", "delta": "0:00:00.481600", "end": "2019-12-06 23:33:29.580737", "item": {"default_route_ip": "192.168.3.1", "name": "t3", "pid": "18329", "pns_if": "t3pns_if", "pns_ip": "192.168.3.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.3.2/24"}, "rc": 0, "start": "2019-12-06 23:33:29.099137", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"t5br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t5C1if1\" type veth peer name \"t5br1if1\" ; fi\nip link set dev \"t5br1if1\" up\nip link set dev \"t5C1if1\" up\n", "delta": "0:00:00.202611", "end": "2019-12-06 23:33:29.915057", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}], "rc": 0, "start": "2019-12-06 23:33:29.712446", "stderr": "Device \"t5br1if1\" does not exist.", "stderr_lines": ["Device \"t5br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item={u'default_route_ip': u'192.168.3.1', u'name': u't3', u'pns_ip': u'192.168.3.1/24', u'tenant_if': u't3if', u'pid': u'18329', u'tenant_ip': u'192.168.3.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip route show default | grep -w '[d]efault via 192.168.3.1' ; if [ $? -ne 0 ] ; then docker exec \"t3\" ip route add default via \"192.168.3.1\" ; fi\n", "delta": "0:00:00.425771", "end": "2019-12-06 23:33:30.227702", "item": {"default_route_ip": "192.168.3.1", "name": "t3", "pid": "18329", "pns_if": "t3pns_if", "pns_ip": "192.168.3.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.3.2/24"}, "rc": 0, "start": "2019-12-06 23:33:29.801931", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"t5br1if2\" ; if [ $? -ne 0 ] ; then ip link add \"t5C2if1\" type veth peer name \"t5br1if2\" ; fi\nip link set dev \"t5br1if2\" up\nip link set dev \"t5C2if1\" up\n", "delta": "0:00:00.225778", "end": "2019-12-06 23:33:30.352034", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "rc": 0, "start": "2019-12-06 23:33:30.126256", "stderr": "Device \"t5br1if2\" does not exist.", "stderr_lines": ["Device \"t5br1if2\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_ns_name': u't3', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'tenant_route_ip': u'192.168.3.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.1.21.0/24', u'remote_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t3ns1\" ip route del default ; fi\n", "delta": "0:00:00.470503", "end": "2019-12-06 23:33:30.993514", "item": {"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, "rc": 0, "start": "2019-12-06 23:33:30.523011", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t5br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t5br1if1\" netns \"21100\" ; fi\ndocker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 't5br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"t5br1if1\" ; fi\n", "delta": "0:00:00.528078", "end": "2019-12-06 23:33:31.158881", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}], "rc": 0, "start": "2019-12-06 23:33:30.630803", "stderr": "", "stderr_lines": [], "stdout": "66: t5br1if1@t5C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 6a:39:a9:98:3d:34 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["66: t5br1if1@t5C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 6a:39:a9:98:3d:34 brd ff:ff:ff:ff:ff:ff"]}
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_ns_name': u't3', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'tenant_route_ip': u'192.168.3.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.1.21.0/24', u'remote_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip route show default | grep -w '[d]efault via 10.1.21.1' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" ip route add default via \"10.1.21.1\" ; fi\n", "delta": "0:00:00.437449", "end": "2019-12-06 23:33:31.695382", "item": {"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, "rc": 0, "start": "2019-12-06 23:33:31.257933", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside container] ***********************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t5br1if2\" ; if [ $? -eq 0 ] ; then ip link set \"t5br1if2\" netns \"21100\" ; fi\ndocker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 't5br1if2' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"t5br1if2\" ; fi\n", "delta": "0:00:00.462677", "end": "2019-12-06 23:33:31.831177", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "rc": 0, "start": "2019-12-06 23:33:31.368500", "stderr": "", "stderr_lines": [], "stdout": "68: t5br1if2@t5C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 1e:3d:b4:ef:97:58 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["68: t5br1if2@t5C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 1e:3d:b4:ef:97:58 brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link set \"t5br1if1\" up\ndocker exec \"t5ns1\" ip link set dev \"t5br1\" up\n", "delta": "0:00:00.398428", "end": "2019-12-06 23:33:32.474130", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}], "rc": 0, "start": "2019-12-06 23:33:32.075702", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_ns_name': u't3', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'tenant_route_ip': u'192.168.3.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.1.21.0/24', u'remote_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" brctl show | grep -w '^t3br1'; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" brctl addbr \"t3br1\" ; fi\ndocker exec \"t3ns1\" ip link set dev \"t3br1\" up\n", "delta": "0:00:00.645484", "end": "2019-12-06 23:33:32.592504", "item": {"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, "rc": 0, "start": "2019-12-06 23:33:31.947020", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link set \"t5br1if2\" up\ndocker exec \"t5ns1\" ip link set dev \"t5br1\" up\n", "delta": "0:00:00.400935", "end": "2019-12-06 23:33:33.038163", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "rc": 0, "start": "2019-12-06 23:33:32.637228", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip link show \"t3s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" ip link add \"t3s1_dnsbrif\" type veth peer name \"t3s1_dnsif\" ; fi\ndocker exec \"t3ns1\" ip link set dev \"t3s1_dnsbrif\" up\ndocker exec \"t3ns1\" ip link set dev \"t3s1_dnsif\" up\n", "delta": "0:00:00.916483", "end": "2019-12-06 23:33:33.771555", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:33:32.855072", "stderr": "Device \"t3s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t3s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip addr show \"t5s1_dnsif\" | awk 'FNR==3{ print $2 }' | grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip addr add \"1.1.1.1/24\" dev \"t5s1_dnsif\" ; fi\n", "delta": "0:00:00.442602", "end": "2019-12-06 23:33:33.806771", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:33:33.364169", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" brctl show \"t3br1\" | grep -w 't3s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" brctl addif \"t3br1\" \"t3s1_dnsbrif\" ; fi\n", "delta": "0:00:00.476853", "end": "2019-12-06 23:33:34.511522", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:33:34.034669", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip link show \"t3br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t3C1if1\" type veth peer name \"t3br1if1\" ; fi\nip link set dev \"t3br1if1\" up\nip link set dev \"t3C1if1\" up\n", "delta": "0:00:00.191524", "end": "2019-12-06 23:33:34.949843", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}], "rc": 0, "start": "2019-12-06 23:33:34.758319", "stderr": "Device \"t3br1if1\" does not exist.", "stderr_lines": ["Device \"t3br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ps aux | grep -w '[d]nsmasq --interface t5s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" dnsmasq --interface \"t5s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.937649", "end": "2019-12-06 23:33:35.025827", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:33:34.088178", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip link show \"t3br1if2\" ; if [ $? -ne 0 ] ; then ip link add \"t3C2if1\" type veth peer name \"t3br1if2\" ; fi\nip link set dev \"t3br1if2\" up\nip link set dev \"t3C2if1\" up\n", "delta": "0:00:00.209310", "end": "2019-12-06 23:33:35.358013", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}], "rc": 0, "start": "2019-12-06 23:33:35.148703", "stderr": "Device \"t3br1if2\" does not exist.", "stderr_lines": ["Device \"t3br1if2\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]}, {u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"vxlan_t5s1\" ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip link add \"vxlan_t5s1\" type vxlan id \"42\" local \"10.1.41.2\" remote \"10.2.41.2\" dstport \"4789\" dev \"t5s1if\"; docker exec \"t5ns1\" ip link set dev \"vxlan_t5s1\" up ; fi\n", "delta": "0:00:00.724419", "end": "2019-12-06 23:33:36.003894", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:33:35.279475", "stderr": "Device \"vxlan_t5s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t5s1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t3br1if1\" netns \"18941\" ; fi\ndocker exec \"t3ns1\" brctl show \"t3br1\" | grep -w 't3br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" brctl addif \"t3br1\" \"t3br1if1\" ; fi\n", "delta": "0:00:00.509403", "end": "2019-12-06 23:33:36.147999", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}], "rc": 0, "start": "2019-12-06 23:33:35.638596", "stderr": "", "stderr_lines": [], "stdout": "70: t3br1if1@t3C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 7a:9c:b6:c2:63:7b brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["70: t3br1if1@t3C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 7a:9c:b6:c2:63:7b brd ff:ff:ff:ff:ff:ff"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]}, {u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 'vxlan_t5s1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"vxlan_t5s1\" ; fi\n", "delta": "0:00:00.443593", "end": "2019-12-06 23:33:36.731522", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:33:36.287929", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3br1if2\" ; if [ $? -eq 0 ] ; then ip link set \"t3br1if2\" netns \"18941\" ; fi\ndocker exec \"t3ns1\" brctl show \"t3br1\" | grep -w 't3br1if2' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" brctl addif \"t3br1\" \"t3br1if2\" ; fi\n", "delta": "0:00:00.469212", "end": "2019-12-06 23:33:36.816578", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}], "rc": 0, "start": "2019-12-06 23:33:36.347366", "stderr": "", "stderr_lines": [], "stdout": "72: t3br1if2@t3C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether ea:08:9b:1c:55:b4 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["72: t3br1if2@t3C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether ea:08:9b:1c:55:b4 brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
Using /etc/ansible/ansible.cfg as config file
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip link set \"t3br1if1\" up\ndocker exec \"t3ns1\" ip link set dev \"t3br1\" up\n", "delta": "0:00:00.403825", "end": "2019-12-06 23:33:37.488202", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}], "rc": 0, "start": "2019-12-06 23:33:37.084377", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY [worker] ***********************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip link set \"t3br1if2\" up\ndocker exec \"t3ns1\" ip link set dev \"t3br1\" up\n", "delta": "0:00:00.381235", "end": "2019-12-06 23:33:38.050689", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}], "rc": 0, "start": "2019-12-06 23:33:37.669454", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.133.1', u'name': u't5', u'pns_ip': u'192.168.133.1/24', u'tenant_if': u't5if', u'pid': u'17607', u'tenant_ip': u'192.168.133.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5if\" ; if [ $? -ne 0 ] ; then ip link add \"t5if\" type veth peer name \"t5pns_if\" ; fi\n", "delta": "0:00:00.254209", "end": "2019-12-06 23:33:38.314379", "item": {"default_route_ip": "192.168.133.1", "name": "t5", "pid": "17607", "pns_if": "t5pns_if", "pns_ip": "192.168.133.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.133.2/24"}, "rc": 0, "start": "2019-12-06 23:33:38.060170", "stderr": "Device \"t5if\" does not exist.", "stderr_lines": ["Device \"t5if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip addr show \"t3s1_dnsif\" | awk 'FNR==3{ print $2 }' | grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" ip addr add \"1.1.1.1/24\" dev \"t3s1_dnsif\" ; fi\n", "delta": "0:00:00.355437", "end": "2019-12-06 23:33:38.644102", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:33:38.288665", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.133.1', u'name': u't5', u'pns_ip': u'192.168.133.1/24', u'tenant_if': u't5if', u'pid': u'17607', u'tenant_ip': u'192.168.133.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t5pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t5pns_if\" netns pns1 ; fi\ndocker exec \"t5\" ip link show \"t5if\" ; if [ $? -ne 0 ] ; then ip link set \"t5if\" netns \"17607\" ; fi\nip netns exec pns1 ip link set dev \"t5pns_if\" up\ndocker exec \"t5\" ip link set dev \"t5if\" up\n", "delta": "0:00:00.493451", "end": "2019-12-06 23:33:39.188705", "item": {"default_route_ip": "192.168.133.1", "name": "t5", "pid": "17607", "pns_if": "t5pns_if", "pns_ip": "192.168.133.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.133.2/24"}, "rc": 0, "start": "2019-12-06 23:33:38.695254", "stderr": "Device \"t5pns_if\" does not exist.\nDevice \"t5if\" does not exist.", "stderr_lines": ["Device \"t5pns_if\" does not exist.", "Device \"t5if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}], u'vxlan': [{u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ps aux | grep -w '[d]nsmasq --interface t3s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" dnsmasq --interface \"t3s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.865823", "end": "2019-12-06 23:33:39.753339", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:33:38.887516", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.133.1', u'name': u't5', u'pns_ip': u'192.168.133.1/24', u'tenant_if': u't5if', u'pid': u'17607', u'tenant_ip': u'192.168.133.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t5pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.133.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.133.1/24\" dev \"t5pns_if\" ; fi\ndocker exec \"t5\" ip addr show \"t5if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.133.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip addr add \"192.168.133.2/24\" dev \"t5if\" ; fi\n", "delta": "0:00:00.463282", "end": "2019-12-06 23:33:40.017814", "item": {"default_route_ip": "192.168.133.1", "name": "t5", "pid": "17607", "pns_if": "t5pns_if", "pns_ip": "192.168.133.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.133.2/24"}, "rc": 0, "start": "2019-12-06 23:33:39.554532", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t5ns1if\" type veth peer name \"t5s1if\" ; fi\n", "delta": "0:00:00.175737", "end": "2019-12-06 23:33:40.595351", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "rc": 0, "start": "2019-12-06 23:33:40.419614", "stderr": "Device \"t5ns1if\" does not exist.", "stderr_lines": ["Device \"t5ns1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}]}, {u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip link show \"vxlan_t3s1\" ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" ip link add \"vxlan_t3s1\" type vxlan id \"42\" local \"10.1.21.2\" remote \"10.2.21.2\" dstport \"4789\" dev \"t3s1if\"; docker exec \"t3ns1\" ip link set dev \"vxlan_t3s1\" up ; fi\n", "delta": "0:00:00.619036", "end": "2019-12-06 23:33:40.616150", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-06 23:33:39.997114", "stderr": "Device \"vxlan_t3s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t3s1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5ns2if\" ; if [ $? -ne 0 ] ; then ip link add \"t5ns2if\" type veth peer name \"t5s2if\" ; fi\n", "delta": "0:00:00.183876", "end": "2019-12-06 23:33:41.045869", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "rc": 0, "start": "2019-12-06 23:33:40.861993", "stderr": "Device \"t5ns2if\" does not exist.", "stderr_lines": ["Device \"t5ns2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}]}, {u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" brctl show \"t3br1\" | grep -w 'vxlan_t3s1' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" brctl addif \"t3br1\" \"vxlan_t3s1\" ; fi\n", "delta": "0:00:00.357584", "end": "2019-12-06 23:33:41.228454", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-06 23:33:40.870870", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t5ns1if\" netns \"17607\" ; fi\ndocker exec \"t5ns1\" ip link show \"t5s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t5s1if\" netns \"18346\" ; fi\n", "delta": "0:00:00.400907", "end": "2019-12-06 23:33:41.828181", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "rc": 0, "start": "2019-12-06 23:33:41.427274", "stderr": "Device \"t5ns1if\" does not exist.\nDevice \"t5s1if\" does not exist.", "stderr_lines": ["Device \"t5ns1if\" does not exist.", "Device \"t5s1if\" does not exist."], "stdout": "", "stdout_lines": []}

PLAY [worker] ***********************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5ns2if\" ; if [ $? -ne 0 ] ; then ip link set \"t5ns2if\" netns \"17607\" ; fi\ndocker exec \"t5ns2\" ip link show \"t5s2if\" ; if [ $? -ne 0 ] ; then ip link set \"t5s2if\" netns \"19475\" ; fi\n", "delta": "0:00:00.411663", "end": "2019-12-06 23:33:42.508259", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "rc": 0, "start": "2019-12-06 23:33:42.096596", "stderr": "Device \"t5ns2if\" does not exist.\nDevice \"t5s2if\" does not exist.", "stderr_lines": ["Device \"t5ns2if\" does not exist.", "Device \"t5s2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.131.1', u'name': u't3', u'pns_ip': u'192.168.131.1/24', u'tenant_if': u't3if', u'pid': u'21000', u'tenant_ip': u'192.168.131.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip link show \"t3if\" ; if [ $? -ne 0 ] ; then ip link add \"t3if\" type veth peer name \"t3pns_if\" ; fi\n", "delta": "0:00:00.218575", "end": "2019-12-06 23:33:42.633652", "item": {"default_route_ip": "192.168.131.1", "name": "t3", "pid": "21000", "pns_if": "t3pns_if", "pns_ip": "192.168.131.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.131.2/24"}, "rc": 0, "start": "2019-12-06 23:33:42.415077", "stderr": "Device \"t3if\" does not exist.", "stderr_lines": ["Device \"t3if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link set dev \"t5ns1if\" up\ndocker exec \"t5ns1\" ip link set dev \"t5s1if\" up\n", "delta": "0:00:00.423699", "end": "2019-12-06 23:33:43.350244", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "rc": 0, "start": "2019-12-06 23:33:42.926545", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.131.1', u'name': u't3', u'pns_ip': u'192.168.131.1/24', u'tenant_if': u't3if', u'pid': u'21000', u'tenant_ip': u'192.168.131.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t3pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t3pns_if\" netns pns1 ; fi\ndocker exec \"t3\" ip link show \"t3if\" ; if [ $? -ne 0 ] ; then ip link set \"t3if\" netns \"21000\" ; fi\nip netns exec pns1 ip link set dev \"t3pns_if\" up\ndocker exec \"t3\" ip link set dev \"t3if\" up\n", "delta": "0:00:00.569564", "end": "2019-12-06 23:33:43.545096", "item": {"default_route_ip": "192.168.131.1", "name": "t3", "pid": "21000", "pns_if": "t3pns_if", "pns_ip": "192.168.131.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.131.2/24"}, "rc": 0, "start": "2019-12-06 23:33:42.975532", "stderr": "Device \"t3pns_if\" does not exist.\nDevice \"t3if\" does not exist.", "stderr_lines": ["Device \"t3pns_if\" does not exist.", "Device \"t3if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link set dev \"t5ns2if\" up\ndocker exec \"t5ns2\" ip link set dev \"t5s2if\" up\n", "delta": "0:00:00.387311", "end": "2019-12-06 23:33:44.032692", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "rc": 0, "start": "2019-12-06 23:33:43.645381", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.131.1', u'name': u't3', u'pns_ip': u'192.168.131.1/24', u'tenant_if': u't3if', u'pid': u'21000', u'tenant_ip': u'192.168.131.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t3pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.131.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.131.1/24\" dev \"t3pns_if\" ; fi\ndocker exec \"t3\" ip addr show \"t3if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.131.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t3\" ip addr add \"192.168.131.2/24\" dev \"t3if\" ; fi\n", "delta": "0:00:00.507624", "end": "2019-12-06 23:33:44.398684", "item": {"default_route_ip": "192.168.131.1", "name": "t3", "pid": "21000", "pns_if": "t3pns_if", "pns_ip": "192.168.131.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.131.2/24"}, "rc": 0, "start": "2019-12-06 23:33:43.891060", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip link show \"t3ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t3ns1if\" type veth peer name \"t3s1if\" ; fi\n", "delta": "0:00:00.204697", "end": "2019-12-06 23:33:44.956705", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "rc": 0, "start": "2019-12-06 23:33:44.752008", "stderr": "Device \"t3ns1if\" does not exist.", "stderr_lines": ["Device \"t3ns1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip addr show \"t5s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.41.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip addr add \"10.2.41.2/24\" dev \"t5s1if\" ; fi\n\ndocker exec \"t5\" ip addr show \"t5ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.41.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip addr add \"10.2.41.1/24\" dev \"t5ns1if\" ; fi\n", "delta": "0:00:00.830194", "end": "2019-12-06 23:33:45.264942", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "rc": 0, "start": "2019-12-06 23:33:44.434748", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip link show \"t3ns2if\" ; if [ $? -ne 0 ] ; then ip link add \"t3ns2if\" type veth peer name \"t3s2if\" ; fi\n", "delta": "0:00:00.189918", "end": "2019-12-06 23:33:45.483850", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "rc": 0, "start": "2019-12-06 23:33:45.293932", "stderr": "Device \"t3ns2if\" does not exist.", "stderr_lines": ["Device \"t3ns2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip link show \"t3ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t3ns1if\" netns \"21000\" ; fi\ndocker exec \"t3ns1\" ip link show \"t3s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t3s1if\" netns \"22985\" ; fi\n", "delta": "0:00:00.485907", "end": "2019-12-06 23:33:46.344314", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "rc": 0, "start": "2019-12-06 23:33:45.858407", "stderr": "Device \"t3ns1if\" does not exist.\nDevice \"t3s1if\" does not exist.", "stderr_lines": ["Device \"t3ns1if\" does not exist.", "Device \"t3s1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ip addr show \"t5s2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.42.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" ip addr add \"10.2.42.2/24\" dev \"t5s2if\" ; fi\n\ndocker exec \"t5\" ip addr show \"t5ns2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.42.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip addr add \"10.2.42.1/24\" dev \"t5ns2if\" ; fi\n", "delta": "0:00:00.938642", "end": "2019-12-06 23:33:46.532267", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "rc": 0, "start": "2019-12-06 23:33:45.593625", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip link show \"t3ns2if\" ; if [ $? -ne 0 ] ; then ip link set \"t3ns2if\" netns \"21000\" ; fi\ndocker exec \"t3ns2\" ip link show \"t3s2if\" ; if [ $? -ne 0 ] ; then ip link set \"t3s2if\" netns \"24775\" ; fi\n", "delta": "0:00:00.487894", "end": "2019-12-06 23:33:47.152786", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "rc": 0, "start": "2019-12-06 23:33:46.664892", "stderr": "Device \"t3ns2if\" does not exist.\nDevice \"t3s2if\" does not exist.", "stderr_lines": ["Device \"t3ns2if\" does not exist.", "Device \"t3s2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.133.1', u'name': u't5', u'pns_ip': u'192.168.133.1/24', u'tenant_if': u't5if', u'pid': u'17607', u'tenant_ip': u'192.168.133.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t5\" ip route del default ; fi\n", "delta": "0:00:00.416910", "end": "2019-12-06 23:33:47.332971", "item": {"default_route_ip": "192.168.133.1", "name": "t5", "pid": "17607", "pns_if": "t5pns_if", "pns_ip": "192.168.133.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.133.2/24"}, "rc": 0, "start": "2019-12-06 23:33:46.916061", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip link set dev \"t3ns1if\" up\ndocker exec \"t3ns1\" ip link set dev \"t3s1if\" up\n", "delta": "0:00:00.377574", "end": "2019-12-06 23:33:47.915232", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "rc": 0, "start": "2019-12-06 23:33:47.537658", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.133.1', u'name': u't5', u'pns_ip': u'192.168.133.1/24', u'tenant_if': u't5if', u'pid': u'17607', u'tenant_ip': u'192.168.133.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip route show default | grep -w '[d]efault via 192.168.133.1' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip route add default via \"192.168.133.1\" ; fi\n", "delta": "0:00:00.455106", "end": "2019-12-06 23:33:48.142706", "item": {"default_route_ip": "192.168.133.1", "name": "t5", "pid": "17607", "pns_if": "t5pns_if", "pns_ip": "192.168.133.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.133.2/24"}, "rc": 0, "start": "2019-12-06 23:33:47.687600", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip link set dev \"t3ns2if\" up\ndocker exec \"t3ns2\" ip link set dev \"t3s2if\" up\n", "delta": "0:00:00.407057", "end": "2019-12-06 23:33:48.646456", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "rc": 0, "start": "2019-12-06 23:33:48.239399", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'tenant_route_ip': u'192.168.133.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.2.41.0/24', u'remote_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t5ns1\" ip route del default ; fi\n", "delta": "0:00:00.420632", "end": "2019-12-06 23:33:48.948797", "item": {"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 23:33:48.528165", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_sub_if': u't5s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t5ns2\" ip route del default ; fi\n", "delta": "0:00:00.445028", "end": "2019-12-06 23:33:49.712074", "item": {"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:33:49.267046", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip addr show \"t3s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.21.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" ip addr add \"10.2.21.2/24\" dev \"t3s1if\" ; fi\n\ndocker exec \"t3\" ip addr show \"t3ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.21.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t3\" ip addr add \"10.2.21.1/24\" dev \"t3ns1if\" ; fi\n", "delta": "0:00:00.813597", "end": "2019-12-06 23:33:49.860462", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "rc": 0, "start": "2019-12-06 23:33:49.046865", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'tenant_route_ip': u'192.168.133.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.2.41.0/24', u'remote_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip route show default | grep -w '[d]efault via 10.2.41.1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip route add default via \"10.2.41.1\" ; fi\n", "delta": "0:00:00.432023", "end": "2019-12-06 23:33:50.551369", "item": {"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 23:33:50.119346", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns2\" ip addr show \"t3s2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.22.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t3ns2\" ip addr add \"10.2.22.2/24\" dev \"t3s2if\" ; fi\n\ndocker exec \"t3\" ip addr show \"t3ns2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.22.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t3\" ip addr add \"10.2.22.1/24\" dev \"t3ns2if\" ; fi\n", "delta": "0:00:00.875843", "end": "2019-12-06 23:33:51.042534", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "rc": 0, "start": "2019-12-06 23:33:50.166691", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route] *********************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_sub_if': u't5s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ip route show default | grep -w '[d]efault via 10.2.42.1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" ip route add default via \"10.2.42.1\" ; fi\n", "delta": "0:00:00.441577", "end": "2019-12-06 23:33:51.316849", "item": {"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:33:50.875272", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside namespace] ***********************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.131.1', u'name': u't3', u'pns_ip': u'192.168.131.1/24', u'tenant_if': u't3if', u'pid': u'21000', u'tenant_ip': u'192.168.131.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t3\" ip route del default ; fi\n", "delta": "0:00:00.407217", "end": "2019-12-06 23:33:51.820117", "item": {"default_route_ip": "192.168.131.1", "name": "t3", "pid": "21000", "pns_if": "t3pns_if", "pns_ip": "192.168.131.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.131.2/24"}, "rc": 0, "start": "2019-12-06 23:33:51.412900", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'tenant_route_ip': u'192.168.133.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.2.41.0/24', u'remote_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show | grep -w '^t5br1'; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addbr \"t5br1\" ; fi\ndocker exec \"t5ns1\" ip link set dev \"t5br1\" up\n", "delta": "0:00:00.712255", "end": "2019-12-06 23:33:52.399085", "item": {"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 23:33:51.686830", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.131.1', u'name': u't3', u'pns_ip': u'192.168.131.1/24', u'tenant_if': u't3if', u'pid': u'21000', u'tenant_ip': u'192.168.131.2/24', u'pns_if': u't3pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3\" ip route show default | grep -w '[d]efault via 192.168.131.1' ; if [ $? -ne 0 ] ; then docker exec \"t3\" ip route add default via \"192.168.131.1\" ; fi\n", "delta": "0:00:00.472422", "end": "2019-12-06 23:33:52.715973", "item": {"default_route_ip": "192.168.131.1", "name": "t3", "pid": "21000", "pns_if": "t3pns_if", "pns_ip": "192.168.131.1/24", "tenant_if": "t3if", "tenant_ip": "192.168.131.2/24"}, "rc": 0, "start": "2019-12-06 23:33:52.243551", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_sub_if': u't5s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" brctl show | grep -w '^t5br2'; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" brctl addbr \"t5br2\" ; fi\ndocker exec \"t5ns2\" ip link set dev \"t5br2\" up\n", "delta": "0:00:00.632954", "end": "2019-12-06 23:33:53.321717", "item": {"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:33:52.688763", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_ns_name': u't3', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'tenant_route_ip': u'192.168.131.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.2.21.0/24', u'remote_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t3ns1\" ip route del default ; fi\n", "delta": "0:00:00.442579", "end": "2019-12-06 23:33:53.549772", "item": {"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, "rc": 0, "start": "2019-12-06 23:33:53.107193", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_ns_name': u't3', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns2\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t3ns2\" ip route del default ; fi\n", "delta": "0:00:00.486417", "end": "2019-12-06 23:33:54.324425", "item": {"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:33:53.838008", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"t5s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip link add \"t5s1_dnsbrif\" type veth peer name \"t5s1_dnsif\" ; fi\ndocker exec \"t5ns1\" ip link set dev \"t5s1_dnsbrif\" up\ndocker exec \"t5ns1\" ip link set dev \"t5s1_dnsif\" up\n", "delta": "0:00:00.899394", "end": "2019-12-06 23:33:54.604496", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:33:53.705102", "stderr": "Device \"t5s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t5s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_ns_name': u't3', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'tenant_route_ip': u'192.168.131.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.2.21.0/24', u'remote_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip route show default | grep -w '[d]efault via 10.2.21.1' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" ip route add default via \"10.2.21.1\" ; fi\n", "delta": "0:00:00.417085", "end": "2019-12-06 23:33:55.127150", "item": {"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, "rc": 0, "start": "2019-12-06 23:33:54.710065", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ip link show \"t5s2_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" ip link add \"t5s2_dnsbrif\" type veth peer name \"t5s2_dnsif\" ; fi\ndocker exec \"t5ns2\" ip link set dev \"t5s2_dnsbrif\" up\ndocker exec \"t5ns2\" ip link set dev \"t5s2_dnsif\" up\n", "delta": "0:00:00.874749", "end": "2019-12-06 23:33:55.794955", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:33:54.920206", "stderr": "Device \"t5s2_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t5s2_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_ns_name': u't3', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns2\" ip route show default | grep -w '[d]efault via 10.2.22.1' ; if [ $? -ne 0 ] ; then docker exec \"t3ns2\" ip route add default via \"10.2.22.1\" ; fi\n", "delta": "0:00:00.425707", "end": "2019-12-06 23:33:55.892992", "item": {"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:33:55.467285", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside namespace] ***********************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 't5s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"t5s1_dnsbrif\" ; fi\n", "delta": "0:00:00.456789", "end": "2019-12-06 23:33:56.630417", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:33:56.173628", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_ns_name': u't3', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_sub_if': u't3s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'tenant_route_ip': u'192.168.131.2', u'dsport': 4789, u'dev': u't3s1if', u'subnet_route': u'10.2.21.0/24', u'remote_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" brctl show | grep -w '^t3br1'; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" brctl addbr \"t3br1\" ; fi\ndocker exec \"t3ns1\" ip link set dev \"t3br1\" up\n", "delta": "0:00:00.675619", "end": "2019-12-06 23:33:56.910613", "item": {"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, "rc": 0, "start": "2019-12-06 23:33:56.234994", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" brctl show \"t5br2\" | grep -w 't5s2_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" brctl addif \"t5br2\" \"t5s2_dnsbrif\" ; fi\n", "delta": "0:00:00.418580", "end": "2019-12-06 23:33:57.389883", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:33:56.971303", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_ns_name': u't3', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_sub_if': u't3s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns2\" brctl show | grep -w '^t3br2'; if [ $? -ne 0 ] ; then docker exec \"t3ns2\" brctl addbr \"t3br2\" ; fi\ndocker exec \"t3ns2\" ip link set dev \"t3br2\" up\n", "delta": "0:00:00.661860", "end": "2019-12-06 23:33:57.862479", "item": {"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:33:57.200619", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"t5br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t5C3if1\" type veth peer name \"t5br1if1\" ; fi\nip link set dev \"t5br1if1\" up\nip link set dev \"t5C3if1\" up\n", "delta": "0:00:00.223437", "end": "2019-12-06 23:33:57.985219", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "rc": 0, "start": "2019-12-06 23:33:57.761782", "stderr": "Device \"t5br1if1\" does not exist.", "stderr_lines": ["Device \"t5br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ip link show \"t5br2if1\" ; if [ $? -ne 0 ] ; then ip link add \"t5C4if1\" type veth peer name \"t5br2if1\" ; fi\nip link set dev \"t5br2if1\" up\nip link set dev \"t5C4if1\" up\n", "delta": "0:00:00.203090", "end": "2019-12-06 23:33:58.491129", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "rc": 0, "start": "2019-12-06 23:33:58.288039", "stderr": "Device \"t5br2if1\" does not exist.", "stderr_lines": ["Device \"t5br2if1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip link show \"t3s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" ip link add \"t3s1_dnsbrif\" type veth peer name \"t3s1_dnsif\" ; fi\ndocker exec \"t3ns1\" ip link set dev \"t3s1_dnsbrif\" up\ndocker exec \"t3ns1\" ip link set dev \"t3s1_dnsif\" up\n", "delta": "0:00:00.844895", "end": "2019-12-06 23:33:59.120247", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:33:58.275352", "stderr": "Device \"t3s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t3s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t5br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t5br1if1\" netns \"18346\" ; fi\ndocker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 't5br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"t5br1if1\" ; fi\n", "delta": "0:00:00.481438", "end": "2019-12-06 23:33:59.371873", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "rc": 0, "start": "2019-12-06 23:33:58.890435", "stderr": "", "stderr_lines": [], "stdout": "67: t5br1if1@t5C3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 92:f6:79:23:72:ad brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["67: t5br1if1@t5C3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 92:f6:79:23:72:ad brd ff:ff:ff:ff:ff:ff"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t5br2if1\" ; if [ $? -eq 0 ] ; then ip link set \"t5br2if1\" netns \"19475\" ; fi\ndocker exec \"t5ns2\" brctl show \"t5br2\" | grep -w 't5br2if1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" brctl addif \"t5br2\" \"t5br2if1\" ; fi\n", "delta": "0:00:00.498035", "end": "2019-12-06 23:34:00.171064", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "rc": 0, "start": "2019-12-06 23:33:59.673029", "stderr": "", "stderr_lines": [], "stdout": "69: t5br2if1@t5C4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether fa:5d:b2:64:37:56 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["69: t5br2if1@t5C4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether fa:5d:b2:64:37:56 brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns2\" ip link show \"t3s2_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t3ns2\" ip link add \"t3s2_dnsbrif\" type veth peer name \"t3s2_dnsif\" ; fi\ndocker exec \"t3ns2\" ip link set dev \"t3s2_dnsbrif\" up\ndocker exec \"t3ns2\" ip link set dev \"t3s2_dnsif\" up\n", "delta": "0:00:00.890498", "end": "2019-12-06 23:34:00.316052", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:33:59.425554", "stderr": "Device \"t3s2_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t3s2_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link set \"t5br1if1\" up\ndocker exec \"t5ns1\" ip link set dev \"t5br1\" up\n", "delta": "0:00:00.440445", "end": "2019-12-06 23:34:00.960395", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "rc": 0, "start": "2019-12-06 23:34:00.519950", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" brctl show \"t3br1\" | grep -w 't3s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" brctl addif \"t3br1\" \"t3s1_dnsbrif\" ; fi\n", "delta": "0:00:00.458092", "end": "2019-12-06 23:34:01.147901", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:34:00.689809", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ip link set \"t5br2if1\" up\ndocker exec \"t5ns2\" ip link set dev \"t5br2\" up\n", "delta": "0:00:00.446021", "end": "2019-12-06 23:34:01.714961", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "rc": 0, "start": "2019-12-06 23:34:01.268940", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns2\" brctl show \"t3br2\" | grep -w 't3s2_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t3ns2\" brctl addif \"t3br2\" \"t3s2_dnsbrif\" ; fi\n", "delta": "0:00:00.457940", "end": "2019-12-06 23:34:01.920972", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:34:01.463032", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip addr show \"t5s1_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip addr add \"1.1.1.1/24\" dev \"t5s1_dnsif\" ; fi\n", "delta": "0:00:00.467773", "end": "2019-12-06 23:34:02.574163", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:34:02.106390", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip link show \"t3br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t3C3if1\" type veth peer name \"t3br1if1\" ; fi\nip link set dev \"t3br1if1\" up\nip link set dev \"t3C3if1\" up\n", "delta": "0:00:00.286418", "end": "2019-12-06 23:34:02.608277", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}], "rc": 0, "start": "2019-12-06 23:34:02.321859", "stderr": "Device \"t3br1if1\" does not exist.", "stderr_lines": ["Device \"t3br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns2\" ip link show \"t3br2if1\" ; if [ $? -ne 0 ] ; then ip link add \"t3C4if1\" type veth peer name \"t3br2if1\" ; fi\nip link set dev \"t3br2if1\" up\nip link set dev \"t3C4if1\" up\n", "delta": "0:00:00.217923", "end": "2019-12-06 23:34:03.108471", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}], "rc": 0, "start": "2019-12-06 23:34:02.890548", "stderr": "Device \"t3br2if1\" does not exist.", "stderr_lines": ["Device \"t3br2if1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ip addr show \"t5s2_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^2.2.2.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" ip addr add \"2.2.2.1/24\" dev \"t5s2_dnsif\" ; fi\n", "delta": "0:00:00.455250", "end": "2019-12-06 23:34:03.336915", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:34:02.881665", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t3br1if1\" netns \"22985\" ; fi\ndocker exec \"t3ns1\" brctl show \"t3br1\" | grep -w 't3br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" brctl addif \"t3br1\" \"t3br1if1\" ; fi\n", "delta": "0:00:00.445163", "end": "2019-12-06 23:34:03.904274", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}], "rc": 0, "start": "2019-12-06 23:34:03.459111", "stderr": "", "stderr_lines": [], "stdout": "71: t3br1if1@t3C3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 0a:cb:96:df:a1:82 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["71: t3br1if1@t3C3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 0a:cb:96:df:a1:82 brd ff:ff:ff:ff:ff:ff"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t3br2if1\" ; if [ $? -eq 0 ] ; then ip link set \"t3br2if1\" netns \"24775\" ; fi\ndocker exec \"t3ns2\" brctl show \"t3br2\" | grep -w 't3br2if1' ; if [ $? -ne 0 ] ; then docker exec \"t3ns2\" brctl addif \"t3br2\" \"t3br2if1\" ; fi\n", "delta": "0:00:00.426131", "end": "2019-12-06 23:34:04.607727", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}], "rc": 0, "start": "2019-12-06 23:34:04.181596", "stderr": "", "stderr_lines": [], "stdout": "73: t3br2if1@t3C4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 3e:2d:90:83:5a:b6 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["73: t3br2if1@t3C4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 3e:2d:90:83:5a:b6 brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ps aux | grep -w '[d]nsmasq --interface t5s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" dnsmasq --interface \"t5s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.959332", "end": "2019-12-06 23:34:04.668677", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:34:03.709345", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip link set \"t3br1if1\" up\ndocker exec \"t3ns1\" ip link set dev \"t3br1\" up\n", "delta": "0:00:00.484494", "end": "2019-12-06 23:34:05.443624", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}], "rc": 0, "start": "2019-12-06 23:34:04.959130", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ps aux | grep -w '[d]nsmasq --interface t5s2_dnsif -z --dhcp-range=2.2.2.5,2.2.2.254' ; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" dnsmasq --interface \"t5s2_dnsif\" -z --dhcp-range=2.2.2.5,'2.2.2.254' ; fi\n", "delta": "0:00:01.002746", "end": "2019-12-06 23:34:05.950718", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:34:04.947972", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns2\" ip link set \"t3br2if1\" up\ndocker exec \"t3ns2\" ip link set dev \"t3br2\" up\n", "delta": "0:00:00.390076", "end": "2019-12-06 23:34:06.094050", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}], "rc": 0, "start": "2019-12-06 23:34:05.703974", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip addr show \"t3s1_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" ip addr add \"1.1.1.1/24\" dev \"t3s1_dnsif\" ; fi\n", "delta": "0:00:00.488653", "end": "2019-12-06 23:34:06.970028", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:34:06.481375", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}]}, {u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"vxlan_t5s1\" ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip link add \"vxlan_t5s1\" type vxlan id \"42\" local \"10.2.41.2\" remote \"10.1.41.2\" dstport \"4789\" dev \"t5s1if\" ; docker exec \"t5ns1\" ip link set dev \"vxlan_t5s1\" up ; fi\n", "delta": "0:00:00.657817", "end": "2019-12-06 23:34:07.016950", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:34:06.359133", "stderr": "Device \"vxlan_t5s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t5s1\" does not exist."], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns2\" ip addr show \"t3s2_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^2.2.2.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t3ns2\" ip addr add \"2.2.2.1/24\" dev \"t3s2_dnsif\" ; fi\n", "delta": "0:00:00.466910", "end": "2019-12-06 23:34:07.719702", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:34:07.252792", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}]}, {u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 'vxlan_t5s1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"vxlan_t5s1\" ; fi\n", "delta": "0:00:00.484343", "end": "2019-12-06 23:34:07.874863", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:34:07.390520", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}], u'vxlan': [{u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]}, {u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ps aux | grep -w '[d]nsmasq --interface t3s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" dnsmasq --interface \"t3s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.845216", "end": "2019-12-06 23:34:08.923407", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}], "vxlan": [{"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}]}, {"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:34:08.078191", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]}, {u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip route show \"10.1.41.0/24\" via \"192.168.5.2\" | grep -w '^10.1.41.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip route add \"10.1.41.0/24\" via \"192.168.5.2\" ; fi\n", "delta": "0:00:00.081663", "end": "2019-12-06 23:34:09.093920", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:34:09.012257", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": "ip netns exec pns1 ip addr show p11 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.045334", "end": "2019-12-06 23:34:09.354346", "rc": 0, "start": "2019-12-06 23:34:09.309012", "stderr": "", "stderr_lines": [], "stdout": "192.168.200.207", "stdout_lines": ["192.168.200.207"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]}, {u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.1.41.0/24\" via \"192.168.200.207\" | grep -w '^10.1.41.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.1.41.0/24\" via \"192.168.200.207\" ; fi\nip route show \"10.2.41.0/24\" via 99.99.99.2 | grep -w '^10.2.41.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.2.41.0/24\" via 99.99.99.2 ; fi\n", "delta": "0:00:00.013022", "end": "2019-12-06 23:34:09.617953", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:34:09.604931", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns2\" ps aux | grep -w '[d]nsmasq --interface t3s2_dnsif -z --dhcp-range=2.2.2.5,2.2.2.254' ; if [ $? -ne 0 ] ; then docker exec \"t3ns2\" dnsmasq --interface \"t3s2_dnsif\" -z --dhcp-range=2.2.2.5,'2.2.2.254' ; fi\n", "delta": "0:00:00.877692", "end": "2019-12-06 23:34:10.079155", "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:34:09.201463", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************

PLAY [worker] ***********************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}]}, {u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip route show \"10.2.41.0/24\" via \"192.168.133.2\" | grep -w '^10.2.41.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip route add \"10.2.41.0/24\" via \"192.168.133.2\" ; fi\n", "delta": "0:00:00.071125", "end": "2019-12-06 23:34:10.914872", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:34:10.843747", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Get PNS ip address] ***********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}]}, {u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" ip link show \"vxlan_t3s1\" ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" ip link add \"vxlan_t3s1\" type vxlan id \"42\" local \"10.2.21.2\" remote \"10.1.21.2\" dstport \"4789\" dev \"t3s1if\" ; docker exec \"t3ns1\" ip link set dev \"vxlan_t3s1\" up ; fi\n", "delta": "0:00:00.607572", "end": "2019-12-06 23:34:11.044781", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-06 23:34:10.437209", "stderr": "Device \"vxlan_t3s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t3s1\" does not exist."], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": "ip netns exec pns1 ip addr show p11 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.035692", "end": "2019-12-06 23:34:11.279513", "rc": 0, "start": "2019-12-06 23:34:11.243821", "stderr": "", "stderr_lines": [], "stdout": "192.168.200.5", "stdout_lines": ["192.168.200.5"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'18346', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}]}, {u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.2.41.0/24\" via \"192.168.200.5\" | grep -w '^10.2.41.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.2.41.0/24\" via \"192.168.200.5\" ; fi\nip route show \"10.1.41.0/24\" via 99.99.99.1 | grep -w '^10.1.41.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.1.41.0/24\" via 99.99.99.1 ; fi\n", "delta": "0:00:00.009938", "end": "2019-12-06 23:34:11.679622", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "18346", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:34:11.669684", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'19475', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'17607', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "19475", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "17607", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}]}, {u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t3ns1\" brctl show \"t3br1\" | grep -w 'vxlan_t3s1' ; if [ $? -ne 0 ] ; then docker exec \"t3ns1\" brctl addif \"t3br1\" \"vxlan_t3s1\" ; fi\n", "delta": "0:00:00.406011", "end": "2019-12-06 23:34:11.803831", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-06 23:34:11.397820", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************

PLAY [main] *************************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
ok: [localhost] => {"actions": [], "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}]}, {u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip route show \"10.1.21.0/24\" via \"192.168.3.2\" | grep -w '^10.1.21.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip route add \"10.1.21.0/24\" via \"192.168.3.2\" ; fi\n", "delta": "0:00:00.067230", "end": "2019-12-06 23:34:13.153992", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-06 23:34:13.086762", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": "ip netns exec pns1 ip addr show p11 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.053027", "end": "2019-12-06 23:34:13.426545", "rc": 0, "start": "2019-12-06 23:34:13.373518", "stderr": "", "stderr_lines": [], "stdout": "192.168.200.207", "stdout_lines": ["192.168.200.207"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.1.21.1', u'pid': u'18941', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'18329', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.1.21.2/24', u'tenant_ns_ip': u'10.1.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C1if1', u'name': u't3_C1'}, {u'vm_pid': u'', u'brif': u't3br1if2', u'vmif': u't3C2if1', u'name': u't3_C2'}]}, {u'local_ip': u'10.1.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.3.2', u'remote_route': u'10.2.21.0/24', u'subnet_route': u'10.1.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.2.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.1.21.0/24\" via \"192.168.200.207\" | grep -w '^10.1.21.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.1.21.0/24\" via \"192.168.200.207\" ; fi\nip route show \"10.2.21.0/24\" via 99.99.99.2 | grep -w '^10.2.21.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.2.21.0/24\" via 99.99.99.2 ; fi\n", "delta": "0:00:00.014489", "end": "2019-12-06 23:34:13.718261", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.1.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "18941", "route": [{"if": "p1", "ip": "10.1.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.1.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "18329", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.1.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C1", "vm_pid": "", "vmif": "t3C1if1"}, {"brif": "t3br1if2", "name": "t3_C2", "vm_pid": "", "vmif": "t3C2if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.21.2", "remote_ip": "10.2.21.2", "remote_route": "10.2.21.0/24", "subnet_route": "10.1.21.0/24", "tenant_route_ip": "192.168.3.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-06 23:34:13.703772", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}]) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:34:13.731017975Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/2f35b6ac6a079df7887b13032e94740fbd989cb5929f5cfb38233d34b9f3ac8a-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/2f35b6ac6a079df7887b13032e94740fbd989cb5929f5cfb38233d34b9f3ac8a/merged", "UpperDir": "/var/lib/docker/overlay2/2f35b6ac6a079df7887b13032e94740fbd989cb5929f5cfb38233d34b9f3ac8a/diff", "WorkDir": "/var/lib/docker/overlay2/2f35b6ac6a079df7887b13032e94740fbd989cb5929f5cfb38233d34b9f3ac8a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/5753473d94e245c5abe9034dd7402b6092c82aaccdfc775fdc541584a66a5708/hostname", "HostsPath": "/var/lib/docker/containers/5753473d94e245c5abe9034dd7402b6092c82aaccdfc775fdc541584a66a5708/hosts", "Id": "5753473d94e245c5abe9034dd7402b6092c82aaccdfc775fdc541584a66a5708", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/5753473d94e245c5abe9034dd7402b6092c82aaccdfc775fdc541584a66a5708/5753473d94e245c5abe9034dd7402b6092c82aaccdfc775fdc541584a66a5708-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ee0e63a2e5dc4963308962ac96f69697605bc61cf83d92fc046a148e060d6250", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ee0e63a2e5dc4963308962ac96f69697605bc61cf83d92fc046a148e060d6250/_data", "Type": "volume"}], "Name": "/t5_C1", "NetworkSettings": {"Bridge": "", "EndpointID": "96212e0aff84c4535fc42fa03c5d63ca7d3279fae1bb19056ad7e25ebadad2ae", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:06", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "96212e0aff84c4535fc42fa03c5d63ca7d3279fae1bb19056ad7e25ebadad2ae", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:06", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "2cafb2805c7ca5ebec55295b5eeafb00a35054b82cbe9bae9493a967d5fd24a8", "SandboxKey": "/var/run/docker/netns/2cafb2805c7c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/5753473d94e245c5abe9034dd7402b6092c82aaccdfc775fdc541584a66a5708/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8274, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:34:14.3381736Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:34:13.731017975Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/2f35b6ac6a079df7887b13032e94740fbd989cb5929f5cfb38233d34b9f3ac8a-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/2f35b6ac6a079df7887b13032e94740fbd989cb5929f5cfb38233d34b9f3ac8a/merged", "UpperDir": "/var/lib/docker/overlay2/2f35b6ac6a079df7887b13032e94740fbd989cb5929f5cfb38233d34b9f3ac8a/diff", "WorkDir": "/var/lib/docker/overlay2/2f35b6ac6a079df7887b13032e94740fbd989cb5929f5cfb38233d34b9f3ac8a/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/5753473d94e245c5abe9034dd7402b6092c82aaccdfc775fdc541584a66a5708/hostname", "HostsPath": "/var/lib/docker/containers/5753473d94e245c5abe9034dd7402b6092c82aaccdfc775fdc541584a66a5708/hosts", "Id": "5753473d94e245c5abe9034dd7402b6092c82aaccdfc775fdc541584a66a5708", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/5753473d94e245c5abe9034dd7402b6092c82aaccdfc775fdc541584a66a5708/5753473d94e245c5abe9034dd7402b6092c82aaccdfc775fdc541584a66a5708-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "ee0e63a2e5dc4963308962ac96f69697605bc61cf83d92fc046a148e060d6250", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/ee0e63a2e5dc4963308962ac96f69697605bc61cf83d92fc046a148e060d6250/_data", "Type": "volume"}], "Name": "/t5_C1", "NetworkSettings": {"Bridge": "", "EndpointID": "96212e0aff84c4535fc42fa03c5d63ca7d3279fae1bb19056ad7e25ebadad2ae", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:06", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "96212e0aff84c4535fc42fa03c5d63ca7d3279fae1bb19056ad7e25ebadad2ae", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.6", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:06", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "2cafb2805c7ca5ebec55295b5eeafb00a35054b82cbe9bae9493a967d5fd24a8", "SandboxKey": "/var/run/docker/netns/2cafb2805c7c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/5753473d94e245c5abe9034dd7402b6092c82aaccdfc775fdc541584a66a5708/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8274, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:34:14.3381736Z", "Status": "running"}}, "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}]}

PLAY [worker] ***********************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}]}, {u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip route show \"10.2.21.0/24\" via \"192.168.131.2\" | grep -w '^10.2.21.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip route add \"10.2.21.0/24\" via \"192.168.131.2\" ; fi\n", "delta": "0:00:00.073201", "end": "2019-12-06 23:34:15.515076", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-06 23:34:15.441875", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": "ip netns exec pns1 ip addr show p11 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.041833", "end": "2019-12-06 23:34:16.031471", "rc": 0, "start": "2019-12-06 23:34:15.989638", "stderr": "", "stderr_lines": [], "stdout": "192.168.200.5", "stdout_lines": ["192.168.200.5"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:34:14.983239807Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/d1c54bd8051cd18f009cd794f8b66207288219e81bc2aff9f9cf11cd8a3e7e07-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/d1c54bd8051cd18f009cd794f8b66207288219e81bc2aff9f9cf11cd8a3e7e07/merged", "UpperDir": "/var/lib/docker/overlay2/d1c54bd8051cd18f009cd794f8b66207288219e81bc2aff9f9cf11cd8a3e7e07/diff", "WorkDir": "/var/lib/docker/overlay2/d1c54bd8051cd18f009cd794f8b66207288219e81bc2aff9f9cf11cd8a3e7e07/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c45dc4c60e7c74d07a429ae37ad0f6841a6d1defca1b13cef74435f91ea4b022/hostname", "HostsPath": "/var/lib/docker/containers/c45dc4c60e7c74d07a429ae37ad0f6841a6d1defca1b13cef74435f91ea4b022/hosts", "Id": "c45dc4c60e7c74d07a429ae37ad0f6841a6d1defca1b13cef74435f91ea4b022", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/c45dc4c60e7c74d07a429ae37ad0f6841a6d1defca1b13cef74435f91ea4b022/c45dc4c60e7c74d07a429ae37ad0f6841a6d1defca1b13cef74435f91ea4b022-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "f9fc4baddf5bbdeb323c7371cb9d61aa74a9b89d62debd48958490ef47275ca1", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/f9fc4baddf5bbdeb323c7371cb9d61aa74a9b89d62debd48958490ef47275ca1/_data", "Type": "volume"}], "Name": "/t5_C2", "NetworkSettings": {"Bridge": "", "EndpointID": "ba833ec6569df4bc1f5d6cceb82aa353c978702a6e4d07189d6e88f7e1d00857", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:07", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "ba833ec6569df4bc1f5d6cceb82aa353c978702a6e4d07189d6e88f7e1d00857", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:07", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "f8204edda32fb0dcfc9a2232becc9d2cbef482516c580cb86ed5c5df75c82770", "SandboxKey": "/var/run/docker/netns/f8204edda32f", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c45dc4c60e7c74d07a429ae37ad0f6841a6d1defca1b13cef74435f91ea4b022/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8877, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:34:16.255487265Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:34:14.983239807Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/d1c54bd8051cd18f009cd794f8b66207288219e81bc2aff9f9cf11cd8a3e7e07-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/d1c54bd8051cd18f009cd794f8b66207288219e81bc2aff9f9cf11cd8a3e7e07/merged", "UpperDir": "/var/lib/docker/overlay2/d1c54bd8051cd18f009cd794f8b66207288219e81bc2aff9f9cf11cd8a3e7e07/diff", "WorkDir": "/var/lib/docker/overlay2/d1c54bd8051cd18f009cd794f8b66207288219e81bc2aff9f9cf11cd8a3e7e07/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c45dc4c60e7c74d07a429ae37ad0f6841a6d1defca1b13cef74435f91ea4b022/hostname", "HostsPath": "/var/lib/docker/containers/c45dc4c60e7c74d07a429ae37ad0f6841a6d1defca1b13cef74435f91ea4b022/hosts", "Id": "c45dc4c60e7c74d07a429ae37ad0f6841a6d1defca1b13cef74435f91ea4b022", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/c45dc4c60e7c74d07a429ae37ad0f6841a6d1defca1b13cef74435f91ea4b022/c45dc4c60e7c74d07a429ae37ad0f6841a6d1defca1b13cef74435f91ea4b022-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "f9fc4baddf5bbdeb323c7371cb9d61aa74a9b89d62debd48958490ef47275ca1", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/f9fc4baddf5bbdeb323c7371cb9d61aa74a9b89d62debd48958490ef47275ca1/_data", "Type": "volume"}], "Name": "/t5_C2", "NetworkSettings": {"Bridge": "", "EndpointID": "ba833ec6569df4bc1f5d6cceb82aa353c978702a6e4d07189d6e88f7e1d00857", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:07", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "ba833ec6569df4bc1f5d6cceb82aa353c978702a6e4d07189d6e88f7e1d00857", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.7", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:07", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "f8204edda32fb0dcfc9a2232becc9d2cbef482516c580cb86ed5c5df75c82770", "SandboxKey": "/var/run/docker/netns/f8204edda32f", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c45dc4c60e7c74d07a429ae37ad0f6841a6d1defca1b13cef74435f91ea4b022/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 8877, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:34:16.255487265Z", "Status": "running"}}, "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}]}

TASK [Attach Container interface] ***************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.21.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.21.1', u'pid': u'22985', u'bridge_name': u't3br1', u'dns': [{u'dnsif': u't3s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s1_dnsbrif'}], u'ns_name': u't3ns1', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s1if', u'tenant_sub_ip': u'10.2.21.2/24', u'tenant_ns_ip': u'10.2.21.1/24', u'tenant_ns_if': u't3ns1if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br1if1', u'vmif': u't3C3if1', u'name': u't3_C3'}]}, {u'local_ip': u'10.2.21.2', u'dsport': 4789, u'dev': u't3s1if', u'tenant_route_ip': u'192.168.131.2', u'remote_route': u'10.1.21.0/24', u'subnet_route': u'10.2.21.0/24', u'v_name': u'vxlan_t3s1', u'id': 42, u'remote_ip': u'10.1.21.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.2.21.0/24\" via \"192.168.200.5\" | grep -w '^10.2.21.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.2.21.0/24\" via \"192.168.200.5\" ; fi\nip route show \"10.1.21.0/24\" via 99.99.99.1 | grep -w '^10.1.21.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.1.21.0/24\" via 99.99.99.1 ; fi\n", "delta": "0:00:00.009083", "end": "2019-12-06 23:34:16.570557", "item": [{"bridge_name": "t3br1", "default_route_ip": "10.2.21.1", "dns": [{"brif": "t3s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t3s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns1", "pid": "22985", "route": [{"if": "p1", "ip": "10.2.21.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns1if", "tenant_ns_ip": "10.2.21.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s1if", "tenant_sub_ip": "10.2.21.2/24"}], "vms": [{"brif": "t3br1if1", "name": "t3_C3", "vm_pid": "", "vmif": "t3C3if1"}]}, {"dev": "t3s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.21.2", "remote_ip": "10.1.21.2", "remote_route": "10.1.21.0/24", "subnet_route": "10.2.21.0/24", "tenant_route_ip": "192.168.131.2", "v_name": "vxlan_t3s1"}], "rc": 0, "start": "2019-12-06 23:34:16.561474", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.22.1/24', u'ns_name': u't3', u'ns_if': u't3if', u'if': u'p1'}], u'default_route_ip': u'10.2.22.1', u'pid': u'24775', u'bridge_name': u't3br2', u'dns': [{u'dnsif': u't3s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't3s2_dnsbrif'}], u'ns_name': u't3ns2', u'tenant_ns': [{u'tenant_ns_pid': u'21000', u'tenant_sub_if': u't3s2if', u'tenant_sub_ip': u'10.2.22.2/24', u'tenant_ns_ip': u'10.2.22.1/24', u'tenant_ns_if': u't3ns2if', u'tenant_ns_name': u't3'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't3br2if1', u'vmif': u't3C4if1', u'name': u't3_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t3br2", "default_route_ip": "10.2.22.1", "dns": [{"brif": "t3s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t3s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t3ns2", "pid": "24775", "route": [{"if": "p1", "ip": "10.2.22.1/24", "ns_if": "t3if", "ns_name": "t3"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t3ns2if", "tenant_ns_ip": "10.2.22.1/24", "tenant_ns_name": "t3", "tenant_ns_pid": "21000", "tenant_sub_if": "t3s2if", "tenant_sub_ip": "10.2.22.2/24"}], "vms": [{"brif": "t3br2if1", "name": "t3_C4", "vm_pid": "", "vmif": "t3C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 23:34:16.827380 Printing the yaml input file
INFO:root: 23:34:16.827558 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 23:34:16.827689 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 23:34:16.827753 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 23:34:16.827805 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file
failed: [localhost] (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5_C1\" ip link show \"t5C1if1\" ; if [ $? -ne 0 ] ; then ip link set \"t5C1if1\" netns \"\" ; fi\n", "delta": "0:00:00.607579", "end": "2019-12-06 23:34:17.516861", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "", "vmif": "t5C1if1"}], "msg": "non-zero return code", "rc": 2, "start": "2019-12-06 23:34:16.909282", "stderr": "Device \"t5C1if1\" does not exist.\nRTNETLINK answers: Invalid argument", "stderr_lines": ["Device \"t5C1if1\" does not exist.", "RTNETLINK answers: Invalid argument"], "stdout": "", "stdout_lines": []}
failed: [localhost] (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5_C2\" ip link show \"t5C2if1\" ; if [ $? -ne 0 ] ; then ip link set \"t5C2if1\" netns \"\" ; fi\n", "delta": "0:00:00.468911", "end": "2019-12-06 23:34:18.403350", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "", "vmif": "t5C2if1"}], "msg": "non-zero return code", "rc": 2, "start": "2019-12-06 23:34:17.934439", "stderr": "Device \"t5C2if1\" does not exist.\nRTNETLINK answers: Invalid argument", "stderr_lines": ["Device \"t5C2if1\" does not exist.", "RTNETLINK answers: Invalid argument"], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=2    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   


PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:34:19.91862238Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/c06af44e45fb94a0af57ad5ab58d0bf6533221ff456fb8794f30a785fea699be-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/c06af44e45fb94a0af57ad5ab58d0bf6533221ff456fb8794f30a785fea699be/merged", "UpperDir": "/var/lib/docker/overlay2/c06af44e45fb94a0af57ad5ab58d0bf6533221ff456fb8794f30a785fea699be/diff", "WorkDir": "/var/lib/docker/overlay2/c06af44e45fb94a0af57ad5ab58d0bf6533221ff456fb8794f30a785fea699be/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/0ed02acbc39d65d164e1ee0b6295956bb86942c6f3b1c2529df3cbe25530ff16/hostname", "HostsPath": "/var/lib/docker/containers/0ed02acbc39d65d164e1ee0b6295956bb86942c6f3b1c2529df3cbe25530ff16/hosts", "Id": "0ed02acbc39d65d164e1ee0b6295956bb86942c6f3b1c2529df3cbe25530ff16", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/0ed02acbc39d65d164e1ee0b6295956bb86942c6f3b1c2529df3cbe25530ff16/0ed02acbc39d65d164e1ee0b6295956bb86942c6f3b1c2529df3cbe25530ff16-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "c7d2d48a505185c09b0c3f7a9abfc72569a46af493cf0b266c546a798798204e", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/c7d2d48a505185c09b0c3f7a9abfc72569a46af493cf0b266c546a798798204e/_data", "Type": "volume"}], "Name": "/t4", "NetworkSettings": {"Bridge": "", "EndpointID": "4059c68a0a1b7dfd358b5b5d2568dcda094ed95670f414471aa329453c3d81cb", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:08", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "4059c68a0a1b7dfd358b5b5d2568dcda094ed95670f414471aa329453c3d81cb", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:08", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "6aa627cf71328455dbbfbfaba299a096ee69cc379af56e174ef8e32fd23aa150", "SandboxKey": "/var/run/docker/netns/6aa627cf7132", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/0ed02acbc39d65d164e1ee0b6295956bb86942c6f3b1c2529df3cbe25530ff16/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 13743, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:34:20.445069357Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:34:19.91862238Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/c06af44e45fb94a0af57ad5ab58d0bf6533221ff456fb8794f30a785fea699be-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/c06af44e45fb94a0af57ad5ab58d0bf6533221ff456fb8794f30a785fea699be/merged", "UpperDir": "/var/lib/docker/overlay2/c06af44e45fb94a0af57ad5ab58d0bf6533221ff456fb8794f30a785fea699be/diff", "WorkDir": "/var/lib/docker/overlay2/c06af44e45fb94a0af57ad5ab58d0bf6533221ff456fb8794f30a785fea699be/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/0ed02acbc39d65d164e1ee0b6295956bb86942c6f3b1c2529df3cbe25530ff16/hostname", "HostsPath": "/var/lib/docker/containers/0ed02acbc39d65d164e1ee0b6295956bb86942c6f3b1c2529df3cbe25530ff16/hosts", "Id": "0ed02acbc39d65d164e1ee0b6295956bb86942c6f3b1c2529df3cbe25530ff16", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/0ed02acbc39d65d164e1ee0b6295956bb86942c6f3b1c2529df3cbe25530ff16/0ed02acbc39d65d164e1ee0b6295956bb86942c6f3b1c2529df3cbe25530ff16-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "c7d2d48a505185c09b0c3f7a9abfc72569a46af493cf0b266c546a798798204e", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/c7d2d48a505185c09b0c3f7a9abfc72569a46af493cf0b266c546a798798204e/_data", "Type": "volume"}], "Name": "/t4", "NetworkSettings": {"Bridge": "", "EndpointID": "4059c68a0a1b7dfd358b5b5d2568dcda094ed95670f414471aa329453c3d81cb", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:08", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "4059c68a0a1b7dfd358b5b5d2568dcda094ed95670f414471aa329453c3d81cb", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:08", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "6aa627cf71328455dbbfbfaba299a096ee69cc379af56e174ef8e32fd23aa150", "SandboxKey": "/var/run/docker/netns/6aa627cf7132", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/0ed02acbc39d65d164e1ee0b6295956bb86942c6f3b1c2529df3cbe25530ff16/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 13743, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:34:20.445069357Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'tenant_route_ip': u'192.168.4.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.1.31.0/24', u'remote_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:34:20.987245572Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/7d84839277747deca9109ccaa01e473a0aa21d49896a40dfc92fb0b51de3bd99-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/7d84839277747deca9109ccaa01e473a0aa21d49896a40dfc92fb0b51de3bd99/merged", "UpperDir": "/var/lib/docker/overlay2/7d84839277747deca9109ccaa01e473a0aa21d49896a40dfc92fb0b51de3bd99/diff", "WorkDir": "/var/lib/docker/overlay2/7d84839277747deca9109ccaa01e473a0aa21d49896a40dfc92fb0b51de3bd99/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/43b0b34a502d224331d629acd35ce78ea7d955d24b05ea81c8979070573c2177/hostname", "HostsPath": "/var/lib/docker/containers/43b0b34a502d224331d629acd35ce78ea7d955d24b05ea81c8979070573c2177/hosts", "Id": "43b0b34a502d224331d629acd35ce78ea7d955d24b05ea81c8979070573c2177", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/43b0b34a502d224331d629acd35ce78ea7d955d24b05ea81c8979070573c2177/43b0b34a502d224331d629acd35ce78ea7d955d24b05ea81c8979070573c2177-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "6f9a7ee5f54eb4bf276e6c28d35085be51dcad22af4071890167a70aa72da6d0", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/6f9a7ee5f54eb4bf276e6c28d35085be51dcad22af4071890167a70aa72da6d0/_data", "Type": "volume"}], "Name": "/t4ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "22761faf259cc9ba2215c17aaf9be3ad2048ea655943300d139e75392a613138", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:09", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "22761faf259cc9ba2215c17aaf9be3ad2048ea655943300d139e75392a613138", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:09", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "d254ff8bf303afa0303b1f1189ac141baad47e509675451fac8c8e53a72a15ab", "SandboxKey": "/var/run/docker/netns/d254ff8bf303", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/43b0b34a502d224331d629acd35ce78ea7d955d24b05ea81c8979070573c2177/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 14205, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:34:22.17787827Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:34:20.987245572Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/7d84839277747deca9109ccaa01e473a0aa21d49896a40dfc92fb0b51de3bd99-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/7d84839277747deca9109ccaa01e473a0aa21d49896a40dfc92fb0b51de3bd99/merged", "UpperDir": "/var/lib/docker/overlay2/7d84839277747deca9109ccaa01e473a0aa21d49896a40dfc92fb0b51de3bd99/diff", "WorkDir": "/var/lib/docker/overlay2/7d84839277747deca9109ccaa01e473a0aa21d49896a40dfc92fb0b51de3bd99/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/43b0b34a502d224331d629acd35ce78ea7d955d24b05ea81c8979070573c2177/hostname", "HostsPath": "/var/lib/docker/containers/43b0b34a502d224331d629acd35ce78ea7d955d24b05ea81c8979070573c2177/hosts", "Id": "43b0b34a502d224331d629acd35ce78ea7d955d24b05ea81c8979070573c2177", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/43b0b34a502d224331d629acd35ce78ea7d955d24b05ea81c8979070573c2177/43b0b34a502d224331d629acd35ce78ea7d955d24b05ea81c8979070573c2177-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "6f9a7ee5f54eb4bf276e6c28d35085be51dcad22af4071890167a70aa72da6d0", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/6f9a7ee5f54eb4bf276e6c28d35085be51dcad22af4071890167a70aa72da6d0/_data", "Type": "volume"}], "Name": "/t4ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "22761faf259cc9ba2215c17aaf9be3ad2048ea655943300d139e75392a613138", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:09", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "22761faf259cc9ba2215c17aaf9be3ad2048ea655943300d139e75392a613138", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:09", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "d254ff8bf303afa0303b1f1189ac141baad47e509675451fac8c8e53a72a15ab", "SandboxKey": "/var/run/docker/netns/d254ff8bf303", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/43b0b34a502d224331d629acd35ce78ea7d955d24b05ea81c8979070573c2177/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 14205, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:34:22.17787827Z", "Status": "running"}}, "item": {"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.132.1', u'name': u't4', u'pns_ip': u'192.168.132.1/24', u'tenant_if': u't4if', u'tenant_ip': u'192.168.132.2/24', u'pns_if': u't4pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:34:25.887217298Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/8d8678b8ee8c3e7398947d6afaa39a0f20618ec985a9f1666b692973451c6a07-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/8d8678b8ee8c3e7398947d6afaa39a0f20618ec985a9f1666b692973451c6a07/merged", "UpperDir": "/var/lib/docker/overlay2/8d8678b8ee8c3e7398947d6afaa39a0f20618ec985a9f1666b692973451c6a07/diff", "WorkDir": "/var/lib/docker/overlay2/8d8678b8ee8c3e7398947d6afaa39a0f20618ec985a9f1666b692973451c6a07/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/703b103b4b6d979a4a55b57238380b799d58da2314c566de36c770d7537b66ff/hostname", "HostsPath": "/var/lib/docker/containers/703b103b4b6d979a4a55b57238380b799d58da2314c566de36c770d7537b66ff/hosts", "Id": "703b103b4b6d979a4a55b57238380b799d58da2314c566de36c770d7537b66ff", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/703b103b4b6d979a4a55b57238380b799d58da2314c566de36c770d7537b66ff/703b103b4b6d979a4a55b57238380b799d58da2314c566de36c770d7537b66ff-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "49ed4ec638483dea0586eeb4aa0c64f72dafcc027c589a136ad661574493f486", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/49ed4ec638483dea0586eeb4aa0c64f72dafcc027c589a136ad661574493f486/_data", "Type": "volume"}], "Name": "/t4", "NetworkSettings": {"Bridge": "", "EndpointID": "a8cde2b572ff3a391df1aa009075dd986a3ce40b13f931c8d35e28053de13d40", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:08", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "a8cde2b572ff3a391df1aa009075dd986a3ce40b13f931c8d35e28053de13d40", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:08", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "65662b06278b16eef0a2ac2e81a8eb487fbb798722dc083417f9fbd9587f07c5", "SandboxKey": "/var/run/docker/netns/65662b06278b", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/703b103b4b6d979a4a55b57238380b799d58da2314c566de36c770d7537b66ff/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12036, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:34:26.413314863Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:34:25.887217298Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/8d8678b8ee8c3e7398947d6afaa39a0f20618ec985a9f1666b692973451c6a07-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/8d8678b8ee8c3e7398947d6afaa39a0f20618ec985a9f1666b692973451c6a07/merged", "UpperDir": "/var/lib/docker/overlay2/8d8678b8ee8c3e7398947d6afaa39a0f20618ec985a9f1666b692973451c6a07/diff", "WorkDir": "/var/lib/docker/overlay2/8d8678b8ee8c3e7398947d6afaa39a0f20618ec985a9f1666b692973451c6a07/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/703b103b4b6d979a4a55b57238380b799d58da2314c566de36c770d7537b66ff/hostname", "HostsPath": "/var/lib/docker/containers/703b103b4b6d979a4a55b57238380b799d58da2314c566de36c770d7537b66ff/hosts", "Id": "703b103b4b6d979a4a55b57238380b799d58da2314c566de36c770d7537b66ff", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/703b103b4b6d979a4a55b57238380b799d58da2314c566de36c770d7537b66ff/703b103b4b6d979a4a55b57238380b799d58da2314c566de36c770d7537b66ff-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "49ed4ec638483dea0586eeb4aa0c64f72dafcc027c589a136ad661574493f486", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/49ed4ec638483dea0586eeb4aa0c64f72dafcc027c589a136ad661574493f486/_data", "Type": "volume"}], "Name": "/t4", "NetworkSettings": {"Bridge": "", "EndpointID": "a8cde2b572ff3a391df1aa009075dd986a3ce40b13f931c8d35e28053de13d40", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:08", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "a8cde2b572ff3a391df1aa009075dd986a3ce40b13f931c8d35e28053de13d40", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.8", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:08", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "65662b06278b16eef0a2ac2e81a8eb487fbb798722dc083417f9fbd9587f07c5", "SandboxKey": "/var/run/docker/netns/65662b06278b", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/703b103b4b6d979a4a55b57238380b799d58da2314c566de36c770d7537b66ff/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12036, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:34:26.413314863Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.132.1", "name": "t4", "pns_if": "t4pns_if", "pns_ip": "192.168.132.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.132.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'tenant_route_ip': u'192.168.132.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.2.31.0/24', u'remote_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:34:27.294845471Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/97c5ab6e41ff49a8e51e0b0f1d0517c4ba02888f22e2d39e27a68ebfe379c1f4-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/97c5ab6e41ff49a8e51e0b0f1d0517c4ba02888f22e2d39e27a68ebfe379c1f4/merged", "UpperDir": "/var/lib/docker/overlay2/97c5ab6e41ff49a8e51e0b0f1d0517c4ba02888f22e2d39e27a68ebfe379c1f4/diff", "WorkDir": "/var/lib/docker/overlay2/97c5ab6e41ff49a8e51e0b0f1d0517c4ba02888f22e2d39e27a68ebfe379c1f4/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/177f1d6e786747920eb87e4f0a80fec133e5e36a50236660c2218011709a3e13/hostname", "HostsPath": "/var/lib/docker/containers/177f1d6e786747920eb87e4f0a80fec133e5e36a50236660c2218011709a3e13/hosts", "Id": "177f1d6e786747920eb87e4f0a80fec133e5e36a50236660c2218011709a3e13", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/177f1d6e786747920eb87e4f0a80fec133e5e36a50236660c2218011709a3e13/177f1d6e786747920eb87e4f0a80fec133e5e36a50236660c2218011709a3e13-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "b48d4a32c1c65e0755ac9495cde3c8227dd30eca4eef09c23dd5e55a432ba761", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/b48d4a32c1c65e0755ac9495cde3c8227dd30eca4eef09c23dd5e55a432ba761/_data", "Type": "volume"}], "Name": "/t4ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "42c373fd150bfd82ecb2078db40f22b184e90335778ca5f32646cb88a2158215", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:09", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "42c373fd150bfd82ecb2078db40f22b184e90335778ca5f32646cb88a2158215", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:09", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "2f781ed6044e78448d395acffc717cb940acbc7a9c4ca5fdcb1a4c5d755a41a8", "SandboxKey": "/var/run/docker/netns/2f781ed6044e", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/177f1d6e786747920eb87e4f0a80fec133e5e36a50236660c2218011709a3e13/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12974, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:34:28.224180844Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:34:27.294845471Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/97c5ab6e41ff49a8e51e0b0f1d0517c4ba02888f22e2d39e27a68ebfe379c1f4-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/97c5ab6e41ff49a8e51e0b0f1d0517c4ba02888f22e2d39e27a68ebfe379c1f4/merged", "UpperDir": "/var/lib/docker/overlay2/97c5ab6e41ff49a8e51e0b0f1d0517c4ba02888f22e2d39e27a68ebfe379c1f4/diff", "WorkDir": "/var/lib/docker/overlay2/97c5ab6e41ff49a8e51e0b0f1d0517c4ba02888f22e2d39e27a68ebfe379c1f4/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/177f1d6e786747920eb87e4f0a80fec133e5e36a50236660c2218011709a3e13/hostname", "HostsPath": "/var/lib/docker/containers/177f1d6e786747920eb87e4f0a80fec133e5e36a50236660c2218011709a3e13/hosts", "Id": "177f1d6e786747920eb87e4f0a80fec133e5e36a50236660c2218011709a3e13", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/177f1d6e786747920eb87e4f0a80fec133e5e36a50236660c2218011709a3e13/177f1d6e786747920eb87e4f0a80fec133e5e36a50236660c2218011709a3e13-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "b48d4a32c1c65e0755ac9495cde3c8227dd30eca4eef09c23dd5e55a432ba761", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/b48d4a32c1c65e0755ac9495cde3c8227dd30eca4eef09c23dd5e55a432ba761/_data", "Type": "volume"}], "Name": "/t4ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "42c373fd150bfd82ecb2078db40f22b184e90335778ca5f32646cb88a2158215", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:09", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "42c373fd150bfd82ecb2078db40f22b184e90335778ca5f32646cb88a2158215", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.9", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:09", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "2f781ed6044e78448d395acffc717cb940acbc7a9c4ca5fdcb1a4c5d755a41a8", "SandboxKey": "/var/run/docker/netns/2f781ed6044e", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/177f1d6e786747920eb87e4f0a80fec133e5e36a50236660c2218011709a3e13/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12974, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:34:28.224180844Z", "Status": "running"}}, "item": {"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vmif": "t4C3if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4', u'tenant_sub_if': u't4s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:34:29.043927886Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/5868c739d904732156b8565156f0622e809e7b78afe09bda36615523d5e7184f-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/5868c739d904732156b8565156f0622e809e7b78afe09bda36615523d5e7184f/merged", "UpperDir": "/var/lib/docker/overlay2/5868c739d904732156b8565156f0622e809e7b78afe09bda36615523d5e7184f/diff", "WorkDir": "/var/lib/docker/overlay2/5868c739d904732156b8565156f0622e809e7b78afe09bda36615523d5e7184f/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/dc3dece10b843228827a359ab5df42af4a56a240c37a790c5acbfc5f52f41d83/hostname", "HostsPath": "/var/lib/docker/containers/dc3dece10b843228827a359ab5df42af4a56a240c37a790c5acbfc5f52f41d83/hosts", "Id": "dc3dece10b843228827a359ab5df42af4a56a240c37a790c5acbfc5f52f41d83", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/dc3dece10b843228827a359ab5df42af4a56a240c37a790c5acbfc5f52f41d83/dc3dece10b843228827a359ab5df42af4a56a240c37a790c5acbfc5f52f41d83-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "21784858df0d3ce0b96c08eab2d49dcd482f145be50c33f22f249c2e71d30092", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/21784858df0d3ce0b96c08eab2d49dcd482f145be50c33f22f249c2e71d30092/_data", "Type": "volume"}], "Name": "/t4ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "18f2e34a87f9e8a347c10666df2f54801ed19f85f2de5da7df55560d91572f46", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.10", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0a", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "18f2e34a87f9e8a347c10666df2f54801ed19f85f2de5da7df55560d91572f46", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.10", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0a", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "207c476b952d13549641910bdc234e5c112bba52555a57442ab9383a87078d20", "SandboxKey": "/var/run/docker/netns/207c476b952d", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/dc3dece10b843228827a359ab5df42af4a56a240c37a790c5acbfc5f52f41d83/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 15418, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:34:30.17698447Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t4ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:34:29.043927886Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/5868c739d904732156b8565156f0622e809e7b78afe09bda36615523d5e7184f-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/5868c739d904732156b8565156f0622e809e7b78afe09bda36615523d5e7184f/merged", "UpperDir": "/var/lib/docker/overlay2/5868c739d904732156b8565156f0622e809e7b78afe09bda36615523d5e7184f/diff", "WorkDir": "/var/lib/docker/overlay2/5868c739d904732156b8565156f0622e809e7b78afe09bda36615523d5e7184f/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/dc3dece10b843228827a359ab5df42af4a56a240c37a790c5acbfc5f52f41d83/hostname", "HostsPath": "/var/lib/docker/containers/dc3dece10b843228827a359ab5df42af4a56a240c37a790c5acbfc5f52f41d83/hosts", "Id": "dc3dece10b843228827a359ab5df42af4a56a240c37a790c5acbfc5f52f41d83", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/dc3dece10b843228827a359ab5df42af4a56a240c37a790c5acbfc5f52f41d83/dc3dece10b843228827a359ab5df42af4a56a240c37a790c5acbfc5f52f41d83-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "21784858df0d3ce0b96c08eab2d49dcd482f145be50c33f22f249c2e71d30092", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/21784858df0d3ce0b96c08eab2d49dcd482f145be50c33f22f249c2e71d30092/_data", "Type": "volume"}], "Name": "/t4ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "18f2e34a87f9e8a347c10666df2f54801ed19f85f2de5da7df55560d91572f46", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.10", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0a", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "18f2e34a87f9e8a347c10666df2f54801ed19f85f2de5da7df55560d91572f46", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.10", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0a", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "207c476b952d13549641910bdc234e5c112bba52555a57442ab9383a87078d20", "SandboxKey": "/var/run/docker/netns/207c476b952d", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/dc3dece10b843228827a359ab5df42af4a56a240c37a790c5acbfc5f52f41d83/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 15418, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:34:30.17698447Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vmif": "t4C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'pid': u'13743', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link show \"t4if\" ; if [ $? -ne 0 ] ; then ip link add \"t4if\" type veth peer name \"t4pns_if\" ; fi\n", "delta": "0:00:00.162075", "end": "2019-12-06 23:34:35.577858", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pid": "13743", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-06 23:34:35.415783", "stderr": "Device \"t4if\" does not exist.", "stderr_lines": ["Device \"t4if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'pid': u'13743', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t4pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t4pns_if\" netns pns1 ; fi\ndocker exec \"t4\" ip link show \"t4if\" ; if [ $? -ne 0 ] ; then ip link set \"t4if\" netns \"13743\" ; fi\nip netns exec pns1 ip link set dev \"t4pns_if\" up\ndocker exec \"t4\" ip link set dev \"t4if\" up\n", "delta": "0:00:00.506032", "end": "2019-12-06 23:34:36.301525", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pid": "13743", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-06 23:34:35.795493", "stderr": "Device \"t4pns_if\" does not exist.\nDevice \"t4if\" does not exist.", "stderr_lines": ["Device \"t4pns_if\" does not exist.", "Device \"t4if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'pid': u'13743', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t4pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.4.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.4.1/24\" dev \"t4pns_if\" ; fi\ndocker exec \"t4\" ip addr show \"t4if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.4.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t4\" ip addr add \"192.168.4.2/24\" dev \"t4if\" ; fi\n", "delta": "0:00:00.410714", "end": "2019-12-06 23:34:36.993800", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pid": "13743", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-06 23:34:36.583086", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link show \"t4ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t4ns1if\" type veth peer name \"t4s1if\" ; fi\n", "delta": "0:00:00.209210", "end": "2019-12-06 23:34:37.428690", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "rc": 0, "start": "2019-12-06 23:34:37.219480", "stderr": "Device \"t4ns1if\" does not exist.", "stderr_lines": ["Device \"t4ns1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link show \"t4ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t4ns1if\" netns \"13743\" ; fi\ndocker exec \"t4ns1\" ip link show \"t4s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t4s1if\" netns \"14205\" ; fi\n", "delta": "0:00:00.358804", "end": "2019-12-06 23:34:38.048058", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "rc": 0, "start": "2019-12-06 23:34:37.689254", "stderr": "Device \"t4ns1if\" does not exist.\nDevice \"t4s1if\" does not exist.", "stderr_lines": ["Device \"t4ns1if\" does not exist.", "Device \"t4s1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link set dev \"t4ns1if\" up\ndocker exec \"t4ns1\" ip link set dev \"t4s1if\" up\n", "delta": "0:00:00.345681", "end": "2019-12-06 23:34:38.609708", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "rc": 0, "start": "2019-12-06 23:34:38.264027", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip addr show \"t4s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.31.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip addr add \"10.1.31.2/24\" dev \"t4s1if\" ; fi\n\ndocker exec \"t4\" ip addr show \"t4ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.31.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t4\" ip addr add \"10.1.31.1/24\" dev \"t4ns1if\" ; fi\n", "delta": "0:00:00.713846", "end": "2019-12-06 23:34:39.544936", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "rc": 0, "start": "2019-12-06 23:34:38.831090", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route] *********************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'pid': u'13743', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t4\" ip route del default ; fi\n", "delta": "0:00:00.362572", "end": "2019-12-06 23:34:40.179581", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pid": "13743", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-06 23:34:39.817009", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.4.1', u'name': u't4', u'pns_ip': u'192.168.4.1/24', u'tenant_if': u't4if', u'pid': u'13743', u'tenant_ip': u'192.168.4.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip route show default | grep -w '[d]efault via 192.168.4.1' ; if [ $? -ne 0 ] ; then docker exec \"t4\" ip route add default via \"192.168.4.1\" ; fi\n", "delta": "0:00:00.365629", "end": "2019-12-06 23:34:40.789068", "item": {"default_route_ip": "192.168.4.1", "name": "t4", "pid": "13743", "pns_if": "t4pns_if", "pns_ip": "192.168.4.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.4.2/24"}, "rc": 0, "start": "2019-12-06 23:34:40.423439", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_ns_name': u't4', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'tenant_route_ip': u'192.168.4.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.1.31.0/24', u'remote_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t4ns1\" ip route del default ; fi\n", "delta": "0:00:00.327468", "end": "2019-12-06 23:34:41.395340", "item": {"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-06 23:34:41.067872", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_ns_name': u't4', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'tenant_route_ip': u'192.168.4.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.1.31.0/24', u'remote_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip route show default | grep -w '[d]efault via 10.1.31.1' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip route add default via \"10.1.31.1\" ; fi\n", "delta": "0:00:00.342835", "end": "2019-12-06 23:34:41.974690", "item": {"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-06 23:34:41.631855", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside container] ***********************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_ns_name': u't4', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'tenant_route_ip': u'192.168.4.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.1.31.0/24', u'remote_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" brctl show | grep -w '^t4br1'; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" brctl addbr \"t4br1\" ; fi\ndocker exec \"t4ns1\" ip link set dev \"t4br1\" up\n", "delta": "0:00:00.591681", "end": "2019-12-06 23:34:42.785667", "item": {"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-06 23:34:42.193986", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link show \"t4s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip link add \"t4s1_dnsbrif\" type veth peer name \"t4s1_dnsif\" ; fi\ndocker exec \"t4ns1\" ip link set dev \"t4s1_dnsbrif\" up\ndocker exec \"t4ns1\" ip link set dev \"t4s1_dnsif\" up\n", "delta": "0:00:00.795211", "end": "2019-12-06 23:34:43.822773", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:34:43.027562", "stderr": "Device \"t4s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t4s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" brctl show \"t4br1\" | grep -w 't4s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" brctl addif \"t4br1\" \"t4s1_dnsbrif\" ; fi\n", "delta": "0:00:00.356569", "end": "2019-12-06 23:34:44.407631", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:34:44.051062", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link show \"t4br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t4C1if1\" type veth peer name \"t4br1if1\" ; fi\nip link set dev \"t4br1if1\" up\nip link set dev \"t4C1if1\" up\n", "delta": "0:00:00.163215", "end": "2019-12-06 23:34:44.785963", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}], "rc": 0, "start": "2019-12-06 23:34:44.622748", "stderr": "Device \"t4br1if1\" does not exist.", "stderr_lines": ["Device \"t4br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link show \"t4br1if2\" ; if [ $? -ne 0 ] ; then ip link add \"t4C2if1\" type veth peer name \"t4br1if2\" ; fi\nip link set dev \"t4br1if2\" up\nip link set dev \"t4C2if1\" up\n", "delta": "0:00:00.195326", "end": "2019-12-06 23:34:45.165876", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}], "rc": 0, "start": "2019-12-06 23:34:44.970550", "stderr": "Device \"t4br1if2\" does not exist.", "stderr_lines": ["Device \"t4br1if2\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t4br1if1\" netns \"14205\" ; fi\ndocker exec \"t4ns1\" brctl show \"t4br1\" | grep -w 't4br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" brctl addif \"t4br1\" \"t4br1if1\" ; fi\n", "delta": "0:00:00.389926", "end": "2019-12-06 23:34:45.814514", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}], "rc": 0, "start": "2019-12-06 23:34:45.424588", "stderr": "", "stderr_lines": [], "stdout": "86: t4br1if1@t4C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 9e:c4:1c:53:62:27 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["86: t4br1if1@t4C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 9e:c4:1c:53:62:27 brd ff:ff:ff:ff:ff:ff"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4br1if2\" ; if [ $? -eq 0 ] ; then ip link set \"t4br1if2\" netns \"14205\" ; fi\ndocker exec \"t4ns1\" brctl show \"t4br1\" | grep -w 't4br1if2' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" brctl addif \"t4br1\" \"t4br1if2\" ; fi\n", "delta": "0:00:00.393250", "end": "2019-12-06 23:34:46.364085", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}], "rc": 0, "start": "2019-12-06 23:34:45.970835", "stderr": "", "stderr_lines": [], "stdout": "88: t4br1if2@t4C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether ce:c1:3e:97:f2:d3 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["88: t4br1if2@t4C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether ce:c1:3e:97:f2:d3 brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link set \"t4br1if1\" up\ndocker exec \"t4ns1\" ip link set dev \"t4br1\" up\n", "delta": "0:00:00.366590", "end": "2019-12-06 23:34:46.983802", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}], "rc": 0, "start": "2019-12-06 23:34:46.617212", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link set \"t4br1if2\" up\ndocker exec \"t4ns1\" ip link set dev \"t4br1\" up\n", "delta": "0:00:00.353997", "end": "2019-12-06 23:34:47.517436", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}], "rc": 0, "start": "2019-12-06 23:34:47.163439", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip addr show \"t4s1_dnsif\" | awk 'FNR==3{ print $2 }' | grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip addr add \"1.1.1.1/24\" dev \"t4s1_dnsif\" ; fi\n", "delta": "0:00:00.337687", "end": "2019-12-06 23:34:48.097055", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:34:47.759368", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}], u'vxlan': [{u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ps aux | grep -w '[d]nsmasq --interface t4s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" dnsmasq --interface \"t4s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.850803", "end": "2019-12-06 23:34:49.198351", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:34:48.347548", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}]}, {u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link show \"vxlan_t4s1\" ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip link add \"vxlan_t4s1\" type vxlan id \"42\" local \"10.1.31.2\" remote \"10.2.31.2\" dstport \"4789\" dev \"t4s1if\"; docker exec \"t4ns1\" ip link set dev \"vxlan_t4s1\" up ; fi\n", "delta": "0:00:00.636032", "end": "2019-12-06 23:34:50.097665", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-06 23:34:49.461633", "stderr": "Device \"vxlan_t4s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t4s1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}]}, {u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" brctl show \"t4br1\" | grep -w 'vxlan_t4s1' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" brctl addif \"t4br1\" \"vxlan_t4s1\" ; fi\n", "delta": "0:00:00.325368", "end": "2019-12-06 23:34:50.660059", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-06 23:34:50.334691", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.132.1', u'name': u't4', u'pns_ip': u'192.168.132.1/24', u'tenant_if': u't4if', u'pid': u'12036', u'tenant_ip': u'192.168.132.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link show \"t4if\" ; if [ $? -ne 0 ] ; then ip link add \"t4if\" type veth peer name \"t4pns_if\" ; fi\n", "delta": "0:00:00.210516", "end": "2019-12-06 23:34:52.138658", "item": {"default_route_ip": "192.168.132.1", "name": "t4", "pid": "12036", "pns_if": "t4pns_if", "pns_ip": "192.168.132.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.132.2/24"}, "rc": 0, "start": "2019-12-06 23:34:51.928142", "stderr": "Device \"t4if\" does not exist.", "stderr_lines": ["Device \"t4if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.132.1', u'name': u't4', u'pns_ip': u'192.168.132.1/24', u'tenant_if': u't4if', u'pid': u'12036', u'tenant_ip': u'192.168.132.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t4pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t4pns_if\" netns pns1 ; fi\ndocker exec \"t4\" ip link show \"t4if\" ; if [ $? -ne 0 ] ; then ip link set \"t4if\" netns \"12036\" ; fi\nip netns exec pns1 ip link set dev \"t4pns_if\" up\ndocker exec \"t4\" ip link set dev \"t4if\" up\n", "delta": "0:00:00.516700", "end": "2019-12-06 23:34:53.011033", "item": {"default_route_ip": "192.168.132.1", "name": "t4", "pid": "12036", "pns_if": "t4pns_if", "pns_ip": "192.168.132.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.132.2/24"}, "rc": 0, "start": "2019-12-06 23:34:52.494333", "stderr": "Device \"t4pns_if\" does not exist.\nDevice \"t4if\" does not exist.", "stderr_lines": ["Device \"t4pns_if\" does not exist.", "Device \"t4if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.132.1', u'name': u't4', u'pns_ip': u'192.168.132.1/24', u'tenant_if': u't4if', u'pid': u'12036', u'tenant_ip': u'192.168.132.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t4pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.132.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.132.1/24\" dev \"t4pns_if\" ; fi\ndocker exec \"t4\" ip addr show \"t4if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.132.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t4\" ip addr add \"192.168.132.2/24\" dev \"t4if\" ; fi\n", "delta": "0:00:00.476092", "end": "2019-12-06 23:34:53.840253", "item": {"default_route_ip": "192.168.132.1", "name": "t4", "pid": "12036", "pns_if": "t4pns_if", "pns_ip": "192.168.132.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.132.2/24"}, "rc": 0, "start": "2019-12-06 23:34:53.364161", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link show \"t4ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t4ns1if\" type veth peer name \"t4s1if\" ; fi\n", "delta": "0:00:00.184239", "end": "2019-12-06 23:34:54.376094", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "rc": 0, "start": "2019-12-06 23:34:54.191855", "stderr": "Device \"t4ns1if\" does not exist.", "stderr_lines": ["Device \"t4ns1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link show \"t4ns2if\" ; if [ $? -ne 0 ] ; then ip link add \"t4ns2if\" type veth peer name \"t4s2if\" ; fi\n", "delta": "0:00:00.178399", "end": "2019-12-06 23:34:54.829922", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "rc": 0, "start": "2019-12-06 23:34:54.651523", "stderr": "Device \"t4ns2if\" does not exist.", "stderr_lines": ["Device \"t4ns2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link show \"t4ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t4ns1if\" netns \"12036\" ; fi\ndocker exec \"t4ns1\" ip link show \"t4s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t4s1if\" netns \"12974\" ; fi\n", "delta": "0:00:00.393158", "end": "2019-12-06 23:34:55.583467", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "rc": 0, "start": "2019-12-06 23:34:55.190309", "stderr": "Device \"t4ns1if\" does not exist.\nDevice \"t4s1if\" does not exist.", "stderr_lines": ["Device \"t4ns1if\" does not exist.", "Device \"t4s1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link show \"t4ns2if\" ; if [ $? -ne 0 ] ; then ip link set \"t4ns2if\" netns \"12036\" ; fi\ndocker exec \"t4ns2\" ip link show \"t4s2if\" ; if [ $? -ne 0 ] ; then ip link set \"t4s2if\" netns \"15418\" ; fi\n", "delta": "0:00:00.401933", "end": "2019-12-06 23:34:56.252060", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "rc": 0, "start": "2019-12-06 23:34:55.850127", "stderr": "Device \"t4ns2if\" does not exist.\nDevice \"t4s2if\" does not exist.", "stderr_lines": ["Device \"t4ns2if\" does not exist.", "Device \"t4s2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link set dev \"t4ns1if\" up\ndocker exec \"t4ns1\" ip link set dev \"t4s1if\" up\n", "delta": "0:00:00.437526", "end": "2019-12-06 23:34:57.029226", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "rc": 0, "start": "2019-12-06 23:34:56.591700", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip link set dev \"t4ns2if\" up\ndocker exec \"t4ns2\" ip link set dev \"t4s2if\" up\n", "delta": "0:00:00.385277", "end": "2019-12-06 23:34:57.675350", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "rc": 0, "start": "2019-12-06 23:34:57.290073", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip addr show \"t4s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.31.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip addr add \"10.2.31.2/24\" dev \"t4s1if\" ; fi\n\ndocker exec \"t4\" ip addr show \"t4ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.31.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t4\" ip addr add \"10.2.31.1/24\" dev \"t4ns1if\" ; fi\n", "delta": "0:00:00.740160", "end": "2019-12-06 23:34:58.757961", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "rc": 0, "start": "2019-12-06 23:34:58.017801", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns2\" ip addr show \"t4s2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.32.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t4ns2\" ip addr add \"10.2.32.2/24\" dev \"t4s2if\" ; fi\n\ndocker exec \"t4\" ip addr show \"t4ns2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.32.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t4\" ip addr add \"10.2.32.1/24\" dev \"t4ns2if\" ; fi\n", "delta": "0:00:00.760662", "end": "2019-12-06 23:34:59.778183", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "rc": 0, "start": "2019-12-06 23:34:59.017521", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route] *********************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.132.1', u'name': u't4', u'pns_ip': u'192.168.132.1/24', u'tenant_if': u't4if', u'pid': u'12036', u'tenant_ip': u'192.168.132.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t4\" ip route del default ; fi\n", "delta": "0:00:00.410215", "end": "2019-12-06 23:35:00.501568", "item": {"default_route_ip": "192.168.132.1", "name": "t4", "pid": "12036", "pns_if": "t4pns_if", "pns_ip": "192.168.132.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.132.2/24"}, "rc": 0, "start": "2019-12-06 23:35:00.091353", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.132.1', u'name': u't4', u'pns_ip': u'192.168.132.1/24', u'tenant_if': u't4if', u'pid': u'12036', u'tenant_ip': u'192.168.132.2/24', u'pns_if': u't4pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4\" ip route show default | grep -w '[d]efault via 192.168.132.1' ; if [ $? -ne 0 ] ; then docker exec \"t4\" ip route add default via \"192.168.132.1\" ; fi\n", "delta": "0:00:00.387418", "end": "2019-12-06 23:35:01.235245", "item": {"default_route_ip": "192.168.132.1", "name": "t4", "pid": "12036", "pns_if": "t4pns_if", "pns_ip": "192.168.132.1/24", "tenant_if": "t4if", "tenant_ip": "192.168.132.2/24"}, "rc": 0, "start": "2019-12-06 23:35:00.847827", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_ns_name': u't4', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'tenant_route_ip': u'192.168.132.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.2.31.0/24', u'remote_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t4ns1\" ip route del default ; fi\n", "delta": "0:00:00.430848", "end": "2019-12-06 23:35:02.039805", "item": {"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-06 23:35:01.608957", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_ns_name': u't4', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns2\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t4ns2\" ip route del default ; fi\n", "delta": "0:00:00.403653", "end": "2019-12-06 23:35:02.736531", "item": {"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:35:02.332878", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_ns_name': u't4', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'tenant_route_ip': u'192.168.132.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.2.31.0/24', u'remote_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip route show default | grep -w '[d]efault via 10.2.31.1' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip route add default via \"10.2.31.1\" ; fi\n", "delta": "0:00:00.395219", "end": "2019-12-06 23:35:03.471923", "item": {"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-06 23:35:03.076704", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_ns_name': u't4', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns2\" ip route show default | grep -w '[d]efault via 10.2.32.1' ; if [ $? -ne 0 ] ; then docker exec \"t4ns2\" ip route add default via \"10.2.32.1\" ; fi\n", "delta": "0:00:00.417545", "end": "2019-12-06 23:35:04.183951", "item": {"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:35:03.766406", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside namespace] ***********************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_ns_name': u't4', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_sub_if': u't4s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'tenant_route_ip': u'192.168.132.2', u'dsport': 4789, u'dev': u't4s1if', u'subnet_route': u'10.2.31.0/24', u'remote_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" brctl show | grep -w '^t4br1'; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" brctl addbr \"t4br1\" ; fi\ndocker exec \"t4ns1\" ip link set dev \"t4br1\" up\n", "delta": "0:00:00.596992", "end": "2019-12-06 23:35:05.140780", "item": {"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, "rc": 0, "start": "2019-12-06 23:35:04.543788", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_ns_name': u't4', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_sub_if': u't4s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns2\" brctl show | grep -w '^t4br2'; if [ $? -ne 0 ] ; then docker exec \"t4ns2\" brctl addbr \"t4br2\" ; fi\ndocker exec \"t4ns2\" ip link set dev \"t4br2\" up\n", "delta": "0:00:00.556520", "end": "2019-12-06 23:35:05.984720", "item": {"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:35:05.428200", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link show \"t4s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip link add \"t4s1_dnsbrif\" type veth peer name \"t4s1_dnsif\" ; fi\ndocker exec \"t4ns1\" ip link set dev \"t4s1_dnsbrif\" up\ndocker exec \"t4ns1\" ip link set dev \"t4s1_dnsif\" up\n", "delta": "0:00:00.759061", "end": "2019-12-06 23:35:07.099541", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:35:06.340480", "stderr": "Device \"t4s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t4s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns2\" ip link show \"t4s2_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t4ns2\" ip link add \"t4s2_dnsbrif\" type veth peer name \"t4s2_dnsif\" ; fi\ndocker exec \"t4ns2\" ip link set dev \"t4s2_dnsbrif\" up\ndocker exec \"t4ns2\" ip link set dev \"t4s2_dnsif\" up\n", "delta": "0:00:00.801379", "end": "2019-12-06 23:35:08.216231", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:35:07.414852", "stderr": "Device \"t4s2_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t4s2_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" brctl show \"t4br1\" | grep -w 't4s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" brctl addif \"t4br1\" \"t4s1_dnsbrif\" ; fi\n", "delta": "0:00:00.419482", "end": "2019-12-06 23:35:09.004793", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:35:08.585311", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns2\" brctl show \"t4br2\" | grep -w 't4s2_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t4ns2\" brctl addif \"t4br2\" \"t4s2_dnsbrif\" ; fi\n", "delta": "0:00:00.385093", "end": "2019-12-06 23:35:09.675174", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:35:09.290081", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link show \"t4br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t4C3if1\" type veth peer name \"t4br1if1\" ; fi\nip link set dev \"t4br1if1\" up\nip link set dev \"t4C3if1\" up\n", "delta": "0:00:00.213445", "end": "2019-12-06 23:35:10.300957", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}], "rc": 0, "start": "2019-12-06 23:35:10.087512", "stderr": "Device \"t4br1if1\" does not exist.", "stderr_lines": ["Device \"t4br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns2\" ip link show \"t4br2if1\" ; if [ $? -ne 0 ] ; then ip link add \"t4C4if1\" type veth peer name \"t4br2if1\" ; fi\nip link set dev \"t4br2if1\" up\nip link set dev \"t4C4if1\" up\n", "delta": "0:00:00.195589", "end": "2019-12-06 23:35:10.811065", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}], "rc": 0, "start": "2019-12-06 23:35:10.615476", "stderr": "Device \"t4br2if1\" does not exist.", "stderr_lines": ["Device \"t4br2if1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t4br1if1\" netns \"12974\" ; fi\ndocker exec \"t4ns1\" brctl show \"t4br1\" | grep -w 't4br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" brctl addif \"t4br1\" \"t4br1if1\" ; fi\n", "delta": "0:00:00.412942", "end": "2019-12-06 23:35:11.750053", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}], "rc": 0, "start": "2019-12-06 23:35:11.337111", "stderr": "", "stderr_lines": [], "stdout": "87: t4br1if1@t4C3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether d2:a6:04:0b:e3:0d brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["87: t4br1if1@t4C3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether d2:a6:04:0b:e3:0d brd ff:ff:ff:ff:ff:ff"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t4br2if1\" ; if [ $? -eq 0 ] ; then ip link set \"t4br2if1\" netns \"15418\" ; fi\ndocker exec \"t4ns2\" brctl show \"t4br2\" | grep -w 't4br2if1' ; if [ $? -ne 0 ] ; then docker exec \"t4ns2\" brctl addif \"t4br2\" \"t4br2if1\" ; fi\n", "delta": "0:00:00.404793", "end": "2019-12-06 23:35:12.496237", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}], "rc": 0, "start": "2019-12-06 23:35:12.091444", "stderr": "", "stderr_lines": [], "stdout": "89: t4br2if1@t4C4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 9e:db:5c:4d:2b:9f brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["89: t4br2if1@t4C4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 9e:db:5c:4d:2b:9f brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link set \"t4br1if1\" up\ndocker exec \"t4ns1\" ip link set dev \"t4br1\" up\n", "delta": "0:00:00.353219", "end": "2019-12-06 23:35:13.339149", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}], "rc": 0, "start": "2019-12-06 23:35:12.985930", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns2\" ip link set \"t4br2if1\" up\ndocker exec \"t4ns2\" ip link set dev \"t4br2\" up\n", "delta": "0:00:00.367760", "end": "2019-12-06 23:35:13.985951", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}], "rc": 0, "start": "2019-12-06 23:35:13.618191", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip addr show \"t4s1_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip addr add \"1.1.1.1/24\" dev \"t4s1_dnsif\" ; fi\n", "delta": "0:00:00.398997", "end": "2019-12-06 23:35:14.738761", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:35:14.339764", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns2\" ip addr show \"t4s2_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^2.2.2.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t4ns2\" ip addr add \"2.2.2.1/24\" dev \"t4s2_dnsif\" ; fi\n", "delta": "0:00:00.394884", "end": "2019-12-06 23:35:15.413508", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:35:15.018624", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}], u'vxlan': [{u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]}, {u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ps aux | grep -w '[d]nsmasq --interface t4s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" dnsmasq --interface \"t4s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.857008", "end": "2019-12-06 23:35:16.633100", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}], "vxlan": [{"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}]}, {"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:35:15.776092", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns2\" ps aux | grep -w '[d]nsmasq --interface t4s2_dnsif -z --dhcp-range=2.2.2.5,2.2.2.254' ; if [ $? -ne 0 ] ; then docker exec \"t4ns2\" dnsmasq --interface \"t4s2_dnsif\" -z --dhcp-range=2.2.2.5,'2.2.2.254' ; fi\n", "delta": "0:00:00.877191", "end": "2019-12-06 23:35:17.838498", "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:35:16.961307", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}]}, {u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" ip link show \"vxlan_t4s1\" ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" ip link add \"vxlan_t4s1\" type vxlan id \"42\" local \"10.2.31.2\" remote \"10.1.31.2\" dstport \"4789\" dev \"t4s1if\" ; docker exec \"t4ns1\" ip link set dev \"vxlan_t4s1\" up ; fi\n", "delta": "0:00:00.578181", "end": "2019-12-06 23:35:18.770907", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-06 23:35:18.192726", "stderr": "Device \"vxlan_t4s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t4s1\" does not exist."], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}]}, {u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t4ns1\" brctl show \"t4br1\" | grep -w 'vxlan_t4s1' ; if [ $? -ne 0 ] ; then docker exec \"t4ns1\" brctl addif \"t4br1\" \"vxlan_t4s1\" ; fi\n", "delta": "0:00:00.385059", "end": "2019-12-06 23:35:19.536328", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-06 23:35:19.151269", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}]}, {u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip route show \"10.1.31.0/24\" via \"192.168.4.2\" | grep -w '^10.1.31.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip route add \"10.1.31.0/24\" via \"192.168.4.2\" ; fi\n", "delta": "0:00:00.075335", "end": "2019-12-06 23:35:20.825891", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-06 23:35:20.750556", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": "ip netns exec pns1 ip addr show p11 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.040289", "end": "2019-12-06 23:35:21.074323", "rc": 0, "start": "2019-12-06 23:35:21.034034", "stderr": "", "stderr_lines": [], "stdout": "192.168.200.207", "stdout_lines": ["192.168.200.207"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.1.31.1', u'pid': u'14205', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'13743', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.1.31.2/24', u'tenant_ns_ip': u'10.1.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C1if1', u'name': u't4_C1'}, {u'vm_pid': u'', u'brif': u't4br1if2', u'vmif': u't4C2if1', u'name': u't4_C2'}]}, {u'local_ip': u'10.1.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.4.2', u'remote_route': u'10.2.31.0/24', u'subnet_route': u'10.1.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.2.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.1.31.0/24\" via \"192.168.200.207\" | grep -w '^10.1.31.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.1.31.0/24\" via \"192.168.200.207\" ; fi\nip route show \"10.2.31.0/24\" via 99.99.99.2 | grep -w '^10.2.31.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.2.31.0/24\" via 99.99.99.2 ; fi\n", "delta": "0:00:00.010564", "end": "2019-12-06 23:35:21.322081", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.1.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "14205", "route": [{"if": "p1", "ip": "10.1.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.1.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "13743", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.1.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C1", "vm_pid": "", "vmif": "t4C1if1"}, {"brif": "t4br1if2", "name": "t4_C2", "vm_pid": "", "vmif": "t4C2if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.31.2", "remote_ip": "10.2.31.2", "remote_route": "10.2.31.0/24", "subnet_route": "10.1.31.0/24", "tenant_route_ip": "192.168.4.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-06 23:35:21.311517", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}]}, {u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip route show \"10.2.31.0/24\" via \"192.168.132.2\" | grep -w '^10.2.31.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip route add \"10.2.31.0/24\" via \"192.168.132.2\" ; fi\n", "delta": "0:00:00.073446", "end": "2019-12-06 23:35:22.619107", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-06 23:35:22.545661", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": "ip netns exec pns1 ip addr show p11 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.056378", "end": "2019-12-06 23:35:23.011991", "rc": 0, "start": "2019-12-06 23:35:22.955613", "stderr": "", "stderr_lines": [], "stdout": "192.168.200.5", "stdout_lines": ["192.168.200.5"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.31.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.31.1', u'pid': u'12974', u'bridge_name': u't4br1', u'dns': [{u'dnsif': u't4s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s1_dnsbrif'}], u'ns_name': u't4ns1', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s1if', u'tenant_sub_ip': u'10.2.31.2/24', u'tenant_ns_ip': u'10.2.31.1/24', u'tenant_ns_if': u't4ns1if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br1if1', u'vmif': u't4C3if1', u'name': u't4_C3'}]}, {u'local_ip': u'10.2.31.2', u'dsport': 4789, u'dev': u't4s1if', u'tenant_route_ip': u'192.168.132.2', u'remote_route': u'10.1.31.0/24', u'subnet_route': u'10.2.31.0/24', u'v_name': u'vxlan_t4s1', u'id': 42, u'remote_ip': u'10.1.31.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.2.31.0/24\" via \"192.168.200.5\" | grep -w '^10.2.31.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.2.31.0/24\" via \"192.168.200.5\" ; fi\nip route show \"10.1.31.0/24\" via 99.99.99.1 | grep -w '^10.1.31.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.1.31.0/24\" via 99.99.99.1 ; fi\n", "delta": "0:00:00.011038", "end": "2019-12-06 23:35:23.371136", "item": [{"bridge_name": "t4br1", "default_route_ip": "10.2.31.1", "dns": [{"brif": "t4s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t4s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns1", "pid": "12974", "route": [{"if": "p1", "ip": "10.2.31.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns1if", "tenant_ns_ip": "10.2.31.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s1if", "tenant_sub_ip": "10.2.31.2/24"}], "vms": [{"brif": "t4br1if1", "name": "t4_C3", "vm_pid": "", "vmif": "t4C3if1"}]}, {"dev": "t4s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.31.2", "remote_ip": "10.1.31.2", "remote_route": "10.1.31.0/24", "subnet_route": "10.2.31.0/24", "tenant_route_ip": "192.168.132.2", "v_name": "vxlan_t4s1"}], "rc": 0, "start": "2019-12-06 23:35:23.360098", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.32.1/24', u'ns_name': u't4', u'ns_if': u't4if', u'if': u'p1'}], u'default_route_ip': u'10.2.32.1', u'pid': u'15418', u'bridge_name': u't4br2', u'dns': [{u'dnsif': u't4s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't4s2_dnsbrif'}], u'ns_name': u't4ns2', u'tenant_ns': [{u'tenant_ns_pid': u'12036', u'tenant_sub_if': u't4s2if', u'tenant_sub_ip': u'10.2.32.2/24', u'tenant_ns_ip': u'10.2.32.1/24', u'tenant_ns_if': u't4ns2if', u'tenant_ns_name': u't4'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't4br2if1', u'vmif': u't4C4if1', u'name': u't4_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t4br2", "default_route_ip": "10.2.32.1", "dns": [{"brif": "t4s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t4s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t4ns2", "pid": "15418", "route": [{"if": "p1", "ip": "10.2.32.1/24", "ns_if": "t4if", "ns_name": "t4"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t4ns2if", "tenant_ns_ip": "10.2.32.1/24", "tenant_ns_name": "t4", "tenant_ns_pid": "12036", "tenant_sub_if": "t4s2if", "tenant_sub_ip": "10.2.32.2/24"}], "vms": [{"brif": "t4br2if1", "name": "t4_C4", "vm_pid": "", "vmif": "t4C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 23:35:23.570023 Printing the yaml input file
INFO:root: 23:35:23.570301 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 23:35:23.570508 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 23:35:23.570599 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 23:35:23.570675 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
ok: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:21:31.579416019Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf/merged", "UpperDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf/diff", "WorkDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/hostname", "HostsPath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/hosts", "Id": "bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "46ecbf9850aef3bb9dc4eda61aed4cc599eae7634573747b97c38496d9f73bd5", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/46ecbf9850aef3bb9dc4eda61aed4cc599eae7634573747b97c38496d9f73bd5/_data", "Type": "volume"}], "Name": "/t5", "NetworkSettings": {"Bridge": "", "EndpointID": "f273a7d6fc912f03ae79096b9850084d60522325f8dbe8cca40531cdfdf15be9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "f273a7d6fc912f03ae79096b9850084d60522325f8dbe8cca40531cdfdf15be9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "465418fd411c7711c7beb56613a1637dcda79e5201340d409019a447c0550b11", "SandboxKey": "/var/run/docker/netns/465418fd411c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 20484, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:21:32.080693846Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:21:31.579416019Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf/merged", "UpperDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf/diff", "WorkDir": "/var/lib/docker/overlay2/cd3b02c6525889592b6147fbf26dd62d0d74a17dcfed23740c6df3ba7414aabf/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/hostname", "HostsPath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/hosts", "Id": "bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "46ecbf9850aef3bb9dc4eda61aed4cc599eae7634573747b97c38496d9f73bd5", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/46ecbf9850aef3bb9dc4eda61aed4cc599eae7634573747b97c38496d9f73bd5/_data", "Type": "volume"}], "Name": "/t5", "NetworkSettings": {"Bridge": "", "EndpointID": "f273a7d6fc912f03ae79096b9850084d60522325f8dbe8cca40531cdfdf15be9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "f273a7d6fc912f03ae79096b9850084d60522325f8dbe8cca40531cdfdf15be9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "465418fd411c7711c7beb56613a1637dcda79e5201340d409019a447c0550b11", "SandboxKey": "/var/run/docker/netns/465418fd411c", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/bd913e164aca9ee1b1f4387d27219439fa34a7d557143954c13d0f5e767df140/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 20484, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:21:32.080693846Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
ok: [localhost] => (item={u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'tenant_route_ip': u'192.168.5.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.1.41.0/24', u'remote_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:21:32.631591395Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8/merged", "UpperDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8/diff", "WorkDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/hostname", "HostsPath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/hosts", "Id": "127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "c4f7c8a05d82c2c7c64237006ee6452403e4c9b2c952244a3fed8c0bb0db6e8d", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/c4f7c8a05d82c2c7c64237006ee6452403e4c9b2c952244a3fed8c0bb0db6e8d/_data", "Type": "volume"}], "Name": "/t5ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "1bad37271fb04f9606ed710ce1f0117ad401ec8887e1b39da6dda9b464e005c8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "1bad37271fb04f9606ed710ce1f0117ad401ec8887e1b39da6dda9b464e005c8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "861a74b36197d918bbdc34d7320511875474fe458a730b0201c6f84fd9409a49", "SandboxKey": "/var/run/docker/netns/861a74b36197", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 21100, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:21:33.515535762Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": false, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:21:32.631591395Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8/merged", "UpperDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8/diff", "WorkDir": "/var/lib/docker/overlay2/9f6efacc8bb3757194e4e84cf4d612513fb478b334d3815b08d00cd380aac6d8/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/hostname", "HostsPath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/hosts", "Id": "127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "c4f7c8a05d82c2c7c64237006ee6452403e4c9b2c952244a3fed8c0bb0db6e8d", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/c4f7c8a05d82c2c7c64237006ee6452403e4c9b2c952244a3fed8c0bb0db6e8d/_data", "Type": "volume"}], "Name": "/t5ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "1bad37271fb04f9606ed710ce1f0117ad401ec8887e1b39da6dda9b464e005c8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:05", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "1bad37271fb04f9606ed710ce1f0117ad401ec8887e1b39da6dda9b464e005c8", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.5", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:05", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "861a74b36197d918bbdc34d7320511875474fe458a730b0201c6f84fd9409a49", "SandboxKey": "/var/run/docker/netns/861a74b36197", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/127ab39a85560d6fdc69886bd1fba6ee4b3d095db59951dc94f4e63ba2d7dfe7/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 21100, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:21:33.515535762Z", "Status": "running"}}, "item": {"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.133.1', u'name': u't5', u'pns_ip': u'192.168.133.1/24', u'tenant_if': u't5if', u'tenant_ip': u'192.168.133.2/24', u'pns_if': u't5pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:35:38.931860005Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/d1d5b36f32e52aca5dc0ad71330a8ec889405effbfd7af78da0e528aa8c6d04f-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/d1d5b36f32e52aca5dc0ad71330a8ec889405effbfd7af78da0e528aa8c6d04f/merged", "UpperDir": "/var/lib/docker/overlay2/d1d5b36f32e52aca5dc0ad71330a8ec889405effbfd7af78da0e528aa8c6d04f/diff", "WorkDir": "/var/lib/docker/overlay2/d1d5b36f32e52aca5dc0ad71330a8ec889405effbfd7af78da0e528aa8c6d04f/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/09cc10c80eb75db4b192eb6e60a83023fa6c5e183100702432f93310bbae6d28/hostname", "HostsPath": "/var/lib/docker/containers/09cc10c80eb75db4b192eb6e60a83023fa6c5e183100702432f93310bbae6d28/hosts", "Id": "09cc10c80eb75db4b192eb6e60a83023fa6c5e183100702432f93310bbae6d28", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/09cc10c80eb75db4b192eb6e60a83023fa6c5e183100702432f93310bbae6d28/09cc10c80eb75db4b192eb6e60a83023fa6c5e183100702432f93310bbae6d28-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "7a1cd58fde049855f23747e2c03693b75f6968e4b9a13f445b25635afc396434", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/7a1cd58fde049855f23747e2c03693b75f6968e4b9a13f445b25635afc396434/_data", "Type": "volume"}], "Name": "/t5", "NetworkSettings": {"Bridge": "", "EndpointID": "9aed520fb226881811a34833345a8659efe015f8c632b74c41fb8befdbd7b89c", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "9aed520fb226881811a34833345a8659efe015f8c632b74c41fb8befdbd7b89c", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "c14ca1d523c5cacd3447f89680b1ac310b11458ff80c0b5e565356b1eb240d8c", "SandboxKey": "/var/run/docker/netns/c14ca1d523c5", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/09cc10c80eb75db4b192eb6e60a83023fa6c5e183100702432f93310bbae6d28/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 30798, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:35:39.452213672Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:35:38.931860005Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/d1d5b36f32e52aca5dc0ad71330a8ec889405effbfd7af78da0e528aa8c6d04f-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/d1d5b36f32e52aca5dc0ad71330a8ec889405effbfd7af78da0e528aa8c6d04f/merged", "UpperDir": "/var/lib/docker/overlay2/d1d5b36f32e52aca5dc0ad71330a8ec889405effbfd7af78da0e528aa8c6d04f/diff", "WorkDir": "/var/lib/docker/overlay2/d1d5b36f32e52aca5dc0ad71330a8ec889405effbfd7af78da0e528aa8c6d04f/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/09cc10c80eb75db4b192eb6e60a83023fa6c5e183100702432f93310bbae6d28/hostname", "HostsPath": "/var/lib/docker/containers/09cc10c80eb75db4b192eb6e60a83023fa6c5e183100702432f93310bbae6d28/hosts", "Id": "09cc10c80eb75db4b192eb6e60a83023fa6c5e183100702432f93310bbae6d28", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/09cc10c80eb75db4b192eb6e60a83023fa6c5e183100702432f93310bbae6d28/09cc10c80eb75db4b192eb6e60a83023fa6c5e183100702432f93310bbae6d28-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "7a1cd58fde049855f23747e2c03693b75f6968e4b9a13f445b25635afc396434", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/7a1cd58fde049855f23747e2c03693b75f6968e4b9a13f445b25635afc396434/_data", "Type": "volume"}], "Name": "/t5", "NetworkSettings": {"Bridge": "", "EndpointID": "9aed520fb226881811a34833345a8659efe015f8c632b74c41fb8befdbd7b89c", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:03", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "9aed520fb226881811a34833345a8659efe015f8c632b74c41fb8befdbd7b89c", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.3", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:03", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "c14ca1d523c5cacd3447f89680b1ac310b11458ff80c0b5e565356b1eb240d8c", "SandboxKey": "/var/run/docker/netns/c14ca1d523c5", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/09cc10c80eb75db4b192eb6e60a83023fa6c5e183100702432f93310bbae6d28/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 30798, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:35:39.452213672Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.133.1", "name": "t5", "pns_if": "t5pns_if", "pns_ip": "192.168.133.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.133.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'tenant_route_ip': u'192.168.133.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.2.41.0/24', u'remote_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:35:50.875905595Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/1cc2f019580419206f5c1f1d8756fa41643b9cb62adb91c72e675f88bc0c5427-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/1cc2f019580419206f5c1f1d8756fa41643b9cb62adb91c72e675f88bc0c5427/merged", "UpperDir": "/var/lib/docker/overlay2/1cc2f019580419206f5c1f1d8756fa41643b9cb62adb91c72e675f88bc0c5427/diff", "WorkDir": "/var/lib/docker/overlay2/1cc2f019580419206f5c1f1d8756fa41643b9cb62adb91c72e675f88bc0c5427/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/9682d45a5c56eb3bdaa3a55c58024bacd3e0c1dc76ff92a77224b46c871b9f5c/hostname", "HostsPath": "/var/lib/docker/containers/9682d45a5c56eb3bdaa3a55c58024bacd3e0c1dc76ff92a77224b46c871b9f5c/hosts", "Id": "9682d45a5c56eb3bdaa3a55c58024bacd3e0c1dc76ff92a77224b46c871b9f5c", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/9682d45a5c56eb3bdaa3a55c58024bacd3e0c1dc76ff92a77224b46c871b9f5c/9682d45a5c56eb3bdaa3a55c58024bacd3e0c1dc76ff92a77224b46c871b9f5c-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "910fef3ae7a07e4f6a4eba9c5a14530fd655affe51d350227cb6db7885efdb25", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/910fef3ae7a07e4f6a4eba9c5a14530fd655affe51d350227cb6db7885efdb25/_data", "Type": "volume"}], "Name": "/t5ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "02cfbb7490685252bc89810881f7378d206200390b6b773ee489b0d7d8f8ebf1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "02cfbb7490685252bc89810881f7378d206200390b6b773ee489b0d7d8f8ebf1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "0bba203fded1f770f79578d44bb4b8c3d30d6efd5e2dec91f700b76a60b0b6bd", "SandboxKey": "/var/run/docker/netns/0bba203fded1", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/9682d45a5c56eb3bdaa3a55c58024bacd3e0c1dc76ff92a77224b46c871b9f5c/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 2687, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:35:51.337635535Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:35:50.875905595Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/1cc2f019580419206f5c1f1d8756fa41643b9cb62adb91c72e675f88bc0c5427-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/1cc2f019580419206f5c1f1d8756fa41643b9cb62adb91c72e675f88bc0c5427/merged", "UpperDir": "/var/lib/docker/overlay2/1cc2f019580419206f5c1f1d8756fa41643b9cb62adb91c72e675f88bc0c5427/diff", "WorkDir": "/var/lib/docker/overlay2/1cc2f019580419206f5c1f1d8756fa41643b9cb62adb91c72e675f88bc0c5427/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/9682d45a5c56eb3bdaa3a55c58024bacd3e0c1dc76ff92a77224b46c871b9f5c/hostname", "HostsPath": "/var/lib/docker/containers/9682d45a5c56eb3bdaa3a55c58024bacd3e0c1dc76ff92a77224b46c871b9f5c/hosts", "Id": "9682d45a5c56eb3bdaa3a55c58024bacd3e0c1dc76ff92a77224b46c871b9f5c", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/9682d45a5c56eb3bdaa3a55c58024bacd3e0c1dc76ff92a77224b46c871b9f5c/9682d45a5c56eb3bdaa3a55c58024bacd3e0c1dc76ff92a77224b46c871b9f5c-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "910fef3ae7a07e4f6a4eba9c5a14530fd655affe51d350227cb6db7885efdb25", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/910fef3ae7a07e4f6a4eba9c5a14530fd655affe51d350227cb6db7885efdb25/_data", "Type": "volume"}], "Name": "/t5ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "02cfbb7490685252bc89810881f7378d206200390b6b773ee489b0d7d8f8ebf1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:02", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "02cfbb7490685252bc89810881f7378d206200390b6b773ee489b0d7d8f8ebf1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:02", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "0bba203fded1f770f79578d44bb4b8c3d30d6efd5e2dec91f700b76a60b0b6bd", "SandboxKey": "/var/run/docker/netns/0bba203fded1", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/9682d45a5c56eb3bdaa3a55c58024bacd3e0c1dc76ff92a77224b46c871b9f5c/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 2687, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:35:51.337635535Z", "Status": "running"}}, "item": {"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5', u'tenant_sub_if': u't5s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:36:02.822801014Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/4fd9978d866664ec8c8d2e1ceb09e5c1de203ed998229c20faf6f988b0d37564-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/4fd9978d866664ec8c8d2e1ceb09e5c1de203ed998229c20faf6f988b0d37564/merged", "UpperDir": "/var/lib/docker/overlay2/4fd9978d866664ec8c8d2e1ceb09e5c1de203ed998229c20faf6f988b0d37564/diff", "WorkDir": "/var/lib/docker/overlay2/4fd9978d866664ec8c8d2e1ceb09e5c1de203ed998229c20faf6f988b0d37564/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/edb38011a09d4e53f15209010c074205ad5c7aa3999640a33656cb1c1e7b5836/hostname", "HostsPath": "/var/lib/docker/containers/edb38011a09d4e53f15209010c074205ad5c7aa3999640a33656cb1c1e7b5836/hosts", "Id": "edb38011a09d4e53f15209010c074205ad5c7aa3999640a33656cb1c1e7b5836", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/edb38011a09d4e53f15209010c074205ad5c7aa3999640a33656cb1c1e7b5836/edb38011a09d4e53f15209010c074205ad5c7aa3999640a33656cb1c1e7b5836-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "7cc6538acfe9b63f0ce5c97cd26d7301d135203f610377f796b39ac5e966d8f7", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/7cc6538acfe9b63f0ce5c97cd26d7301d135203f610377f796b39ac5e966d8f7/_data", "Type": "volume"}], "Name": "/t5ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "8698e8806259f013eb852b5093322f322dd91eedbd5012de5774bc64eccdc29d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "8698e8806259f013eb852b5093322f322dd91eedbd5012de5774bc64eccdc29d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "6506d71a5336b92f56e28909cdff90698cfe8142d0c6570424e7d0b4cf26976f", "SandboxKey": "/var/run/docker/netns/6506d71a5336", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/edb38011a09d4e53f15209010c074205ad5c7aa3999640a33656cb1c1e7b5836/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 6794, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:36:03.320261423Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t5ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:36:02.822801014Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/4fd9978d866664ec8c8d2e1ceb09e5c1de203ed998229c20faf6f988b0d37564-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/4fd9978d866664ec8c8d2e1ceb09e5c1de203ed998229c20faf6f988b0d37564/merged", "UpperDir": "/var/lib/docker/overlay2/4fd9978d866664ec8c8d2e1ceb09e5c1de203ed998229c20faf6f988b0d37564/diff", "WorkDir": "/var/lib/docker/overlay2/4fd9978d866664ec8c8d2e1ceb09e5c1de203ed998229c20faf6f988b0d37564/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/edb38011a09d4e53f15209010c074205ad5c7aa3999640a33656cb1c1e7b5836/hostname", "HostsPath": "/var/lib/docker/containers/edb38011a09d4e53f15209010c074205ad5c7aa3999640a33656cb1c1e7b5836/hosts", "Id": "edb38011a09d4e53f15209010c074205ad5c7aa3999640a33656cb1c1e7b5836", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/edb38011a09d4e53f15209010c074205ad5c7aa3999640a33656cb1c1e7b5836/edb38011a09d4e53f15209010c074205ad5c7aa3999640a33656cb1c1e7b5836-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "7cc6538acfe9b63f0ce5c97cd26d7301d135203f610377f796b39ac5e966d8f7", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/7cc6538acfe9b63f0ce5c97cd26d7301d135203f610377f796b39ac5e966d8f7/_data", "Type": "volume"}], "Name": "/t5ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "8698e8806259f013eb852b5093322f322dd91eedbd5012de5774bc64eccdc29d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:04", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "8698e8806259f013eb852b5093322f322dd91eedbd5012de5774bc64eccdc29d", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.4", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:04", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "6506d71a5336b92f56e28909cdff90698cfe8142d0c6570424e7d0b4cf26976f", "SandboxKey": "/var/run/docker/netns/6506d71a5336", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/edb38011a09d4e53f15209010c074205ad5c7aa3999640a33656cb1c1e7b5836/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 6794, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:36:03.320261423Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'20484', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5if\" ; if [ $? -ne 0 ] ; then ip link add \"t5if\" type veth peer name \"t5pns_if\" ; fi\n", "delta": "0:00:00.154455", "end": "2019-12-06 23:36:08.743462", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "20484", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 23:36:08.589007", "stderr": "", "stderr_lines": [], "stdout": "59: t5if@if58: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 86:3f:96:c5:df:05 brd ff:ff:ff:ff:ff:ff link-netnsid 1", "stdout_lines": ["59: t5if@if58: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 86:3f:96:c5:df:05 brd ff:ff:ff:ff:ff:ff link-netnsid 1"]}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'20484', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t5pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t5pns_if\" netns pns1 ; fi\ndocker exec \"t5\" ip link show \"t5if\" ; if [ $? -ne 0 ] ; then ip link set \"t5if\" netns \"20484\" ; fi\nip netns exec pns1 ip link set dev \"t5pns_if\" up\ndocker exec \"t5\" ip link set dev \"t5if\" up\n", "delta": "0:00:00.414327", "end": "2019-12-06 23:36:09.385424", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "20484", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 23:36:08.971097", "stderr": "", "stderr_lines": [], "stdout": "58: t5pns_if@if59: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 6a:46:7f:3b:3a:ae brd ff:ff:ff:ff:ff:ff link-netnsid 1\n59: t5if@if58: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 86:3f:96:c5:df:05 brd ff:ff:ff:ff:ff:ff link-netnsid 1", "stdout_lines": ["58: t5pns_if@if59: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 6a:46:7f:3b:3a:ae brd ff:ff:ff:ff:ff:ff link-netnsid 1", "59: t5if@if58: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 86:3f:96:c5:df:05 brd ff:ff:ff:ff:ff:ff link-netnsid 1"]}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'20484', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t5pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.5.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.5.1/24\" dev \"t5pns_if\" ; fi\ndocker exec \"t5\" ip addr show \"t5if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.5.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip addr add \"192.168.5.2/24\" dev \"t5if\" ; fi\n", "delta": "0:00:00.275754", "end": "2019-12-06 23:36:09.940790", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "20484", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 23:36:09.665036", "stderr": "", "stderr_lines": [], "stdout": "192.168.5.1/24\n192.168.5.2/24", "stdout_lines": ["192.168.5.1/24", "192.168.5.2/24"]}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t5ns1if\" type veth peer name \"t5s1if\" ; fi\n", "delta": "0:00:00.163526", "end": "2019-12-06 23:36:10.356037", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "rc": 0, "start": "2019-12-06 23:36:10.192511", "stderr": "", "stderr_lines": [], "stdout": "61: t5ns1if@if60: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 6e:cd:10:61:52:60 brd ff:ff:ff:ff:ff:ff link-netnsid 2", "stdout_lines": ["61: t5ns1if@if60: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 6e:cd:10:61:52:60 brd ff:ff:ff:ff:ff:ff link-netnsid 2"]}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t5ns1if\" netns \"20484\" ; fi\ndocker exec \"t5ns1\" ip link show \"t5s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t5s1if\" netns \"21100\" ; fi\n", "delta": "0:00:00.344173", "end": "2019-12-06 23:36:10.962737", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "rc": 0, "start": "2019-12-06 23:36:10.618564", "stderr": "", "stderr_lines": [], "stdout": "61: t5ns1if@if60: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 6e:cd:10:61:52:60 brd ff:ff:ff:ff:ff:ff link-netnsid 2\n60: t5s1if@if61: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 46:4a:08:55:b6:3d brd ff:ff:ff:ff:ff:ff link-netnsid 1", "stdout_lines": ["61: t5ns1if@if60: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 6e:cd:10:61:52:60 brd ff:ff:ff:ff:ff:ff link-netnsid 2", "60: t5s1if@if61: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 46:4a:08:55:b6:3d brd ff:ff:ff:ff:ff:ff link-netnsid 1"]}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link set dev \"t5ns1if\" up\ndocker exec \"t5ns1\" ip link set dev \"t5s1if\" up\n", "delta": "0:00:00.342117", "end": "2019-12-06 23:36:11.553376", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "rc": 0, "start": "2019-12-06 23:36:11.211259", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip addr show \"t5s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.41.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip addr add \"10.1.41.2/24\" dev \"t5s1if\" ; fi\n\ndocker exec \"t5\" ip addr show \"t5ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.41.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip addr add \"10.1.41.1/24\" dev \"t5ns1if\" ; fi\n", "delta": "0:00:00.317309", "end": "2019-12-06 23:36:12.082681", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "rc": 0, "start": "2019-12-06 23:36:11.765372", "stderr": "", "stderr_lines": [], "stdout": "10.1.41.2/24\n10.1.41.1/24", "stdout_lines": ["10.1.41.2/24", "10.1.41.1/24"]}

TASK [Delete default route] *********************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'20484', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t5\" ip route del default ; fi\n", "delta": "0:00:00.335631", "end": "2019-12-06 23:36:12.624555", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "20484", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 23:36:12.288924", "stderr": "", "stderr_lines": [], "stdout": "default via 192.168.5.1 dev t5if ", "stdout_lines": ["default via 192.168.5.1 dev t5if "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.5.1', u'name': u't5', u'pns_ip': u'192.168.5.1/24', u'tenant_if': u't5if', u'pid': u'20484', u'tenant_ip': u'192.168.5.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip route show default | grep -w '[d]efault via 192.168.5.1' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip route add default via \"192.168.5.1\" ; fi\n", "delta": "0:00:00.358734", "end": "2019-12-06 23:36:13.199888", "item": {"default_route_ip": "192.168.5.1", "name": "t5", "pid": "20484", "pns_if": "t5pns_if", "pns_ip": "192.168.5.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.5.2/24"}, "rc": 0, "start": "2019-12-06 23:36:12.841154", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'tenant_route_ip': u'192.168.5.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.1.41.0/24', u'remote_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t5ns1\" ip route del default ; fi\n", "delta": "0:00:00.395547", "end": "2019-12-06 23:36:13.840430", "item": {"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 23:36:13.444883", "stderr": "", "stderr_lines": [], "stdout": "default via 10.1.41.1 dev t5s1if ", "stdout_lines": ["default via 10.1.41.1 dev t5s1if "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'tenant_route_ip': u'192.168.5.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.1.41.0/24', u'remote_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip route show default | grep -w '[d]efault via 10.1.41.1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip route add default via \"10.1.41.1\" ; fi\n", "delta": "0:00:00.401089", "end": "2019-12-06 23:36:14.464748", "item": {"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 23:36:14.063659", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside container] ***********************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'tenant_route_ip': u'192.168.5.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.1.41.0/24', u'remote_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show | grep -w '^t5br1'; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addbr \"t5br1\" ; fi\ndocker exec \"t5ns1\" ip link set dev \"t5br1\" up\n", "delta": "0:00:00.376283", "end": "2019-12-06 23:36:15.061934", "item": {"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 23:36:14.685651", "stderr": "", "stderr_lines": [], "stdout": "t5br1\t\t8000.1e3db4ef9758\tno\t\tt5br1if1", "stdout_lines": ["t5br1\t\t8000.1e3db4ef9758\tno\t\tt5br1if1"]}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"t5s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip link add \"t5s1_dnsbrif\" type veth peer name \"t5s1_dnsif\" ; fi\ndocker exec \"t5ns1\" ip link set dev \"t5s1_dnsbrif\" up\ndocker exec \"t5ns1\" ip link set dev \"t5s1_dnsif\" up\n", "delta": "0:00:00.620973", "end": "2019-12-06 23:36:15.949678", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:36:15.328705", "stderr": "", "stderr_lines": [], "stdout": "4: t5s1_dnsbrif@t5s1_dnsif: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master t5br1 state UP mode DEFAULT group default qlen 1000\n    link/ether ca:6f:ac:1c:2d:bc brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["4: t5s1_dnsbrif@t5s1_dnsif: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master t5br1 state UP mode DEFAULT group default qlen 1000", "    link/ether ca:6f:ac:1c:2d:bc brd ff:ff:ff:ff:ff:ff"]}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 't5s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"t5s1_dnsbrif\" ; fi\n", "delta": "0:00:00.163958", "end": "2019-12-06 23:36:16.366559", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:36:16.202601", "stderr": "", "stderr_lines": [], "stdout": "\t\t\t\t\t\t\tt5s1_dnsbrif", "stdout_lines": ["\t\t\t\t\t\t\tt5s1_dnsbrif"]}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"t5br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t5C1if1\" type veth peer name \"t5br1if1\" ; fi\nip link set dev \"t5br1if1\" up\nip link set dev \"t5C1if1\" up\n", "delta": "0:00:00.178459", "end": "2019-12-06 23:36:16.798031", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}], "rc": 0, "start": "2019-12-06 23:36:16.619572", "stderr": "Cannot find device \"t5br1if1\"", "stderr_lines": ["Cannot find device \"t5br1if1\""], "stdout": "66: t5br1if1@if67: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master t5br1 state UP mode DEFAULT group default qlen 1000\n    link/ether 6a:39:a9:98:3d:34 brd ff:ff:ff:ff:ff:ff link-netnsid 0", "stdout_lines": ["66: t5br1if1@if67: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master t5br1 state UP mode DEFAULT group default qlen 1000", "    link/ether 6a:39:a9:98:3d:34 brd ff:ff:ff:ff:ff:ff link-netnsid 0"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"t5br1if2\" ; if [ $? -ne 0 ] ; then ip link add \"t5C2if1\" type veth peer name \"t5br1if2\" ; fi\nip link set dev \"t5br1if2\" up\nip link set dev \"t5C2if1\" up\n", "delta": "0:00:00.189848", "end": "2019-12-06 23:36:17.163439", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}], "rc": 0, "start": "2019-12-06 23:36:16.973591", "stderr": "Cannot find device \"t5br1if2\"", "stderr_lines": ["Cannot find device \"t5br1if2\""], "stdout": "68: t5br1if2@if69: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master t5br1 state UP mode DEFAULT group default qlen 1000\n    link/ether 1e:3d:b4:ef:97:58 brd ff:ff:ff:ff:ff:ff link-netnsid 0", "stdout_lines": ["68: t5br1if2@if69: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master t5br1 state UP mode DEFAULT group default qlen 1000", "    link/ether 1e:3d:b4:ef:97:58 brd ff:ff:ff:ff:ff:ff link-netnsid 0"]}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t5br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t5br1if1\" netns \"21100\" ; fi\ndocker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 't5br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"t5br1if1\" ; fi\n", "delta": "0:00:00.177005", "end": "2019-12-06 23:36:17.580145", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}], "rc": 0, "start": "2019-12-06 23:36:17.403140", "stderr": "Device \"t5br1if1\" does not exist.", "stderr_lines": ["Device \"t5br1if1\" does not exist."], "stdout": "t5br1\t\t8000.1e3db4ef9758\tno\t\tt5br1if1", "stdout_lines": ["t5br1\t\t8000.1e3db4ef9758\tno\t\tt5br1if1"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t5br1if2\" ; if [ $? -eq 0 ] ; then ip link set \"t5br1if2\" netns \"21100\" ; fi\ndocker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 't5br1if2' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"t5br1if2\" ; fi\n", "delta": "0:00:00.167398", "end": "2019-12-06 23:36:17.898989", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}], "rc": 0, "start": "2019-12-06 23:36:17.731591", "stderr": "Device \"t5br1if2\" does not exist.", "stderr_lines": ["Device \"t5br1if2\" does not exist."], "stdout": "\t\t\t\t\t\t\tt5br1if2", "stdout_lines": ["\t\t\t\t\t\t\tt5br1if2"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link set \"t5br1if1\" up\ndocker exec \"t5ns1\" ip link set dev \"t5br1\" up\n", "delta": "0:00:00.355908", "end": "2019-12-06 23:36:18.488586", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}], "rc": 0, "start": "2019-12-06 23:36:18.132678", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link set \"t5br1if2\" up\ndocker exec \"t5ns1\" ip link set dev \"t5br1\" up\n", "delta": "0:00:00.369721", "end": "2019-12-06 23:36:19.050189", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}], "rc": 0, "start": "2019-12-06 23:36:18.680468", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip addr show \"t5s1_dnsif\" | awk 'FNR==3{ print $2 }' | grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip addr add \"1.1.1.1/24\" dev \"t5s1_dnsif\" ; fi\n", "delta": "0:00:00.198612", "end": "2019-12-06 23:36:19.508348", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:36:19.309736", "stderr": "", "stderr_lines": [], "stdout": "1.1.1.1/24", "stdout_lines": ["1.1.1.1/24"]}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}], u'vxlan': [{u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ps aux | grep -w '[d]nsmasq --interface t5s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" dnsmasq --interface \"t5s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.201501", "end": "2019-12-06 23:36:19.991994", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:36:19.790493", "stderr": "", "stderr_lines": [], "stdout": "nobody    1221  0.0  0.0  53912  2472 ?        S    23:33   0:00 dnsmasq --interface t5s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254", "stdout_lines": ["nobody    1221  0.0  0.0  53912  2472 ?        S    23:33   0:00 dnsmasq --interface t5s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254"]}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]}, {u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"vxlan_t5s1\" ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip link add \"vxlan_t5s1\" type vxlan id \"42\" local \"10.1.41.2\" remote \"10.2.41.2\" dstport \"4789\" dev \"t5s1if\"; docker exec \"t5ns1\" ip link set dev \"vxlan_t5s1\" up ; fi\n", "delta": "0:00:00.159291", "end": "2019-12-06 23:36:20.390493", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:36:20.231202", "stderr": "", "stderr_lines": [], "stdout": "5: vxlan_t5s1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc noqueue master t5br1 state UNKNOWN mode DEFAULT group default qlen 1000\n    link/ether e2:08:a2:4d:5a:89 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["5: vxlan_t5s1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc noqueue master t5br1 state UNKNOWN mode DEFAULT group default qlen 1000", "    link/ether e2:08:a2:4d:5a:89 brd ff:ff:ff:ff:ff:ff"]}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]}, {u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 'vxlan_t5s1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"vxlan_t5s1\" ; fi\n", "delta": "0:00:00.156731", "end": "2019-12-06 23:36:20.787893", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:36:20.631162", "stderr": "", "stderr_lines": [], "stdout": "\t\t\t\t\t\t\tvxlan_t5s1", "stdout_lines": ["\t\t\t\t\t\t\tvxlan_t5s1"]}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.133.1', u'name': u't5', u'pns_ip': u'192.168.133.1/24', u'tenant_if': u't5if', u'pid': u'30798', u'tenant_ip': u'192.168.133.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5if\" ; if [ $? -ne 0 ] ; then ip link add \"t5if\" type veth peer name \"t5pns_if\" ; fi\n", "delta": "0:00:00.206425", "end": "2019-12-06 23:36:22.139430", "item": {"default_route_ip": "192.168.133.1", "name": "t5", "pid": "30798", "pns_if": "t5pns_if", "pns_ip": "192.168.133.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.133.2/24"}, "rc": 0, "start": "2019-12-06 23:36:21.933005", "stderr": "Device \"t5if\" does not exist.", "stderr_lines": ["Device \"t5if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.133.1', u'name': u't5', u'pns_ip': u'192.168.133.1/24', u'tenant_if': u't5if', u'pid': u'30798', u'tenant_ip': u'192.168.133.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t5pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t5pns_if\" netns pns1 ; fi\ndocker exec \"t5\" ip link show \"t5if\" ; if [ $? -ne 0 ] ; then ip link set \"t5if\" netns \"30798\" ; fi\nip netns exec pns1 ip link set dev \"t5pns_if\" up\ndocker exec \"t5\" ip link set dev \"t5if\" up\n", "delta": "0:00:00.494576", "end": "2019-12-06 23:36:22.958365", "item": {"default_route_ip": "192.168.133.1", "name": "t5", "pid": "30798", "pns_if": "t5pns_if", "pns_ip": "192.168.133.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.133.2/24"}, "rc": 0, "start": "2019-12-06 23:36:22.463789", "stderr": "Device \"t5pns_if\" does not exist.\nDevice \"t5if\" does not exist.", "stderr_lines": ["Device \"t5pns_if\" does not exist.", "Device \"t5if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.133.1', u'name': u't5', u'pns_ip': u'192.168.133.1/24', u'tenant_if': u't5if', u'pid': u'30798', u'tenant_ip': u'192.168.133.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t5pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.133.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.133.1/24\" dev \"t5pns_if\" ; fi\ndocker exec \"t5\" ip addr show \"t5if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.133.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip addr add \"192.168.133.2/24\" dev \"t5if\" ; fi\n", "delta": "0:00:00.452833", "end": "2019-12-06 23:36:23.728599", "item": {"default_route_ip": "192.168.133.1", "name": "t5", "pid": "30798", "pns_if": "t5pns_if", "pns_ip": "192.168.133.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.133.2/24"}, "rc": 0, "start": "2019-12-06 23:36:23.275766", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t5ns1if\" type veth peer name \"t5s1if\" ; fi\n", "delta": "0:00:00.202441", "end": "2019-12-06 23:36:24.264531", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "rc": 0, "start": "2019-12-06 23:36:24.062090", "stderr": "Device \"t5ns1if\" does not exist.", "stderr_lines": ["Device \"t5ns1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5ns2if\" ; if [ $? -ne 0 ] ; then ip link add \"t5ns2if\" type veth peer name \"t5s2if\" ; fi\n", "delta": "0:00:00.166391", "end": "2019-12-06 23:36:24.696303", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "rc": 0, "start": "2019-12-06 23:36:24.529912", "stderr": "Device \"t5ns2if\" does not exist.", "stderr_lines": ["Device \"t5ns2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t5ns1if\" netns \"30798\" ; fi\ndocker exec \"t5ns1\" ip link show \"t5s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t5s1if\" netns \"2687\" ; fi\n", "delta": "0:00:00.424514", "end": "2019-12-06 23:36:25.492451", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "rc": 0, "start": "2019-12-06 23:36:25.067937", "stderr": "Device \"t5ns1if\" does not exist.\nDevice \"t5s1if\" does not exist.", "stderr_lines": ["Device \"t5ns1if\" does not exist.", "Device \"t5s1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link show \"t5ns2if\" ; if [ $? -ne 0 ] ; then ip link set \"t5ns2if\" netns \"30798\" ; fi\ndocker exec \"t5ns2\" ip link show \"t5s2if\" ; if [ $? -ne 0 ] ; then ip link set \"t5s2if\" netns \"6794\" ; fi\n", "delta": "0:00:00.401849", "end": "2019-12-06 23:36:26.181281", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "rc": 0, "start": "2019-12-06 23:36:25.779432", "stderr": "Device \"t5ns2if\" does not exist.\nDevice \"t5s2if\" does not exist.", "stderr_lines": ["Device \"t5ns2if\" does not exist.", "Device \"t5s2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link set dev \"t5ns1if\" up\ndocker exec \"t5ns1\" ip link set dev \"t5s1if\" up\n", "delta": "0:00:00.381115", "end": "2019-12-06 23:36:26.902242", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "rc": 0, "start": "2019-12-06 23:36:26.521127", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip link set dev \"t5ns2if\" up\ndocker exec \"t5ns2\" ip link set dev \"t5s2if\" up\n", "delta": "0:00:00.362918", "end": "2019-12-06 23:36:27.521334", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "rc": 0, "start": "2019-12-06 23:36:27.158416", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip addr show \"t5s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.41.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip addr add \"10.2.41.2/24\" dev \"t5s1if\" ; fi\n\ndocker exec \"t5\" ip addr show \"t5ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.41.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip addr add \"10.2.41.1/24\" dev \"t5ns1if\" ; fi\n", "delta": "0:00:00.763684", "end": "2019-12-06 23:36:28.596064", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "rc": 0, "start": "2019-12-06 23:36:27.832380", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ip addr show \"t5s2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.42.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" ip addr add \"10.2.42.2/24\" dev \"t5s2if\" ; fi\n\ndocker exec \"t5\" ip addr show \"t5ns2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.42.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip addr add \"10.2.42.1/24\" dev \"t5ns2if\" ; fi\n", "delta": "0:00:00.763388", "end": "2019-12-06 23:36:29.651736", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "rc": 0, "start": "2019-12-06 23:36:28.888348", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route] *********************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.133.1', u'name': u't5', u'pns_ip': u'192.168.133.1/24', u'tenant_if': u't5if', u'pid': u'30798', u'tenant_ip': u'192.168.133.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t5\" ip route del default ; fi\n", "delta": "0:00:00.382528", "end": "2019-12-06 23:36:30.358301", "item": {"default_route_ip": "192.168.133.1", "name": "t5", "pid": "30798", "pns_if": "t5pns_if", "pns_ip": "192.168.133.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.133.2/24"}, "rc": 0, "start": "2019-12-06 23:36:29.975773", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.133.1', u'name': u't5', u'pns_ip': u'192.168.133.1/24', u'tenant_if': u't5if', u'pid': u'30798', u'tenant_ip': u'192.168.133.2/24', u'pns_if': u't5pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5\" ip route show default | grep -w '[d]efault via 192.168.133.1' ; if [ $? -ne 0 ] ; then docker exec \"t5\" ip route add default via \"192.168.133.1\" ; fi\n", "delta": "0:00:00.383829", "end": "2019-12-06 23:36:31.060999", "item": {"default_route_ip": "192.168.133.1", "name": "t5", "pid": "30798", "pns_if": "t5pns_if", "pns_ip": "192.168.133.1/24", "tenant_if": "t5if", "tenant_ip": "192.168.133.2/24"}, "rc": 0, "start": "2019-12-06 23:36:30.677170", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'tenant_route_ip': u'192.168.133.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.2.41.0/24', u'remote_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t5ns1\" ip route del default ; fi\n", "delta": "0:00:00.429785", "end": "2019-12-06 23:36:31.841034", "item": {"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 23:36:31.411249", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_sub_if': u't5s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t5ns2\" ip route del default ; fi\n", "delta": "0:00:00.398152", "end": "2019-12-06 23:36:32.499695", "item": {"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:36:32.101543", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'tenant_route_ip': u'192.168.133.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.2.41.0/24', u'remote_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip route show default | grep -w '[d]efault via 10.2.41.1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip route add default via \"10.2.41.1\" ; fi\n", "delta": "0:00:00.389738", "end": "2019-12-06 23:36:33.239938", "item": {"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 23:36:32.850200", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_sub_if': u't5s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ip route show default | grep -w '[d]efault via 10.2.42.1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" ip route add default via \"10.2.42.1\" ; fi\n", "delta": "0:00:00.399103", "end": "2019-12-06 23:36:33.902624", "item": {"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:36:33.503521", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside namespace] ***********************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_sub_if': u't5s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'tenant_route_ip': u'192.168.133.2', u'dsport': 4789, u'dev': u't5s1if', u'subnet_route': u'10.2.41.0/24', u'remote_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show | grep -w '^t5br1'; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addbr \"t5br1\" ; fi\ndocker exec \"t5ns1\" ip link set dev \"t5br1\" up\n", "delta": "0:00:00.575936", "end": "2019-12-06 23:36:34.830555", "item": {"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, "rc": 0, "start": "2019-12-06 23:36:34.254619", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_ns_name': u't5', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_sub_if': u't5s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" brctl show | grep -w '^t5br2'; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" brctl addbr \"t5br2\" ; fi\ndocker exec \"t5ns2\" ip link set dev \"t5br2\" up\n", "delta": "0:00:00.556320", "end": "2019-12-06 23:36:35.648865", "item": {"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:36:35.092545", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"t5s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip link add \"t5s1_dnsbrif\" type veth peer name \"t5s1_dnsif\" ; fi\ndocker exec \"t5ns1\" ip link set dev \"t5s1_dnsbrif\" up\ndocker exec \"t5ns1\" ip link set dev \"t5s1_dnsif\" up\n", "delta": "0:00:00.837322", "end": "2019-12-06 23:36:36.860187", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:36:36.022865", "stderr": "Device \"t5s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t5s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ip link show \"t5s2_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" ip link add \"t5s2_dnsbrif\" type veth peer name \"t5s2_dnsif\" ; fi\ndocker exec \"t5ns2\" ip link set dev \"t5s2_dnsbrif\" up\ndocker exec \"t5ns2\" ip link set dev \"t5s2_dnsif\" up\n", "delta": "0:00:00.751645", "end": "2019-12-06 23:36:37.892322", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:36:37.140677", "stderr": "Device \"t5s2_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t5s2_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 't5s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"t5s1_dnsbrif\" ; fi\n", "delta": "0:00:00.381989", "end": "2019-12-06 23:36:38.639608", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:36:38.257619", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" brctl show \"t5br2\" | grep -w 't5s2_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" brctl addif \"t5br2\" \"t5s2_dnsbrif\" ; fi\n", "delta": "0:00:00.372535", "end": "2019-12-06 23:36:39.286699", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:36:38.914164", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"t5br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t5C3if1\" type veth peer name \"t5br1if1\" ; fi\nip link set dev \"t5br1if1\" up\nip link set dev \"t5C3if1\" up\n", "delta": "0:00:00.184598", "end": "2019-12-06 23:36:39.802921", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "rc": 0, "start": "2019-12-06 23:36:39.618323", "stderr": "Device \"t5br1if1\" does not exist.", "stderr_lines": ["Device \"t5br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ip link show \"t5br2if1\" ; if [ $? -ne 0 ] ; then ip link add \"t5C4if1\" type veth peer name \"t5br2if1\" ; fi\nip link set dev \"t5br2if1\" up\nip link set dev \"t5C4if1\" up\n", "delta": "0:00:00.184826", "end": "2019-12-06 23:36:40.270066", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "rc": 0, "start": "2019-12-06 23:36:40.085240", "stderr": "Device \"t5br2if1\" does not exist.", "stderr_lines": ["Device \"t5br2if1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t5br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t5br1if1\" netns \"2687\" ; fi\ndocker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 't5br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"t5br1if1\" ; fi\n", "delta": "0:00:00.405635", "end": "2019-12-06 23:36:41.038718", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "rc": 0, "start": "2019-12-06 23:36:40.633083", "stderr": "", "stderr_lines": [], "stdout": "103: t5br1if1@t5C3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 7e:4f:36:7e:6b:bd brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["103: t5br1if1@t5C3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 7e:4f:36:7e:6b:bd brd ff:ff:ff:ff:ff:ff"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t5br2if1\" ; if [ $? -eq 0 ] ; then ip link set \"t5br2if1\" netns \"6794\" ; fi\ndocker exec \"t5ns2\" brctl show \"t5br2\" | grep -w 't5br2if1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" brctl addif \"t5br2\" \"t5br2if1\" ; fi\n", "delta": "0:00:00.415462", "end": "2019-12-06 23:36:41.734584", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "rc": 0, "start": "2019-12-06 23:36:41.319122", "stderr": "", "stderr_lines": [], "stdout": "105: t5br2if1@t5C4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether e2:1b:b4:fa:a1:a5 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["105: t5br2if1@t5C4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether e2:1b:b4:fa:a1:a5 brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link set \"t5br1if1\" up\ndocker exec \"t5ns1\" ip link set dev \"t5br1\" up\n", "delta": "0:00:00.404170", "end": "2019-12-06 23:36:42.475512", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "rc": 0, "start": "2019-12-06 23:36:42.071342", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ip link set \"t5br2if1\" up\ndocker exec \"t5ns2\" ip link set dev \"t5br2\" up\n", "delta": "0:00:00.398397", "end": "2019-12-06 23:36:43.140431", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "rc": 0, "start": "2019-12-06 23:36:42.742034", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip addr show \"t5s1_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip addr add \"1.1.1.1/24\" dev \"t5s1_dnsif\" ; fi\n", "delta": "0:00:00.401846", "end": "2019-12-06 23:36:43.926606", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:36:43.524760", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ip addr show \"t5s2_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^2.2.2.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" ip addr add \"2.2.2.1/24\" dev \"t5s2_dnsif\" ; fi\n", "delta": "0:00:00.381466", "end": "2019-12-06 23:36:44.576709", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:36:44.195243", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}], u'vxlan': [{u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]}, {u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ps aux | grep -w '[d]nsmasq --interface t5s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" dnsmasq --interface \"t5s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.857412", "end": "2019-12-06 23:36:45.790761", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}], "vxlan": [{"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}]}, {"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:36:44.933349", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns2\" ps aux | grep -w '[d]nsmasq --interface t5s2_dnsif -z --dhcp-range=2.2.2.5,2.2.2.254' ; if [ $? -ne 0 ] ; then docker exec \"t5ns2\" dnsmasq --interface \"t5s2_dnsif\" -z --dhcp-range=2.2.2.5,'2.2.2.254' ; fi\n", "delta": "0:00:00.849538", "end": "2019-12-06 23:36:46.918310", "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:36:46.068772", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}]}, {u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" ip link show \"vxlan_t5s1\" ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" ip link add \"vxlan_t5s1\" type vxlan id \"42\" local \"10.2.41.2\" remote \"10.1.41.2\" dstport \"4789\" dev \"t5s1if\" ; docker exec \"t5ns1\" ip link set dev \"vxlan_t5s1\" up ; fi\n", "delta": "0:00:00.609813", "end": "2019-12-06 23:36:47.884303", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:36:47.274490", "stderr": "Device \"vxlan_t5s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t5s1\" does not exist."], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}]}, {u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t5ns1\" brctl show \"t5br1\" | grep -w 'vxlan_t5s1' ; if [ $? -ne 0 ] ; then docker exec \"t5ns1\" brctl addif \"t5br1\" \"vxlan_t5s1\" ; fi\n", "delta": "0:00:00.380825", "end": "2019-12-06 23:36:48.675132", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:36:48.294307", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]}, {u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip route show \"10.1.41.0/24\" via \"192.168.5.2\" | grep -w '^10.1.41.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip route add \"10.1.41.0/24\" via \"192.168.5.2\" ; fi\n", "delta": "0:00:00.040841", "end": "2019-12-06 23:36:49.838052", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:36:49.797211", "stderr": "", "stderr_lines": [], "stdout": "10.1.41.0/24 dev t5pns_if ", "stdout_lines": ["10.1.41.0/24 dev t5pns_if "]}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": "ip netns exec pns1 ip addr show p11 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.039771", "end": "2019-12-06 23:36:50.110279", "rc": 0, "start": "2019-12-06 23:36:50.070508", "stderr": "", "stderr_lines": [], "stdout": "192.168.200.207", "stdout_lines": ["192.168.200.207"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.1.41.1', u'pid': u'21100', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'20484', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.1.41.2/24', u'tenant_ns_ip': u'10.1.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'8274', u'brif': u't5br1if1', u'vmif': u't5C1if1', u'name': u't5_C1'}, {u'vm_pid': u'8877', u'brif': u't5br1if2', u'vmif': u't5C2if1', u'name': u't5_C2'}]}, {u'local_ip': u'10.1.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.5.2', u'remote_route': u'10.2.41.0/24', u'subnet_route': u'10.1.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.2.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.1.41.0/24\" via \"192.168.200.207\" | grep -w '^10.1.41.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.1.41.0/24\" via \"192.168.200.207\" ; fi\nip route show \"10.2.41.0/24\" via 99.99.99.2 | grep -w '^10.2.41.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.2.41.0/24\" via 99.99.99.2 ; fi\n", "delta": "0:00:00.006052", "end": "2019-12-06 23:36:50.347014", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.1.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "21100", "route": [{"if": "p1", "ip": "10.1.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.1.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "20484", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.1.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C1", "vm_pid": "8274", "vmif": "t5C1if1"}, {"brif": "t5br1if2", "name": "t5_C2", "vm_pid": "8877", "vmif": "t5C2if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.41.2", "remote_ip": "10.2.41.2", "remote_route": "10.2.41.0/24", "subnet_route": "10.1.41.0/24", "tenant_route_ip": "192.168.5.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:36:50.340962", "stderr": "", "stderr_lines": [], "stdout": "10.1.41.0/24 dev testBR1 \n10.2.41.0/24 dev ens4 ", "stdout_lines": ["10.1.41.0/24 dev testBR1 ", "10.2.41.0/24 dev ens4 "]}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}]}, {u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip route show \"10.2.41.0/24\" via \"192.168.133.2\" | grep -w '^10.2.41.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip route add \"10.2.41.0/24\" via \"192.168.133.2\" ; fi\n", "delta": "0:00:00.068143", "end": "2019-12-06 23:36:51.563161", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:36:51.495018", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": "ip netns exec pns1 ip addr show p11 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.049713", "end": "2019-12-06 23:36:51.927595", "rc": 0, "start": "2019-12-06 23:36:51.877882", "stderr": "", "stderr_lines": [], "stdout": "192.168.200.5", "stdout_lines": ["192.168.200.5"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.41.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.41.1', u'pid': u'2687', u'bridge_name': u't5br1', u'dns': [{u'dnsif': u't5s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s1_dnsbrif'}], u'ns_name': u't5ns1', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s1if', u'tenant_sub_ip': u'10.2.41.2/24', u'tenant_ns_ip': u'10.2.41.1/24', u'tenant_ns_if': u't5ns1if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br1if1', u'vmif': u't5C3if1', u'name': u't5_C3'}]}, {u'local_ip': u'10.2.41.2', u'dsport': 4789, u'dev': u't5s1if', u'tenant_route_ip': u'192.168.133.2', u'remote_route': u'10.1.41.0/24', u'subnet_route': u'10.2.41.0/24', u'v_name': u'vxlan_t5s1', u'id': 42, u'remote_ip': u'10.1.41.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.2.41.0/24\" via \"192.168.200.5\" | grep -w '^10.2.41.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.2.41.0/24\" via \"192.168.200.5\" ; fi\nip route show \"10.1.41.0/24\" via 99.99.99.1 | grep -w '^10.1.41.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.1.41.0/24\" via 99.99.99.1 ; fi\n", "delta": "0:00:00.006747", "end": "2019-12-06 23:36:52.288401", "item": [{"bridge_name": "t5br1", "default_route_ip": "10.2.41.1", "dns": [{"brif": "t5s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t5s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns1", "pid": "2687", "route": [{"if": "p1", "ip": "10.2.41.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns1if", "tenant_ns_ip": "10.2.41.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s1if", "tenant_sub_ip": "10.2.41.2/24"}], "vms": [{"brif": "t5br1if1", "name": "t5_C3", "vm_pid": "", "vmif": "t5C3if1"}]}, {"dev": "t5s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.41.2", "remote_ip": "10.1.41.2", "remote_route": "10.1.41.0/24", "subnet_route": "10.2.41.0/24", "tenant_route_ip": "192.168.133.2", "v_name": "vxlan_t5s1"}], "rc": 0, "start": "2019-12-06 23:36:52.281654", "stderr": "", "stderr_lines": [], "stdout": "10.2.41.0/24 dev testBR1 \n10.1.41.0/24 dev ens4 ", "stdout_lines": ["10.2.41.0/24 dev testBR1 ", "10.1.41.0/24 dev ens4 "]}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.42.1/24', u'ns_name': u't5', u'ns_if': u't5if', u'if': u'p1'}], u'default_route_ip': u'10.2.42.1', u'pid': u'6794', u'bridge_name': u't5br2', u'dns': [{u'dnsif': u't5s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't5s2_dnsbrif'}], u'ns_name': u't5ns2', u'tenant_ns': [{u'tenant_ns_pid': u'30798', u'tenant_sub_if': u't5s2if', u'tenant_sub_ip': u'10.2.42.2/24', u'tenant_ns_ip': u'10.2.42.1/24', u'tenant_ns_if': u't5ns2if', u'tenant_ns_name': u't5'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't5br2if1', u'vmif': u't5C4if1', u'name': u't5_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t5br2", "default_route_ip": "10.2.42.1", "dns": [{"brif": "t5s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t5s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t5ns2", "pid": "6794", "route": [{"if": "p1", "ip": "10.2.42.1/24", "ns_if": "t5if", "ns_name": "t5"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t5ns2if", "tenant_ns_ip": "10.2.42.1/24", "tenant_ns_name": "t5", "tenant_ns_pid": "30798", "tenant_sub_if": "t5s2if", "tenant_sub_ip": "10.2.42.2/24"}], "vms": [{"brif": "t5br2if1", "name": "t5_C4", "vm_pid": "", "vmif": "t5C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

INFO:root: 23:40:11.295014 Printing the yaml input file
INFO:root: 23:40:11.295212 {'C1': [{'CONTAINER': [{'name': 'C1'}, {'name': 'C2'}], 'subnet_addr': '1.1.1.0/24'}], 'C2': [{'CONTAINER': [{'name': 'C3'}], 'subnet_addr': '1.1.1.0/24'}, {'CONTAINER': [{'name': 'C4'}], 'subnet_addr': '2.2.2.0/24'}], 'MISC': [{'LOG_ENABLE': True, 'GUI': True}]}
INFO:root: 23:40:11.295333 Provided subnet in C1: 1.1.1.0/24 is valid
INFO:root: 23:40:11.295387 Provided subnet in C2: 1.1.1.0/24 is valid
INFO:root: 23:40:11.295431 Provided subnet in C2: 2.2.2.0/24 is valid
Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:40:13.462521691Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/84c6d72fd7d3eb8b7d36f5527be74e4d11afb1c623e6404656282613e4c3fd06-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/84c6d72fd7d3eb8b7d36f5527be74e4d11afb1c623e6404656282613e4c3fd06/merged", "UpperDir": "/var/lib/docker/overlay2/84c6d72fd7d3eb8b7d36f5527be74e4d11afb1c623e6404656282613e4c3fd06/diff", "WorkDir": "/var/lib/docker/overlay2/84c6d72fd7d3eb8b7d36f5527be74e4d11afb1c623e6404656282613e4c3fd06/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/b48d27735f4bb039aca218c259fbacb235def9add858d825aabe9fd7e6ed0897/hostname", "HostsPath": "/var/lib/docker/containers/b48d27735f4bb039aca218c259fbacb235def9add858d825aabe9fd7e6ed0897/hosts", "Id": "b48d27735f4bb039aca218c259fbacb235def9add858d825aabe9fd7e6ed0897", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/b48d27735f4bb039aca218c259fbacb235def9add858d825aabe9fd7e6ed0897/b48d27735f4bb039aca218c259fbacb235def9add858d825aabe9fd7e6ed0897-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "5f8ce3716894ec8a61da52cb38e6564f4a7cce795bd26f60682a2c2054ecd496", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/5f8ce3716894ec8a61da52cb38e6564f4a7cce795bd26f60682a2c2054ecd496/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "3f58c17699618429c15eb163bf64bec760b7b0b2ec60e3f98af502d140b3d442", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.11", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0b", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "3f58c17699618429c15eb163bf64bec760b7b0b2ec60e3f98af502d140b3d442", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.11", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0b", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "8c20aaf7e91d155a60d788c22707e0ba93c5ccdc41a27fc23550d7da2fdefc95", "SandboxKey": "/var/run/docker/netns/8c20aaf7e91d", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/b48d27735f4bb039aca218c259fbacb235def9add858d825aabe9fd7e6ed0897/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 6842, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:40:14.091909757Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:40:13.462521691Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/84c6d72fd7d3eb8b7d36f5527be74e4d11afb1c623e6404656282613e4c3fd06-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/84c6d72fd7d3eb8b7d36f5527be74e4d11afb1c623e6404656282613e4c3fd06/merged", "UpperDir": "/var/lib/docker/overlay2/84c6d72fd7d3eb8b7d36f5527be74e4d11afb1c623e6404656282613e4c3fd06/diff", "WorkDir": "/var/lib/docker/overlay2/84c6d72fd7d3eb8b7d36f5527be74e4d11afb1c623e6404656282613e4c3fd06/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/b48d27735f4bb039aca218c259fbacb235def9add858d825aabe9fd7e6ed0897/hostname", "HostsPath": "/var/lib/docker/containers/b48d27735f4bb039aca218c259fbacb235def9add858d825aabe9fd7e6ed0897/hosts", "Id": "b48d27735f4bb039aca218c259fbacb235def9add858d825aabe9fd7e6ed0897", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/b48d27735f4bb039aca218c259fbacb235def9add858d825aabe9fd7e6ed0897/b48d27735f4bb039aca218c259fbacb235def9add858d825aabe9fd7e6ed0897-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "5f8ce3716894ec8a61da52cb38e6564f4a7cce795bd26f60682a2c2054ecd496", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/5f8ce3716894ec8a61da52cb38e6564f4a7cce795bd26f60682a2c2054ecd496/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "3f58c17699618429c15eb163bf64bec760b7b0b2ec60e3f98af502d140b3d442", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.11", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0b", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "3f58c17699618429c15eb163bf64bec760b7b0b2ec60e3f98af502d140b3d442", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.11", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0b", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "8c20aaf7e91d155a60d788c22707e0ba93c5ccdc41a27fc23550d7da2fdefc95", "SandboxKey": "/var/run/docker/netns/8c20aaf7e91d", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/b48d27735f4bb039aca218c259fbacb235def9add858d825aabe9fd7e6ed0897/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 6842, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:40:14.091909757Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:40:14.735855377Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/485d667613e1e3226321b17959bff99b8948860ee38cbe2140c64debe75b070c-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/485d667613e1e3226321b17959bff99b8948860ee38cbe2140c64debe75b070c/merged", "UpperDir": "/var/lib/docker/overlay2/485d667613e1e3226321b17959bff99b8948860ee38cbe2140c64debe75b070c/diff", "WorkDir": "/var/lib/docker/overlay2/485d667613e1e3226321b17959bff99b8948860ee38cbe2140c64debe75b070c/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/7aaef6117428e69f95b3131585aba6d23ed76c824b1dcb5b1d539a835617a8da/hostname", "HostsPath": "/var/lib/docker/containers/7aaef6117428e69f95b3131585aba6d23ed76c824b1dcb5b1d539a835617a8da/hosts", "Id": "7aaef6117428e69f95b3131585aba6d23ed76c824b1dcb5b1d539a835617a8da", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/7aaef6117428e69f95b3131585aba6d23ed76c824b1dcb5b1d539a835617a8da/7aaef6117428e69f95b3131585aba6d23ed76c824b1dcb5b1d539a835617a8da-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "268dc284bfe75d5fee8ca97f0ac56f299f79f96bb1655de1c2f961a74a9f179f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/268dc284bfe75d5fee8ca97f0ac56f299f79f96bb1655de1c2f961a74a9f179f/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "2069e1f9de6d043b667816cb8b17b6651ccf67717377b39e135ddbfb8016ff5e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.12", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0c", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "2069e1f9de6d043b667816cb8b17b6651ccf67717377b39e135ddbfb8016ff5e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.12", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0c", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "e0c6c7bf903fcbe1f1186ccabccd443dbc6cb626f997a17ad5f7bb2489f8ddc5", "SandboxKey": "/var/run/docker/netns/e0c6c7bf903f", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/7aaef6117428e69f95b3131585aba6d23ed76c824b1dcb5b1d539a835617a8da/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 7247, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:40:16.216591255Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:40:14.735855377Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/485d667613e1e3226321b17959bff99b8948860ee38cbe2140c64debe75b070c-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/485d667613e1e3226321b17959bff99b8948860ee38cbe2140c64debe75b070c/merged", "UpperDir": "/var/lib/docker/overlay2/485d667613e1e3226321b17959bff99b8948860ee38cbe2140c64debe75b070c/diff", "WorkDir": "/var/lib/docker/overlay2/485d667613e1e3226321b17959bff99b8948860ee38cbe2140c64debe75b070c/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/7aaef6117428e69f95b3131585aba6d23ed76c824b1dcb5b1d539a835617a8da/hostname", "HostsPath": "/var/lib/docker/containers/7aaef6117428e69f95b3131585aba6d23ed76c824b1dcb5b1d539a835617a8da/hosts", "Id": "7aaef6117428e69f95b3131585aba6d23ed76c824b1dcb5b1d539a835617a8da", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/7aaef6117428e69f95b3131585aba6d23ed76c824b1dcb5b1d539a835617a8da/7aaef6117428e69f95b3131585aba6d23ed76c824b1dcb5b1d539a835617a8da-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "268dc284bfe75d5fee8ca97f0ac56f299f79f96bb1655de1c2f961a74a9f179f", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/268dc284bfe75d5fee8ca97f0ac56f299f79f96bb1655de1c2f961a74a9f179f/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "2069e1f9de6d043b667816cb8b17b6651ccf67717377b39e135ddbfb8016ff5e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.12", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0c", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "2069e1f9de6d043b667816cb8b17b6651ccf67717377b39e135ddbfb8016ff5e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.12", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0c", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "e0c6c7bf903fcbe1f1186ccabccd443dbc6cb626f997a17ad5f7bb2489f8ddc5", "SandboxKey": "/var/run/docker/netns/e0c6c7bf903f", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/7aaef6117428e69f95b3131585aba6d23ed76c824b1dcb5b1d539a835617a8da/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 7247, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:40:16.216591255Z", "Status": "running"}}, "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"actions": [], "ansible_facts": {"discovered_interpreter_python": "/usr/bin/python"}, "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.134.1', u'name': u't6', u'pns_ip': u'192.168.134.1/24', u'tenant_if': u't6if', u'tenant_ip': u'192.168.134.2/24', u'pns_if': u't6pns_if'}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:40:20.863713921Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/6f3dcf64ebbcba3f655d54338e6e7d0b920c2e109754c6debb3576cf4b33be7f-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/6f3dcf64ebbcba3f655d54338e6e7d0b920c2e109754c6debb3576cf4b33be7f/merged", "UpperDir": "/var/lib/docker/overlay2/6f3dcf64ebbcba3f655d54338e6e7d0b920c2e109754c6debb3576cf4b33be7f/diff", "WorkDir": "/var/lib/docker/overlay2/6f3dcf64ebbcba3f655d54338e6e7d0b920c2e109754c6debb3576cf4b33be7f/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/77da25bb0a2353fb056d6f4eb822c776ac656f189b667739b82d0348a5b1e42d/hostname", "HostsPath": "/var/lib/docker/containers/77da25bb0a2353fb056d6f4eb822c776ac656f189b667739b82d0348a5b1e42d/hosts", "Id": "77da25bb0a2353fb056d6f4eb822c776ac656f189b667739b82d0348a5b1e42d", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/77da25bb0a2353fb056d6f4eb822c776ac656f189b667739b82d0348a5b1e42d/77da25bb0a2353fb056d6f4eb822c776ac656f189b667739b82d0348a5b1e42d-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "504df1615bcf34e3ecb3f3adb13e3ebf2a0b2afcebdbf72f2a9656d572e9f266", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/504df1615bcf34e3ecb3f3adb13e3ebf2a0b2afcebdbf72f2a9656d572e9f266/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "a3a9c399b70c994bfe04e2764aa456e7957d5270fee6a7ff26f6b5c76c7a5928", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.11", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0b", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "a3a9c399b70c994bfe04e2764aa456e7957d5270fee6a7ff26f6b5c76c7a5928", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.11", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0b", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "049b6c71b946973c0413c7698a7ae4095cc56f2f99a69e3291dff98d3b6b3b13", "SandboxKey": "/var/run/docker/netns/049b6c71b946", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/77da25bb0a2353fb056d6f4eb822c776ac656f189b667739b82d0348a5b1e42d/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 19028, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:40:21.399908391Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:40:20.863713921Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/6f3dcf64ebbcba3f655d54338e6e7d0b920c2e109754c6debb3576cf4b33be7f-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/6f3dcf64ebbcba3f655d54338e6e7d0b920c2e109754c6debb3576cf4b33be7f/merged", "UpperDir": "/var/lib/docker/overlay2/6f3dcf64ebbcba3f655d54338e6e7d0b920c2e109754c6debb3576cf4b33be7f/diff", "WorkDir": "/var/lib/docker/overlay2/6f3dcf64ebbcba3f655d54338e6e7d0b920c2e109754c6debb3576cf4b33be7f/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/77da25bb0a2353fb056d6f4eb822c776ac656f189b667739b82d0348a5b1e42d/hostname", "HostsPath": "/var/lib/docker/containers/77da25bb0a2353fb056d6f4eb822c776ac656f189b667739b82d0348a5b1e42d/hosts", "Id": "77da25bb0a2353fb056d6f4eb822c776ac656f189b667739b82d0348a5b1e42d", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/77da25bb0a2353fb056d6f4eb822c776ac656f189b667739b82d0348a5b1e42d/77da25bb0a2353fb056d6f4eb822c776ac656f189b667739b82d0348a5b1e42d-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "504df1615bcf34e3ecb3f3adb13e3ebf2a0b2afcebdbf72f2a9656d572e9f266", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/504df1615bcf34e3ecb3f3adb13e3ebf2a0b2afcebdbf72f2a9656d572e9f266/_data", "Type": "volume"}], "Name": "/t6", "NetworkSettings": {"Bridge": "", "EndpointID": "a3a9c399b70c994bfe04e2764aa456e7957d5270fee6a7ff26f6b5c76c7a5928", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.11", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0b", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "a3a9c399b70c994bfe04e2764aa456e7957d5270fee6a7ff26f6b5c76c7a5928", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.11", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0b", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "049b6c71b946973c0413c7698a7ae4095cc56f2f99a69e3291dff98d3b6b3b13", "SandboxKey": "/var/run/docker/netns/049b6c71b946", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/77da25bb0a2353fb056d6f4eb822c776ac656f189b667739b82d0348a5b1e42d/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 19028, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:40:21.399908391Z", "Status": "running"}}, "item": {"default_route_ip": "192.168.134.1", "name": "t6", "pns_if": "t6pns_if", "pns_ip": "192.168.134.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.134.2/24"}}

TASK [Create Subnet Containers] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}], u'vxlan': [{u'local_ip': u'10.2.51.2', u'tenant_route_ip': u'192.168.134.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.2.51.0/24', u'remote_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:40:22.240487433Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/d72a58bfd3fbad4fcf14dc2bc269a0c6f97564f29a26399ef40ce6d5c623de17-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/d72a58bfd3fbad4fcf14dc2bc269a0c6f97564f29a26399ef40ce6d5c623de17/merged", "UpperDir": "/var/lib/docker/overlay2/d72a58bfd3fbad4fcf14dc2bc269a0c6f97564f29a26399ef40ce6d5c623de17/diff", "WorkDir": "/var/lib/docker/overlay2/d72a58bfd3fbad4fcf14dc2bc269a0c6f97564f29a26399ef40ce6d5c623de17/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/ea51ae14a767e82a44dbd3ddcaf2aeabd579e85f62b1269d6612e1b3aac68890/hostname", "HostsPath": "/var/lib/docker/containers/ea51ae14a767e82a44dbd3ddcaf2aeabd579e85f62b1269d6612e1b3aac68890/hosts", "Id": "ea51ae14a767e82a44dbd3ddcaf2aeabd579e85f62b1269d6612e1b3aac68890", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/ea51ae14a767e82a44dbd3ddcaf2aeabd579e85f62b1269d6612e1b3aac68890/ea51ae14a767e82a44dbd3ddcaf2aeabd579e85f62b1269d6612e1b3aac68890-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "469a5d5073da68212af91b0d6350f0a957ea65716ec8c24bbe58d0985ef66fcc", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/469a5d5073da68212af91b0d6350f0a957ea65716ec8c24bbe58d0985ef66fcc/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "36bc49b647e5f37250f69f47cd095b77f1a2d5c1ee468c7a235f1cfa92decc10", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.12", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0c", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "36bc49b647e5f37250f69f47cd095b77f1a2d5c1ee468c7a235f1cfa92decc10", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.12", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0c", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "91201b5cde7402472d4ed833f87328a02d777cf69331fb42a18220631d095368", "SandboxKey": "/var/run/docker/netns/91201b5cde74", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/ea51ae14a767e82a44dbd3ddcaf2aeabd579e85f62b1269d6612e1b3aac68890/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 19910, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:40:23.425982272Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns1", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:40:22.240487433Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/d72a58bfd3fbad4fcf14dc2bc269a0c6f97564f29a26399ef40ce6d5c623de17-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/d72a58bfd3fbad4fcf14dc2bc269a0c6f97564f29a26399ef40ce6d5c623de17/merged", "UpperDir": "/var/lib/docker/overlay2/d72a58bfd3fbad4fcf14dc2bc269a0c6f97564f29a26399ef40ce6d5c623de17/diff", "WorkDir": "/var/lib/docker/overlay2/d72a58bfd3fbad4fcf14dc2bc269a0c6f97564f29a26399ef40ce6d5c623de17/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/ea51ae14a767e82a44dbd3ddcaf2aeabd579e85f62b1269d6612e1b3aac68890/hostname", "HostsPath": "/var/lib/docker/containers/ea51ae14a767e82a44dbd3ddcaf2aeabd579e85f62b1269d6612e1b3aac68890/hosts", "Id": "ea51ae14a767e82a44dbd3ddcaf2aeabd579e85f62b1269d6612e1b3aac68890", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/ea51ae14a767e82a44dbd3ddcaf2aeabd579e85f62b1269d6612e1b3aac68890/ea51ae14a767e82a44dbd3ddcaf2aeabd579e85f62b1269d6612e1b3aac68890-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "469a5d5073da68212af91b0d6350f0a957ea65716ec8c24bbe58d0985ef66fcc", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/469a5d5073da68212af91b0d6350f0a957ea65716ec8c24bbe58d0985ef66fcc/_data", "Type": "volume"}], "Name": "/t6ns1", "NetworkSettings": {"Bridge": "", "EndpointID": "36bc49b647e5f37250f69f47cd095b77f1a2d5c1ee468c7a235f1cfa92decc10", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.12", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0c", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "36bc49b647e5f37250f69f47cd095b77f1a2d5c1ee468c7a235f1cfa92decc10", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.12", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0c", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "91201b5cde7402472d4ed833f87328a02d777cf69331fb42a18220631d095368", "SandboxKey": "/var/run/docker/netns/91201b5cde74", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/ea51ae14a767e82a44dbd3ddcaf2aeabd579e85f62b1269d6612e1b3aac68890/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 19910, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:40:23.425982272Z", "Status": "running"}}, "item": {"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vmif": "t6C3if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6', u'tenant_sub_if': u't6s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python", "docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:40:24.356911907Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/d0e402ce97d80a7e45a9fb2781dd099cfc072595458d15195f4f9a6f6e5bf18c-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/d0e402ce97d80a7e45a9fb2781dd099cfc072595458d15195f4f9a6f6e5bf18c/merged", "UpperDir": "/var/lib/docker/overlay2/d0e402ce97d80a7e45a9fb2781dd099cfc072595458d15195f4f9a6f6e5bf18c/diff", "WorkDir": "/var/lib/docker/overlay2/d0e402ce97d80a7e45a9fb2781dd099cfc072595458d15195f4f9a6f6e5bf18c/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/e5146471c522de59c0d8eb43ccc2e910dc1ad4f117e2267e4fd2cdd09b3fe4f9/hostname", "HostsPath": "/var/lib/docker/containers/e5146471c522de59c0d8eb43ccc2e910dc1ad4f117e2267e4fd2cdd09b3fe4f9/hosts", "Id": "e5146471c522de59c0d8eb43ccc2e910dc1ad4f117e2267e4fd2cdd09b3fe4f9", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/e5146471c522de59c0d8eb43ccc2e910dc1ad4f117e2267e4fd2cdd09b3fe4f9/e5146471c522de59c0d8eb43ccc2e910dc1ad4f117e2267e4fd2cdd09b3fe4f9-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "f42bf6ac2073ed0369ce72b50dcffa8a0c0f034113a095ab95110f54aeded9aa", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/f42bf6ac2073ed0369ce72b50dcffa8a0c0f034113a095ab95110f54aeded9aa/_data", "Type": "volume"}], "Name": "/t6ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "6828ed32ad8a9f195bb2efdd7df0a9cbc4ba8365dafdb22ec88f294b5d07064b", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.13", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0d", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "6828ed32ad8a9f195bb2efdd7df0a9cbc4ba8365dafdb22ec88f294b5d07064b", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.13", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0d", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "0ac048892bfff0376094c9d7852c30119991a388986fb69660956643461f035d", "SandboxKey": "/var/run/docker/netns/0ac048892bff", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/e5146471c522de59c0d8eb43ccc2e910dc1ad4f117e2267e4fd2cdd09b3fe4f9/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 23447, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:40:25.278116808Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "t6ns2", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:40:24.356911907Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/d0e402ce97d80a7e45a9fb2781dd099cfc072595458d15195f4f9a6f6e5bf18c-init/diff:/var/lib/docker/overlay2/57ea2eb7c55c77adf97147c3b1b77a4e186f931a122e0046ce05a7e0fb27d197/diff:/var/lib/docker/overlay2/5b03442cc1e70748a2885562ac9d16b6bd1724d8e53780d584e8f0eabefe7427/diff:/var/lib/docker/overlay2/626fec4d8fd5c7433ba50bc92cfbbb0cdfd900268d2afa9666fd4161a1356a7b/diff:/var/lib/docker/overlay2/eb8317f97dcab61973ffa9ba914051ece017568b7395e079442e7625b575c664/diff", "MergedDir": "/var/lib/docker/overlay2/d0e402ce97d80a7e45a9fb2781dd099cfc072595458d15195f4f9a6f6e5bf18c/merged", "UpperDir": "/var/lib/docker/overlay2/d0e402ce97d80a7e45a9fb2781dd099cfc072595458d15195f4f9a6f6e5bf18c/diff", "WorkDir": "/var/lib/docker/overlay2/d0e402ce97d80a7e45a9fb2781dd099cfc072595458d15195f4f9a6f6e5bf18c/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/e5146471c522de59c0d8eb43ccc2e910dc1ad4f117e2267e4fd2cdd09b3fe4f9/hostname", "HostsPath": "/var/lib/docker/containers/e5146471c522de59c0d8eb43ccc2e910dc1ad4f117e2267e4fd2cdd09b3fe4f9/hosts", "Id": "e5146471c522de59c0d8eb43ccc2e910dc1ad4f117e2267e4fd2cdd09b3fe4f9", "Image": "sha256:bcbe2a1acc38c7bf93dab489aec1248b83d0f86696331d1c2c6c9113523bb3d6", "LogPath": "/var/lib/docker/containers/e5146471c522de59c0d8eb43ccc2e910dc1ad4f117e2267e4fd2cdd09b3fe4f9/e5146471c522de59c0d8eb43ccc2e910dc1ad4f117e2267e4fd2cdd09b3fe4f9-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "f42bf6ac2073ed0369ce72b50dcffa8a0c0f034113a095ab95110f54aeded9aa", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/f42bf6ac2073ed0369ce72b50dcffa8a0c0f034113a095ab95110f54aeded9aa/_data", "Type": "volume"}], "Name": "/t6ns2", "NetworkSettings": {"Bridge": "", "EndpointID": "6828ed32ad8a9f195bb2efdd7df0a9cbc4ba8365dafdb22ec88f294b5d07064b", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.13", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0d", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "6828ed32ad8a9f195bb2efdd7df0a9cbc4ba8365dafdb22ec88f294b5d07064b", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.13", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0d", "NetworkID": "40771a0de81615ddb42787f0eae02f014a09d4f3641fa6b393696b66fbfd26e8"}}, "Ports": {}, "SandboxID": "0ac048892bfff0376094c9d7852c30119991a388986fb69660956643461f035d", "SandboxKey": "/var/run/docker/netns/0ac048892bff", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/e5146471c522de59c0d8eb43ccc2e910dc1ad4f117e2267e4fd2cdd09b3fe4f9/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 23447, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:40:25.278116808Z", "Status": "running"}}, "deprecations": [{"msg": "Distribution Ubuntu 18.04 on host 99.99.99.2 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information", "version": "2.12"}], "item": {"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vmif": "t6C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'pid': u'6842', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link show \"t6if\" ; if [ $? -ne 0 ] ; then ip link add \"t6if\" type veth peer name \"t6pns_if\" ; fi\n", "delta": "0:00:00.190614", "end": "2019-12-06 23:40:31.123392", "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pid": "6842", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}, "rc": 0, "start": "2019-12-06 23:40:30.932778", "stderr": "Device \"t6if\" does not exist.", "stderr_lines": ["Device \"t6if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'pid': u'6842', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t6pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t6pns_if\" netns pns1 ; fi\ndocker exec \"t6\" ip link show \"t6if\" ; if [ $? -ne 0 ] ; then ip link set \"t6if\" netns \"6842\" ; fi\nip netns exec pns1 ip link set dev \"t6pns_if\" up\ndocker exec \"t6\" ip link set dev \"t6if\" up\n", "delta": "0:00:00.487810", "end": "2019-12-06 23:40:31.851798", "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pid": "6842", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}, "rc": 0, "start": "2019-12-06 23:40:31.363988", "stderr": "Device \"t6pns_if\" does not exist.\nDevice \"t6if\" does not exist.", "stderr_lines": ["Device \"t6pns_if\" does not exist.", "Device \"t6if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'pid': u'6842', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t6pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.6.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.6.1/24\" dev \"t6pns_if\" ; fi\ndocker exec \"t6\" ip addr show \"t6if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.6.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t6\" ip addr add \"192.168.6.2/24\" dev \"t6if\" ; fi\n", "delta": "0:00:00.410849", "end": "2019-12-06 23:40:32.538418", "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pid": "6842", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}, "rc": 0, "start": "2019-12-06 23:40:32.127569", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link show \"t6ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t6ns1if\" type veth peer name \"t6s1if\" ; fi\n", "delta": "0:00:00.181536", "end": "2019-12-06 23:40:32.949537", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "rc": 0, "start": "2019-12-06 23:40:32.768001", "stderr": "Device \"t6ns1if\" does not exist.", "stderr_lines": ["Device \"t6ns1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link show \"t6ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t6ns1if\" netns \"6842\" ; fi\ndocker exec \"t6ns1\" ip link show \"t6s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t6s1if\" netns \"7247\" ; fi\n", "delta": "0:00:00.402304", "end": "2019-12-06 23:40:33.606417", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "rc": 0, "start": "2019-12-06 23:40:33.204113", "stderr": "Device \"t6ns1if\" does not exist.\nDevice \"t6s1if\" does not exist.", "stderr_lines": ["Device \"t6ns1if\" does not exist.", "Device \"t6s1if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link set dev \"t6ns1if\" up\ndocker exec \"t6ns1\" ip link set dev \"t6s1if\" up\n", "delta": "0:00:00.318243", "end": "2019-12-06 23:40:34.145063", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "rc": 0, "start": "2019-12-06 23:40:33.826820", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip addr show \"t6s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.51.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip addr add \"10.1.51.2/24\" dev \"t6s1if\" ; fi\n\ndocker exec \"t6\" ip addr show \"t6ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.1.51.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t6\" ip addr add \"10.1.51.1/24\" dev \"t6ns1if\" ; fi\n", "delta": "0:00:00.686082", "end": "2019-12-06 23:40:35.054663", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "rc": 0, "start": "2019-12-06 23:40:34.368581", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route] *********************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'pid': u'6842', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t6\" ip route del default ; fi\n", "delta": "0:00:00.358945", "end": "2019-12-06 23:40:35.665740", "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pid": "6842", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}, "rc": 0, "start": "2019-12-06 23:40:35.306795", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [localhost] => (item={u'default_route_ip': u'192.168.6.1', u'name': u't6', u'pns_ip': u'192.168.6.1/24', u'tenant_if': u't6if', u'pid': u'6842', u'tenant_ip': u'192.168.6.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip route show default | grep -w '[d]efault via 192.168.6.1' ; if [ $? -ne 0 ] ; then docker exec \"t6\" ip route add default via \"192.168.6.1\" ; fi\n", "delta": "0:00:00.357676", "end": "2019-12-06 23:40:36.260936", "item": {"default_route_ip": "192.168.6.1", "name": "t6", "pid": "6842", "pns_if": "t6pns_if", "pns_ip": "192.168.6.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.6.2/24"}, "rc": 0, "start": "2019-12-06 23:40:35.903260", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_ns_name': u't6', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t6ns1\" ip route del default ; fi\n", "delta": "0:00:00.412987", "end": "2019-12-06 23:40:36.892912", "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, "rc": 0, "start": "2019-12-06 23:40:36.479925", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_ns_name': u't6', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip route show default | grep -w '[d]efault via 10.1.51.1' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip route add default via \"10.1.51.1\" ; fi\n", "delta": "0:00:00.335876", "end": "2019-12-06 23:40:37.442062", "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, "rc": 0, "start": "2019-12-06 23:40:37.106186", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside container] ***********************************************************************************************************************
changed: [localhost] => (item={u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_ns_name': u't6', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'tenant_route_ip': u'192.168.6.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.1.51.0/24', u'remote_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" brctl show | grep -w '^t6br1'; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" brctl addbr \"t6br1\" ; fi\ndocker exec \"t6ns1\" ip link set dev \"t6br1\" up\n", "delta": "0:00:00.594760", "end": "2019-12-06 23:40:38.294986", "item": {"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, "rc": 0, "start": "2019-12-06 23:40:37.700226", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link show \"t6s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip link add \"t6s1_dnsbrif\" type veth peer name \"t6s1_dnsif\" ; fi\ndocker exec \"t6ns1\" ip link set dev \"t6s1_dnsbrif\" up\ndocker exec \"t6ns1\" ip link set dev \"t6s1_dnsif\" up\n", "delta": "0:00:00.772817", "end": "2019-12-06 23:40:39.348717", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:40:38.575900", "stderr": "Device \"t6s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t6s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" brctl show \"t6br1\" | grep -w 't6s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" brctl addif \"t6br1\" \"t6s1_dnsbrif\" ; fi\n", "delta": "0:00:00.365634", "end": "2019-12-06 23:40:39.961067", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:40:39.595433", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link show \"t6br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t6C1if1\" type veth peer name \"t6br1if1\" ; fi\nip link set dev \"t6br1if1\" up\nip link set dev \"t6C1if1\" up\n", "delta": "0:00:00.219574", "end": "2019-12-06 23:40:40.434631", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}], "rc": 0, "start": "2019-12-06 23:40:40.215057", "stderr": "Device \"t6br1if1\" does not exist.", "stderr_lines": ["Device \"t6br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link show \"t6br1if2\" ; if [ $? -ne 0 ] ; then ip link add \"t6C2if1\" type veth peer name \"t6br1if2\" ; fi\nip link set dev \"t6br1if2\" up\nip link set dev \"t6C2if1\" up\n", "delta": "0:00:00.183201", "end": "2019-12-06 23:40:40.797538", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "rc": 0, "start": "2019-12-06 23:40:40.614337", "stderr": "Device \"t6br1if2\" does not exist.", "stderr_lines": ["Device \"t6br1if2\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t6br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t6br1if1\" netns \"7247\" ; fi\ndocker exec \"t6ns1\" brctl show \"t6br1\" | grep -w 't6br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" brctl addif \"t6br1\" \"t6br1if1\" ; fi\n", "delta": "0:00:00.396370", "end": "2019-12-06 23:40:41.438999", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}], "rc": 0, "start": "2019-12-06 23:40:41.042629", "stderr": "", "stderr_lines": [], "stdout": "100: t6br1if1@t6C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 06:01:a2:d3:81:48 brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["100: t6br1if1@t6C1if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 06:01:a2:d3:81:48 brd ff:ff:ff:ff:ff:ff"]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t6br1if2\" ; if [ $? -eq 0 ] ; then ip link set \"t6br1if2\" netns \"7247\" ; fi\ndocker exec \"t6ns1\" brctl show \"t6br1\" | grep -w 't6br1if2' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" brctl addif \"t6br1\" \"t6br1if2\" ; fi\n", "delta": "0:00:00.399099", "end": "2019-12-06 23:40:42.013166", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "rc": 0, "start": "2019-12-06 23:40:41.614067", "stderr": "", "stderr_lines": [], "stdout": "102: t6br1if2@t6C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 36:0d:f6:2b:20:8f brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["102: t6br1if2@t6C2if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 36:0d:f6:2b:20:8f brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link set \"t6br1if1\" up\ndocker exec \"t6ns1\" ip link set dev \"t6br1\" up\n", "delta": "0:00:00.362300", "end": "2019-12-06 23:40:42.613417", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}], "rc": 0, "start": "2019-12-06 23:40:42.251117", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link set \"t6br1if2\" up\ndocker exec \"t6ns1\" ip link set dev \"t6br1\" up\n", "delta": "0:00:00.357118", "end": "2019-12-06 23:40:43.133134", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "rc": 0, "start": "2019-12-06 23:40:42.776016", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip addr show \"t6s1_dnsif\" | awk 'FNR==3{ print $2 }' | grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip addr add \"1.1.1.1/24\" dev \"t6s1_dnsif\" ; fi\n", "delta": "0:00:00.380729", "end": "2019-12-06 23:40:43.760828", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:40:43.380099", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}], u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ps aux | grep -w '[d]nsmasq --interface t6s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" dnsmasq --interface \"t6s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.847598", "end": "2019-12-06 23:40:44.846991", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:40:43.999393", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}]}, {u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link show \"vxlan_t6s1\" ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip link add \"vxlan_t6s1\" type vxlan id \"42\" local \"10.1.51.2\" remote \"10.2.51.2\" dstport \"4789\" dev \"t6s1if\"; docker exec \"t6ns1\" ip link set dev \"vxlan_t6s1\" up ; fi\n", "delta": "0:00:00.591512", "end": "2019-12-06 23:40:45.684119", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}]}, {"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}], "rc": 0, "start": "2019-12-06 23:40:45.092607", "stderr": "Device \"vxlan_t6s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t6s1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}]}, {u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" brctl show \"t6br1\" | grep -w 'vxlan_t6s1' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" brctl addif \"t6br1\" \"vxlan_t6s1\" ; fi\n", "delta": "0:00:00.331220", "end": "2019-12-06 23:40:46.246032", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}]}, {"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}], "rc": 0, "start": "2019-12-06 23:40:45.914812", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Create Tenant VETH pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.134.1', u'name': u't6', u'pns_ip': u'192.168.134.1/24', u'tenant_if': u't6if', u'pid': u'19028', u'tenant_ip': u'192.168.134.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link show \"t6if\" ; if [ $? -ne 0 ] ; then ip link add \"t6if\" type veth peer name \"t6pns_if\" ; fi\n", "delta": "0:00:00.192583", "end": "2019-12-06 23:40:47.693921", "item": {"default_route_ip": "192.168.134.1", "name": "t6", "pid": "19028", "pns_if": "t6pns_if", "pns_ip": "192.168.134.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.134.2/24"}, "rc": 0, "start": "2019-12-06 23:40:47.501338", "stderr": "Device \"t6if\" does not exist.", "stderr_lines": ["Device \"t6if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Tenant VETH Pairs] *****************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.134.1', u'name': u't6', u'pns_ip': u'192.168.134.1/24', u'tenant_if': u't6if', u'pid': u'19028', u'tenant_ip': u'192.168.134.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip link show \"t6pns_if\" ; if [ $? -ne 0 ] ; then ip link set \"t6pns_if\" netns pns1 ; fi\ndocker exec \"t6\" ip link show \"t6if\" ; if [ $? -ne 0 ] ; then ip link set \"t6if\" netns \"19028\" ; fi\nip netns exec pns1 ip link set dev \"t6pns_if\" up\ndocker exec \"t6\" ip link set dev \"t6if\" up\n", "delta": "0:00:00.460609", "end": "2019-12-06 23:40:48.486706", "item": {"default_route_ip": "192.168.134.1", "name": "t6", "pid": "19028", "pns_if": "t6pns_if", "pns_ip": "192.168.134.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.134.2/24"}, "rc": 0, "start": "2019-12-06 23:40:48.026097", "stderr": "Device \"t6pns_if\" does not exist.\nDevice \"t6if\" does not exist.", "stderr_lines": ["Device \"t6pns_if\" does not exist.", "Device \"t6if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Tenant VETH Pairs] ****************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.134.1', u'name': u't6', u'pns_ip': u'192.168.134.1/24', u'tenant_if': u't6if', u'pid': u'19028', u'tenant_ip': u'192.168.134.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip addr show \"t6pns_if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.134.1/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip addr add \"192.168.134.1/24\" dev \"t6pns_if\" ; fi\ndocker exec \"t6\" ip addr show \"t6if\" | awk 'FNR==3{ print $2 }' | grep -w '^192.168.134.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t6\" ip addr add \"192.168.134.2/24\" dev \"t6if\" ; fi\n", "delta": "0:00:00.474706", "end": "2019-12-06 23:40:49.308096", "item": {"default_route_ip": "192.168.134.1", "name": "t6", "pid": "19028", "pns_if": "t6pns_if", "pns_ip": "192.168.134.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.134.2/24"}, "rc": 0, "start": "2019-12-06 23:40:48.833390", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}], u'vxlan': [{u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}, {u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link show \"t6ns1if\" ; if [ $? -ne 0 ] ; then ip link add \"t6ns1if\" type veth peer name \"t6s1if\" ; fi\n", "delta": "0:00:00.189528", "end": "2019-12-06 23:40:49.822879", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}, {"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "rc": 0, "start": "2019-12-06 23:40:49.633351", "stderr": "Device \"t6ns1if\" does not exist.", "stderr_lines": ["Device \"t6ns1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link show \"t6ns2if\" ; if [ $? -ne 0 ] ; then ip link add \"t6ns2if\" type veth peer name \"t6s2if\" ; fi\n", "delta": "0:00:00.192940", "end": "2019-12-06 23:40:50.282797", "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "rc": 0, "start": "2019-12-06 23:40:50.089857", "stderr": "Device \"t6ns2if\" does not exist.", "stderr_lines": ["Device \"t6ns2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach Namespace VETH Pairs] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}], u'vxlan': [{u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}, {u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link show \"t6ns1if\" ; if [ $? -ne 0 ] ; then ip link set \"t6ns1if\" netns \"19028\" ; fi\ndocker exec \"t6ns1\" ip link show \"t6s1if\" ; if [ $? -ne 0 ] ; then ip link set \"t6s1if\" netns \"19910\" ; fi\n", "delta": "0:00:00.421994", "end": "2019-12-06 23:40:51.044128", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}, {"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "rc": 0, "start": "2019-12-06 23:40:50.622134", "stderr": "Device \"t6ns1if\" does not exist.\nDevice \"t6s1if\" does not exist.", "stderr_lines": ["Device \"t6ns1if\" does not exist.", "Device \"t6s1if\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link show \"t6ns2if\" ; if [ $? -ne 0 ] ; then ip link set \"t6ns2if\" netns \"19028\" ; fi\ndocker exec \"t6ns2\" ip link show \"t6s2if\" ; if [ $? -ne 0 ] ; then ip link set \"t6s2if\" netns \"23447\" ; fi\n", "delta": "0:00:00.411976", "end": "2019-12-06 23:40:51.724071", "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "rc": 0, "start": "2019-12-06 23:40:51.312095", "stderr": "Device \"t6ns2if\" does not exist.\nDevice \"t6s2if\" does not exist.", "stderr_lines": ["Device \"t6ns2if\" does not exist.", "Device \"t6s2if\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Set Namespace VETH Pairs UP] **************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}], u'vxlan': [{u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}, {u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link set dev \"t6ns1if\" up\ndocker exec \"t6ns1\" ip link set dev \"t6s1if\" up\n", "delta": "0:00:00.417224", "end": "2019-12-06 23:40:52.487563", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}, {"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "rc": 0, "start": "2019-12-06 23:40:52.070339", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip link set dev \"t6ns2if\" up\ndocker exec \"t6ns2\" ip link set dev \"t6s2if\" up\n", "delta": "0:00:00.384220", "end": "2019-12-06 23:40:53.148628", "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "rc": 0, "start": "2019-12-06 23:40:52.764408", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP addresses to Namespace VETH Pairs] *************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}], u'vxlan': [{u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}, {u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip addr show \"t6s1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.51.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip addr add \"10.2.51.2/24\" dev \"t6s1if\" ; fi\n\ndocker exec \"t6\" ip addr show \"t6ns1if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.51.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t6\" ip addr add \"10.2.51.1/24\" dev \"t6ns1if\" ; fi\n", "delta": "0:00:00.769166", "end": "2019-12-06 23:40:54.249975", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}, {"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "rc": 0, "start": "2019-12-06 23:40:53.480809", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns2\" ip addr show \"t6s2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.52.2/24' ; if [ $? -ne 0 ] ; then docker exec \"t6ns2\" ip addr add \"10.2.52.2/24\" dev \"t6s2if\" ; fi\n\ndocker exec \"t6\" ip addr show \"t6ns2if\" | awk 'FNR==3{ print $2 }' | grep -w '^10.2.52.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t6\" ip addr add \"10.2.52.1/24\" dev \"t6ns2if\" ; fi\n", "delta": "0:00:00.800639", "end": "2019-12-06 23:40:55.316175", "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "rc": 0, "start": "2019-12-06 23:40:54.515536", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route] *********************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.134.1', u'name': u't6', u'pns_ip': u'192.168.134.1/24', u'tenant_if': u't6if', u'pid': u'19028', u'tenant_ip': u'192.168.134.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t6\" ip route del default ; fi\n", "delta": "0:00:00.398377", "end": "2019-12-06 23:40:56.047193", "item": {"default_route_ip": "192.168.134.1", "name": "t6", "pid": "19028", "pns_if": "t6pns_if", "pns_ip": "192.168.134.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.134.2/24"}, "rc": 0, "start": "2019-12-06 23:40:55.648816", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant] *******************************************************************************************************************************
changed: [99.99.99.2] => (item={u'default_route_ip': u'192.168.134.1', u'name': u't6', u'pns_ip': u'192.168.134.1/24', u'tenant_if': u't6if', u'pid': u'19028', u'tenant_ip': u'192.168.134.2/24', u'pns_if': u't6pns_if'}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6\" ip route show default | grep -w '[d]efault via 192.168.134.1' ; if [ $? -ne 0 ] ; then docker exec \"t6\" ip route add default via \"192.168.134.1\" ; fi\n", "delta": "0:00:00.419512", "end": "2019-12-06 23:40:56.800964", "item": {"default_route_ip": "192.168.134.1", "name": "t6", "pid": "19028", "pns_if": "t6pns_if", "pns_ip": "192.168.134.1/24", "tenant_if": "t6if", "tenant_ip": "192.168.134.2/24"}, "rc": 0, "start": "2019-12-06 23:40:56.381452", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Delete default route in tenant subnet] ****************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_ns_name': u't6', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}], u'vxlan': [{u'local_ip': u'10.2.51.2', u'tenant_route_ip': u'192.168.134.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.2.51.0/24', u'remote_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t6ns1\" ip route del default ; fi\n", "delta": "0:00:00.392971", "end": "2019-12-06 23:40:57.536187", "item": {"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}, "rc": 0, "start": "2019-12-06 23:40:57.143216", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_ns_name': u't6', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_sub_if': u't6s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns2\" ip route show default | grep -w '[d]efault via' ; if [ $? -eq 0 ] ; then docker exec \"t6ns2\" ip route del default ; fi\n", "delta": "0:00:00.439189", "end": "2019-12-06 23:40:58.269419", "item": {"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:40:57.830230", "stderr": "", "stderr_lines": [], "stdout": "default via 172.17.0.1 dev eth0 ", "stdout_lines": ["default via 172.17.0.1 dev eth0 "]}

TASK [Add IP Route to Tenant Subnet] ************************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_ns_name': u't6', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}], u'vxlan': [{u'local_ip': u'10.2.51.2', u'tenant_route_ip': u'192.168.134.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.2.51.0/24', u'remote_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip route show default | grep -w '[d]efault via 10.2.51.1' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip route add default via \"10.2.51.1\" ; fi\n", "delta": "0:00:00.384347", "end": "2019-12-06 23:40:58.996275", "item": {"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}, "rc": 0, "start": "2019-12-06 23:40:58.611928", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_ns_name': u't6', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_sub_if': u't6s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns2\" ip route show default | grep -w '[d]efault via 10.2.52.1' ; if [ $? -ne 0 ] ; then docker exec \"t6ns2\" ip route add default via \"10.2.52.1\" ; fi\n", "delta": "0:00:00.388272", "end": "2019-12-06 23:40:59.699973", "item": {"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:40:59.311701", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create bridge inside namespace] ***********************************************************************************************************************
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_ns_name': u't6', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_sub_if': u't6s1if'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}], u'vxlan': [{u'local_ip': u'10.2.51.2', u'tenant_route_ip': u'192.168.134.2', u'dsport': 4789, u'dev': u't6s1if', u'subnet_route': u'10.2.51.0/24', u'remote_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" brctl show | grep -w '^t6br1'; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" brctl addbr \"t6br1\" ; fi\ndocker exec \"t6ns1\" ip link set dev \"t6br1\" up\n", "delta": "0:00:00.604100", "end": "2019-12-06 23:41:00.679076", "item": {"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}, "rc": 0, "start": "2019-12-06 23:41:00.074976", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item={u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_ns_name': u't6', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_sub_if': u't6s2if'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}], u'vxlan': [{u'local_ip': [], u'tenant_route_ip': [], u'dsport': [], u'dev': [], u'subnet_route': [], u'remote_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns2\" brctl show | grep -w '^t6br2'; if [ $? -ne 0 ] ; then docker exec \"t6ns2\" brctl addbr \"t6br2\" ; fi\ndocker exec \"t6ns2\" ip link set dev \"t6br2\" up\n", "delta": "0:00:00.605263", "end": "2019-12-06 23:41:01.547988", "item": {"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, "rc": 0, "start": "2019-12-06 23:41:00.942725", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}], u'vxlan': [{u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}, {u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link show \"t6s1_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip link add \"t6s1_dnsbrif\" type veth peer name \"t6s1_dnsif\" ; fi\ndocker exec \"t6ns1\" ip link set dev \"t6s1_dnsbrif\" up\ndocker exec \"t6ns1\" ip link set dev \"t6s1_dnsif\" up\n", "delta": "0:00:00.802927", "end": "2019-12-06 23:41:02.736695", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:41:01.933768", "stderr": "Device \"t6s1_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t6s1_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns2\" ip link show \"t6s2_dnsbrif\" ; if [ $? -ne 0 ] ; then docker exec \"t6ns2\" ip link add \"t6s2_dnsbrif\" type veth peer name \"t6s2_dnsif\" ; fi\ndocker exec \"t6ns2\" ip link set dev \"t6s2_dnsbrif\" up\ndocker exec \"t6ns2\" ip link set dev \"t6s2_dnsif\" up\n", "delta": "0:00:00.821350", "end": "2019-12-06 23:41:03.867013", "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:41:03.045663", "stderr": "Device \"t6s2_dnsbrif\" does not exist.", "stderr_lines": ["Device \"t6s2_dnsbrif\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach DNS VETH Pair] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}], u'vxlan': [{u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}, {u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" brctl show \"t6br1\" | grep -w 't6s1_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" brctl addif \"t6br1\" \"t6s1_dnsbrif\" ; fi\n", "delta": "0:00:00.393607", "end": "2019-12-06 23:41:04.609201", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:41:04.215594", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns2\" brctl show \"t6br2\" | grep -w 't6s2_dnsbrif' ; if [ $? -ne 0 ] ; then docker exec \"t6ns2\" brctl addif \"t6br2\" \"t6s2_dnsbrif\" ; fi\n", "delta": "0:00:00.418015", "end": "2019-12-06 23:41:05.326169", "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:41:04.908154", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}, {u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link show \"t6br1if1\" ; if [ $? -ne 0 ] ; then ip link add \"t6C3if1\" type veth peer name \"t6br1if1\" ; fi\nip link set dev \"t6br1if1\" up\nip link set dev \"t6C3if1\" up\n", "delta": "0:00:00.176714", "end": "2019-12-06 23:41:05.843420", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}], "rc": 0, "start": "2019-12-06 23:41:05.666706", "stderr": "Device \"t6br1if1\" does not exist.", "stderr_lines": ["Device \"t6br1if1\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns2\" ip link show \"t6br2if1\" ; if [ $? -ne 0 ] ; then ip link add \"t6C4if1\" type veth peer name \"t6br2if1\" ; fi\nip link set dev \"t6br2if1\" up\nip link set dev \"t6C4if1\" up\n", "delta": "0:00:00.192710", "end": "2019-12-06 23:41:06.326637", "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}], "rc": 0, "start": "2019-12-06 23:41:06.133927", "stderr": "Device \"t6br2if1\" does not exist.", "stderr_lines": ["Device \"t6br2if1\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}, {u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t6br1if1\" ; if [ $? -eq 0 ] ; then ip link set \"t6br1if1\" netns \"19910\" ; fi\ndocker exec \"t6ns1\" brctl show \"t6br1\" | grep -w 't6br1if1' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" brctl addif \"t6br1\" \"t6br1if1\" ; fi\n", "delta": "0:00:00.447799", "end": "2019-12-06 23:41:07.159056", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}], "rc": 0, "start": "2019-12-06 23:41:06.711257", "stderr": "", "stderr_lines": [], "stdout": "119: t6br1if1@t6C3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether b2:a3:a6:82:3b:ed brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["119: t6br1if1@t6C3if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether b2:a3:a6:82:3b:ed brd ff:ff:ff:ff:ff:ff"]}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t6br2if1\" ; if [ $? -eq 0 ] ; then ip link set \"t6br2if1\" netns \"23447\" ; fi\ndocker exec \"t6ns2\" brctl show \"t6br2\" | grep -w 't6br2if1' ; if [ $? -ne 0 ] ; then docker exec \"t6ns2\" brctl addif \"t6br2\" \"t6br2if1\" ; fi\n", "delta": "0:00:00.445509", "end": "2019-12-06 23:41:07.869148", "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}], "rc": 0, "start": "2019-12-06 23:41:07.423639", "stderr": "", "stderr_lines": [], "stdout": "121: t6br2if1@t6C4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 5e:59:40:9b:d9:fe brd ff:ff:ff:ff:ff:ff", "stdout_lines": ["121: t6br2if1@t6C4if1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 5e:59:40:9b:d9:fe brd ff:ff:ff:ff:ff:ff"]}

TASK [All interfaces and bridges UP] ************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}, {u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link set \"t6br1if1\" up\ndocker exec \"t6ns1\" ip link set dev \"t6br1\" up\n", "delta": "0:00:00.455815", "end": "2019-12-06 23:41:08.703172", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}], "rc": 0, "start": "2019-12-06 23:41:08.247357", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'2.2.2.0/24', u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns2\" ip link set \"t6br2if1\" up\ndocker exec \"t6ns2\" ip link set dev \"t6br2\" up\n", "delta": "0:00:00.428558", "end": "2019-12-06 23:41:09.431800", "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}], "rc": 0, "start": "2019-12-06 23:41:09.003242", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Add IP to DNS Interface] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}], u'vxlan': [{u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}, {u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip addr show \"t6s1_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^1.1.1.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip addr add \"1.1.1.1/24\" dev \"t6s1_dnsif\" ; fi\n", "delta": "0:00:00.400539", "end": "2019-12-06 23:41:10.239483", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:41:09.838944", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns2\" ip addr show \"t6s2_dnsif\" | awk 'FNR==3{ print $2}'| grep -w '^2.2.2.1/24' ; if [ $? -ne 0 ] ; then docker exec \"t6ns2\" ip addr add \"2.2.2.1/24\" dev \"t6s2_dnsif\" ; fi\n", "delta": "0:00:00.397270", "end": "2019-12-06 23:41:10.913058", "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:41:10.515788", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Install DHCP Server] **********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}], u'vxlan': [{u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]}, {u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ps aux | grep -w '[d]nsmasq --interface t6s1_dnsif -z --dhcp-range=1.1.1.5,1.1.1.254' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" dnsmasq --interface \"t6s1_dnsif\" -z --dhcp-range=1.1.1.5,'1.1.1.254' ; fi\n", "delta": "0:00:00.881612", "end": "2019-12-06 23:41:12.138562", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:41:11.256950", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}], u'vxlan': [{u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}]}, {u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns2\" ps aux | grep -w '[d]nsmasq --interface t6s2_dnsif -z --dhcp-range=2.2.2.5,2.2.2.254' ; if [ $? -ne 0 ] ; then docker exec \"t6ns2\" dnsmasq --interface \"t6s2_dnsif\" -z --dhcp-range=2.2.2.5,'2.2.2.254' ; fi\n", "delta": "0:00:00.879553", "end": "2019-12-06 23:41:13.293337", "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}], "vxlan": [{"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}]}, {"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "rc": 0, "start": "2019-12-06 23:41:12.413784", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Create VXLAN devices] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}]}, {u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" ip link show \"vxlan_t6s1\" ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" ip link add \"vxlan_t6s1\" type vxlan id \"42\" local \"10.2.51.2\" remote \"10.1.51.2\" dstport \"4789\" dev \"t6s1if\" ; docker exec \"t6ns1\" ip link set dev \"vxlan_t6s1\" up ; fi\n", "delta": "0:00:00.628848", "end": "2019-12-06 23:41:14.292835", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}]}, {"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}], "rc": 0, "start": "2019-12-06 23:41:13.663987", "stderr": "Device \"vxlan_t6s1\" does not exist.", "stderr_lines": ["Device \"vxlan_t6s1\" does not exist."], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Attach VXLANs to bridge] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}]}, {u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6ns1\" brctl show \"t6br1\" | grep -w 'vxlan_t6s1' ; if [ $? -ne 0 ] ; then docker exec \"t6ns1\" brctl addif \"t6br1\" \"vxlan_t6s1\" ; fi\n", "delta": "0:00:00.395508", "end": "2019-12-06 23:41:15.043891", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}]}, {"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}], "rc": 0, "start": "2019-12-06 23:41:14.648383", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=21   changed=21   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}]}, {u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip route show \"10.1.51.0/24\" via \"192.168.6.2\" | grep -w '^10.1.51.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip route add \"10.1.51.0/24\" via \"192.168.6.2\" ; fi\n", "delta": "0:00:00.078682", "end": "2019-12-06 23:41:16.258186", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}]}, {"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}], "rc": 0, "start": "2019-12-06 23:41:16.179504", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": "ip netns exec pns1 ip addr show p11 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.035230", "end": "2019-12-06 23:41:16.522498", "rc": 0, "start": "2019-12-06 23:41:16.487268", "stderr": "", "stderr_lines": [], "stdout": "192.168.200.207", "stdout_lines": ["192.168.200.207"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}]}, {u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.1.51.0/24\" via \"192.168.200.207\" | grep -w '^10.1.51.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.1.51.0/24\" via \"192.168.200.207\" ; fi\nip route show \"10.2.51.0/24\" via 99.99.99.2 | grep -w '^10.2.51.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.2.51.0/24\" via 99.99.99.2 ; fi\n", "delta": "0:00:00.010230", "end": "2019-12-06 23:41:16.791005", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}]}, {"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}], "rc": 0, "start": "2019-12-06 23:41:16.780775", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Add VXLAN routes in PNS] ******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}]}, {u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec pns1 ip route show \"10.2.51.0/24\" via \"192.168.134.2\" | grep -w '^10.2.51.0/24' ; if [ $? -ne 0 ] ; then ip netns exec pns1 ip route add \"10.2.51.0/24\" via \"192.168.134.2\" ; fi\n", "delta": "0:00:00.089082", "end": "2019-12-06 23:41:18.167086", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}]}, {"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}], "rc": 0, "start": "2019-12-06 23:41:18.078004", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

TASK [Get PNS ip address] ***********************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": "ip netns exec pns1 ip addr show p11 | awk 'FNR==3{ print $2 }' | awk -F/ '{ print $1 }'\n", "delta": "0:00:00.038339", "end": "2019-12-06 23:41:18.563605", "rc": 0, "start": "2019-12-06 23:41:18.525266", "stderr": "", "stderr_lines": [], "stdout": "192.168.200.5", "stdout_lines": ["192.168.200.5"]}

TASK [Add VXLAN routes to host] *****************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.51.1', u'pid': u'19910', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.2.51.2/24', u'tenant_ns_ip': u'10.2.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C3if1', u'name': u't6_C3'}]}, {u'local_ip': u'10.2.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.134.2', u'remote_route': u'10.1.51.0/24', u'subnet_route': u'10.2.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.1.51.2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip route show \"10.2.51.0/24\" via \"192.168.200.5\" | grep -w '^10.2.51.0/24' ; if [ $? -ne 0 ] ; then ip route add \"10.2.51.0/24\" via \"192.168.200.5\" ; fi\nip route show \"10.1.51.0/24\" via 99.99.99.1 | grep -w '^10.1.51.0/24'; if [ $? -ne 0 ] ; then ip route add \"10.1.51.0/24\" via 99.99.99.1 ; fi\n", "delta": "0:00:00.008604", "end": "2019-12-06 23:41:18.928499", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.2.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "19910", "route": [{"if": "p1", "ip": "10.2.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.2.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.2.51.2/24"}], "vms": [{"brif": "t6br1if1", "name": "t6_C3", "vm_pid": "", "vmif": "t6C3if1"}]}, {"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.2.51.2", "remote_ip": "10.1.51.2", "remote_route": "10.1.51.0/24", "subnet_route": "10.2.51.0/24", "tenant_route_ip": "192.168.134.2", "v_name": "vxlan_t6s1"}], "rc": 0, "start": "2019-12-06 23:41:18.919895", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
skipping: [99.99.99.2] => (item=[{u'route': [{u'ip': u'10.2.52.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.2.52.1', u'pid': u'23447', u'bridge_name': u't6br2', u'dns': [{u'dnsif': u't6s2_dnsif', u'dhcp_start': u'2.2.2.5', u'dhcp_end': u'2.2.2.254', u'dnsif_ip': u'2.2.2.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s2_dnsbrif'}], u'ns_name': u't6ns2', u'tenant_ns': [{u'tenant_ns_pid': u'19028', u'tenant_sub_if': u't6s2if', u'tenant_sub_ip': u'10.2.52.2/24', u'tenant_ns_ip': u'10.2.52.1/24', u'tenant_ns_if': u't6ns2if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'2.2.2.0/24', u'vms': [{u'vm_pid': u'', u'brif': u't6br2if1', u'vmif': u't6C4if1', u'name': u't6_C4'}]}, {u'local_ip': [], u'dsport': [], u'dev': [], u'tenant_route_ip': [], u'remote_route': [], u'subnet_route': [], u'v_name': [], u'id': [], u'remote_ip': []}])  => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t6br2", "default_route_ip": "10.2.52.1", "dns": [{"brif": "t6s2_dnsbrif", "dhcp_end": "2.2.2.254", "dhcp_start": "2.2.2.5", "dnsif": "t6s2_dnsif", "dnsif_ip": "2.2.2.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns2", "pid": "23447", "route": [{"if": "p1", "ip": "10.2.52.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "2.2.2.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns2if", "tenant_ns_ip": "10.2.52.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "19028", "tenant_sub_if": "t6s2if", "tenant_sub_ip": "10.2.52.2/24"}], "vms": [{"brif": "t6br2if1", "name": "t6_C4", "vm_pid": "", "vmif": "t6C4if1"}]}, {"dev": [], "dsport": [], "id": [], "local_ip": [], "remote_ip": [], "remote_route": [], "subnet_route": [], "tenant_route_ip": [], "v_name": []}], "skip_reason": "Conditional result was False"}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Build Docker Image] ***********************************************************************************************************************************
ok: [localhost] => {"actions": [], "changed": false, "image": {}}

TASK [Spawning Tenant Container] ****************************************************************************************************************************
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}]) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:41:20.998073307Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/1efdaabf5d48d9ccfb8437bab18ee080c2b506ce2731fccdad788dd17b8456e0-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/1efdaabf5d48d9ccfb8437bab18ee080c2b506ce2731fccdad788dd17b8456e0/merged", "UpperDir": "/var/lib/docker/overlay2/1efdaabf5d48d9ccfb8437bab18ee080c2b506ce2731fccdad788dd17b8456e0/diff", "WorkDir": "/var/lib/docker/overlay2/1efdaabf5d48d9ccfb8437bab18ee080c2b506ce2731fccdad788dd17b8456e0/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/d69f417f73d916499cf8e31050764a0456721602e2c1f91226f09c20bb25ff1e/hostname", "HostsPath": "/var/lib/docker/containers/d69f417f73d916499cf8e31050764a0456721602e2c1f91226f09c20bb25ff1e/hosts", "Id": "d69f417f73d916499cf8e31050764a0456721602e2c1f91226f09c20bb25ff1e", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/d69f417f73d916499cf8e31050764a0456721602e2c1f91226f09c20bb25ff1e/d69f417f73d916499cf8e31050764a0456721602e2c1f91226f09c20bb25ff1e-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "4aa9d3758c0586b59666033bf514a45a1936bd11aa5d65cd006daea63ab8c995", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/4aa9d3758c0586b59666033bf514a45a1936bd11aa5d65cd006daea63ab8c995/_data", "Type": "volume"}], "Name": "/t6_C1", "NetworkSettings": {"Bridge": "", "EndpointID": "edf93f435c40f1ad5b82358b79492e5efc3961712f0642ceb2008fc0c3e87224", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.13", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0d", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "edf93f435c40f1ad5b82358b79492e5efc3961712f0642ceb2008fc0c3e87224", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.13", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0d", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "f903a3e189b1013d0a2e3f434abc1a0aeea54fad41b7bbea881cd1f5e322f36d", "SandboxKey": "/var/run/docker/netns/f903a3e189b1", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/d69f417f73d916499cf8e31050764a0456721602e2c1f91226f09c20bb25ff1e/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 22899, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:41:21.589448808Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:41:20.998073307Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/1efdaabf5d48d9ccfb8437bab18ee080c2b506ce2731fccdad788dd17b8456e0-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/1efdaabf5d48d9ccfb8437bab18ee080c2b506ce2731fccdad788dd17b8456e0/merged", "UpperDir": "/var/lib/docker/overlay2/1efdaabf5d48d9ccfb8437bab18ee080c2b506ce2731fccdad788dd17b8456e0/diff", "WorkDir": "/var/lib/docker/overlay2/1efdaabf5d48d9ccfb8437bab18ee080c2b506ce2731fccdad788dd17b8456e0/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/d69f417f73d916499cf8e31050764a0456721602e2c1f91226f09c20bb25ff1e/hostname", "HostsPath": "/var/lib/docker/containers/d69f417f73d916499cf8e31050764a0456721602e2c1f91226f09c20bb25ff1e/hosts", "Id": "d69f417f73d916499cf8e31050764a0456721602e2c1f91226f09c20bb25ff1e", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/d69f417f73d916499cf8e31050764a0456721602e2c1f91226f09c20bb25ff1e/d69f417f73d916499cf8e31050764a0456721602e2c1f91226f09c20bb25ff1e-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "4aa9d3758c0586b59666033bf514a45a1936bd11aa5d65cd006daea63ab8c995", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/4aa9d3758c0586b59666033bf514a45a1936bd11aa5d65cd006daea63ab8c995/_data", "Type": "volume"}], "Name": "/t6_C1", "NetworkSettings": {"Bridge": "", "EndpointID": "edf93f435c40f1ad5b82358b79492e5efc3961712f0642ceb2008fc0c3e87224", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.13", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0d", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "edf93f435c40f1ad5b82358b79492e5efc3961712f0642ceb2008fc0c3e87224", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.13", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0d", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "f903a3e189b1013d0a2e3f434abc1a0aeea54fad41b7bbea881cd1f5e322f36d", "SandboxKey": "/var/run/docker/netns/f903a3e189b1", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/d69f417f73d916499cf8e31050764a0456721602e2c1f91226f09c20bb25ff1e/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 22899, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:41:21.589448808Z", "Status": "running"}}, "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}]}
changed: [localhost] => (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}]) => {"ansible_facts": {"docker_container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:41:22.148048503Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/e4605c3799388adf23a00c5da2b96ab9438366879d5118a0e08b28e1a91fd9fa-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/e4605c3799388adf23a00c5da2b96ab9438366879d5118a0e08b28e1a91fd9fa/merged", "UpperDir": "/var/lib/docker/overlay2/e4605c3799388adf23a00c5da2b96ab9438366879d5118a0e08b28e1a91fd9fa/diff", "WorkDir": "/var/lib/docker/overlay2/e4605c3799388adf23a00c5da2b96ab9438366879d5118a0e08b28e1a91fd9fa/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c99f0f933a30a37ab0e4171ecd8a626ee8bb2f439332fc725f3f1fa67a3d3899/hostname", "HostsPath": "/var/lib/docker/containers/c99f0f933a30a37ab0e4171ecd8a626ee8bb2f439332fc725f3f1fa67a3d3899/hosts", "Id": "c99f0f933a30a37ab0e4171ecd8a626ee8bb2f439332fc725f3f1fa67a3d3899", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/c99f0f933a30a37ab0e4171ecd8a626ee8bb2f439332fc725f3f1fa67a3d3899/c99f0f933a30a37ab0e4171ecd8a626ee8bb2f439332fc725f3f1fa67a3d3899-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "e472fce003e12e9497a7c2e75a4e269a147711dbb59a9309f7fd87f3024b9e97", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/e472fce003e12e9497a7c2e75a4e269a147711dbb59a9309f7fd87f3024b9e97/_data", "Type": "volume"}], "Name": "/t6_C2", "NetworkSettings": {"Bridge": "", "EndpointID": "4859081ed4c032231b8db2affe6cd78045a0cfdea59b44550f0c06f1ecb99ef1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.14", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0e", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "4859081ed4c032231b8db2affe6cd78045a0cfdea59b44550f0c06f1ecb99ef1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.14", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0e", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "ded6f83259668cbfc4c3836f8bf43f00a315cf2abbc8861176688926dd006a00", "SandboxKey": "/var/run/docker/netns/ded6f8325966", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c99f0f933a30a37ab0e4171ecd8a626ee8bb2f439332fc725f3f1fa67a3d3899/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 23276, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:41:23.317326453Z", "Status": "running"}}}, "ansible_loop_var": "item", "changed": true, "container": {"AppArmorProfile": "unconfined", "Args": [], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/sbin/init"], "Domainname": "", "Entrypoint": null, "Env": ["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "container=docker"], "Hostname": "test", "Image": "centos7:latest", "Labels": {"org.label-schema.build-date": "20191001", "org.label-schema.license": "GPLv2", "org.label-schema.name": "CentOS Base Image", "org.label-schema.schema-version": "1.0", "org.label-schema.vendor": "CentOS"}, "OnBuild": null, "OpenStdin": true, "StdinOnce": false, "Tty": true, "User": "", "Volumes": {"/sys/fs/cgroup": {}}, "WorkingDir": ""}, "Created": "2019-12-06T23:41:22.148048503Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/e4605c3799388adf23a00c5da2b96ab9438366879d5118a0e08b28e1a91fd9fa-init/diff:/var/lib/docker/overlay2/740285405c0aa9c16dbd4b74e20f2c309b179b015b63db41bc7bd9f89e15c5f7/diff:/var/lib/docker/overlay2/d4ae9105e6ad5e9cead206fb709e8a2c24193f036a4616ae036fb9ed0938bde0/diff:/var/lib/docker/overlay2/db4afff961be3fb4e9f4ba89def4da4cc707119565e7da5308c73935fe4e5042/diff:/var/lib/docker/overlay2/82ed5b703396e6df7f37d00f5d7c75c71a8308a7e265b2924c004a0e2c76fa87/diff", "MergedDir": "/var/lib/docker/overlay2/e4605c3799388adf23a00c5da2b96ab9438366879d5118a0e08b28e1a91fd9fa/merged", "UpperDir": "/var/lib/docker/overlay2/e4605c3799388adf23a00c5da2b96ab9438366879d5118a0e08b28e1a91fd9fa/diff", "WorkDir": "/var/lib/docker/overlay2/e4605c3799388adf23a00c5da2b96ab9438366879d5118a0e08b28e1a91fd9fa/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Capabilities": null, "Cgroup": "", "CgroupParent": "", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "KernelMemory": 0, "KernelMemoryTCP": 0, "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": null, "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "default", "OomKillDisable": false, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": true, "PublishAllPorts": false, "ReadonlyPaths": null, "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": ["label=disable"], "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/c99f0f933a30a37ab0e4171ecd8a626ee8bb2f439332fc725f3f1fa67a3d3899/hostname", "HostsPath": "/var/lib/docker/containers/c99f0f933a30a37ab0e4171ecd8a626ee8bb2f439332fc725f3f1fa67a3d3899/hosts", "Id": "c99f0f933a30a37ab0e4171ecd8a626ee8bb2f439332fc725f3f1fa67a3d3899", "Image": "sha256:d4e956d7556692894f4ebd94889ae2211ef634b402794c9241932e02f58f9a81", "LogPath": "/var/lib/docker/containers/c99f0f933a30a37ab0e4171ecd8a626ee8bb2f439332fc725f3f1fa67a3d3899/c99f0f933a30a37ab0e4171ecd8a626ee8bb2f439332fc725f3f1fa67a3d3899-json.log", "MountLabel": "", "Mounts": [{"Destination": "/sys/fs/cgroup", "Driver": "local", "Mode": "", "Name": "e472fce003e12e9497a7c2e75a4e269a147711dbb59a9309f7fd87f3024b9e97", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/e472fce003e12e9497a7c2e75a4e269a147711dbb59a9309f7fd87f3024b9e97/_data", "Type": "volume"}], "Name": "/t6_C2", "NetworkSettings": {"Bridge": "", "EndpointID": "4859081ed4c032231b8db2affe6cd78045a0cfdea59b44550f0c06f1ecb99ef1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.14", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:42:ac:11:00:0e", "Networks": {"bridge": {"Aliases": null, "DriverOpts": null, "EndpointID": "4859081ed4c032231b8db2affe6cd78045a0cfdea59b44550f0c06f1ecb99ef1", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.17.0.14", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:11:00:0e", "NetworkID": "77d20a05a037c898d28843603b89c85882ac354e0a6e3a2ade7584c6cd373956"}}, "Ports": {}, "SandboxID": "ded6f83259668cbfc4c3836f8bf43f00a315cf2abbc8861176688926dd006a00", "SandboxKey": "/var/run/docker/netns/ded6f8325966", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/sbin/init", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/c99f0f933a30a37ab0e4171ecd8a626ee8bb2f439332fc725f3f1fa67a3d3899/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 23276, "Restarting": false, "Running": true, "StartedAt": "2019-12-06T23:41:23.317326453Z", "Status": "running"}}, "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}]}

TASK [Attach Container interface] ***************************************************************************************************************************
failed: [localhost] (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'vm_pid': u'', u'brif': u't6br1if1', u'vmif': u't6C1if1', u'name': u't6_C1'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6_C1\" ip link show \"t6C1if1\" ; if [ $? -ne 0 ] ; then ip link set \"t6C1if1\" netns \"\" ; fi\n", "delta": "0:00:00.506484", "end": "2019-12-06 23:41:24.501244", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if1", "name": "t6_C1", "vm_pid": "", "vmif": "t6C1if1"}], "msg": "non-zero return code", "rc": 2, "start": "2019-12-06 23:41:23.994760", "stderr": "Device \"t6C1if1\" does not exist.\nRTNETLINK answers: Invalid argument", "stderr_lines": ["Device \"t6C1if1\" does not exist.", "RTNETLINK answers: Invalid argument"], "stdout": "", "stdout_lines": []}
failed: [localhost] (item=[{u'route': [{u'ip': u'10.1.51.1/24', u'ns_name': u't6', u'ns_if': u't6if', u'if': u'p1'}], u'default_route_ip': u'10.1.51.1', u'pid': u'7247', u'bridge_name': u't6br1', u'dns': [{u'dnsif': u't6s1_dnsif', u'dhcp_start': u'1.1.1.5', u'dhcp_end': u'1.1.1.254', u'dnsif_ip': u'1.1.1.1/24', u'net_mask': u'255.255.255.0', u'brif': u't6s1_dnsbrif'}], u'ns_name': u't6ns1', u'tenant_ns': [{u'tenant_ns_pid': u'6842', u'tenant_sub_if': u't6s1if', u'tenant_sub_ip': u'10.1.51.2/24', u'tenant_ns_ip': u'10.1.51.1/24', u'tenant_ns_if': u't6ns1if', u'tenant_ns_name': u't6'}], u'subnet_ip': u'1.1.1.0/24', u'vxlan': [{u'local_ip': u'10.1.51.2', u'dsport': 4789, u'dev': u't6s1if', u'tenant_route_ip': u'192.168.6.2', u'remote_route': u'10.2.51.0/24', u'subnet_route': u'10.1.51.0/24', u'v_name': u'vxlan_t6s1', u'id': 42, u'remote_ip': u'10.2.51.2'}]}, {u'vm_pid': u'', u'brif': u't6br1if2', u'vmif': u't6C2if1', u'name': u't6_C2'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "docker exec \"t6_C2\" ip link show \"t6C2if1\" ; if [ $? -ne 0 ] ; then ip link set \"t6C2if1\" netns \"\" ; fi\n", "delta": "0:00:00.398839", "end": "2019-12-06 23:41:25.176356", "item": [{"bridge_name": "t6br1", "default_route_ip": "10.1.51.1", "dns": [{"brif": "t6s1_dnsbrif", "dhcp_end": "1.1.1.254", "dhcp_start": "1.1.1.5", "dnsif": "t6s1_dnsif", "dnsif_ip": "1.1.1.1/24", "net_mask": "255.255.255.0"}], "ns_name": "t6ns1", "pid": "7247", "route": [{"if": "p1", "ip": "10.1.51.1/24", "ns_if": "t6if", "ns_name": "t6"}], "subnet_ip": "1.1.1.0/24", "tenant_ns": [{"tenant_ns_if": "t6ns1if", "tenant_ns_ip": "10.1.51.1/24", "tenant_ns_name": "t6", "tenant_ns_pid": "6842", "tenant_sub_if": "t6s1if", "tenant_sub_ip": "10.1.51.2/24"}], "vxlan": [{"dev": "t6s1if", "dsport": 4789, "id": 42, "local_ip": "10.1.51.2", "remote_ip": "10.2.51.2", "remote_route": "10.2.51.0/24", "subnet_route": "10.1.51.0/24", "tenant_route_ip": "192.168.6.2", "v_name": "vxlan_t6s1"}]}, {"brif": "t6br1if2", "name": "t6_C2", "vm_pid": "", "vmif": "t6C2if1"}], "msg": "non-zero return code", "rc": 2, "start": "2019-12-06 23:41:24.777517", "stderr": "Device \"t6C2if1\" does not exist.\nRTNETLINK answers: Invalid argument", "stderr_lines": ["Device \"t6C2if1\" does not exist.", "RTNETLINK answers: Invalid argument"], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=2    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   

